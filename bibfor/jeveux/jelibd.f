      SUBROUTINE JELIBD ( NOMLU , LTOT )
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF JEVEUX  DATE 13/11/2012   AUTEUR COURTOIS M.COURTOIS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C ----------------------------------------------------------------------
C
C LIBERE DE LA MEMOIRE LE SEGMENT DE VALEURS ASSOCIES A UN OBJET
C JEVEUX ALLOUE DYNAMIQUEMENT LORSQU'IL EST DANS L'ETAT XA OU XD
C
C IN   NOMLU : NOM DE L'OBJET A LIBERER
C OUT  LTOT  : LONGUEUR EN ENTIERS LIBEREE
C
C ----------------------------------------------------------------------
C RESPONSABLE LEFEBVRE J-P.LEFEBVRE
C POUR LES VARS I4ZON, LSZON, R8ZON QUI DANS UN COMMON MAIS UNIQUEMENT
C PAR EQUIVALENCE
C TOLE CRS_512
      IMPLICIT NONE
      INCLUDE 'jeveux_private.h'
      CHARACTER*(*)    NOMLU
C
      INTEGER          LK1ZON , JK1ZON , LISZON , JISZON 
      COMMON /IZONJE/  LK1ZON , JK1ZON , LISZON , JISZON
C     -----------------------------------------------------------------
      INTEGER          ICLAS ,ICLAOS , ICLACO , IDATOS , IDATCO , IDATOC
      COMMON /IATCJE/  ICLAS ,ICLAOS , ICLACO , IDATOS , IDATCO , IDATOC
C     ------------------------------------------------------------------
C-----------------------------------------------------------------------
      INTEGER IADMI ,IADYN ,IBACOL ,IBIADM 
      INTEGER INAT  ,IXDESO ,IXIADD ,IXIADM ,JCARA 
      INTEGER JDATE ,JDOCU ,JGENR ,JHCOD ,JIACCE ,JIADD ,JIADM 
      INTEGER JINDIR ,JLONG ,JLONO ,JLTYP ,JLUTI ,JMARQ ,JORIG 
      INTEGER JRNOM ,JTYPE ,K ,LTOT ,LTYPI ,N 
      INTEGER NBACCE ,NBMAX 
C-----------------------------------------------------------------------
      PARAMETER  ( N = 5 )
      COMMON /JIATJE/  JLTYP(N), JLONG(N), JDATE(N), JIADD(N), JIADM(N),
     +                 JLONO(N), JHCOD(N), JCARA(N), JLUTI(N), JMARQ(N)
C
      COMMON /JKATJE/  JGENR(N), JTYPE(N), JDOCU(N), JORIG(N), JRNOM(N)
C
      INTEGER          NBLMAX    , NBLUTI    , LONGBL    ,
     &                 KITLEC    , KITECR    ,             KIADM    ,
     &                 IITLEC    , IITECR    , NITECR    , KMARQ
      COMMON /IFICJE/  NBLMAX(N) , NBLUTI(N) , LONGBL(N) ,
     &                 KITLEC(N) , KITECR(N) ,             KIADM(N) ,
     &                 IITLEC(N) , IITECR(N) , NITECR(N) , KMARQ(N)
      CHARACTER*2      DN2
      CHARACTER*5      CLASSE
      CHARACTER*8                  NOMFIC    , KSTOUT    , KSTINI
      COMMON /KFICJE/  CLASSE    , NOMFIC(N) , KSTOUT(N) , KSTINI(N) ,
     +                 DN2(N)
C
      INTEGER          NRHCOD    , NREMAX    , NREUTI
      COMMON /ICODJE/  NRHCOD(N) , NREMAX(N) , NREUTI(N)
      COMMON /JIACCE/  JIACCE(N),NBACCE(2*N)
      COMMON /JINDIR/  JINDIR(N)
      INTEGER          ISSTAT
      COMMON /ICONJE/  ISSTAT
      INTEGER          LDYN , LGDYN , NBDYN , NBFREE
      COMMON /IDYNJE/  LDYN , LGDYN , NBDYN , NBFREE
      INTEGER          ICDYN , MXLTOT
      COMMON /XDYNJE/  ICDYN , MXLTOT
      REAL *8         MXDYN, MCDYN, MLDYN, VMXDYN, VMET, LGIO
      COMMON /R8DYJE/ MXDYN, MCDYN, MLDYN, VMXDYN, VMET, LGIO(2)
      INTEGER          LBIS , LOIS , LOLS , LOR8 , LOC8
      COMMON /IENVJE/  LBIS , LOIS , LOLS , LOR8 , LOC8
      INTEGER          DATEI
      COMMON /IHEUJE/  DATEI
C ----------------------------------------------------------------------
      INTEGER        IVNMAX     , IDDESO     , IDIADD    , IDIADM
      PARAMETER    ( IVNMAX = 0 , IDDESO = 1 , IDIADD = 2 , IDIADM = 3 )
C ----------------------------------------------------------------------
      CHARACTER*32   NOML32
      INTEGER        ICRE,IRET
C
      NOML32 = NOMLU
      LTOT = 0
      ICRE = 0
      CALL JJVERN ( NOML32 , ICRE , IRET )
C
      IF ( IRET .EQ. 0 ) THEN
        CALL U2MESK('A','JEVEUX_26',1,NOML32(1:24))
        GOTO 9999
      ELSE IF ( IRET .EQ. 1 ) THEN
C
C ----  CAS D'UN OBJET SIMPLE
C
        INAT = 1
        IADMI  = IADM (JIADM(ICLAOS)+2*IDATOS-1)
        LTYPI  = LTYP (JLTYP(ICLAOS)+IDATOS)
        IF ( IADMI .EQ. 0 ) THEN
          GOTO 9999
        ENDIF
        IADYN = IADM(JIADM(ICLAOS)+2*IDATOS)
C
        CALL JJLBSG (ICLAOS, IDATOS, 0, 0, IADMI, IADYN, LTOT)
C
      ELSE IF ( IRET .EQ. 2 ) THEN
C
C ----- CAS D'UNE COLLECTION
C
        CALL JJALLC ( ICLACO , IDATCO , 'L' , IBACOL )
        IF ( NOML32(25:32) .EQ. '        ') THEN
          INAT = 2
        ELSE
          CALL JJCROC ( NOML32(25:32) , ICRE )
          INAT = 3
        ENDIF
      ENDIF
      IF ( INAT .EQ. 2 ) THEN
C
C ----- CAS D'UNE COLLECTION ENTIERE : ON LIBERE TOUS LES OC
C
        IXIADD = ISZON ( JISZON + IBACOL + IDIADD )
        IXIADM = ISZON ( JISZON + IBACOL + IDIADM )
        IXDESO = ISZON ( JISZON + IBACOL + IDDESO )
        LTYPI  = LTYP( JLTYP(ICLACO) + IXDESO )
        IF ( IXIADD .EQ. 0 ) THEN
C
C ------- COLLECTION CONTIGUE
C
          IADMI  = IADM ( JIADM(ICLACO) + 2*IXDESO-1 )
          IF ( IADMI .EQ. 0 ) THEN
            GOTO 9999
          ENDIF
          IADYN = IADM ( JIADM(ICLACO) + 2*IXDESO   )
C
          CALL JJLBSG (ICLACO, IXDESO, 0, 0, IADMI, IADYN, LTOT)
C
        ELSE
C
C ------- COLLECTION DISPERSEE
C
          NBMAX  = ISZON ( JISZON + IBACOL + IVNMAX )
          IBIADM = IADM ( JIADM(ICLACO) + 2*IXIADM-1 )
          DO 10 K = 1,NBMAX
            IADMI = ISZON(JISZON + IBIADM - 1 + 2*K-1 )
            IF ( IADMI .EQ. 0 ) THEN
              GOTO 10
            ENDIF
            IADYN  = ISZON(JISZON + IBIADM - 1 + 2*K   )
C
            CALL JJLBSG (ICLACO, IDATCO, K, IBACOL, IADMI, IADYN, LTOT)
C
 10       CONTINUE
        ENDIF
      ELSE IF ( INAT .EQ. 3 ) THEN
C       ------ CAS D'UN OBJET DE COLLECTION  ------
        IXIADD = ISZON ( JISZON + IBACOL + IDIADD )
        IXIADM = ISZON ( JISZON + IBACOL + IDIADM )
        IXDESO = ISZON ( JISZON + IBACOL + IDDESO )
        LTYPI = LTYP( JLTYP(ICLACO) + IXDESO )
        IF ( IXIADD .NE. 0 ) THEN
C
C -------- COLLECTION DISPERSEE
C
          IBIADM = IADM ( JIADM(ICLACO) + 2*IXIADM-1 )
          IADMI  = ISZON(JISZON + IBIADM - 1 + 2*IDATOC-1 )
          IF ( IADMI .EQ. 0 ) THEN
            GOTO 9999
          ENDIF
          IADYN  = ISZON(JISZON + IBIADM - 1 + 2*IDATOC)
C
          CALL JJLBSG (ICLACO,IDATCO,IDATOC,IBACOL,IADMI,IADYN,LTOT)
C
        ENDIF
      ENDIF
 9999 CONTINUE
C
      END
