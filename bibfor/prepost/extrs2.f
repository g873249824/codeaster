      SUBROUTINE EXTRS2 ( RESU0, RESU1, TYPCON,
     >                    NBORDR, NUORDR, NBACC, NOMACC,
     >                    NBARCH, NUARCH, NBEXCL, CHEXCL, NBNOSY )
      IMPLICIT   NONE
      INTEGER NBORDR,NUORDR(*),NBARCH,NBACC,NUARCH(*),NBEXCL,NBNOSY
      CHARACTER*16 NOMACC(*),CHEXCL(*)
      CHARACTER*(*) RESU0, RESU1
      CHARACTER*16 TYPCON
C     ------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF PREPOST  DATE 24/09/2007   AUTEUR REZETTE C.REZETTE 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C     OPERATEUR D'EXTRACTION
C     ------------------------------------------------------------------

C     ----- DEBUT COMMUNS NORMALISES  JEVEUX  --------------------------
      INTEGER ZI
      COMMON /IVARJE/ZI(1)
      REAL*8 ZR
      COMMON /RVARJE/ZR(1)
      COMPLEX*16 ZC
      COMMON /CVARJE/ZC(1)
      LOGICAL ZL
      COMMON /LVARJE/ZL(1)
      CHARACTER*8 ZK8
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*32 ZK32
      CHARACTER*80 ZK80
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
      CHARACTER*32 JEXNUM
C     -----  FIN  COMMUNS NORMALISES  JEVEUX  --------------------------
C
C 0.3. ==> VARIABLES LOCALES
C
      INTEGER LXLGUT
      INTEGER VALI(2)
C
      INTEGER I,J,IRE1,IRE2,IADIN,IADOU,IRET
      CHARACTER*3 TYPE
      CHARACTER*16 NOMSYM
      CHARACTER*16 NOPARA
      CHARACTER*19 RESUIN,RESUOU
      CHARACTER*24 CHAMIN,CHAMOU
      CHARACTER*24 VALK
C     ------------------------------------------------------------------

      CALL JEMARQ( )
C
C               1234567890123456789
      RESUIN = '                   '
      RESUOU = '                   '
      I = LXLGUT(RESU0)
      RESUIN(1:I) = RESU0(1:I)
      I = LXLGUT(RESU1)
      RESUOU(1:I) = RESU1(1:I)
C

      CALL JEEXIN (RESUOU//'.DESC',IRET)
      IF ( IRET.EQ.0 ) THEN
        CALL RSCRSD (RESUOU,TYPCON,NBARCH)
      ENDIF


      DO 30 I = 1,NBNOSY

        CALL JENUNO(JEXNUM(RESUIN//'.DESC',I),NOMSYM)
        DO 10 J = 1,NBEXCL
          IF ( CHEXCL(J) .EQ. NOMSYM ) GO TO 30
   10   CONTINUE

        DO 20 J = 1,NBORDR
          IF (NUARCH(J).EQ.0) GO TO 20
          CALL RSEXCH(RESUIN,NOMSYM,NUORDR(J),CHAMIN,IRE1)
          IF (IRE1.GT.0) GO TO 20

          CALL RSEXCH(RESUOU,NOMSYM,NUORDR(J),CHAMOU,IRE2)
          IF (IRE2.EQ.0) THEN
          ELSE IF (IRE2.EQ.100) THEN
          ELSE
            VALI (1) = NUORDR(J)
            VALI (2) = IRE2
            VALK = CHAMOU
            CALL U2MESG('F', 'PREPOST5_16',1,VALK,2,VALI,0,0.D0)
          END IF
          CALL COPISD('CHAMP_GD','G',CHAMIN,CHAMOU)
          CALL RSNOCH(RESUOU,NOMSYM,NUORDR(J),' ')
   20   CONTINUE
   30 CONTINUE


      DO 50 I = 1 , NBORDR
        IF ( NUARCH(I).EQ.0 ) GOTO 50
        DO 40 J = 1 , NBACC
          NOPARA = NOMACC(J)
          CALL RSADPA(RESUIN,'L',1,NOPARA,NUORDR(I),1,IADIN,TYPE)
          CALL RSADPA(RESUOU,'E',1,NOPARA,NUORDR(I),1,IADOU,TYPE)
          IF (TYPE(1:1).EQ.'I') THEN
            ZI(IADOU) = ZI(IADIN)
          ELSEIF (TYPE(1:1).EQ.'R') THEN
            ZR(IADOU) = ZR(IADIN)
          ELSEIF (TYPE(1:1).EQ.'C') THEN
            ZC(IADOU) = ZC(IADIN)
          ELSEIF (TYPE(1:3).EQ.'K80') THEN
            ZK80(IADOU) = ZK80(IADIN)
          ELSEIF (TYPE(1:3).EQ.'K32') THEN
            ZK32(IADOU) = ZK32(IADIN)
          ELSEIF (TYPE(1:3).EQ.'K24') THEN
            ZK24(IADOU) = ZK24(IADIN)
            IF(NOPARA(1:5).EQ.'EXCIT'.AND.ZK24(IADIN)(1:2).NE.'  ')THEN
              ZK24(IADOU) = RESUOU(1:8)//ZK24(IADIN)(9:)
              CALL COPISD(' ','G',ZK24(IADIN)(1:19),ZK24(IADOU)(1:19))
            ENDIF
          ELSEIF (TYPE(1:3).EQ.'K16') THEN
            ZK16(IADOU) = ZK16(IADIN)
          ELSEIF (TYPE(1:2).EQ.'K8') THEN
            ZK8(IADOU) = ZK8(IADIN)
          ENDIF
   40   CONTINUE
   50 CONTINUE

      CALL JEDEMA( )

      END
