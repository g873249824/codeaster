      SUBROUTINE IMPFR5 (NOMNOZ, NOMCMZ, LONLIS, VALE, 
     +                   FORM3, FORM4, IFM)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF PREPOST  DATE 16/06/2004   AUTEUR DURAND C.DURAND 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C.======================================================================
      IMPLICIT REAL*8 (A-H,O-Z)
C
C      IMPFR5 -- IMPRESSION D'UNE LIGNE D'UNE MATRICE ELEMENTAIRE
C                D 'UN MATR_ELEM SELON LE GRAIN 'MAILLE'
C                (I.E. ON IMPRIME CHAQUE LIGNE D'UNE 
C                      MATRICE ELEMENTAIRE)
C                LA LIGNE NE CONTIENT QUE LES VALEURS
C                DES COMPOSANTES LICITES 
C                (LICITE VEUT DIRE 'CHOISI PAR L'UTILISATEUR')
C
C   ARGUMENT        E/S  TYPE         ROLE
C    NOMNOZ          IN   K*     NOM DU NOEUD POUR LEQUEL ON VA 
C                                IMPRIMER LA LIGNE DE LA MATRICE
C    NOMCMZ          IN   K*     NOM DE LA COMPOSANTE POUR LAQUELLLE  
C                                ON VA IMPRIMER LA LIGNE DE LA MATRICE
C    LONLIS          IN   I      LONGUEUR 'UTILE' DES TABLEAUX NOMNOE,
C                                NOMCMP ET  VALE
C    NOMNOE(*)       IN   K8     LISTE DES NOEUDS SUR-LESQUELS PORTENT
C                                LES TERMES DU TABLEAU VALE
C    NOMCMP(*)       IN   K8     LISTE DES COMPOSANTES SUR-LESQUELLES 
C                                PORTENT LES TERMES DU TABLEAU VALE
C    VALE(*)         IN   R      TABLEAU DES VALEURS DE LA LIGNE OU
C                                DE LA COLONNE A IMPRIMER 
C    FORM3           IN   K72    FORMAT D'IMPRESSION D'UNE LIGNE DU
C                                CADRE
C    FORM4           IN   K72    FORMAT D'IMPRESSION D'UNE LIGNE DE
C                                LA MATRICE ELEMENTAIRE
C    NBCHIF          IN    I     NOMBRE DE CHIFFRES SIGNIFICATIFS
C    IFM             IN    I     UNITE LOGIQUE D'IMPRESSION
C.========================= DEBUT DES DECLARATIONS ====================
C -----  ARGUMENTS
      CHARACTER*(*) NOMNOZ, NOMCMZ
      CHARACTER*72  FORM3, FORM4
      REAL*8        VALE(*)
C -----  VARIABLES LOCALES
      CHARACTER*1   SLACH 
      CHARACTER*1   EXCLAM 
      CHARACTER*8   NOMNO1, NOMCM1
      CHARACTER*17  NOMNC1
C
C.========================= DEBUT DU CODE EXECUTABLE ==================
C
C --- INITIALISATIONS :
C     ---------------
      SLACH  = '/'
      EXCLAM = '!'
      NOMNO1 = NOMNOZ
      NOMCM1 = NOMCMZ
      NOMNC1 = NOMNO1(1:LXLGUT(NOMNO1))//SLACH//NOMCM1
C
C --- IMPRESSION DES VALEURS PAR LIGNE :
C     --------------------------------
      WRITE(IFM,FORM4) EXCLAM, NOMNC1, EXCLAM,
     +                        (VALE(I),EXCLAM,I=1,LONLIS)
      WRITE(IFM,FORM3) 
C
      END
