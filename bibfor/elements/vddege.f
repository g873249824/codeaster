      SUBROUTINE VDDEGE(NOMTE,NB1,NPGSR,XR,DEGGTG,DEGGT)
      IMPLICIT NONE
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ELEMENTS  DATE 05/02/2013   AUTEUR LEBOUVIER F.LEBOUVIER 
C ======================================================================
C COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C
C CALCUL DE L'OPTION EDGE_ELNO POUR LES COQUE_3D
C
      CHARACTER*16 NOMTE
      REAL*8 XR(*),DEGGTG(8,*),DEGGT(8,9)
      INTEGER I ,I1 ,J ,K ,L1 ,NB1 ,NPGSR

      DO 5 I=1,NB1
      DO 6 J=1,8
         DEGGT(J,I)=0.D0
 6    CONTINUE
 5    CONTINUE
C
      L1 =1452
C
      IF (NOMTE.EQ.'MEC3QU9H') THEN

         DO 15 I=1,NB1
           I1=L1+4*(I-1)
           DO 20 K=1,NPGSR
             DEGGT(1,I)=DEGGT(1,I)+DEGGTG(1,K)*XR(I1+K)
             DEGGT(2,I)=DEGGT(2,I)+DEGGTG(2,K)*XR(I1+K)
             DEGGT(3,I)=DEGGT(3,I)+DEGGTG(3,K)*XR(I1+K)
             DEGGT(4,I)=DEGGT(4,I)+DEGGTG(4,K)*XR(I1+K)
             DEGGT(5,I)=DEGGT(5,I)+DEGGTG(5,K)*XR(I1+K)
             DEGGT(6,I)=DEGGT(6,I)+DEGGTG(6,K)*XR(I1+K)
             DEGGT(7,I)=DEGGT(7,I)+DEGGTG(7,K)*XR(I1+K)
             DEGGT(8,I)=DEGGT(8,I)+DEGGTG(8,K)*XR(I1+K)
 20        CONTINUE
 15      CONTINUE
C
C     VALEURS AU NOEUD INTERNE OBTENUE PAR MOYENNE DES AUTRES
C
         DEGGT(1,9)=(DEGGT(1,5)+DEGGT(1,6)+DEGGT(1,7)+DEGGT(1,8))/4.D0
         DEGGT(2,9)=(DEGGT(2,5)+DEGGT(2,6)+DEGGT(2,7)+DEGGT(2,8))/4.D0
         DEGGT(3,9)=(DEGGT(3,5)+DEGGT(3,6)+DEGGT(3,7)+DEGGT(3,8))/4.D0
         DEGGT(4,9)=(DEGGT(4,5)+DEGGT(4,6)+DEGGT(4,7)+DEGGT(4,8))/4.D0
         DEGGT(5,9)=(DEGGT(5,5)+DEGGT(5,6)+DEGGT(5,7)+DEGGT(5,8))/4.D0
         DEGGT(6,9)=(DEGGT(6,5)+DEGGT(6,6)+DEGGT(6,7)+DEGGT(6,8))/4.D0
         DEGGT(7,9)=(DEGGT(7,5)+DEGGT(7,6)+DEGGT(7,7)+DEGGT(7,8))/4.D0
         DEGGT(8,9)=(DEGGT(8,5)+DEGGT(8,6)+DEGGT(8,7)+DEGGT(8,8))/4.D0
C
      ELSE IF (NOMTE.EQ.'MEC3TR7H') THEN
C
         DO 35 I=1,NB1
           I1=L1+4*(I-1)
           DO 40 K=1,NPGSR
             DEGGT(1,I)=DEGGT(1,I)+DEGGTG(1,K)*XR(I1+K)
             DEGGT(2,I)=DEGGT(2,I)+DEGGTG(2,K)*XR(I1+K)
             DEGGT(3,I)=DEGGT(3,I)+DEGGTG(3,K)*XR(I1+K)
             DEGGT(4,I)=DEGGT(4,I)+DEGGTG(4,K)*XR(I1+K)
             DEGGT(5,I)=DEGGT(5,I)+DEGGTG(5,K)*XR(I1+K)
             DEGGT(6,I)=DEGGT(6,I)+DEGGTG(6,K)*XR(I1+K)
             DEGGT(7,I)=DEGGT(7,I)+DEGGTG(7,K)*XR(I1+K)
             DEGGT(8,I)=DEGGT(8,I)+DEGGTG(8,K)*XR(I1+K)
 40        CONTINUE
 35      CONTINUE
C
C     VALEURS AU NOEUD INTERNE OBTENUE PAR MOYENNE DES AUTRES
C
         DEGGT(1,7)=(DEGGT(1,1)+DEGGT(1,2)+DEGGT(1,3))/3.D0
         DEGGT(2,7)=(DEGGT(2,1)+DEGGT(2,2)+DEGGT(2,3))/3.D0
         DEGGT(3,7)=(DEGGT(3,1)+DEGGT(3,2)+DEGGT(3,3))/3.D0
         DEGGT(4,7)=(DEGGT(4,1)+DEGGT(4,2)+DEGGT(4,3))/3.D0
         DEGGT(5,7)=(DEGGT(5,1)+DEGGT(5,2)+DEGGT(5,3))/3.D0
         DEGGT(6,7)=(DEGGT(6,1)+DEGGT(6,2)+DEGGT(6,3))/3.D0
         DEGGT(7,7)=(DEGGT(7,1)+DEGGT(7,2)+DEGGT(7,3))/3.D0
         DEGGT(8,7)=(DEGGT(8,1)+DEGGT(8,2)+DEGGT(8,3))/3.D0
C
      ENDIF
C
      END
