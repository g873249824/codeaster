      SUBROUTINE TE0581 ( OPTION , NOMTE )
      IMPLICIT NONE
C-----------------------------------------------------------------------
C MODIF ELEMENTS  DATE 13/05/2013   AUTEUR PELLET J.PELLET 
C ======================================================================
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C-----------------------------------------------------------------------
C  DESCRIPTION : REALISE L'OPTION ADD_SIGM :
C  -----------   ADDITION DE CONTRAINTES AUX ELEMENTS
C
C  IN     : OPTION : CHARACTER*16 , SCALAIRE
C                    OPTION DE CALCUL
C  IN     : NOMTE  : CHARACTER*16 , SCALAIRE
C                    NOM DU TYPE ELEMENT
C
C-------------------   DECLARATION DES VARIABLES   ---------------------
C
C
C ARGUMENTS
C ---------
      INCLUDE 'jeveux.h'
      CHARACTER*16  OPTION, NOMTE
C
C VARIABLES LOCALES
C -----------------
      INTEGER       JTAB1(7),JTAB2(7),JTAB3(7),IRET
      INTEGER       J1,J2,J3,NBCMP,NBSP,NBSP2,NBSP1,NBPT
      CHARACTER*24  VALK(2)
      REAL*8 V1,V2
C
C-------------------   DEBUT DU CODE EXECUTABLE    ---------------------

      CALL TECACH('ONN','PEPCON1','L',7,JTAB1,IRET)
      CALL TECACH('ONN','PEPCON2','L',7,JTAB2,IRET)
      CALL TECACH('ONN','PEPCON3','E',7,JTAB3,IRET)

      IF ( (JTAB1(1).EQ.0).OR.(JTAB2(1).EQ.0).OR.(JTAB3(1).EQ.0)) THEN
         VALK(1) = OPTION
         VALK(2) = NOMTE
         CALL U2MESK('F','ELEMENTS4_38', 2 ,VALK)
      ENDIF

      IF (( JTAB1(2).NE.JTAB2(2) ).OR.( JTAB1(3).NE.JTAB2(3) ))
     &   CALL U2MESK('F','ELEMENTS4_39',1,OPTION)


      NBPT=JTAB3(3)
      CALL ASSERT(NBPT.EQ.JTAB1(3))

      NBSP=JTAB3(7)
      NBSP1=JTAB1(7)
      NBSP2=JTAB2(7)
      CALL ASSERT(NBSP.EQ.NBSP1)
      CALL ASSERT((NBSP2.EQ.NBSP).OR.(NBSP2.EQ.1))

      NBCMP=JTAB3(2)/NBPT
      CALL ASSERT(JTAB3(2).EQ.NBCMP*NBPT)

      DO 20 J1 = 1, NBPT
         DO 21 J2 = 1, NBSP
            DO 22 J3 = 1, NBCMP
               V1= ZR(JTAB1(1)+(J1-1)*NBSP*NBCMP+(J2-1)*NBCMP+J3-1)
               IF (NBSP.EQ.NBSP2) THEN
                 V2= ZR(JTAB2(1)+(J1-1)*NBSP*NBCMP+(J2-1)*NBCMP+J3-1)
               ELSE
                 CALL ASSERT(NBSP2.EQ.1)
                 V2= ZR(JTAB2(1)+(J1-1)*NBCMP+J3-1)
               END IF
C              -- LA PRECONTRAINTE != 0 N'EST AUTORISEE QUE POUR
C              LES ELEMENTS DE BARRE (CABLES DE PRECONTRAINTE) :
               IF (V2.NE.0.D0) CALL ASSERT(NOMTE.EQ.'MECA_BARRE')
               ZR(JTAB3(1)+(J1-1)*NBSP*NBCMP+(J2-1)*NBCMP+J3-1)=V1+V2
  22        CONTINUE
  21     CONTINUE
  20  CONTINUE

      END
