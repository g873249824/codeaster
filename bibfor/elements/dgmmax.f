      SUBROUTINE DGMMAX(EB,NUB,NUM,NUF,H,A,B1,B,MP,DRP,W,C)

      IMPLICIT NONE

C PARAMETRES ENTRANTS
      REAL*8  EB,NUB,NUM,NUF
      REAL*8  H,A,B1,B,DRP

C PARAMETRES SORTANTS
      REAL*8  D3,W,MP,C

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ELEMENTS  DATE 03/01/2011   AUTEUR SFAYOLLE S.FAYOLLE 
C ======================================================================
C COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE SFAYOLLE S.FAYOLLE
C ----------------------------------------------------------------------
C
C BUT : CALCUL DES INFORMATIONS NECESSAIRES A LA DETERMINATION DES
C PENTES POST ELASTIQUE EN FLEXION DE GLRC_DM OPTION EPSI_MAX
C OU PENTE_LIM
C
C ----------------------------------------------------------------------

C PARAMETRES INTERMEDIAIRES
      REAL*8  DELTA,X1,X2,M,F
      REAL*8  D1,D2,D4,D5,A1,Z

      M=EB/(1.D0-NUB**2)*(1.D0-NUB*NUM)
      F=EB/(1.D0-NUB**2)/2.D0*(1.D0-NUB*NUF)
      A1=F-M
      Z=(B+M*H/2.D0)
      C=-F*H**2/4.D0-H*B1

      DELTA=Z*Z-4.D0*A1*C
      X1=(Z-SQRT(DELTA))/(2.D0*A1)
      X2=(Z+SQRT(DELTA))/(2.D0*A1)

      IF (ABS(X1) .GE. ABS(X2)) THEN
        W=ABS(X2)
      ELSE
        W=ABS(X1)
      ENDIF

      D1=EB/(1.D0-NUB**2)*(1.D0-NUB*NUM)*(H/2.D0-W)+B
      D2=-EB/(1.D0-NUB**2)/2.D0*(1.D0-NUB*NUF)*(H**2/4.D0-W**2)-H*B1
      D3=-D2/D1
      D4=EB/(1.D0-NUB**2)*(-(1.D0-NUB*NUM)*D3/2.D0*(H**2/4.D0-W**2)+
     &   (1.D0-NUB*NUF)/3.D0*(H**3/8.D0-W**3))
      D5=H*(-B1*D3+A*H)
      C=D4+D5
      MP=C*DRP
      END
