      SUBROUTINE PROJZ1(SIGMIN,SIGMAX,DELTA,SIG0,NORM,NCMP,ALPHA2)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ELEMENTS  DATE 27/01/97   AUTEUR PABMZAC S.TAHERI 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C TOLE CRP_7    
      IMPLICIT  REAL*8 (A-H,O-Z)
C ----------------------------------------------------------------------
C     BUT:  PROJECTION D'UN POINT SUR DEUX SPHERES (METHODE ZAC)
C
C     IN   SIGMIN,SIGMAX  (CENTRE DES SPHERES)
C          SIG0           (RAYON DES SPHERES)
C          NCMP           (NOMBRE DE COMPOSANTES)
C          DELTA          (DISTANCE) 
C          NORM           (NORME)         
C     OUT  ALPHA2         (POINT PROJETE)
C ----------------------------------------------------------------------
      REAL*8    SIGMIN(*),SIGMAX(*),SIG0,NORM,ALPHA2(*),DELTA(*)
      REAL*8    NORSIG
      INTEGER   NCMP
      EXTERNAL  NORSIG
C
      ZERO = 0.D0
      R3S2 = SQRT(3.D0/2.D0)
C
      DO 109 I=1,NCMP
         ALPHA2(I) = SIGMAX(I) + SIG0*DELTA(I)/NORM  
109   CONTINUE                 
      DO 110 I=1,NCMP
         DELTA(I) = ALPHA2(I) - SIGMIN(I) 
110   CONTINUE
      NORM = R3S2*NORSIG(DELTA,NCMP)    
      IF ((NORM - SIG0).LE.ZERO) THEN
C
C           ALPHA2 EST DANS LA  BOULE MIN
C
         GOTO 9999
C
      ELSE
C
C        ALPHA2 N'EST PAS DANS LA  BOULE MIN
C  
         CALL PROJZ2(SIGMIN,SIGMAX,SIG0,NCMP,ALPHA2)
C
      END IF
C
9999  CONTINUE
      END
