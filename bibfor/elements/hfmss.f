      SUBROUTINE HFMSS(IND,VECTT,HSFM,HSS)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ELEMENTS  DATE 03/07/2012   AUTEUR PELLET J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
      IMPLICIT NONE
      INTEGER IND
      REAL*8 VECTT(3,3)
      REAL*8 HFM(3,6),HS(2,6),HSFM(3,9),HSS(2,9)
C
C     CONSTRUCTION DE  HFM  :  (3,6) AUX X PTS D'INTEGRATION
C                                        X= REDUIT OU NORMAL
C     (DANS L'EXPRESSION DE HFM, PAS DE COMPOSANTES VECTT(3,K))
C
C-----------------------------------------------------------------------
C-----------------------------------------------------------------------
      HFM(1,1)=VECTT(1,1)*VECTT(1,1)
      HFM(1,2)=VECTT(1,2)*VECTT(1,2)
      HFM(1,3)=VECTT(1,3)*VECTT(1,3)
      HFM(1,4)=VECTT(1,1)*VECTT(1,2)
      HFM(1,5)=VECTT(1,1)*VECTT(1,3)
      HFM(1,6)=VECTT(1,2)*VECTT(1,3)
C
      HFM(2,1)=VECTT(2,1)*VECTT(2,1)
      HFM(2,2)=VECTT(2,2)*VECTT(2,2)
      HFM(2,3)=VECTT(2,3)*VECTT(2,3)
      HFM(2,4)=VECTT(2,1)*VECTT(2,2)
      HFM(2,5)=VECTT(2,1)*VECTT(2,3)
      HFM(2,6)=VECTT(2,2)*VECTT(2,3)
C
      HFM(3,1)=2*VECTT(1,1)*VECTT(2,1)
      HFM(3,2)=2*VECTT(1,2)*VECTT(2,2)
      HFM(3,3)=2*VECTT(1,3)*VECTT(2,3)
      HFM(3,4)=VECTT(2,1)*VECTT(1,2)+VECTT(1,1)*VECTT(2,2)
      HFM(3,5)=VECTT(2,1)*VECTT(1,3)+VECTT(1,1)*VECTT(2,3)
      HFM(3,6)=VECTT(2,2)*VECTT(1,3)+VECTT(1,2)*VECTT(2,3)
C
C     CONSTRUCTION DE LA MATRICE HFM * S : (3,9) AUX X PTS DE GAUSS
C
      HSFM(1,1)=HFM(1,1)
      HSFM(1,2)=HFM(1,4)
      HSFM(1,3)=HFM(1,5)
      HSFM(1,4)=HFM(1,4)
      HSFM(1,5)=HFM(1,2)
      HSFM(1,6)=HFM(1,6)
      HSFM(1,7)=HFM(1,5)
      HSFM(1,8)=HFM(1,6)
      HSFM(1,9)=HFM(1,3)
C
      HSFM(2,1)=HFM(2,1)
      HSFM(2,2)=HFM(2,4)
      HSFM(2,3)=HFM(2,5)
      HSFM(2,4)=HFM(2,4)
      HSFM(2,5)=HFM(2,2)
      HSFM(2,6)=HFM(2,6)
      HSFM(2,7)=HFM(2,5)
      HSFM(2,8)=HFM(2,6)
      HSFM(2,9)=HFM(2,3)
C
      HSFM(3,1)=HFM(3,1)
      HSFM(3,2)=HFM(3,4)
      HSFM(3,3)=HFM(3,5)
      HSFM(3,4)=HFM(3,4)
      HSFM(3,5)=HFM(3,2)
      HSFM(3,6)=HFM(3,6)
      HSFM(3,7)=HFM(3,5)
      HSFM(3,8)=HFM(3,6)
      HSFM(3,9)=HFM(3,3)
C
      IF (IND.EQ.1) THEN
C
C     CONSTRUCTION DE HS  :  (2,6) AUX PTS D'INTEGRATION REDUITS
C
      HS(1,1)=2*VECTT(1,1)*VECTT(3,1)
      HS(1,2)=2*VECTT(1,2)*VECTT(3,2)
      HS(1,3)=2*VECTT(1,3)*VECTT(3,3)
      HS(1,4)=VECTT(3,2)*VECTT(1,1)+VECTT(3,1)*VECTT(1,2)
      HS(1,5)=VECTT(1,1)*VECTT(3,3)+VECTT(3,1)*VECTT(1,3)
      HS(1,6)=VECTT(3,3)*VECTT(1,2)+VECTT(1,3)*VECTT(3,2)
C
      HS(2,1)=2*VECTT(2,1)*VECTT(3,1)
      HS(2,2)=2*VECTT(2,2)*VECTT(3,2)
      HS(2,3)=2*VECTT(3,3)*VECTT(2,3)
      HS(2,4)=VECTT(2,1)*VECTT(3,2)+VECTT(3,1)*VECTT(2,2)
      HS(2,5)=VECTT(2,1)*VECTT(3,3)+VECTT(3,1)*VECTT(2,3)
      HS(2,6)=VECTT(2,2)*VECTT(3,3)+VECTT(2,3)*VECTT(3,2)
C
C     CONSTRUCTION DE LA MATRICE HS * S : (2,9) AUX PTS
C     D'INTEGRATION REDUITS
      HSS(1,1)=HS(1,1)
      HSS(1,2)=HS(1,4)
      HSS(1,3)=HS(1,5)
      HSS(1,4)=HS(1,4)
      HSS(1,5)=HS(1,2)
      HSS(1,6)=HS(1,6)
      HSS(1,7)=HS(1,5)
      HSS(1,8)=HS(1,6)
      HSS(1,9)=HS(1,3)
C
      HSS(2,1)=HS(2,1)
      HSS(2,2)=HS(2,4)
      HSS(2,3)=HS(2,5)
      HSS(2,4)=HS(2,4)
      HSS(2,5)=HS(2,2)
      HSS(2,6)=HS(2,6)
      HSS(2,7)=HS(2,5)
      HSS(2,8)=HS(2,6)
      HSS(2,9)=HS(2,3)
C
      ENDIF
      END
