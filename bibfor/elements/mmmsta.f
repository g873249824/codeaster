      SUBROUTINE MMMSTA(NDIM  ,LELTF ,LPENAF,LOPTF ,DVITE ,
     &                  DLAGRF,COEFFR,COEFFP,COEFFF,TAU1  ,
     &                  TAU2  ,MPROJT,LCONT ,LASPE ,LADHE ,
     &                  LAMBDA,RESE  ,NRESE )
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ELEMENTS  DATE 18/04/2011   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT NONE
      INTEGER      NDIM
      REAL*8       DLAGRF(2),DVITE(3)      
      LOGICAL      LOPTF,LPENAF,LELTF
      REAL*8       TAU1(3),TAU2(3),MPROJT(3,3)      
      LOGICAL      LCONT,LASPE,LADHE
      REAL*8       RESE(3),NRESE,LAMBDA
      REAL*8       COEFFR,COEFFP,COEFFF
C
C ----------------------------------------------------------------------
C
C ROUTINE CONTACT (METHODE CONTINUE - CALCUL)
C
C PREPARATION DES CALCULS - LECTURE DES STATUTS
C
C ----------------------------------------------------------------------
C
C
C IN  NDIM   : DIMENSION DE L'ESPACE
C IN  LPENAF : .TRUE. SI FROTTEMENT PENALISE
C IN  LELTF  : .TRUE. SI ELEMENT DE FROTTEMENT
C IN  LOPTF  : .TRUE. SI OPTION DE FROTTEMENT
C IN  DLAGRF : INCREMENT DEPDEL DES LAGRANGIENS DE FROTTEMENT
C IN  DVITE  : SAUT DE "VITESSE" [[DELTA X]]
C IN  COEFFR : COEF_REGU_FROT
C IN  COEFFP : COEF_PENA_FROT
C IN  COEFFF : COEFFICIENT DE FROTTEMENT DE COULOMB
C IN  TAU1   : PREMIER VECTEUR TANGENT
C IN  TAU2   : SECOND VECTEUR TANGENT
C IN  MPROJT : MATRICE DE PROJECTION TANGENTE
C OUT LCONT  : .TRUE. SI CONTACT (SU=1)
C OUT LASPE  : .TRUE. SI DANS ASPERITE (SA=1)
C OUT LADHE  : .TRUE. SI ADHERENCE
C OUT LAMBDA : VALEUR DU MULT. DE CONTACT (SEUIL DE TRESCA)
C OUT RESE   : SEMI-MULTIPLICATEUR GTK DE FROTTEMENT 
C               GTK = LAMBDAF + COEFFR*VITESSE
C OUT NRESE  : NORME DU SEMI-MULTIPLICATEUR GTK DE FROTTEMENT
C 
C --------- DEBUT DECLARATIONS NORMALISEES  JEVEUX ---------------------
C
      INTEGER ZI
      COMMON /IVARJE/ZI(1)
      REAL*8 ZR
      COMMON /RVARJE/ZR(1)
      COMPLEX*16 ZC
      COMMON /CVARJE/ZC(1)
      LOGICAL ZL
      COMMON /LVARJE/ZL(1)
      CHARACTER*8 ZK8
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*32 ZK32
      CHARACTER*80 ZK80
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C
C --------- FIN  DECLARATIONS  NORMALISEES  JEVEUX ---------------------
C
      INTEGER      JPCF
      INTEGER      INDCO,INDASP
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
C --- INITIALISATIONS
C
      LCONT   = .FALSE.
      LASPE   = .FALSE.
      LADHE   = .FALSE.
      NRESE   = 0.D0
      RESE(1) = 0.D0
      RESE(2) = 0.D0
      RESE(3) = 0.D0      
C
C --- RECUPERATION DES DONNEES DU CHAM_ELEM DU CONTACT (VOIR MMCHML)
C
      CALL JEVECH('PCONFR','L',JPCF )
      INDCO    = NINT(ZR(JPCF-1+37))
      INDASP   = NINT(ZR(JPCF-1+38))
      LAMBDA   =      ZR(JPCF-1+12)
C
C --- STATUT DE LA COMPLIANCE
C
      LASPE    = INDASP.EQ.1
C
C --- STATUT DU CONTACT
C
      LCONT    = INDCO.EQ.1
C
C --- PAS DE FROTTEMENT SI CALCUL OPTION CONTACT
C
      IF (.NOT.LOPTF) THEN
        LELTF = .FALSE.
      ENDIF
C
C --- STATUT DU CONTACT - CAS DU FROTTEMENT
C
      IF (LOPTF) THEN
        IF (COEFFF.EQ.0.D0) LCONT = .FALSE.
        IF (LAMBDA.EQ.0.D0) LCONT = .FALSE.
        IF (.NOT.LELTF)     LCONT = .FALSE.
      ENDIF  
C
C --- ETAT D'ADHERENCE DU POINT DE CONTACT
C  
      IF (LOPTF.AND.LCONT) THEN
        CALL MMTRPR(NDIM  ,LPENAF,DVITE ,DLAGRF,COEFFR,
     &              COEFFP,TAU1  ,TAU2  ,MPROJT,LADHE ,
     &              RESE  ,NRESE )
      ENDIF
C
      CALL JEDEMA()
C
      END
