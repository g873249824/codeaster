      SUBROUTINE CALAJT(J1,J,DIAG,COL,N,ITAB,DEB,TAB,SUIV,LT,IER)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGELINE  DATE 07/01/2002   AUTEUR JFBHHUC C.ROSE 
C RESPONSABLE JFBHHUC C.ROSE
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
      IMPLICIT NONE
      INTEGER J1,J,N,DIAG(0:N),COL(*),ITAB,DEB(1:N)
      INTEGER TAB(*),SUIV(*),LT,IER
      INTEGER K,L,OK,OJ,PRED,IT
C     ON AJOUTE LES NOEUDS COL(J1) A COL(J-1) DANS LA LISTE
C     DES VOISINS DE COL(J)
      OJ = COL(J)
      DO 1 K = J1 , J-1
      OK = COL(K)
      DO 2 L= DIAG(OJ-1)+1, DIAG(OJ)-1
         IF( COL(L).EQ.OK) GOTO 3
 2       CONTINUE
C     OK N' EST PAS UN VOISIN INITIAL DE OJ ON L INSERE DANS
C     LA LISTE DES VOISINS
         IF(DEB(OJ).EQ.0) THEN
            ITAB = ITAB + 1
            IF(ITAB.GT.LT) THEN
            IER=1
            GOTO 22
            END IF
            DEB(OJ) = ITAB
            TAB(ITAB) = OK
            SUIV(ITAB) = 0
         ELSE
            IT = DEB(OJ)
            PRED =IT
 10         CONTINUE
            IF(IT.GT.0) THEN
               IF(TAB(IT).EQ.OK) GOTO 9
               PRED = IT
               IT = SUIV(IT)
               GOTO 10
            ENDIF
C     OK N'EST PAS DANS TAB
            ITAB = ITAB + 1
            IF(ITAB.GT.LT) THEN
            IER=1
            GOTO 22
            END IF
            TAB(ITAB) = OK
            SUIV(PRED) = ITAB
            SUIV(ITAB) = 0
 9          CONTINUE
         ENDIF
 3       CONTINUE
 1    CONTINUE
      IER = -ITAB
 22    CONTINUE
      END
