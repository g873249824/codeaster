      SUBROUTINE CPDEPL(MELFLU,BASE,NUOR,NBM)
      IMPLICIT NONE
C-----------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGELINE  DATE 03/07/2012   AUTEUR PELLET J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C-----------------------------------------------------------------------
C  RECOPIE LES CHAMPS DE DEPLACEMENTS PRIS DANS UN CONCEPT MODE_MECA
C  LES DDL DE LAGRANGE SONT ELIMINES
C  APPELANT : FLUST1 , FLUST2
C-----------------------------------------------------------------------
C  IN : MELFLU : NOM DU CONCEPT DE TYPE MELASFLU PRODUIT
C  IN : BASE   : NOM DU CONCEPT DE TYPE MODE_MECA DEFINISSANT LA BASE
C                MODALE DU SYSTEME AVANT PRISE EN COMPTE DU COUPLAGE
C  IN : NUOR   : LISTE DES NUMEROS D'ORDRE DES MODES SELECTIONNES POUR
C                LE COUPLAGE (SUR LESQUELS PORTE L'EXTRACTION)
C  IN : NBM    : NOMBRE DE MODES PRIS EN COMPTE POUR LE COUPLAGE
C-----------------------------------------------------------------------
C
      INCLUDE 'jeveux.h'
      INTEGER      NBM,NUOR(NBM)
      CHARACTER*8  BASE
      CHARACTER*19 MELFLU
C
      INTEGER      IDDL(6)
      CHARACTER*1  K1BID
      CHARACTER*8  MAILLA,K8BID
      CHARACTER*14 NUMDDL
      CHARACTER*24 NOMCHA,REFEI,MATRIA,NOMNOE
C-----------------------------------------------------------------------
      INTEGER IBI ,ICHAM ,IM ,IMOD ,IREFEI ,IRET ,LNOE 
      INTEGER NEQ 
C-----------------------------------------------------------------------
      DATA IDDL    /1,2,3,4,5,6/
C
C-----------------------------------------------------------------------
      CALL JEMARQ()
C
      NOMCHA(1:13)   = MELFLU(1:8)//'.C01.'
      NOMCHA(17:24) = '001.VALE'
C
      CALL WKVECT('&&CPDEPL.TEMP.NUOR','V V I',1,IMOD)
C
      REFEI = BASE//'           .REFD'
      CALL JEVEUO(REFEI,'L',IREFEI)
      MATRIA = ZK24(IREFEI)
C
      CALL DISMOI('F','NOM_NUME_DDL',MATRIA,'MATR_ASSE',IBI,NUMDDL,IRET)
      CALL DISMOI('F','NB_EQUA',MATRIA,'MATR_ASSE',NEQ,K8BID,IRET)
      CALL DISMOI('F','NOM_MAILLA',MATRIA,'MATR_ASSE',IBI,MAILLA,IRET)
      NOMNOE = MAILLA//'.NOMNOE'
      CALL JELIRA(NOMNOE,'NOMUTI',LNOE,K1BID)
C
      DO 10 IM = 1,NBM
        WRITE(NOMCHA(14:16),'(I3.3)') NUOR(IM)
        CALL JEVEUO(NOMCHA,'E',ICHAM)
        ZI(IMOD) = NUOR(IM)
        CALL EXTMOD(BASE,NUMDDL,ZI(IMOD),1,ZR(ICHAM),NEQ,LNOE,IDDL,6)
        CALL JELIBE(NOMCHA)
  10  CONTINUE
C
      CALL JEDETC('V','&&CPDEPL',1)
      CALL JEDEMA()
C
      END
