      SUBROUTINE IB0MAI()
      IMPLICIT NONE
C     ------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF SUPERVIS  DATE 10/09/2012   AUTEUR COURTOIS M.COURTOIS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C     MAIN D'ANALYSE DE LA COMMANDE DE DEMARRAGE
C     ------------------------------------------------------------------
C     UTILISATION DU COMMON POUR L'AFFICHAGE
      INTEGER          LFIC,MFIC
      COMMON /FENVJE/  LFIC,MFIC
C
      INTEGER          NEXCEP
      COMMON /UTEXC /  NEXCEP
C     ------------------------------------------------------------------
      CHARACTER*8  NOMF, K8TAB(4)
      INTEGER      UNMEGA, IDEBUG, IRET, LOIS
      INTEGER      MXDYN, IBID, ISMAEM
      REAL*8       VALR(4), MOCTET, MEMORY, SIZF
      INTEGER      LOISEM
C
      CALL IB1MAI()
      NEXCEP = 0
      IBID = 0
C
      CALL R8INIR(4, 0.D0, VALR, 1)
      K8TAB(1) = 'VMSIZE'
      CALL UTGTME(1, K8TAB, VALR, IRET)
C     --- MEMOIRE POUR LE GESTIONNAIRE D'OBJET ---
      UNMEGA = 1 024 * 1 024
C     RESTRICTION POUR UNE TAILLE MEMOIRE JEVEUX EXACTE
      LOIS = LOISEM()
C --- UNITES LOGIQUES
      CALL IBIMPR()
C
C     --- OUVERTURE DE GESTIONNAIRE D'OBJET ---
      IDEBUG = 0
      CALL GTOPTI('dbgjeveux', IDEBUG, IRET)
C
      MEMORY = 0.D0
      CALL GTOPTR('memory', MEMORY, IRET)
      MOCTET = MEMORY * UNMEGA
      IF ( MOCTET .GT. ISMAEM() ) THEN
        VALR(1) = MOCTET
        VALR(2) = ISMAEM()
        CALL U2MESR('F', 'JEVEUX_1', 2, VALR)
      ENDIF
      MXDYN = INT(MOCTET)
C
      CALL JEDEBU(4,MXDYN/LOIS,IDEBUG)
C
C     --- ALLOCATION D'UNE BASE DE DONNEES TEMPORAIRE VOLATILE---
      NOMF = 'VOLATILE'
      CALL JEINIF( 'DEBUT','DETRUIT',NOMF,'V', 250 , 100, 1 )
C --- IMPRESSION DE L'ENTETE
      CALL ENTETE()
      K8TAB(1) = 'LIMIT_JV'
      K8TAB(2) = 'MEM_TOTA'
      K8TAB(3) = 'MEM_INIT'
      K8TAB(4) = 'MEM_JDC'
      CALL UTGTME(4, K8TAB, VALR, IRET)
      CALL U2MESR('I', 'SUPERVIS2_22', 4, VALR)
C
      SIZF = MFIC/(1024*1024.0D0)
      CALL U2MESR('I', 'SUPERVIS2_24', 1, SIZF)
C
C --- INFORMATIONS SURCHARGE
      CALL PRHEAD(3)
C
      IF (IDEBUG .EQ. 1) THEN
         CALL U2MESS('I','SUPERVIS_12')
      ENDIF
C --- VERSION SURCHARGEE OU NON ?
      CALL SURCHG(IBID)
      END
