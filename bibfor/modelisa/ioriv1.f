      FUNCTION IORIV1(NUM,NOEUD,VECT,COOR)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF MODELISA  DATE 22/08/2000   AUTEUR JMBHH01 J.M.PROIX 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C.======================================================================
      IMPLICIT REAL*8 (A-H,O-Z)
C
C     IORIV1  --  ORIENTATION D'UNE MAILLE PAR RAPPORT A UN VECTEUR
C
C   ARGUMENT        E/S  TYPE         ROLE
C    NUM          IN/OUT  K*     NUMEROTATION DE LA MAILLE
C
C   CODE RETOUR IORIV1 : 0 SI LA MAILLE NE CONTIENT PAS LE NOEUD
C                       -1 OU 1 SINON (SELON QU'IL AIT OU NON
C                                      FALLU REORIENTER)
      INTEGER NUM(2)
      REAL*8  VECT(2),COOR(3,*)
      X(I)=COOR(1,I)
      Y(I)=COOR(2,I)
C
C.========================= DEBUT DU CODE EXECUTABLE ==================
C
C     BOUCLE SUR LES SOMMETS
      IORIV1=0
      DO 10 I=1,2
      IF (NUM(I).EQ.NOEUD) THEN
        N1=NUM(1)
        N2=NUM(2)
        X1=X(N1)
        Y1=Y(N1)
        X2=X(N2)
        Y2=Y(N2)
C     VECTEUR NORMAL AU SEGMENT
        XN=Y2-Y1
        YN=X1-X2
        SCAL=XN*VECT(1)+YN*VECT(2)
        IF (SCAL.GT.0) THEN
          IORIV1= 1
        ELSE IF (SCAL.LT.0) THEN
          IORIV1=-1
        ELSE
          CALL UTMESS('F','IORIV1','LE VECTEUR NORMAL EST '//
     .                             'DANS LE PLAN TANGENT')
        ENDIF
      ENDIF
   10 CONTINUE
      IF (IORIV1.LT.0) THEN
C       ON PERMUTE LES SOMMETS
        K=NUM(1)
        L=NUM(2)
        NUM(1)=L
        NUM(2)=K
      ENDIF
C
      END
