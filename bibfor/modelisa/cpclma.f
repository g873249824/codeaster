      SUBROUTINE CPCLMA(NOMAIN,NOMAOU,TYPCOL,BASE)
      IMPLICIT NONE
C
      CHARACTER*1 BASE
      CHARACTER*8 NOMAIN,NOMAOU,TYPCOL
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF MODELISA  DATE 18/12/2012   AUTEUR SELLENET N.SELLENET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE SELLENET N.SELLENET
C
      INCLUDE 'jeveux.h'
C
      INTEGER      NBGMAI,IGROUP,JNUMA1,JNUMA2,NBMAIL,JMAILL
      INTEGER      CODRET
C
      CHARACTER*8  K8BIDO
      CHARACTER*24 GRMAIN,GRMAOU,PTNMOU,NOMGRP
      CHARACTER*32 JEXNUM,JEXNOM
C
C     RECOPIE DES COLLECTIONS .GROUPEMA ET .GROUPENO
C
      CALL JEMARQ()
C
      IF ( TYPCOL.EQ.'GROUPEMA' ) THEN
        GRMAIN = NOMAIN//'.GROUPEMA'
        GRMAOU = NOMAOU//'.GROUPEMA'
        PTNMOU = NOMAOU//'.PTRNOMMAI'
      ELSEIF ( TYPCOL.EQ.'GROUPENO' ) THEN
        GRMAIN = NOMAIN//'.GROUPENO'
        GRMAOU = NOMAOU//'.GROUPENO'
        PTNMOU = NOMAOU//'.PTRNOMNOE'
      ELSE
        CALL ASSERT(.FALSE.)
      ENDIF
C
      CALL JEDETR(GRMAOU)
      CALL JEDETR(PTNMOU)
C
      CALL JEEXIN(GRMAIN,CODRET)
      IF ( CODRET.EQ.0 ) GOTO 9999
      CALL JELIRA(GRMAIN,'NOMUTI',NBGMAI,K8BIDO)
      CALL JECREO(PTNMOU,BASE//' N K24')
      CALL JEECRA(PTNMOU,'NOMMAX',NBGMAI,' ')
      CALL JECREC(GRMAOU,BASE//' V I','NO '//PTNMOU,
     &            'DISPERSE','VARIABLE',NBGMAI)
C
      DO 10 IGROUP = 1, NBGMAI
        CALL JENUNO(JEXNUM(GRMAIN,IGROUP),NOMGRP)
        CALL JECROC(JEXNOM(GRMAOU,NOMGRP))
        CALL JEVEUO(JEXNUM(GRMAIN,IGROUP),'L',JNUMA1)
        CALL JELIRA(JEXNUM(GRMAIN,IGROUP),'LONUTI',NBMAIL,K8BIDO)
        CALL JEECRA(JEXNOM(GRMAOU,NOMGRP),'LONMAX',MAX(NBMAIL,1),' ')
        CALL JEECRA(JEXNOM(GRMAOU,NOMGRP),'LONUTI',NBMAIL,' ')
        CALL JEVEUO(JEXNOM(GRMAOU,NOMGRP),'E',JNUMA2)
        DO 20 JMAILL = 0, NBMAIL-1
          ZI(JNUMA2+JMAILL) = ZI(JNUMA1+JMAILL)
  20    CONTINUE
  10  CONTINUE
C
 9999 CONTINUE
C
      CALL JEDEMA()
C
      END
