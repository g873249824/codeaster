      SUBROUTINE NBNOD2(NOMA,NBENT,LISENT,TYPENT,
     &                  NBNO)
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF MODELISA  DATE 29/09/2006   AUTEUR VABHHTS J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2006  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C
      IMPLICIT      NONE
      CHARACTER*8   NOMA
      INTEGER       NBENT
      CHARACTER*8   LISENT(*)
      CHARACTER*8   TYPENT
      INTEGER       NBNO
C
C ----------------------------------------------------------------------
C ROUTINE UTILITAIRE
C ----------------------------------------------------------------------
C
C COMPTE LES NOEUDS :
C   - D'UN GROUP_NO OU D'UNE LISTE DE GROUP_NO
C   - D'UN GROUP_MA OU D'UNE LISTE DE GROUP_MA
C   - D'UNE MAILLE OU D'UNE LISTE DE MAILLES
C
C
C IN  NOMA   : NOM DU MAILLAGE
C IN  TYPENT : TYPE DES ENTITES A ANALYSER
C              - 'GROUP_NO' LISENT EST UNE LISTE DE GROUPES DE NOEUDS
C              - 'GROUP_MA' LISENT EST UNE LISTE DE GROUPES DE MAILLES
C              - 'MAILLE'   LISENT EST UNE LISTE DE MAILLES
C
C IN  LISENT : VECTEUR DE TYPE K8 ET DE LONGUEUR NBENT CONTENANT LA
C               LISTE DES NOMS DES ENTITES (GROUP_MA, GROUP_NO, NOEUD OU
C               MAILLE) A ANALYSER
C IN  NBENT  : NOMBRE D'ENTITES A ANALYSER DANS LA LISTE
C OUT NBNO   : NOMBRE DE NOEUDS DANS L'OBJET RESULTANT
C
C -------------- DEBUT DECLARATIONS NORMALISEES JEVEUX -----------------
C
      CHARACTER*32 JEXNOM,JEXNUM
      INTEGER ZI
      COMMON /IVARJE/ZI(1)
      REAL*8 ZR
      COMMON /RVARJE/ZR(1)
      COMPLEX*16 ZC
      COMMON /CVARJE/ZC(1)
      LOGICAL ZL
      COMMON /LVARJE/ZL(1)
      CHARACTER*8 ZK8
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*32 ZK32
      CHARACTER*80 ZK80
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C
C ---------------- FIN DECLARATIONS NORMALISEES JEVEUX -----------------
C
      CHARACTER*1   K1BID
      CHARACTER*8   ENTITE
      CHARACTER*24  MAILMA,GRMAMA,GRNONO,CONNEX
      INTEGER       N1
      INTEGER       IMA,IGR
      INTEGER       JGRMA
      INTEGER       NUMAIL,NUGRMA,NBMAIL,NUGRNO
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
      MAILMA = NOMA//'.NOMMAI'
      GRMAMA = NOMA//'.GROUPEMA'
      GRNONO = NOMA//'.GROUPENO'
      CONNEX = NOMA//'.CONNEX'

      NBNO   = 0
C
C --- CAS D'UNE LISTE DE MAILLES
C
      IF (TYPENT.EQ.'MAILLE') THEN
C
C --- NOMBRE DE NOEUDS TOTAL SUR LA LISTE DES MAILLES
C
        DO 10 IMA = 1, NBENT
           ENTITE = LISENT(IMA)
           CALL JENONU(JEXNOM(MAILMA,ENTITE),NUMAIL)
           CALL JELIRA(JEXNUM(CONNEX,NUMAIL),'LONMAX',N1,K1BID)
           NBNO = NBNO + N1
  10    CONTINUE
C
C --- CAS D'UNE LISTE DE GROUPES DE MAILLE
C
      ELSEIF (TYPENT.EQ.'GROUP_MA') THEN
C
C --- NOMBRE DE MAILLES TOTAL PUIS NOMBRE DE NOEUDS TOTAL
C --- SUR LA LISTE DES GROUPES DE MAILLES
C
        DO 20 IGR = 1, NBENT
          ENTITE = LISENT(IGR)
          CALL JENONU(JEXNOM(GRMAMA,ENTITE),NUGRMA)
          CALL JELIRA(JEXNUM(GRMAMA,NUGRMA),'LONMAX',NBMAIL,K1BID)
          CALL JEVEUO(JEXNOM(GRMAMA,ENTITE),'L',JGRMA)
          DO 21 IMA = 1, NBMAIL
            NUMAIL = ZI(JGRMA-1+IMA)
            CALL JELIRA(JEXNUM(CONNEX,NUMAIL),'LONMAX',N1,K1BID)
            NBNO = NBNO + N1
  21      CONTINUE
  20    CONTINUE
      ELSEIF (TYPENT.EQ.'GROUP_NO') THEN
C
C --- NOMBRE DE NOEUDS TOTAL SUR LA LISTE DES GROUPES DE NOEUDS
C
        DO 40 IGR = 1, NBENT
          ENTITE = LISENT(IGR)
          CALL JENONU(JEXNOM(GRNONO,ENTITE),NUGRNO)
          CALL JELIRA(JEXNUM(GRNONO,NUGRNO),'LONMAX',N1,K1BID)
          NBNO = NBNO + N1
  40    CONTINUE
      ELSE
        CALL U2MESS('F','MODELISA5_38')
      ENDIF

C
      CALL JEDEMA()
C
      END
