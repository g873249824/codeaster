      SUBROUTINE DDLFAC(FONREE,IFACE)
      IMPLICIT NONE
      CHARACTER*4  FONREE
      INTEGER      IFACE
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF MODELISA  DATE 24/09/2007   AUTEUR FLEJOU J-L.FLEJOU 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C
C     BUT: DETERMINER SI LA REGLE DE SURCHARGE DES DDL IMPOSES VA
C        S'APPLIQUER ENTRE LES 2 MOTS-CLE FACTEUR DDL_IMPO ET FACE_IMPO
C
C ARGUMENT  D'ENTREE :
C      FONREE : 'REEL'  AFFE_CHAR_MECA
C               'FONC'  AFFE_CHAR_MECA_F
C
C ARGUMENT  DE SORTIE:
C      IFACE : = 0 PAS DE REGLE DE SURCHARGE ENTRE LES 2 MOTS-CLE
C              = 1 REGLE DE SURCHARGE => PAS DE REMPLISSAGE DU LIGREL
C                  ET DES CARTES DANS CADDLI
C
      INTEGER      NDDLA,NMOCL,NDDLI,NFACI,NCMP,IOCC,NMCL,J,ICMP,N
      PARAMETER   (NMOCL=30)
      INTEGER      DDLIMP(NMOCL)
      REAL*8       ZRBID
      CHARACTER*3  TYMOCL(NMOCL)
      CHARACTER*8  ZK8BID
      CHARACTER*16 MOTCLE(NMOCL)
C
      CALL GETFAC ('DDL_IMPO',NDDLI)
      CALL GETFAC ('FACE_IMPO',NFACI)
      NCMP=0
C
      IF (NFACI.NE.0.AND.NDDLI.NE.0) THEN
C ---------------------------------------------------------
C     BOUCLE SUR LES OCCURENCES DU MOT-CLE FACTEUR FACE_IMPO
C ---------------------------------------------------------
      DO 160 IOCC = 1, NFACI
         CALL GETMJM('FACE_IMPO',IOCC,   0,MOTCLE,TYMOCL,N)
         NMCL = ABS(N)
         CALL GETMJM('FACE_IMPO',IOCC,NMCL,MOTCLE,TYMOCL,N)
         NDDLA =0
         DO 10 J = 1, NMCL
C           MEME TEST DANS CAFACI
            IF (  MOTCLE(J).NE.'MAILLE' .AND.
     &            MOTCLE(J).NE.'GROUP_MA' .AND.
     &            MOTCLE(J).NE.'SANS_MAILLE' .AND.
     &            MOTCLE(J).NE.'SANS_GROUP_MA' .AND.
     &            MOTCLE(J).NE.'SANS_NOEUD' .AND.
     &            MOTCLE(J).NE.'SANS_GROUP_NO' .AND.
     &            MOTCLE(J).NE.'DNOR' .AND.
     &            MOTCLE(J).NE.'DTAN') THEN
               NDDLA = NDDLA + 1
               MOTCLE(NDDLA) = MOTCLE(J)
            ENDIF
10       CONTINUE
         ICMP = 0
         IF (FONREE.EQ.'REEL') THEN
            DO 40  J = 1, NDDLA
               CALL GETVR8('FACE_IMPO',MOTCLE(J),IOCC,1,1,ZRBID,
     &                                 DDLIMP(J))
               ICMP = ICMP + DDLIMP(J)
40          CONTINUE
         ELSE IF (FONREE.EQ.'FONC') THEN
            DO 50  J = 1, NDDLA
               CALL GETVID('FACE_IMPO',MOTCLE(J),IOCC,1,1,ZK8BID,
     &                                 DDLIMP(J))
               ICMP = ICMP + DDLIMP(J)
50          CONTINUE
         ELSE
            CALL U2MESK('F','MODELISA2_37',1,FONREE)
         END IF
         NCMP=NCMP+ICMP
160      CONTINUE
      ENDIF
C
      IF(NCMP.NE.0) IFACE = 1
      END
