      SUBROUTINE ADLIVO(M0,MV,IS,NVTOT,NVOIMA,NSCOMA,TOUVOI)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF MODELISA  DATE 06/05/2008   AUTEUR PELLET J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2008  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
      IMPLICIT NONE
      INTEGER M0,MV,IS,NVTOT
      INTEGER NVOIMA,NSCOMA
      INTEGER TOUVOI(1:NVOIMA,1:NSCOMA+2)
      INTEGER IV,NSCO,ISCO
      LOGICAL TRMA,TRSO
C
C  AJOUTE A LA LISTE DE TOUS LES VOISINS DE LA MAILLE COURANTE MO
C  LA MAILLE MV ET LE SOMMET IS SI CETTE MAILE N EXISTE PAS DEJA
C
C    IN : M0,MAILLE C0URANTE DONT ON CHERCHE LES VOISINS
C       : M ,MAILLE VOISINE
C       : IS ,SOMMET LOCAL DE M0 QUI EST AUSSI SOMMET DE MV
C    VAR NVTOT : NOMBRE TOTAL DE VOI
C         TOUVOI : CES VOISINS :
C    CONTENU DU TABLEAU TOUVOI :
C     TOUVOI(IV,1) : MAILLE VOISINE
C     TOUVOI(IV,2) : NOMBRE DE SOMMETS COMMUNS
C     TOUVOI(IV,2+IS) : CES SOMMETS COMMUNS DANS NUMEROTATION DE M0
C
      TRMA=.FALSE.
      DO 30 IV=1,NVTOT
        IF (MV.EQ.TOUVOI(IV,1)) THEN
          TRMA=.TRUE.
          TRSO=.FALSE.
          NSCO=TOUVOI(IV,2)
          DO 10 ISCO=1,NSCO
            IF (TOUVOI(IV,2+ISCO).EQ.IS) THEN
              TRSO=.TRUE.
              GOTO 20

            ENDIF
   10     CONTINUE
   20     CONTINUE
          IF (.NOT.TRSO) THEN
            NSCO=NSCO+1
            IF (NSCO.GT.NSCOMA) THEN
              CALL U2MESG('F','VOLUFINI_4',0,' ',1,NSCO,0,0.D0)
            ENDIF
            TOUVOI(IV,2)=NSCO
            TOUVOI(IV,2+NSCO)=IS
          ENDIF
          GOTO 40

        ENDIF
   30 CONTINUE
   40 CONTINUE
      IF (.NOT.TRMA) THEN
        NVTOT=NVTOT+1
        IF (NVTOT.GT.NVOIMA) THEN
          CALL U2MESG('F','VOLUFINI_3',0,' ',1,NVTOT,0,0.D0)
        ENDIF
        TOUVOI(NVTOT,1)=MV
        TOUVOI(NVTOT,2)=1
        TOUVOI(NVTOT,3)=IS
      ENDIF

      END
