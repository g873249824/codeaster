      SUBROUTINE XMACON(CHAR  ,NOMA  ,NOMO)
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF MODELISA  DATE 23/07/2007   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2007  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT NONE
      CHARACTER*8  CHAR
      CHARACTER*8  NOMA
      CHARACTER*8  NOMO
C      
C ----------------------------------------------------------------------
C
C ROUTINE CONTACT (METHODE XFEM - LECTURE DONNEES)
C
C CREATION DES SDS SPECIFIQUES FORMULATION XFEM
C      
C ----------------------------------------------------------------------
C
C
C IN  CHAR   : NOM UTILISATEUR DU CONCEPT DE CHARGE
C IN  NOMA   : NOM DU MAILLAGE
C IN  NOMO   : NOM DU MODELE
C
C -------------- DEBUT DECLARATIONS NORMALISEES JEVEUX -----------------
C
      INTEGER ZI
      COMMON /IVARJE/ZI(1)
      REAL*8 ZR
      COMMON /RVARJE/ZR(1)
      COMPLEX*16 ZC
      COMMON /CVARJE/ZC(1)
      LOGICAL ZL
      COMMON /LVARJE/ZL(1)
      CHARACTER*8 ZK8
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*32 ZK32
      CHARACTER*80 ZK80
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C
C ---------------- FIN DECLARATIONS NORMALISEES JEVEUX -----------------
C
C     INTEGER       NFISMX
C     PARAMETER    (NFISMX=100)    
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()

C 
C --- LECTURE DES STRUCTURES DE DONNEES DE CONTACT
C


C     MAESCL = CHAR(1:8)//'.CONTACT.MAESCL'
C     TABFIN = CHAR(1:8)//'.CONTACT.TABFIN'
C
C     ZMAES  = CFMMVD('ZMAES')
C     ZTABF  = CFMMVD('ZTABF')      
C
C     CHS1 = '&&XMACON.CHS1'
C     CHS2 = '&&XMACON.CHS2'

C
C --- NOMBRE DE FISSURES
C
C      CALL JEVEUO(NOMO//'.NFIS','L',JNFIS)
C      NFISS  = ZI(JNFIS)  
C      IF (NFISS .GT. NFISMX) THEN
C        CALL U2MESI('F', 'XFEM_2', 1, NFISMX)
C      ENDIF  
C      IF (NFISS .LE. 0) THEN
C        CALL U2MESS('F', 'XFEM_3')
C      ENDIF 
C      CALL JEVEUO(NOMO//'.FISS','L',JMOFIS)               
C      
C --- NOMBRE TOTAL DES MAILLES ESCLAVES DE CONTACT.
C
C      NTMAE = 0
C
C      DO 100 IFIS = 1, NFISS      
C        NOMFIS = ZK8(JMOFIS-1 + IFIS) 
C        FACLON = NOMFIS(1:8)//'.TOPOFAC.LO'       
C        CALL CELCES(FACLON,'V',CHS1)
C        CALL JEVEUO(CHS1//'.CESD','L',JCESD1)
C        CALL JEVEUO(CHS1//'.CESV','L',JCESV1)
C        CALL JEVEUO(CHS1//'.CESL','L',JCESL1)
C        DO 110 IMA = 1,NBMA
C          CALL CESEXI('C',JCESD1,JCESL1,IMA,1,1,1,IAD)
C          IF (IAD.GT.0) THEN
C            IF (ZI(JCESV1-1+IAD).GT.0) THEN
C              NTMAE = NTMAE + 1
C	    ENDIF
C          ENDIF
C 110    CONTINUE	   
C 100  CONTINUE
C
C --- CREATION DU TABLEAU DES MAILLES ESCLAVES MAESC
C
C      CALL WKVECT(MAESCL,'G V I',ZMAES*NTMAE+1,JMAESC)
C
C --- REMPLISSAGE DU TABLEAU DES MAILLES ESCLAVES MAESC
C   
C      ZI(JMAESC) = 0
C      NTMAE = 0
C      DO 200 IFIS = 1,NFISS
C  	 NBMZ   = 0             
C        NOMFIS = ZK8(JMOFIS-1 + IFIS) 
C        FACLON = NOMFIS(1:8)//'.TOPOFAC.LO' 
C        CALL CELCES(FACLON,'V',CHS2)
C        CALL JEVEUO(CHS2//'.CESD','L',JCESD2)
C        CALL JEVEUO(CHS2//'.CESV','L',JCESV2)
C        CALL JEVEUO(CHS2//'.CESL','L',JCESL2)        
C	 DO 210 IMA = 1,NBMA
C          CALL CESEXI('C',JCESD2,JCESL2,IMA,1,1,1,IAD)
C          IF (IAD.GT.0)  THEN
C	     IF (ZI(JCESV2-1+IAD).GT.0) THEN
C              NBMZ = NBMZ+1
C	       ZI(JMAESC+ZMAES*(NTMAE+NBMZ-1)+1)= IMA
C	     ENDIF
C          ENDIF   
C 210    CONTINUE	
C
C        DO 220 IMA = 1,NBMZ
C          ZI(JMAESC+ZMAES*NTMAE+ZMAES*IMA-1) = IFIS
C          ZI(JMAESC+ZMAES*NTMAE+ZMAES*IMA)   = 2
C 220    CONTINUE
C        NTMAE = NTMAE + NBMZ
C 200  CONTINUE 
C      ZI(JMAESC) = NTMAE
C
C --- ON COMPTE LE NOMBRE DES POINTS ESCLAVES 
C
C      NTPC = 0
C      DO 300 IMAE = 1,NTMAE
C        NBN  = ZI(JMAESC+3*(IMAE-1)+3)
C        NTPC = NTPC + NBN
C 300  CONTINUE
C
C --- CREATION DE TABLEAU TABFIN 
C
C      CALL WKVECT(TABFIN,'G V R',ZTABF*NTPC+1,JTABF)
C    
      CALL JEDEMA()
      END
