      SUBROUTINE TFIMPR(NOM)
C-----------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF MODELISA  DATE 30/11/2004   AUTEUR DURAND C.DURAND 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C-----------------------------------------------------------------------
      IMPLICIT REAL*8 (A-H,O-Z)
C-----------------------------------------------------------------------
C IMPRESSION DANS LE FICHIER MESSAGE DES INFORMATIONS CONTENUES DANS
C                  UN CONCEPT DE TYPE TYPE_FLUI_STRU
C-----------------------------------------------------------------------
C  IN   : NOM   : NOM DU CONCEPT DE TYPE TYPE_FLUI_STRU
C-----------------------------------------------------------------------
C     ----- DEBUT COMMUNS NORMALISES  JEVEUX  --------------------------
      INTEGER            ZI
      COMMON  / IVARJE / ZI(1)
      REAL*8             ZR
      COMMON  / RVARJE / ZR(1)
      COMPLEX*16         ZC
      COMMON  / CVARJE / ZC(1)
      LOGICAL            ZL
      COMMON  / LVARJE / ZL(1)
      CHARACTER*8        ZK8
      CHARACTER*16                ZK16
      CHARACTER*24                          ZK24
      CHARACTER*32                                    ZK32
      CHARACTER*80                                              ZK80
      COMMON  / KVARJE / ZK8(1) , ZK16(1) , ZK24(1) , ZK32(1) , ZK80(1)
C     -----  FIN  COMMUNS NORMALISES  JEVEUX  --------------------------
C
        CHARACTER*3  NONOUI(2)
        CHARACTER*8  NOMZO
        CHARACTER*19 NOM
        CHARACTER*24 FSIC, FSVI, FSVK, FSVR
C
        CHARACTER*16 TXENCE(2)
        CHARACTER*24 TEXPAS(2), TXFAAX(2), TEXAXE(3)
        CHARACTER*60 TEXTYP(4),TXRES1(8),TXRES2(4),TXGRA2(4)
        CHARACTER*60 TXRES3(6),TXRES4(6)
C
        DATA NONOUI  /'NON','OUI'/
C
        DATA TEXTYP  /
     +   'FAISCEAU DE TUBES SOUS ECOULEMENT TRANSVERSE               ',
     +   'GRAPPE DE COMMANDE                                         ',
     +   'FAISCEAU DE TUBES SOUS ECOULEMENT AXIAL                    ',
     +   'DEUX COQUES CYLINDRIQUES COAXIALES - ECOULEMENT ANNULAIRE  '/
C
        DATA TXRES1  /
     +   'CELLULE DE TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE1   ',
     +   'CELLULE DE TUBES VIBRANTS CLOTAIRE PROFIL REEL             ',
     +   'CELLULE DE TUBES VIBRANTS CLOTAIRE PROFIL UNIFORME         ',
     +   'TUBE UNIQUE VIBRANT EN MILIEU DE FAISCEAU RIGIDE VISCACHE1 ',
     +   'TUBE UNIQUE VIBRANT EN DEBUT DE FAISCEAU RIGIDE VISCACHE1  ',
     +   'TUBE ROMPU                                                 ',
     +   'TUBE UNIQUE VIBRANT EN MILIEU DE FAISCEAU RIGIDE TANAKA    ',
     +   'TUBE UNIQUE VIBRANT EN MILIEU DE FAISCEAU RIGIDE DIVA EAU  '/
C
        DATA TXRES2  /
     +   'CELLULE DE TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE1   ',
     +   'CELLULE DE TUBES VIBRANTS EN MILIEU DE FAISCEAU VISCACHE1  ',
     +   'TUBE UNIQUE VIBRANT EN MILIEU DE FAISCEAU RIGIDE VISCACHE1 ',
     +   'TUBE UNIQUE VIBRANT EN DEBUT DE FAISCEAU RIGIDE VISCACHE1  '/
C
        DATA TXRES3  /
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 CFD 90 %     ',
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 CFD 85 %     ',
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 CFD 80 %     ',
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 CFD 50 %     ',
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 CFD 20 %     ',
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 CFD 10 %     '/
C
        DATA TXRES4  /
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 TUM 90 %     ',
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 TUM 86 %     ',
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 TUM 80 %     ',
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 TUM 50 %     ',
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 TUM 20 %     ',
     +   'TUBES VIBRANTS EN DEBUT DE FAISCEAU VISCACHE2 TUM 10 %     '/
C
        DATA TEXPAS  /'CARRE LIGNE             ',
     +                'TRIANGULAIRE LIGNE      '/
C
        DATA TXGRA2  /
     +   'GRAPPE2, ECOULEMENT ASCENDANT , TIGE DE COMMANDE CENTREE   ',
     +   'GRAPPE2, ECOULEMENT ASCENDANT , TIGE DE COMMANDE EXCENTREE ',
     +   'GRAPPE2, ECOULEMENT DESCENDANT, TIGE DE COMMANDE CENTREE   ',
     +   'GRAPPE2, ECOULEMENT DESCENDANT, TIGE DE COMMANDE EXCENTREE '/
C
        DATA TEXAXE  /'AXE X DU REPERE GLOBAL  ',
     +                'AXE Y DU REPERE GLOBAL  ',
     +                'AXE Z DU REPERE GLOBAL  '/
C
        DATA TXFAAX  /'FAISCEAU COMPLET        ',
     +                'FAISCEAU EQUIVALENT     '/
C
        DATA TXENCE  /'CIRCULAIRE      ',
     +                'RECTANGULAIRE   '/
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
  90    FORMAT(3X,'***************************************************',
     &         '****')
  91    FORMAT(3X,'*',53X,'*')
  92    FORMAT(3X,'*',1X,'DEFINITION DES CARACTERISTIQUES D UNE ',
     &         'CONFIGURATION',1X,'*')
  93    FORMAT(3X,'*',6X,'POUR UNE ETUDE DYNAMIQUE SOUS ECOULEMENT',
     &         7X,'*')
  94    FORMAT(3X,'CONFIGURATION : ',A60)
  95    FORMAT(3X,'PRISE EN COMPTE DU COUPLAGE : ',A3)
C
 101    FORMAT(5X, A60)
 102    FORMAT(3X,'TYPE DE PAS DU FAISCEAU : ',A24)
 103    FORMAT(3X,'VALEUR DU PAS REDUIT : ',D12.5)
 104    FORMAT(3X,'VALEUR DU CONFINEMENT : ',D12.5)
 105    FORMAT(3X,'TYPE DE RESEAU DE LA ZONE ASSOCIEE AU PROFIL '
     &        ,A8,':')
C
 201    FORMAT(3X,'EXCITATION : ',A60)
 202    FORMAT(3X,'NOEUD D APPLICATION : ',A8)
 203    FORMAT(3X,'VALEUR DU COEFFICIENT DE MASSE AJOUTEE : ',D12.5)
C
 301    FORMAT(3X,'TYPE DE REPRESENTATION : ',A24)
 302    FORMAT(3X,'AXE DIRECTEUR DU FAISCEAU : ',A24)
 311    FORMAT(3X,'NOMBRE DE TUBES DU FAISCEAU EQUIVALENT : ',I3)
 312    FORMAT(3X,'NOMBRE DE TUBES DU FAISCEAU REEL : ',I3)
 321    FORMAT(3X,'TYPE D ENCEINTE : ',A16)
C
 401    FORMAT(3X,'PRISE EN COMPTE DES EFFETS DE MASSE AJOUTEE : ',A3)
 402    FORMAT(3X,'AXE DE REVOLUTION DES COQUES : ',A24)
C
        IFM = IUNIFI('MESSAGE')
C
        FSIC = NOM//'.FSIC'
        FSVI = NOM//'.FSVI'
        FSVK = NOM//'.FSVK'
        FSVR = NOM//'.FSVR'
C
        CALL JEVEUO(FSIC,'L',LFSIC)
        ITYPFL = ZI(LFSIC)
        ICOUPL = ZI(LFSIC+1)
C
        WRITE(IFM,*)
        WRITE(IFM,90)
        WRITE(IFM,91)
        WRITE(IFM,92)
        WRITE(IFM,91)
        WRITE(IFM,93)
        WRITE(IFM,91)
        WRITE(IFM,90)
        WRITE(IFM,*)
        WRITE(IFM,94) TEXTYP(ITYPFL)
        WRITE(IFM,*)
        WRITE(IFM,95) NONOUI(ICOUPL+1)
        WRITE(IFM,*)
C
        IF (ITYPFL.EQ.1) THEN
C
          CALL JEVEUO(FSVR,'L',LFSVR)
          IF (ICOUPL.EQ.0) THEN
            WRITE(IFM,104) ZR(LFSVR)
          ELSE
            CALL JEVEUO(FSVI,'L',LFSVI)
            CALL JEVEUO(FSVK,'L',LFSVK)
            IP = ZI(LFSVI)
            NZEX = ZI(LFSVI+1)
            IF (IP.EQ.1) THEN
              DO 10 IZON = 1,NZEX
                IR    = ZI(LFSVI+IZON+1)
                NOMZO = ZK8(LFSVK+IZON+3)
                WRITE(IFM,105) NOMZO
                IF(IR.LT.100) THEN
                   WRITE(IFM,101) TXRES1(IR)
                ELSE IF(IR.LT.200) THEN
                   WRITE(IFM,101) TXRES3(IR-100)
                ELSE
                   WRITE(IFM,101) TXRES4(IR-1000)
                ENDIF
  10          CONTINUE
            ELSE
              DO 20 IZON = 1,NZEX
                IR    = ZI(LFSVI+IZON+1)
                NOMZO = ZK8(LFSVK+IZON+3)
                WRITE(IFM,105) NOMZO
                WRITE(IFM,101) TXRES2(IR)
  20          CONTINUE
            ENDIF
            WRITE(IFM,102) TEXPAS(IP)
            WRITE(IFM,103) ZR(LFSVR+1)
            WRITE(IFM,104) ZR(LFSVR)
          ENDIF
C
        ELSE IF (ITYPFL.EQ.2) THEN
C
          IF (ICOUPL.EQ.1) THEN
            CALL JEVEUO(FSVK,'L',LFSVK)
            CALL JEVEUO(FSVR,'L',LFSVR)
            IF (ZK8(LFSVK).EQ.'ASC_CEN') THEN
              WRITE(IFM,201) TXGRA2(1)
            ELSE IF (ZK8(LFSVK).EQ.'ASC_EXC') THEN
              WRITE(IFM,201) TXGRA2(2)
            ELSE IF (ZK8(LFSVK).EQ.'DES_CEN') THEN
              WRITE(IFM,201) TXGRA2(3)
            ELSE
              WRITE(IFM,201) TXGRA2(4)
            ENDIF
            WRITE(IFM,202) ZK8(LFSVK+1)
            WRITE(IFM,203) ZR(LFSVR)
          ENDIF
C
        ELSE IF (ITYPFL.EQ.3) THEN
C
          CALL JEVEUO(FSVI,'L',LFSVI)
          IEQUIV = ZI(LFSVI)
          IAXE   = ZI(LFSVI+1)
          IENCE  = ZI(LFSVI+2)
          WRITE(IFM,301) TXFAAX(IEQUIV+1)
          WRITE(IFM,302) TEXAXE(IAXE)
          IF (IEQUIV.EQ.1) THEN
            WRITE(IFM,311) ZI(LFSVI+3)
            WRITE(IFM,312) ZI(LFSVI+4)
          ENDIF
          WRITE(IFM,321) TXENCE(IENCE)
C
        ELSE
C
          CALL JEVEUO(FSVI,'L',LFSVI)
          IMASSE = ZI(LFSVI)
          IAXE   = ZI(LFSVI+1)
          WRITE(IFM,401) NONOUI(IMASSE+1)
          WRITE(IFM,402) TEXAXE(IAXE)
C
        ENDIF
C
        WRITE(IFM,*)
C
      CALL JEDEMA()
        END
