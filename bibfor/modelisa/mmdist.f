      SUBROUTINE MMDIST(IZONE,IPC,NBN,USUFIX,LUSURE,DEFICO,
     &                  IMA, NCMPMX, NCMPU,JEUSUP,JEUUSU)
     
     
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF MODELISA  DATE 02/07/2007   AUTEUR MACOCCO K.MACOCCO 
C ======================================================================
C COPYRIGHT (C) 1991 - 2007  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
     
      IMPLICIT NONE     
      CHARACTER*24  DEFICO
      CHARACTER*19  USUFIX
      INTEGER       IZONE, IPC, NBN, IMA, NCMPMX, NCMPU
      REAL*8        JEUSUP,JEUUSU
      LOGICAL       LUSURE

C
C ----------------------------------------------------------------------
C ROUTINE APPELEE PAR : MMMBCA
C ----------------------------------------------------------------------
C
C ALGO. DES CONTRAINTES ACTIVES POUR LE CONTACT METHODE CONTINUE
C
C
C IN  IZONE  : ZONE DE CONTACT
C IN  IPC    : NUMERO DU POINT DE CONTACT
C IN  NBN    : NOMBRE DE POINTS DE CONTACT
C IN  USUFIX : ????
C IN  DEFICO : SD POUR LA DEFINITION DE CONTACT
C IN  IMA    : NUMERO DE LA MAILLE ESCLAVE
C IN  NCMPMX : ????
C IN  NCMPU  : ????
C OUT JEUSUP : JEU SUPPLEMENTAIRE DIST_MAIT+DIST_ESCL
C              OU DIST_MAIT+EPAISSEUR DE LA POUTRE OU 
C              OU DIST_MAIT+EPAISSEUR DE LA COQUE
C OUT JEUUSU : JEU DU A L'USURE
C
C -------------- DEBUT DECLARATIONS NORMALISEES  JEVEUX ----------------
C
      INTEGER            ZI
      COMMON  / IVARJE / ZI(1)
      REAL*8             ZR
      COMMON  / RVARJE / ZR(1)
      COMPLEX*16         ZC
      COMMON  / CVARJE / ZC(1)
      LOGICAL            ZL
      COMMON  / LVARJE / ZL(1)
      CHARACTER*8        ZK8
      CHARACTER*16                ZK16
      CHARACTER*24                          ZK24
      CHARACTER*32                                    ZK32
      CHARACTER*80                                              ZK80
      COMMON  / KVARJE / ZK8(1) , ZK16(1) , ZK24(1) , ZK32(1) , ZK80(1)

      INTEGER      IREP,JJSUP,JJCOQ,JJPOU,NNOCO,JVALEX,CFDISI
      REAL*8       RREP,DIST1,DIST2,DIST3
      CHARACTER*5  QUESTI
      CHARACTER*24 JEUPOU,JEUCOQ,JEUSUC

C
C --- LECTURE DES SD POUR LE CONTACT POTENTIEL
C
      CALL JEMARQ
      JEUPOU = DEFICO(1:16)//'.JEUPOU'
      JEUCOQ = DEFICO(1:16)//'.JEUCOQ'
      JEUSUC = DEFICO(1:16)//'.JSUPCO'

      CALL JEVEUO(JEUSUC,'L',JJSUP)      
      CALL JEVEUO(JEUPOU,'L',JJPOU )
      CALL JEVEUO(JEUCOQ,'L',JJCOQ )
      CALL JEVEUO(USUFIX//'.VALE','L',JVALEX)

C
C --- INITIALISATION DE VARIABLES
C
      DIST1 = 0.D0
      DIST2 = 0.D0
      DIST3 = 0.D0
      NNOCO  = CFDISI(DEFICO,'NNOCO',IZONE)
      
      IF (LUSURE) THEN
        JVALEX = JVALEX + (NCMPMX-NCMPU)*(IPC-1)*IMA
        JEUUSU = - ABS(ZR(JVALEX+(NBN*(IMA-1)+IPC-1)))
      ELSE 
        JEUUSU = 0.D0
      ENDIF
      
C
C --- VALEUR DU JEU SUPPLEMENTAIRE SI DIST_POUTRE
C
      IF ( ZR(JJPOU-1+NNOCO+1).GT.0.5D0 ) THEN
       DIST1= ZR(JJPOU-1+IZONE)
      ENDIF
C
C --- VALEUR DU JEU SUPPLEMENTAIRE SI DIST_COQUE
C
      IF ( ZR(JJCOQ-1+NNOCO+1).GT.0.5D0 ) THEN
        DIST2 = ZR(JJCOQ-1+IZONE)
      ENDIF
C
C --- VALEUR DU JEU SUPPLEMENTAIRE SI DIST_ESCL
C
      DIST3 = ZR(JJSUP-1+IZONE)

      JEUSUP = DIST1+DIST2+DIST3
      
      CALL JEDEMA()
      END
