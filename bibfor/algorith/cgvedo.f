      SUBROUTINE CGVEDO(NDIM,OPTION)
      IMPLICIT NONE

      INTEGER      NDIM
      CHARACTER*16 OPTION

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 17/12/2012   AUTEUR DELMAS J.DELMAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE GENIAUT S.GENIAUT
C
C      SOUS-ROUTINE DE L'OPERATEUR CALC_G
C
C      BUT : VERIFICATION DE LA COMPATIBILITE ENTRE NDIM ET OPTION
C
C  IN :
C     NDIM   : DIMENSION DU PROBLEME
C     OPTION : OPTION DE CALC_G
C ======================================================================
C
      INTEGER      NBOP3D,I
      PARAMETER   (NBOP3D=4)
      CHARACTER*16 LIOP3D(NBOP3D)
      DATA         LIOP3D / 'CALC_G_GLOB','G_MAX_GLOB','G_BILI_GLOB',
     &                      'CALC_K_MAX' /

C     VERIFICATION DE NDIM VAUT 2 OU 3
      IF (.NOT.(NDIM.EQ.2.OR.NDIM.EQ.3)) CALL U2MESS('F','RUPTURE0_2')

C     VERIFICATION DE L'OPTION (NORMALEMENT, C'EST FAIT DANS LE CAPY)
      CALL ASSERT(OPTION.EQ.'CALC_G'.OR.
     &            OPTION.EQ.'CALC_G_GLOB'.OR.
     &            OPTION.EQ.'CALC_K_G'.OR.
     &            OPTION.EQ.'K_G_MODA'.OR.
     &            OPTION.EQ.'G_BILI'.OR.
     &            OPTION.EQ.'G_BILI_GLOB'.OR.
     &            OPTION.EQ.'G_MAX'.OR.
     &            OPTION.EQ.'G_MAX_GLOB'.OR.
     &            OPTION.EQ.'CALC_K_MAX')

C     CERTAINES OPTIONS NE S'UTILISENT (OU NE SONT PROGRAMMEES) QU'EN 3D
      IF (NDIM.EQ.2) THEN
        DO 10 I=1,NBOP3D
          IF (OPTION.EQ.LIOP3D(I)) THEN
            CALL U2MESK('F','RUPTURE0_3',1,OPTION)
          ENDIF
 10     CONTINUE
      ENDIF

      END
