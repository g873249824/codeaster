      SUBROUTINE INSDT (EPSRX,STRNX,STRNRX,TANG,S1X,
     1   EDT,EDC,EPST,DEFR,IFISU,IPLA,EQSTR,RTM,EPSC,IREFE)
        IMPLICIT REAL*8 (A-H,O-Z)
C       -----------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 09/02/2004   AUTEUR REZETTE C.REZETTE 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C       -----------------------------------------------------------
C       NADAI_B :  BETON FISSURE
C
C       CE SOUS-PROGRAMME GERE LA REFERMETURE DES FISSURES.
C       CALCUL DE LA NOUVELLE PENTE EDT (RESTAURATION PROGRESSIVE
C         DE LA RAIDEUR DE LA FISSURE)
C
C ENTREES : EPSRX  = DEFORMATION TOTALE A T
C           STRNX  = INCREMENT DE DEFORMATION
C           STRNRX = EPSRX + STRNX
C
C  E/S : IFISU,IPLA,EQSTR,TANG,EPST,EPSC,EDC,EDT,RTM,DEFR
C        CE SONT TOUTES DES VARIABLES INTERNES, VOIR LEUR
C        SIGNIFICATION DANS LA PROCEDURE  INSPIF
C
C SORTIES :  S1X :  CONTRAINTE UNIAXIALE A T+DT
C       -----------------------------------------------------------
      INTEGER   IFISU,IPLA,IREFE,ICC
      REAL*8    EPSRX,STRNX,S1X,EQSTR,TANG,EPST
      REAL*8    EPSC,EDC,EDT,RTM,DEFR
      COMMON/CARMA/EX,RB,ALPHA,EMAX,PENT,ICU
      COMMON /DBETO/ POU1(4),RBB,ALPH,EXX,PXY,EMAXX,EPSUT,FTC,FLIM,
     &    EPO,EPO1,POU2(6),ICC,IPOU1(9)
C------------------------------------------------------------------
      IREFE=0
      RBT=ALPHA*RB
      REFERM=3.D0*EPSUT
      IF(ABS(EDC).LT.0.1D-06) EDC=0.D0
      IF(EDC.NE.0.D0) REFERM=REFERM+DEFR
      IF(STRNRX.GT.EPSRX) GOTO 9999
      IF(STRNRX.GT.REFERM) THEN
        IREFE=1
        S1X=0.D0
        TANG=0.D0
        GOTO 9999
      ENDIF
      IFISU=0
      IF(EDC.NE.0.D0) EPST=DEFR-RBT/EDC
C
C       REFERMETURE POUR UN POINT INITIALLEMENT TENDU
C
C       CALCUL DU MODULE EDT LORS DE LA REFERMETURE
C
       IF(STRNRX.GT.EPST) THEN
        IF(EPSRX.LE.REFERM)THEN
         EDT=(RBT+RTM)/(EPSRX-EPST)
         IF(IPLA.EQ.1.AND.EQSTR.LT.RBT) EDT=EQSTR/(EPSRX-EPST)
        S1X=EDT*STRNX+RTM
       ELSE
       EDT=RBT/(REFERM-EPST)
         IF(IPLA.EQ.1.AND.EQSTR.LT.RBT) EDT=EQSTR/(REFERM-EPST)
       S1X=EDT*(STRNRX-REFERM)
      ENDIF
      TANG=EDT
       ELSE
        IF(STRNRX.LT.EPSC) THEN
       A=ABS(STRNRX)
      CALL INSCU ( A , SEQ , EPEQ , IPLA , TANG )
C
C       ACTUALISATION DE EQSTR
C
       EQSTR=SEQ
       S1X=-SEQ
        ELSE
C
C ON EST SUR LA PENTE EDC
C
       S1X=EDC*(STRNRX-DEFR)
       TANG=EDC
        ENDIF
       ENDIF
 9999 CONTINUE
      END
