      SUBROUTINE PROJSE(MATYP ,NDIM  ,PROJ  ,MOYEN ,
     &                  UNORM ,MNORM ,
     &                  COORDA,COORDB,COORDC,COORDP,
     &                  COORDM,LAMBDA,DEBORD)
C
C ======================================================================
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 24/09/2007   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.

C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.

C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT NONE
      CHARACTER*4 MATYP
      INTEGER     NDIM
      REAL*8      COORDA(3)
      REAL*8      COORDB(3)
      REAL*8      COORDC(3)
      REAL*8      COORDP(3)
      INTEGER     PROJ
      INTEGER     MOYEN
      REAL*8      UNORM(3)
      REAL*8      MNORM(3)
      REAL*8      COORDM(3)
      REAL*8      DEBORD
      REAL*8      LAMBDA(3)
C      
C ----------------------------------------------------------------------
C
C ROUTINE CONTACT (METHODES DISCRETES - APPARIEMENT - MAIT/ESCL - SEG)
C
C PROJECTION D'UN NOEUD ESCLAVE SUR UN SEG2 OU UN SEG3
C
C ----------------------------------------------------------------------
C
C
C IN  MATYP  : TYPE DE LA MAILLE ( SEG2 , SEG3 )
C IN  NDIM   : DIMENSION DU PROBLEME
C IN  COORDA : COORDONNEES DU SOMMET A DU SEGMENT
C IN  COORDB : COORDONNEES DU SOMMET B DU SEGMENT
C IN  COORDC : COORDONNEES DU MILIEU C DU SEGMENT
C IN  COORDP : COORDONNEES DU NOEUD ESCLAVE P
C IN  PROJ   : PROJECTION LINEAIRE (1) OU QUADRATIQUE (2) SUR LA MAILLE
C              OU PAS DE NOUVELLE PROJECTION (0)
C IN  MOYEN  : NORMALES D'APPARIEMENT
C               0 MAIT
C               1 MAIT_ESCL
C IN  UNORM  : NORMALE MOYENNE MAITRE/ESCLAVE                
C IN  MNORM  : NORMALE A LA MAILLE MAITRE
C OUT COORDM : COORDONNEES PHYSIQUES DE LA "PROJECTION" M
C OUT LAMBDA : COORDONNEES PARAMETRIQUES SUR LA MAILLE MAITRE
C                 DE LA "PROJECTION" M 
C OUT DEBORD : PROJECTION HORS DE LA MAILLE
C              >0 : PROJECTION HORS DE LA MAILLE
C              <0 : PROJECTION SUR LA MAILLE
C
C ----------------------------------------------------------------------
C
      IF ((MATYP.EQ.'SEG2') .OR. (PROJ.EQ.1)) THEN
        CALL PROJLI(NDIM  ,COORDA,COORDB,COORDP,MOYEN ,
     &              UNORM ,MNORM ,COORDM,LAMBDA,DEBORD)
      ELSE IF ((MATYP.EQ.'SEG3') .AND. (PROJ.EQ.2)) THEN
        CALL PROJSQ(NDIM  ,COORDA,COORDB,COORDC,COORDP,
     &              COORDM,LAMBDA,DEBORD)
      ELSE
        CALL ASSERT(.FALSE.)
      END IF

      END
