      SUBROUTINE CGLEMU(RESU,VECORD,LMELAS,LNCAS,MELORD)
      IMPLICIT NONE

      INCLUDE 'jeveux.h'

      CHARACTER*8  RESU
      CHARACTER*19 VECORD
      CHARACTER*24 MELORD
      LOGICAL      LMELAS,LNCAS

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 17/12/2012   AUTEUR DELMAS J.DELMAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE GENIAUT S.GENIAUT
C
C     SOUS-ROUTINE DE L'OPERATEUR CALC_G
C
C     BUT : LECTURE DES INFORMATINOS RELATIVES AUX MULT_ELAS
C  IN :
C     RESU   : MOT-CLE RESULTAT
C     VECORD : VECTEUR DES NUME_ORDRE DU RESU
C  OUT :
C     LMELAS : .TRUE. SI LA SD_RESULTAT EST DE TYPE MULT_ELAS
C     LNCAS  : .TRUE. SI ON A RENSEIGNE DANS CALC_G LES CAS A TRAITER
C     MELORD : VECTEUR DE LOGICAL POUR SAVOIR SI UN NUME_ORDRE
C              DOIT ETRE TRAITE OU PAS
C ======================================================================
C
      INTEGER      IER,IARG,NCAS,JNCAS,JNORD,I,IBID,IIND,IVEC,NBORD
      INTEGER      NUTROU,NBTROU,INDIIS
      REAL*8       RBID
      CHARACTER*8  K8B
      CHARACTER*16 TYPSD,K16B,NOMCAS,VALK(2)
      CHARACTER*24 MELCAS
      COMPLEX*16   C16B

      CALL JEMARQ()

C     INITIALISATIONS
      LNCAS =.FALSE.
      LMELAS=.FALSE.

      CALL JEVEUO(VECORD,'L',IVEC)
      CALL JELIRA(VECORD,'LONMAX',NBORD,K8B)

      CALL GETTCO(RESU,TYPSD)

      IF (TYPSD.NE.'MULT_ELAS') GOTO 999

      LMELAS=.TRUE.

C     A T-ON RENSEIGNE NOM_CAS DANS CALC_G ?
      CALL GETVTX(' ','NOM_CAS',0,IARG,0,K16B,NCAS)

      IF (NCAS.NE.0) THEN

C       NOM_CAS EST RENSEIGNE DANS CALC_G
        LNCAS=.TRUE.

C       NOMBRE DE CAS A TRAITER
        NCAS=-NCAS

C       CREATION DU VECTEUR CONTENANT LES NOMS DES CAS
        MELCAS = '&&CGLEMU.MULTELAS.NOMCAS'
        CALL WKVECT(MELCAS,'V V K16',NCAS,JNCAS)

C       REMPLISSAGE DU VECTEUR CONTENANT LES NOMS DES CAS
        CALL GETVTX(' ','NOM_CAS',0,IARG,NCAS,ZK16(JNCAS),IER)

C       CREATION DU VECTEUR DE LOGICAL POUR SAVOIR SI UN NUME_ORDRE
C       DOIT ETRE TRAITE OU PAS
        CALL WKVECT(MELORD,'V V L',NBORD,JNORD)

C       REMPLISSAGE DU VECTEUR MELORD
        DO 10 I=1,NCAS
C         RECUP DU NUME_ORDRE CORRESPONDANT AU NOM_CAS COURANT
          NOMCAS=ZK16(JNCAS-1+I)
          CALL RSORAC(RESU,'NOM_CAS',IBID,RBID,NOMCAS,C16B,RBID,K8B,
     &                NUTROU,1,NBTROU)
          IF (NBTROU.EQ.0) THEN
            VALK(1)=NOMCAS
            VALK(2)=RESU
            CALL U2MESK('F','RUPTURE0_28',2,VALK)
          ELSE
            IIND=INDIIS(ZI(IVEC),NUTROU,1,NBORD)
            ZL(JNORD+IIND-1)=.TRUE.
          ENDIF
 10     CONTINUE

        CALL JEDETR(MELCAS)

      ENDIF

 999  CONTINUE

      CALL JEDEMA()

      END
