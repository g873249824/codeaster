      SUBROUTINE XDOCON(ALGOCR,ALGOFR,CFACE ,CONTAC,COEFCP,
     &                  COEFFP,COEFCR,COEFFR,ELC   ,FPG   ,
     &                  IFISS ,IVFF  ,JCFACE,JDONCO,JLONCH,
     &                  MU    ,NSPFIS,NCOMPD,NDIM  ,NFACE ,
     &                  NINTER,NNOF  ,NOMTE ,NPGF  ,NPTF  ,
     &                  RELA)
      IMPLICIT   NONE
      INCLUDE 'jeveux.h'
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 19/12/2012   AUTEUR PELLET J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C TOLE CRP_21
C RECUPERATION DIVERSES INFOS LIEES AU CONTACT XFEM DANS UN TE
C
C OUT ALGOCR : ALGO DE CONTACT (1:LAG, 2:PENA, 3:COHESIF)
C OUT ALGOFR : ALGO DE FROTTEMENT (1: LAGRANGIEN, 2: PENALISATION)
C OUT CFACE  : TABLEAU CONNECTIVITE FACETTES DE CONTACT
C IN  CONTAC : TYPE DE CONTACT (P1P1, P1P2)
C OUT COEFCP : COEFF PENALISATION CONTACT
C OUT COEFFP : COEFF PENALISATION FROTTEMENT
C OUT COEFCR : COEFF AUGM CONTACT
C OUT COEFFR : COEFF AUGM FROTTEMENT
C OUT COHES  : VECTEUR VARIABLES INTERNES LOI COHESIVE
C OUT IAINT  : ADRESSE TOPOFAC.AI FISSURE COURANTE
C IN  IFISS  : NUMERO FISSURE
C OUT INDCO  : TABLEAU DES STATUTS FISSURE COURANTE
C OUT IVFF   : ADRESSE TABLEAU DES FONCTIONS DE FORME
C IN  JAINT  : ADRESSE TOPOFAC.AI INITIAL
C IN  JBASEC : ADRESSE TOPOFAC.BA INITIAL
C IN  JCFACE : ADRESSE TOPOFAC.CF INITIAL
C IN  JDONCO : ADRESSE CHAM_ELEM DONNEES DU CONTACT
C IN  JINDCO : ADRESSE STOCKAGE CHAMP STATUT DE CONTACT
C IN  JLONCH : ADRESSE STOCKAGE CHAMP TOPOFAC.LO
C IN  JPTINT : ADRESSE STOCKAGE CHAMP TOPOFAC.PI
C IN  JSEUIL : ADRESSE STOCKAGE CHAMP SEUIL FROTTEMENT
C OUT MU     : COEFFICIENT DE COULOMB
C IN  NCOMP[X] : NOMBRE DE COMPOSANTES CHAMP LOCAL DS LE CATALOGUE
C IN NDIM    : DIMENSION MODELE
C OUT NFACE  : NOMBRE DE FACETTES POUR L ELEMENT ET LA FISSURE
C OUT NINTER : NOMBRE DE POINTS D INTERSECTION
C OUT NNOF   : NOMBRE DE NOEUDS TOTAL 
C               D UN EL DE CONTACT (UNE FACETTE)
C IN  NOMTE  : TYPE ELEMENT
C OUT NPGF   : NOMBRE DE POINTS DE GAUSS PAR FACETTE
C OUT SEUIL  : TABLEAU DES SEUILS DE FROTTEMENT
      INTEGER ALGOCR,ALGOFR,CFACE(5,3),CONTAC
      INTEGER I,IBID,IDFDEF,IFISS
      INTEGER IPOIDF,IVFF,J,JCFACE
      INTEGER JDONCO,JLONCH
      INTEGER NSPFIS,NCOMPD,NDIM
      INTEGER NFACE,NINT,NINTEG,NINTER,NNOF
      INTEGER NPGF,NPTF
      REAL*8  COEFCP,COEFFP,COEFCR,COEFFR,MU,RELA
      CHARACTER*8 ELC,FPG
      CHARACTER*16 ENR,NOMTE
     
C
C --- RECUPERATION TOPOLOGIE FACETTES
C --- DECALAGE D INDICE POUR TOPOFAC (MULTIFISSURATION)
C
        NINTER=ZI(JLONCH+3*(IFISS-1)-1+1)
        IF (NINTER.EQ.0) GOTO 99
C
C --- SCHEMA D'INTEGRATION NUMERIQUE ET ELEMENT 
C     DISCUSSION VOIR BOOK IV 18/10/2004 ET BOOK VI 06/07/2005
        NINTEG = NINT(ZR(JDONCO-1+(IFISS-1)*NCOMPD+4))
        CALL XMINTE(NDIM,NINTEG,FPG)
C
        IF (NDIM .EQ. 3) THEN
          ELC='TR3'
        ELSEIF (NDIM.EQ.2) THEN
          IF(CONTAC.LE.2) THEN
            ELC='SE2'
          ELSE
            ELC='SE3'
          ENDIF
        ENDIF
        CALL ELREF4(ELC,FPG,IBID,NNOF,IBID,NPGF,IPOIDF,
     &              IVFF,IDFDEF,IBID)
C
C --- RECUPERATIONS DONNEES ET COEFFS DU CONTACT
C
        ALGOCR = NINT(ZR(JDONCO-1+(IFISS-1)*NCOMPD+6))
        ALGOFR = NINT(ZR(JDONCO-1+(IFISS-1)*NCOMPD+7))
        COEFCR = ZR(JDONCO-1+(IFISS-1)*NCOMPD+1)
        MU     = ZR(JDONCO-1+(IFISS-1)*NCOMPD+2)
        COEFFR = ZR(JDONCO-1+(IFISS-1)*NCOMPD+3)
        COEFCP = ZR(JDONCO-1+(IFISS-1)*NCOMPD+8)
        COEFFP = ZR(JDONCO-1+(IFISS-1)*NCOMPD+9)
C     VERIFICATIONS
        IF(ALGOCR.EQ.1) THEN
          CALL ASSERT(COEFCR.NE.0.D0.AND.COEFCP.EQ.0.D0)
        ELSE IF(ALGOCR.EQ.2) THEN
          CALL ASSERT(COEFCR.EQ.0.D0.AND.COEFCP.NE.0.D0)
        ELSE IF(ALGOCR.EQ.3) THEN
          CALL TEATTR(NOMTE,'S','XFEM',ENR,IBID)
          CALL ASSERT(ENR.EQ.'XHC')
          RELA   = ZR(JDONCO-1+(IFISS-1)*NCOMPD+10)
          CALL ASSERT(RELA.EQ.1.D0.OR.RELA.EQ.2.D0.OR.
     &                RELA.EQ.3.D0.OR.RELA.EQ.4.D0)
          COEFCR = 1.D0
        ELSE
          CALL ASSERT(.FALSE.)
        ENDIF
C
        IF(ALGOFR.EQ.1) THEN
          CALL ASSERT(COEFFR.NE.0.D0.AND.COEFFP.EQ.0.D0)
        ELSE IF(ALGOFR.EQ.2) THEN
          CALL ASSERT(COEFFR.EQ.0.D0.AND.COEFFP.NE.0.D0)
        ELSE
          CALL ASSERT(ALGOFR.EQ.0)
        ENDIF
C
C --- DECALAGE INDICE POUR LA MULTIFISSURATION
C
        NFACE=ZI(JLONCH+3*(IFISS-1)-1+2)
        NPTF=ZI(JLONCH+3*(IFISS-1)-1+3)
        DO 11 I=1,NFACE
           DO 12 J=1,NPTF
             CFACE(I,J)=ZI(JCFACE-1+NPTF*(I-1)+J)
 12        CONTINUE
 11     CONTINUE
C
        NSPFIS = NPGF*NFACE
C
99      CONTINUE
C
        END
