      SUBROUTINE BRCHRE(X066,V33,V33T,X166)

C     ROUTINE ANCIENNEMENT NOMMEE CHREPX66

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 08/12/2009   AUTEUR DEBONNIERES P.DE-BONNIERES 
C ======================================================================
C COPYRIGHT (C) 1991 - 2009  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================

C     CONSTRUCTION DE L OPERATEUR DE ROTATION R PASSAGE DE 0 A 1
C     DE LA BASE DE REFERENCE A LA BASE PRINCIPALE 
C     DES ENDOMMAGEMENTS DE RANKINE ET DE SON INVERSE RM1
      IMPLICIT NONE
      REAL*8 X33(3,3),Z33(3,3),V33(3,3),V33T(3,3)
      REAL*8 X066(6,6),X166(6,6),A66(6,6),B66(6,6)
      INTEGER I,J,K,L,M,N
      REAL*8 R(6,6),RM1(6,6),ZZ,TRAV(3,3)

      ZZ = 0.D0
      
      DO 10 I=1,6
       CALL MATINI(3,3,ZZ,X33)
       CALL BRINDZ(I,M,N)
       X33(M,N)=1.D0
       X33(N,M)=1.D0
       CALL UTBTAB('ZERO',3,3,X33,V33,TRAV,Z33)
       DO 20 J=1,3
         R(J,I)=Z33(J,J)
20    CONTINUE
       R(4,I)=Z33(1,2)
       R(5,I)=Z33(1,3)
       R(6,I)=Z33(2,3)
       CALL UTBTAB('ZERO',3,3,X33,V33T,TRAV,Z33)
       DO 30 J=1,3
        RM1(J,I)=Z33(J,J)
30    CONTINUE
       RM1(4,I)=Z33(1,2)
       RM1(5,I)=Z33(1,3)
       RM1(6,I)=Z33(2,3)
10    CONTINUE

C      PRINT*,'R'
C      CALL AFFICHE66(R)
C      PRINT*,'RM1'
C      CALL AFFICHE66(RM1)

C     VERIF R*RM1=I
C      DO I=1,6
C       DO J=1,6
C        A66(I,J)=0.
C        DO K=1,6
C         A66(I,J)=A66(I,J)+R(I,K)*RM1(K,J)
C        END DO
C       END DO
C      END DO
C      PRINT*,'R*RM1'
C      CALL AFFICHE66(A66)

C     PASSAGE DE LA MATRICE DES ENDOMMAGEMENTS DANS LA BASE FIXE
      DO 40 I=1,6
       DO 50 J=1,6
        A66(I,J)=0.D0
        DO 60 K=1,6
         A66(I,J)=A66(I,J)+X066(I,K)*RM1(K,J)
60      CONTINUE
50     CONTINUE
40    CONTINUE
      DO 70 I=1,6
       DO 80 J=1,6  
        X166(I,J)=0.D0
        DO 90 K=1,6
         X166(I,J)=X166(I,J)+R(I,K)*A66(K,J)
90      CONTINUE
80     CONTINUE
70    CONTINUE
C      PRINT*,'DT66 EN BASE FIXE'
C      CALL AFFICHE66(DT166)
C      READ*
       END
