      SUBROUTINE  ASSGCY (NOMRES,NOMNUM,NOMSTO)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 18/04/2005   AUTEUR NICOLAS O.NICOLAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2005  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
      IMPLICIT REAL*8 (A-H,O-Z)
C
C***********************************************************************
C    P. RICHARD     DATE 13/10/92
C-----------------------------------------------------------------------
C  BUT:      < ASSEMBLAGE GENERALISEE >
C
C  ASSEMBLER UNE MATRICE A PARTIR D'UNE NUMEROTATION GENERALISEE
C  ET D'UNE OPTION (RIGI_GENE,MASS_GENE,AMOR_GENE)
C
C REMARQUE : L'ASSEMBLAGE DONNE UNE MATRICE ASSEMBLEE LIGNE DE CIEL
C            IL CONSIDERE LES MATRICE ELEMENTAIRE GENERALISEES
C  A ASSEMBLER COMME DES BLOCS
C  CHAQUE MATRICE ELEMENTAIRE POUVANT ETRE CONSTITUE DE PLUSIEURS BLOCS
C  CE QUI SEMBLE COMPLIQUER NETTEMENT LA TACHE POUR LE MOMENT MAIS
C  LE TRAVAIL POUR CONSIDERE UNE MATRICE ASSEMBLEE LIGNE DE CIEL
C     COMME UNE MATRICE ELEMENTAIRE DEVRAIT ETRE MINIME
C
C-----------------------------------------------------------------------
C
C NOM----- / /:
C
C NOMRES   /I/: NOM K8 DE LA MATRICE GENERALISEE RESULTAT
C OPTION   /I/: OPTION DE CALCUL (RIGI_GENE,MASS_GENE)
C NOMNUM   /I/: NOM K19 DE LA NUMEROTATION GENERALISEE
C NOMSTO   /I/: NOM K19 DU STOCKAGE DE LA MATRICE
C
C-------- DEBUT COMMUNS NORMALISES  JEVEUX  ----------------------------
C
      INTEGER          ZI
      COMMON  /IVARJE/ ZI(1)
      REAL*8           ZR
      COMMON  /RVARJE/ ZR(1)
      COMPLEX*16       ZC
      COMMON  /CVARJE/ ZC(1)
      LOGICAL          ZL
      COMMON  /LVARJE/ ZL(1)
      CHARACTER*8      ZK8
      CHARACTER*16              ZK16
      CHARACTER*24                        ZK24
      CHARACTER*32                                  ZK32
      CHARACTER*80                                            ZK80
      COMMON  /KVARJE/ ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C
      CHARACTER*32  JEXNUM,JEXNOM
C
C----------  FIN  COMMUNS NORMALISES  JEVEUX  --------------------------
C----------  FIN  COMMUNS NORMALISES  JEVEUX  --------------------------
C
      CHARACTER*8  NOMRES,MODGEN,NOMPRN
      CHARACTER*19 NOMNUM,NOMSTO,RESU
      CHARACTER*24 TMADBL,TMNOBL,TMINBL,TMNOMB,TMNUMB,TMREP,TMCONL
      CHARACTER*24 NOMBLO
C
      INTEGER      BID,IBLO,NBSST,LDLIM,LLDESC,NEQ,NTBLOC,NBLOC,
     +             IALIME,IACONL,LDREF,IADESC,IADIA,IABLO,IHCOL,
     +             LDBLO,N1BLOC,N2BLOC,NBLIA,LLBLO,
     +             I,J,LLREF
      CHARACTER*8 K8BID
      CHARACTER*1 K1BID
C
C-----------------------------------------------------------------------
C
C--------------------------CREATION DU .REFA----------------------------
C
      CALL JEMARQ()
C
      RESU = NOMRES
C
C--------------------RECUPERATION DU MODE_GENE AMONT--------------------
C
      CALL JEVEUO(NOMNUM//'.REFN','L',LLREF)
      MODGEN=ZK24(LLREF)(1:8)
C
C--------------------------CREATION DU .LIME----------------------------
C   POUR L'INSTANT ON DONNE LE NOM DU MODELE GENERALISE
C
      CALL WKVECT(RESU//'.LIME','G V K8',1,LDLIM)
      ZK8(LDLIM)=MODGEN
C
C--------------------RECUPERATION DES CARACTERISTIQUES BLOCS------------
C
      CALL JEVEUO(NOMSTO//'.DESC','L',LLDESC)
      NEQ=ZI(LLDESC)
      NTBLOC=ZI(LLDESC+1)
      NBLOC=ZI(LLDESC+2)
      
      CALL JELIBE(NOMSTO//'.DESC')
      
      CALL JECREC(RESU//'.VALE','G V R','NU','DISPERSE',
     &'CONSTANT',NBLOC)
      CALL JEECRA(RESU//'.VALE','LONMAX',NTBLOC,K8BID)
      CALL JEECRA(RESU//'.VALE','DOCU',BID,'MS')
C
      CALL WKVECT ( RESU//'.CONL', 'G V R' , NEQ, IACONL )
      DO 10 I = 1 , NEQ
         ZR(IACONL+I-1) = 1.0D0
 10   CONTINUE
C
      CALL WKVECT(RESU//'.REFA','G V K24',4,LDREF)
      CALL JEECRA(RESU//'.REFA','DOCU',BID,'SLCS')
      ZK24(LDREF)='                    '
      ZK24(LDREF+1)=NOMNUM
      ZK24(LDREF+2)=NOMSTO

      CALL WKVECT ( RESU//'.DESC', 'G V I', 3, IADESC )
      ZI(IADESC)   = 2
      ZI(IADESC+1) = NEQ
      ZI(IADESC+2) = 2
 
C --- RECUPERATION DE LA STRUCTURE DE LA MATR_ASSE_GENE
C
      CALL JEVEUO ( NOMSTO//'.ADIA', 'L', IADIA )
      CALL JEVEUO ( NOMSTO//'.ABLO', 'L', IABLO )
      CALL JEVEUO ( NOMSTO//'.HCOL', 'L', IHCOL )
C
      DO 20 IBLO = 1 , NBLOC
C
         CALL JECROC ( JEXNUM(RESU//'.VALE',IBLO) )
         CALL JEVEUO ( JEXNUM(RESU//'.VALE',IBLO),
     +     'E', LDBLO )
C
C        BOUCLE SUR LES COLONNES DE LA MATRICE ASSEMBLEE
C
         N1BLOC = ZI(IABLO+IBLO-1)+1
         N2BLOC = ZI(IABLO+IBLO)
C    INITIALISATION DE LA MATRICE GENERALISEE        
           DO 30 I = N1BLOC , N2BLOC
              DO 40 J = (I-ZI(IHCOL+I-1)+1) , I
                 ZR(LDBLO+ZI(IADIA+I-1)+J-I-1) = 0.D0
 40           CONTINUE
 30        CONTINUE
C
         CALL JELIBE ( JEXNUM(RESU//'.VALE', IBLO) )
 20   CONTINUE
      CALL JEDEMA()
      END
