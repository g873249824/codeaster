      SUBROUTINE GRANAC(FAMI,KPG,KSP,ICDMAT,MATERI,COMPO,IRRAP,IRRAM,
     +                                              TM,TP,ANGMAS,DEGRAN)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 13/12/2011   AUTEUR FOUCAULT A.FOUCAULT 
C ======================================================================
C COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C     RECUPERATION DES CARACTERISTIQUES DE GRANDISSEMENT
      IMPLICIT NONE
      INTEGER        ICDMAT,KPG,KSP,NBPAR,CODRET
      REAL*8         IRRAM,IRRAP,TM,TP,ANGMAS(3),DEGRAN,VALRES
      REAL*8         DEPSGM,DEPSGP,DEPSGR,VALPAR(2),ALPHA
      CHARACTER*8    MATERI,NOMGRD,NOMPAR(2)
      CHARACTER*16   COMPO
      CHARACTER*(*)  FAMI
      DATA           NOMGRD /'GRAN_FO'/

      DEGRAN = 0.0D0
      IF (COMPO.EQ.'GRAN_IRRA_LOG') THEN
         NBPAR=2
         NOMPAR(1)='TEMP'
         NOMPAR(2)='IRRA'

C        INSTANT -
         VALPAR(1)=TM
         VALPAR(2)=IRRAM
         IF (IRRAM.GT.0.0D0) THEN
            CALL RCVALB(FAMI,KPG,KSP,'+',ICDMAT,MATERI,COMPO,NBPAR,
     &                          NOMPAR,VALPAR,1,NOMGRD,VALRES,CODRET,0)
            DEPSGM = VALRES
         ELSE
            DEPSGM = 0.0D0
         ENDIF

C        INSTANT +
         VALPAR(1)=TP
         VALPAR(2)=IRRAP
         IF (IRRAP.GT.0.0D0) THEN
            CALL RCVALB(FAMI,KPG,KSP,'+',ICDMAT,MATERI,COMPO,NBPAR,
     &                         NOMPAR,VALPAR,1,NOMGRD,VALRES,CODRET,0)
            DEPSGP = VALRES
         ELSE
            DEPSGP = 0.0D0
         ENDIF

         DEPSGR = DEPSGP - DEPSGM
         IF (DEPSGR.LT.0.0D0) THEN
            DEPSGR = 0.0D0
         ENDIF
C        RECUPERATION DU REPERE POUR LE GRANDISSEMENT
         ALPHA = ANGMAS(1)
         IF ( ANGMAS(2) .NE. 0.D0 ) THEN
            CALL U2MESS('F','ALGORITH6_59')
         ENDIF

C        INCREMENT DEFORMATION DE GRANDISSEMENT DANS LE REPERE
         DEGRAN = (DEPSGR/100.0D0)*COS(ALPHA)*COS(ALPHA)
      ENDIF
      END
