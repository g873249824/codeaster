      FUNCTION FITOF(PHI,F1,F2,AMOR,HORIG)
      IMPLICIT REAL*8 (A-H,O-Z)
C     ------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 10/03/98   AUTEUR VABHHTS J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C CETTE FONCTION RENVOIT LA FREQUENCE F TELLE QUE
C     PHASE(H-HORIG)=PHI OU H=1/(1-F**2+2I*F*AMOR)
C
C IN  :PHI      R8  :PHASE
C IN  :F1,F2    R8  :BORNES DU DOMAINE DANS LEQUEL ON RECHERCHE
C IN  :AMOR     R8  :AMORTISSEMENT REDUIT
C IN  :HORIG    C16 :DECALAGE DE L'ORIGINE POUR LES ANGLES
C     ------------------------------------------------------------------
      REAL*8 PHI,F1,F2,F3,EPS,PHI1,PHI2,PHI3,DF,FITOF,AMOR,FX1,FX2
      COMPLEX*16 H1,H2,H3,HORIG
      EPS=0.000001D0
      FX1=F1
      FX2=F2
       CALL TRANSF(FX1,AMOR,H1)
       CALL TRANSF(FX2,AMOR,H2)
      PHI1=PHASE((H1-HORIG)/DCMPLX(0.D0,1.D0))
      PHI2=PHASE((H2-HORIG)/DCMPLX(0.D0,1.D0))
      IF(((PHI1-PHI)*(PHI2-PHI)).GT.0.D0) THEN
      ENDIF
 101  CONTINUE
      F3=(FX1+FX2)/2.D0
      CALL TRANSF(F3,AMOR,H3)
      PHI3=PHASE((H3-HORIG)/DCMPLX(0.D0,1.D0))
      DF=ABS(F3-FX1)
      IF(DF.LT.EPS)THEN
      FITOF=F3
      GOTO 9999
      ENDIF
      IF(PHI3.GE.PHI)THEN
      FX1=F3
      ELSE
      FX2=F3
      ENDIF
      GOTO 101
 9999 CONTINUE
      END
