      SUBROUTINE MDFREV (NBMODE,VITGEN,FEXGEN,NBREVI,DPLREV,FONREV)
      IMPLICIT NONE
C ----------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 03/07/2012   AUTEUR PELLET J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C
C CALCUL DU SECOND MEMBRE POUR UNE NON-LINEARITE DE TYPE RELA_EFFO_VITE
C ----------------------------------------------------------------------
C IN  : NBMODE : NOMBRE DE MODES NORMAUX CONSIDERES
C IN  : VITGEN : VITESSES GENERALISES AU PAS COURANT
C VAR : FEXGEN : FORCES GENERALISEES AU PAS COURANT
C IN  : NBREVI : NOMBRE DE POINTS DECRIVANT LA NON-LINEARITE
C IN  : DPLREV : TABLEAU DES DEPLACEMENTS MODAUX AUX NOEUDS DE REV
C IN  : FONREV : FONCTIONS DE NON-LINEARITE
C ----------------------------------------------------------------------
      INTEGER     IER,ICOMP,NBMODE,NBREVI
      REAL*8      FORCE,VITESS,VITGEN(*),FEXGEN(*),
     &            DPLREV(NBREVI,NBMODE,*)
      CHARACTER*8 FONC,COMP,FONREV(NBREVI,*)
      INTEGER I ,J
C-----------------------------------------------------------------------
C
C     --- BOUCLE SUR LES NOEUDS DE NON-LINEARITE ---
C
      DO 10 I=1,NBREVI
C
        COMP = FONREV(I,2)
        FONC = FONREV(I,3)
C
        IF (COMP(1:2).EQ.'DX')  ICOMP = 1
        IF (COMP(1:2).EQ.'DY')  ICOMP = 2
        IF (COMP(1:2).EQ.'DZ')  ICOMP = 3
        IF (COMP(1:3).EQ.'DRX') ICOMP = 4
        IF (COMP(1:3).EQ.'DRY') ICOMP = 5
        IF (COMP(1:3).EQ.'DRZ') ICOMP = 6
C
        VITESS = 0.D0
        DO 20 J=1,NBMODE
          VITESS = VITESS + DPLREV(I,J,ICOMP)*VITGEN(J)
20      CONTINUE
C
        CALL FOINTE('F ',FONC,1,COMP,VITESS,FORCE,IER)
C
        DO 30 J=1,NBMODE
          FEXGEN(J)=FEXGEN(J)+DPLREV(I,J,ICOMP)*FORCE
30      CONTINUE
C
10    CONTINUE
C
      END
