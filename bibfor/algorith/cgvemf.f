      SUBROUTINE CGVEMF(MODELE,TYPFIS,NOMFIS)
      IMPLICIT NONE

      CHARACTER*8  MODELE,TYPFIS,NOMFIS

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 17/12/2012   AUTEUR DELMAS J.DELMAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE GENIAUT S.GENIAUT
C
C     SOUS-ROUTINE DE L'OPERATEUR CALC_G
C
C     BUT : VERIFICATION DE LA COMPATIBILITE ENTRE LA SD ASSOCIEE AU
C           FOND DE FISSURE ET LE MODELE
C
C  IN :
C    MODELE : NOM DE LA SD_MODELE
C    TYPFIS : TYPE DE LA SD DECRIVANT LE FOND DE FISSURE
C            ('THETA' OU 'FONDIFSS' OU 'FISSURE')
C    NOMFIS : NOM DE LA SD DECRIVANT LE FOND DE FISSURE
C ======================================================================
C
      INTEGER      IXFEM
      LOGICAL      FIINMO,XVFIMO
      CHARACTER*8  VALK(2)

C     LE MODELE EST-IL X-FEM : SI OUI IXFEM=1
      CALL EXIXFE(MODELE,IXFEM)

C     ERREUR SI FOND_FISS EST DONNE AVEC UN MODELE X-FEM
      IF (TYPFIS.EQ.'FONDFISS'.AND.IXFEM.EQ.1) THEN
        CALL U2MESK('F','RUPTURE0_95',1,MODELE)
      ENDIF

C     ERREUR SI FISSURE EST DONNE AVEC UN MODELE NON X-FEM
      IF (TYPFIS.EQ.'FISSURE'.AND.IXFEM.EQ.0) THEN
        CALL U2MESK('F','RUPTURE0_96',1,MODELE)
      ENDIF

C     ERREUR SI FISSURE N'EST PAS ASSOCIEE AU MODELE X-FEM
      IF (TYPFIS.EQ.'FISSURE') THEN
        FIINMO = XVFIMO(MODELE,NOMFIS)
        IF (.NOT.FIINMO) THEN
          VALK(1)=NOMFIS
          VALK(2)=MODELE
          CALL U2MESK('F','RUPTURE0_97',2,VALK)
        ENDIF
      ENDIF

      END
