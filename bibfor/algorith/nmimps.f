      SUBROUTINE NMIMPS(SDIMPR,SDCONV,SDERRO)
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 09/04/2013   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT      NONE
      INCLUDE       'jeveux.h'
      CHARACTER*24  SDCONV,SDIMPR,SDERRO
C
C ----------------------------------------------------------------------
C
C ROUTINE MECA_NON_LINE (AFFICHAGE - ACCES SD)
C
C IMPRESSION DES RESIDUS (RECAP FIN DE PAS)
C
C ----------------------------------------------------------------------
C
C
C IN  SDCONV : SD GESTION DE LA CONVERGENCE
C IN  SDIMPR : SD AFFICHAGE
C IN  SDERRO : GESTION DES ERREURS
C
C ----------------------------------------------------------------------
C
      CHARACTER*24 CNVTYP,CNVLIE,CNVVAL,CNVACT
      INTEGER      JCNVTY,JCNVLI,JCNVVA,JCNVAC
      INTEGER      IRESI,IARG,IBID,NRESI
      CHARACTER*8  K8BID
      REAL*8       VALR(1)
      CHARACTER*16 VALK(2)
      LOGICAL      LPRINT,MAXREL,MAXNOD
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
C --- ACCES SD CONVERGENCE
C
      CNVTYP = SDCONV(1:19)//'.TYPE'
      CNVLIE = SDCONV(1:19)//'.LIEU'
      CNVVAL = SDCONV(1:19)//'.VALE'
      CNVACT = SDCONV(1:19)//'.ACTI'
      CALL JEVEUO(CNVTYP,'L',JCNVTY)
      CALL JEVEUO(CNVLIE,'L',JCNVLI)
      CALL JEVEUO(CNVVAL,'L',JCNVVA)
      CALL JEVEUO(CNVACT,'L',JCNVAC)
      CALL JELIRA(CNVTYP,'LONMAX',NRESI,K8BID)
C
C --- MESSAGE DE BASCULEMENT DES CONVERGENCES
C
      CALL NMERGE(SDERRO,'RESI_MAXR',MAXREL)
      CALL NMERGE(SDERRO,'RESI_MAXN',MAXNOD)
C
C --- AFFICHAGE POUR CE PAS ?
C
      CALL OBGETB(SDIMPR,'PRINT',LPRINT)
      IF (.NOT.LPRINT) GOTO 99
C
C --- AFFICHAGE ENTETE ARCHIVAGE
C
      CALL U2MESS('I','MECANONLINE6_60')
      IF (MAXNOD) CALL U2MESS('I','MECANONLINE6_61')
      IF (MAXREL) CALL U2MESS('I','MECANONLINE6_62')
C
C --- AFFICHAGE
C
      IARG = 0
      DO 20 IRESI = 1,NRESI
        IF (ZL(JCNVAC-1+IRESI)) THEN
          IARG = IARG + 1
          VALK(1) = ZK16(JCNVTY-1+IRESI)
          VALK(2) = ZK16(JCNVLI-1+IRESI)
          VALR(1) = ZR(JCNVVA-1+IRESI)
          CALL U2MESG('I','MECANONLINE6_70',2,VALK,0,IBID,1,VALR)
        ENDIF
  20  CONTINUE
C
  99  CONTINUE
C
      CALL JEDEMA()

      END
