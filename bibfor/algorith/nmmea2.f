      SUBROUTINE NMMEA2(COEFIN,CMP,COEF)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 21/09/2011   AUTEUR COURTOIS M.COURTOIS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
      IMPLICIT NONE
      REAL*8      COEFIN,COEF
      CHARACTER*8 CMP

C  --------------------------------------------------------------------
C CONTACT XFEM : MISE A ECHELLE INCREMENT LAGRANGIENS DE CONTACT
C IN COEFIN : MODELE
C IN CMP    : NOM DE LA COMPOSANTE
C OUT COEF  : COEF MIS A L ECHELLE SI NECESSAIRE
C
C -------------- DEBUT DECLARATIONS NORMALISEES  JEVEUX ----------------
C
      INTEGER ZI
      COMMON /IVARJE/ZI(1)
      REAL*8 ZR
      COMMON /RVARJE/ZR(1)
      COMPLEX*16 ZC
      COMMON /CVARJE/ZC(1)
      LOGICAL ZL
      COMMON /LVARJE/ZL(1)
      CHARACTER*8 ZK8
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*32 ZK32
      CHARACTER*80 ZK80
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C
C -------------- FIN  DECLARATIONS  NORMALISEES  JEVEUX ----------------
      INTEGER      NOCC,IFORM,CFDISI,JNFIS,JMOFIS,NFISS,IZONE,XXCONI
      INTEGER      IFISS,IMODEL
      REAL*8       COECHE,COPENC,COPENF,COECH2,COPEC2,COPEF2,COEFME
      REAL*8       MMINFR
      CHARACTER*8  CHARCO,MODELE,NOMFIS
      CHARACTER*24 DEFICO,PMODEL
      LOGICAL      LEXIP,CFDISL
      INTEGER      IARG

C ----------------------------------------------------------------------
      CALL JEMARQ()
C
C SI PAS UNE RELATION SUR LAMBDA ON SORT
C
      COEF=COEFIN
      IF(CMP(1:4).NE.'LAGS') GOTO 99
C
C SI PAS DU CONTACT XFEM ON SORT
C
      CALL GETVID(' ','CONTACT',1,IARG,1,CHARCO,NOCC)
      IF(NOCC.LE.0) GOTO 99
      DEFICO=CHARCO//'.CONTACT'
      IFORM=CFDISI(DEFICO,'FORMULATION')
      IF(IFORM.NE.3) GOTO 99
C
      PMODEL=DEFICO(1:16)//'.MODELX'
      CALL JEVEUO(PMODEL,'L',IMODEL)
      MODELE=ZK8(IMODEL)
C
      CALL JEVEUO(MODELE//'.NFIS','L',JNFIS)
      NFISS  = ZI(JNFIS)
      CALL JEVEUO(MODELE//'.FISS','L',JMOFIS)
      LEXIP = CFDISL(DEFICO,'EXIS_PENA')
C
C
C COEFFS DE MISE A ECHELLE
C
      DO 1 IFISS=1,NFISS
        NOMFIS = ZK8(JMOFIS-1 + IFISS)
        IZONE  = XXCONI(DEFICO,NOMFIS,'MAIT')
        COECHE = MMINFR(DEFICO,'COEF_ECHELLE',IZONE)
        COPENC = MMINFR(DEFICO,'COEF_PENA_CONT',IZONE)
        COPENF = MMINFR(DEFICO,'COEF_PENA_FROT',IZONE)
        IF(IFISS.GT.1) THEN
          CALL ASSERT(COECH2.EQ.COECHE)
          CALL ASSERT(COPEC2.EQ.COPENC)
          CALL ASSERT(COPEF2.EQ.COPENF)
        ENDIF
        COECH2 = COECHE
        COPEC2 = COPENC
        COPEF2 = COPENF
1     CONTINUE

      IF(CMP(1:6).EQ.'LAGS_C') THEN
        IF(.NOT.LEXIP) THEN
          COEFME = COECHE
        ELSE
          COEFME = COPENC
        ENDIF
      ELSE IF(CMP(1:6).EQ.'LAGS_F') THEN
        IF(.NOT.LEXIP) THEN
          COEFME = 1.D0
        ELSE
          COEFME = COPENF
        ENDIF
      ENDIF
      COEF = COEFIN/COEFME

99    CONTINUE
      CALL JEDEMA()
C
      END
