      SUBROUTINE XMULCO(CONTAC,DDLC,DDLM,IAINT,IFISS,
     &                  JHEANO,VSTNC,LACT,LCALEL,LELIM,NDIM,NFE,
     &                  NFH,NFISS,NINTER,NLACT,NNO,
     &                  NNOL,NNOM,NNOS,PLA,TYPMA)
      IMPLICIT   NONE
      INCLUDE 'jeveux.h'
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 19/12/2012   AUTEUR PELLET J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C TOLE CRP_21
C IN TYPMA : TYPE DE MAILLE
C IN NINTER : NOMBRE DE POINTS D'INTERSECTION
C IN IAINT : ADRESSE TOPOFAC.AI POUR LA FISSURE COURANTE
C OUT LACT : LISTE LAMBDA ACTIFS
C OUT NLACT : NOMBRE LAMBDA ACTIFS
C IN NFISS : NOMBRE DE FISSURES VUES PAR L ELEMENT
C IN JSTNC : ADRESSE TABLEAU FISSURE ACTIVE OU NON
C IN NFH  : NOMBRE ENRICHISSEMENTS HEAVISIDE POUR L ELEMENT
C IN IFISS : INDICE DE LA FISSURE
C IN JHEANO : HEAVISIDE ACTIF AU NOEUD?
C IN CONTAC : P1P1 OU P2P1
C OUT NNOL : NOMBRE DE NOEUDS PORTEURS DE LAGRANGES
C IN NNO : NOMBRE TOT DE NOEUDS
C IN NNOS : NOMBRE NOEUDS SOMMETS
C IN NDIM : DIMENSION
C IN NFE : NOMBRE DE NOEUDS ENRICHIS CRACK TIP
C IN DDLC : NOMBRE DE DDLS DE CONTACT PAR NOEUD
C IN DDLM :
C IN NNOM : NOMBRE DE NOEUDS MILIEUX
C IN LCALEL : SI TE DE CALCUL ELEMENTAIRE
C OUT PLA : PLACES DE LAGRANGES DE CONTACT DANS LA MATRICE
C OUT LELIM : YA-T-IL DES LAGRANGES DE CONTACT
C
C --- LISTE DES LAMBDAS ACTIFS
C
      INTEGER CONTAC,DDLC,DDLM,IAINT,IFISS,JHEANO,VSTNC(*)
      INTEGER LACT(8),NDIM,NFE,NFH,NFISS,NINTER,NLACT
      INTEGER NNO,NNOL,NNOM,NNOS,PLA(27)
      INTEGER PLI,I
      LOGICAL LELIM,LCALEL
      CHARACTER*8 TYPMA
C ----------------------------------------------------------------------

      CALL XLACTI(TYPMA,NINTER,IAINT,LACT,NLACT)
      IF(LCALEL) THEN
         IF (NLACT.LT.NNOS) LELIM = .TRUE.
         IF (NFISS.EQ.1) THEN
            DO 50 I=1,NNOS
               IF (LACT(I).EQ.0) VSTNC(I)=0
50          CONTINUE
         ELSE
            DO 60 I=1,NNOS
               IF (LACT(I).EQ.0) VSTNC((I-1)*NFH+
     &                     ZI(JHEANO-1+(I-1)*NFISS+IFISS))=0
60          CONTINUE
         ENDIF
      ENDIF
C --- NOMBRE DE LAMBDAS ET LEUR PLACE DANS LA MATRICE
      IF (CONTAC.EQ.1) NNOL=NNO
      IF (CONTAC.EQ.3) NNOL=NNOS
      DO 15 I=1,NNOL
         CALL XPLMAT(NDIM,NFH,NFE,DDLC,DDLM,NNO,NNOM,I,PLI)
         IF (NFISS.EQ.1) THEN
            PLA(I) = PLI
         ELSE
            PLA(I) = PLI+NDIM*(ZI(JHEANO-1+(I-1)*NFISS+IFISS)-1)
         ENDIF
15    CONTINUE
      END
