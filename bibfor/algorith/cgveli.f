      SUBROUTINE CGVELI(TYPFIS,CAS,OPTION,LNOFF,LISS,NDEG)
      IMPLICIT NONE

      INTEGER      LNOFF,NDEG
      CHARACTER*8  TYPFIS
      CHARACTER*16 OPTION,CAS
      CHARACTER*24 LISS
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 17/12/2012   AUTEUR DELMAS J.DELMAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE GENIAUT S.GENIAUT
C
C     SOUS-ROUTINE DE L'OPERATEUR CALC_G
C
C     BUT : VERIFICATION DES DONNEES RELATIVES AU LISSAGE
C
C  IN :
C     TYPFIS : TYPE DE LA SD DECRIVANT LE FOND DE FISSURE
C             ('THETA' OU 'FONDIFSS' OU 'FISSURE')
C     CAS    : '2D', '3D LOCAL' OU '3D GLOBAL'
C     LNOFF  : NOMBRE DE NOEUDS (OU POINTS) DU FOND DE FISSURE
C  OUT :
C     LISS   : TYPE DE LISSAGE (NOM CONTRACTE)
C     NDEG   : DEBRE DES POLYNOMES DE LEGENDRE
C              (-1 DANS LES CAS OU DEGRE N'A PAS DE SENS)
C ======================================================================
C
      INTEGER      IER,IARG
      CHARACTER*24 LISSG,LISSTH

C     ----------------------------------------------------------
C     LISSAGE_G         LISSAGE_THETA         NOUVEAU NOM
C     ----------------------------------------------------------
C     LEGENDRE        +  LEGENDRE         ->   LEGENDRE
C     LEGENDRE        +  LAGRANGE         ->   MIXTE
C     LAGRANGE        +  LAGRANGE         ->   LAGRANGE
C     LAGRANGE_NO_NO  +  LAGRANGE         ->   LAGRANGE_NO_NO
C     LAGRANGE_REGU   +  LAGRANGE_REGU    ->   LAGRANGE_REGU
C     ----------------------------------------------------------
C     TOUTES LES AUTRES COMBINAISONS SONT INTERDITES
C     ----------------------------------------------------------

C     INITIALISATIONS
      LISS=' '
      NDEG=-1

      IF (CAS.NE.'3D_LOCAL') THEN

C       L'UTILISATEUR NE DOIT PAS AVOIR RENSEIGNE LISSAGE_G
        CALL GETVTX('LISSAGE','LISSAGE_G',1,IARG,1,LISSG,IER)
        IF (IARG.EQ.0) CALL U2MESS('A','RUPTURE0_67')

C       L'UTILISATEUR NE DOIT PAS AVOIR RENSEIGNE LISSAGE_THETA
        CALL GETVTX('LISSAGE','LISSAGE_THETA',1,IARG,1,LISSTH,IER)
        IF (IARG.EQ.0) CALL U2MESS('A','RUPTURE0_67')

      ELSEIF (CAS.EQ.'3D_LOCAL') THEN

        CALL GETVTX('LISSAGE','LISSAGE_G',1,IARG,1,LISSG,IER)
        CALL GETVTX('LISSAGE','LISSAGE_THETA',1,IARG,1,LISSTH,IER)

        IF (LISSG.EQ.'LEGENDRE'.AND.LISSTH.EQ.'LEGENDRE') THEN
          LISS='LEGENDRE'
        ELSEIF (LISSG.EQ.'LEGENDRE'.AND.LISSTH.EQ.'LAGRANGE') THEN
          LISS='MIXTE'
        ELSEIF (LISSG.EQ.'LAGRANGE'.AND.LISSTH.EQ.'LAGRANGE') THEN
          LISS='LAGRANGE'
        ELSEIF (LISSG.EQ.'LAGRANGE_NO_NO'.AND.LISSTH.EQ.'LAGRANGE') THEN
          LISS='LAGRANGE_NO_NO'
        ELSEIF (LISSG .EQ.'LAGRANGE_REGU'.AND.
     &          LISSTH.EQ.'LAGRANGE_REGU') THEN
          LISS='LAGRANGE_REGU'
        ELSE
          CALL U2MESS('F','RUPTURE0_86')
        ENDIF

C       COMPATIBILITE ENTRE LISSAGE ET TYPFIS
        IF (TYPFIS.EQ.'FISSURE'.AND.LISS.EQ.'MIXTE') THEN
          CALL U2MESS('F','RUPTURE0_76')
        ENDIF

C       COMPATIBILITE ENTRE LISSAGE ET OPTION
        IF (LISS.EQ.'MIXTE') THEN
          IF (OPTION.EQ.'G_MAX'.OR.OPTION.EQ.'G_BILI') THEN
            CALL U2MESK('F','RUPTURE0_83',1,OPTION)
          ENDIF
        ENDIF

C       RECUPERATION DU DEGRE DES POLYNOMES DE LEGENDRE
        CALL GETVIS('LISSAGE','DEGRE',1,IARG,1,NDEG,IER)

C       COMPATIBILITE DES DIMENSIONS DES ESPACES EN LISSAGE MIXTE
        IF (LISS.EQ.'MIXTE') THEN
          IF (NDEG.GE.LNOFF) THEN
            CALL U2MESI('F','RUPTURE0_84',1,LNOFF)
          ENDIF
        ENDIF

      ENDIF


      END
