      SUBROUTINE TTPRSM(NDIM,C,DEPLE,DEPLM,COEFFA,INADH,
     &                    RESE,TAU1,TAU2)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 08/03/2004   AUTEUR REZETTE C.REZETTE 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================

      IMPLICIT NONE
      INTEGER INADH,I,J,K,NDIM
      REAL*8  COEFFA,NRESE
      REAL*8  C(3,3),GEOMI(3),RESE(3),DEPLE(6)
      REAL*8  DEPLM(6),TAU1(3),TAU2(3),BIDON(3)


C   SUBROUTINE APPELEE PAR TE0546
C......................................................................


C   CALCUL DE P_B(0,1)(LAMDBA+ RHO C [[DELTA X]])


C        ENTREE    NDIM   : DIMENSION DE L'ESPACE
C                  C      : MATRICE POUR RETOUVER LA PARTIE TANGENTIELLE
C                  DEPLM : LE CHAMP DE DEPLACEMENT DU PT MAITRE
C                  DEPLE : LE CHAMP DE DEPLACEMENT DU PT ESCLAVE
C                  COEFFA : COEFFICIENT DE REGULARISATION DE FROTTEMENT

C        OUT       INDDAH : INCICE D'ADHERENCE 1 ADHERENT 0 GLISSANT
C                  RESE   : X SI ADHERENT X/||X|| SINON

C......................................................................
C

C CALCUL DE LA "VITESSE"[[DELTA X]]

      DO 10 I = 1,NDIM
        GEOMI(I) = DEPLE(I) - DEPLM(I)
        RESE(I) = 0.D00
        BIDON(I)= 0.D00
   10 CONTINUE
      DO 20  I = 1,3
        RESE(I) = 0.D00
 20   CONTINUE

        DO 21 I=1,NDIM
            DO 22  K=1,NDIM
               BIDON(I)=C(I,K)*GEOMI(K)+BIDON(I)
22       CONTINUE
21      CONTINUE

        IF (NDIM.EQ.2) THEN
         DO 30 I = 1,NDIM
          RESE(I) = DEPLE(NDIM+1+1)*TAU1(I)+COEFFA* BIDON(I)
   30    CONTINUE

      ELSE IF (NDIM.EQ.3) THEN
       DO 31 I = 1,NDIM
          RESE(I) = DEPLE(NDIM+1+1)*TAU1(I)+DEPLE(NDIM+3)*TAU2(I)
     &              +COEFFA*BIDON(I)
   31  CONTINUE

      ELSE
         CALL  UTMESS('F','TTPROJ','STOP1')
      END IF
       NRESE=0.D0

      DO 40 I = 1,3
        NRESE = RESE(I)*RESE(I) + NRESE
 40   CONTINUE
      NRESE =SQRT(NRESE)

C  ON TESTE SI    NRESE < 1 OU NON
C           SIOUI ADHERENCE

      IF (NRESE.LE.1.D00) THEN
        INADH = 1
        GO TO 50
      ELSE IF (NRESE.GT.1.D00) THEN
        INADH = 0
      ELSE
        CALL JXABOR()
      END IF

   50 CONTINUE

      END
