      SUBROUTINE CGLECT(RESU,MODELE,NDIM,OPTION,CAS,TYPFIS,NOMFIS,
     &                  FONOEU,CHFOND,BASFON,LNOFF,LISS,NDEG)
      IMPLICIT NONE

      INTEGER      NDIM,LNOFF,NDEG
      CHARACTER*8  RESU,MODELE,TYPFIS,NOMFIS
      CHARACTER*16 OPTION,CAS
      CHARACTER*24 FONOEU,CHFOND,BASFON,LISS

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 17/12/2012   AUTEUR DELMAS J.DELMAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE GENIAUT S.GENIAUT
C
C     SOUS-ROUTINE DE L'OPERATEUR CALC_G
C
C     BUT : LECTURE ET VERIFICATION DES OPERANDES
C
C  IN :
C  OUT :
C     RESU   : MOT-CLE RESULTAT
C     MODELE : MODELE ASSOCIE A RESU
C     NDIM   : DIMENSION DU MODELE
C     OPTION : MOT-CLE OPTION
C     CAS    : '2D', '3D_LOCAL' OU '3D_GLOBAL'
C     TYPFIS : TYPE D'OBJET POUR DECRIRE LE FOND DE FISSURE
C              'FONDFISS' OU 'FISSURE' OU 'THETA'
C     NOMFIS : NOM DE L'OBJET POUR DECRIRE LE FOND DE FISSURE
C     FONOEU : NOMS DES NOEUDS DU FOND DE FISSURE
C     CHFOND : COORDONNES DES POINTS/NOEUDS DU FOND DE FISSURE
C     BASFON : BASE LOCALE AU FOND DE FISSURE
C     LNOFF  : NOMBRE DE NOEUDS (OU POINTS) DU FOND DE FISSURE
C     LISS   : TYPE DE LISSAGE (NOM UNIQUE CONTRACTE)
C ======================================================================
C
      INTEGER      IBID,IARG,IER,NEXCI
      CHARACTER*8  K8B

      CALL JEMARQ()

C     RECUPERATION DE LA SD RESULTAT : RESU
      CALL GETVID(' ','RESULTAT',0,IARG,1,RESU,IER)

C     LECTURE DES CHARGES ET VERIFICATION DE LA COMPATIBILITE AVEC RESU
      CALL GETFAC('EXCIT',NEXCI)
      CALL CGVERC(RESU,NEXCI)

C     RECUPERATION DU MODELE PUIS DE LA DIMENSION DU MODELE
      CALL DISMOI('F','MODELE',RESU,'RESULTAT',IBID,MODELE,IER)
      CALL DISMOI('F','DIM_GEOM',MODELE,'MODELE',NDIM,K8B,IER)

C     RECUPERATION DE L'OPTION
      CALL GETVTX(' ','OPTION',0,IARG,1,OPTION,IER)

C     VERIFICATION DE LA COMPATIBILITE ENTRE NDIM ET OPTION
      CALL CGVEDO(NDIM,OPTION)

C     DETERMINATION DU CAS : 2D, 3D LOCAL OU 3D GLOBAL
      CALL CGVECA(NDIM,OPTION,CAS)

C     DETERMINATION DU TYPFIS = 'FONDFISS' OU 'FISSURE' OU 'THETA'
C     ET RECUPERATION DE LA SD POUR DECRIRE LE FOND DE FISSURE : NOMFIS
      CALL CGTYFI(TYPFIS,NOMFIS)

C     VERIFICATION DE LA COMPATIBILITE ENTRE LA SD ASSOCIEE AU FOND
C     DE FISSURE ET LE MODELE
      CALL CGVEMF(MODELE,TYPFIS,NOMFIS)

C     VERIFICATION DE LA COMPATIBILITE ENTRE OPTION ET TYPE DE FISSURE
      CALL CGVEFO(OPTION,TYPFIS,NOMFIS)

C     VERIFICATION DES DONNEES RELATIVES AU(X) CHAMP(S) THETA
      CALL CGVETH(TYPFIS,CAS)

C     LECTURE DE LA DESCRIPTION DU FOND DE FISSURE
C     ET RECUPERATION DES OBJETS FONOEU, CHFOND, BASFON + LNOFF
      CALL CGLEFF(TYPFIS,NOMFIS,FONOEU,CHFOND,BASFON,LNOFF)

C     VERIFICATION DES DONNEES RELATIVES AU LISSAGE
C     ET DETERMINATION DU LISSAGE (NOM UNIQUE CONTRACTE) : LISS ET NDEG
      CALL CGVELI(TYPFIS,CAS,OPTION,LNOFF,LISS,NDEG)

      CALL JEDEMA()

      END
