      SUBROUTINE CARANO(IZONE ,DEFICO,RESOCO,NEWGEO,NDIM  ,
     &                  POSESC,COORDP,ENORM ,NBDDLE)
C     
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 13/03/2007   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2004  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT     NONE
      INTEGER      IZONE
      CHARACTER*24 DEFICO
      CHARACTER*24 RESOCO
      CHARACTER*24 NEWGEO
      INTEGER      NDIM
      INTEGER      POSESC
      REAL*8       COORDP(3)
      REAL*8       ENORM(3)
      INTEGER      NBDDLE
C      
C ----------------------------------------------------------------------
C
C ROUTINE CONTACT (METHODES DISCRETES - APPARIEMENT )
C
C CARACTERISTIQUES DU NOEUD ESCLAVE
C
C ----------------------------------------------------------------------
C
C
C IN  IZONE  : NUMERO DE LA ZONE DE CONTACT
C IN  DEFICO : SD DE CONTACT (DEFINITION)
C IN  RESOCO : SD DE CONTACT (RESULTAT)
C IN  NEWGEO : COORDONNEES REACTUALISEES DES NOEUDS DU MAILLAGE
C IN  NDIM   : DIMENSION DE L'ESPACE (2 OU 3)
C IN  POSESC : INDICE DU NOEUD ESCLAVE DANS CONTNO
C OUT COORDP : COORDONNEES DU NOEUD ESCLAVE
C OUT ENORM  : VECTEUR NORMAL AU NOEUD ESCLAVE
C OUT NBDDLE : NOMBRE DE DDLs SUR LE NOEUD ESCLAVE
C
C -------------- DEBUT DECLARATIONS NORMALISEES JEVEUX -----------------
C
      INTEGER            ZI
      COMMON  / IVARJE / ZI(1)
      REAL*8             ZR
      COMMON  / RVARJE / ZR(1)
      COMPLEX*16         ZC
      COMMON  / CVARJE / ZC(1)
      LOGICAL            ZL
      COMMON  / LVARJE / ZL(1)
      CHARACTER*8        ZK8
      CHARACTER*16                ZK16
      CHARACTER*24                          ZK24
      CHARACTER*32                                    ZK32
      CHARACTER*80                                              ZK80
      COMMON  / KVARJE / ZK8(1) , ZK16(1) , ZK24(1) , ZK32(1) , ZK80(1)
C
C ---------------- FIN DECLARATIONS NORMALISEES JEVEUX -----------------
C
      CHARACTER*24 CONTNO,PDDL,NORINI
      INTEGER      JNOCO,JPDDL,JNRINI,JCOOR
      INTEGER      K,NUMNO
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ ()
C
      CONTNO = DEFICO(1:16)//'.NOEUCO'
      PDDL   = DEFICO(1:16)//'.PDDLCO'
      NORINI = RESOCO(1:14)//'.NORINI'      
C
      CALL JEVEUO(NEWGEO(1:19)//'.VALE','L',JCOOR)
      CALL JEVEUO(PDDL,  'L',JPDDL)
      CALL JEVEUO(CONTNO,'L',JNOCO)
      CALL JEVEUO(NORINI,'L',JNRINI)
C
C --- NOMBRE DE DDLS DU NOEUD ESCLAVE
C
      NUMNO  = ZI(JNOCO+POSESC-1)
      NBDDLE = ZI(JPDDL+POSESC) - ZI(JPDDL+POSESC-1)
      IF (NBDDLE.GT.3) THEN
        CALL U2MESS('F','CONTACT_76')
      END IF
C
C --- VECTEUR NORMAL AU NOEUD ESCLAVE (CALCULE DANS RECHCO/CFNORM)
C
      DO 3 K = 1,3
        ENORM(K) = ZR(JNRINI+3*(POSESC-1)+K-1)
3     CONTINUE
C
C --- COORDONNEES DU NOEUD ESCLAVE
C
      COORDP(1) = ZR(JCOOR+3*(NUMNO-1))
      COORDP(2) = ZR(JCOOR+3*(NUMNO-1)+1)
      COORDP(3) = ZR(JCOOR+3*(NUMNO-1)+2)
C
      CALL JEDEMA()
      END
