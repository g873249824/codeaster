      SUBROUTINE MMIMP4(IFM,NOMA,NUMA,IPC,NTPC,JTABF,
     &                  XAINI,XSINI,
     &                  LVITES,LGLISS,LCOMPL,JEU,JEUVIT,LAMBDC)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 18/09/2006   AUTEUR MABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2006  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
      IMPLICIT     NONE
      INTEGER      IFM
      INTEGER      NUMA                   
      CHARACTER*8  NOMA
      INTEGER      IPC
      INTEGER      NTPC
      INTEGER      JTABF
      INTEGER      XAINI
      INTEGER      XSINI
      LOGICAL      LVITES
      LOGICAL      LGLISS
      LOGICAL      LCOMPL
      REAL*8       JEU
      REAL*8       JEUVIT
      REAL*8       LAMBDC
C
C ----------------------------------------------------------------------
C ROUTINE APPELEE PAR : MMMBCA
C ----------------------------------------------------------------------
C
C AFFICHAGE DE LA CARTE DES ELEMENTS DE CONTACT 
C (METHODE CONTACT CONTINU)
C
C IN  IFM    : UNITE D'IMPRESSION DU MESSAGE
C IN  NOMA   : NOM DU MAILLAGE
C IN  NUMA   : NUMERO ABSOLU DE LA MAILLE ESCLAVE
C IN  IPC    : NUMERO DU POINT DE CONTACT SUR LA MAILLE ESCLAVE
C IN  NTPC   : NOMBRE TOTAL DE POINTS DE CONTACT SUR LA MAILLE ESCLAVE
C IN  JTABF  : POINTEUR VERS DEFICO(1:16)//'.CARACF'
C IN  XSINI  : INDICATEUR DE CONTACT SUR LE POINT A L'ETAT INITIAL
C IN  XAINI  : INDICATEUR DE COMPLIANCE SUR LE POINT A L'ETAT INITIAL
C IN  LVITES : SI FORMULATION EN VITESSE
C IN  LGLISS : SI CONTACT GLISSIERE
C IN  LCOMPL : SI FORMULATION EN COMPLIANCE
C IN  JEU    : JEU 
C IN  JEUVIT : GAP VITESSE
C IN  LAMBDC : LAGRANGE DE CONTACT (PRESSION DE CONTACT)
C
C -------------- DEBUT DECLARATIONS NORMALISEES JEVEUX -----------------
C
      CHARACTER*32 JEXNUM
      INTEGER ZI
      COMMON /IVARJE/ZI(1)
      REAL*8 ZR
      COMMON /RVARJE/ZR(1)
      COMPLEX*16 ZC
      COMMON /CVARJE/ZC(1)
      LOGICAL ZL
      COMMON /LVARJE/ZL(1)
      CHARACTER*8 ZK8
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*32 ZK32
      CHARACTER*80 ZK80
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C
C ---------------- FIN DECLARATIONS NORMALISEES JEVEUX -----------------
C
      INTEGER      CFMMVD,ZTABF  
      CHARACTER*8  NOMESC     
      CHARACTER*16 STATUT
      INTEGER      XS,XA   
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
      ZTABF = CFMMVD('ZTABF')          
C      
C
C --- REPERAGE MAILLE ESCLAVE
C
      CALL JENUNO(JEXNUM(NOMA//'.NOMMAI',NUMA),NOMESC)
      WRITE(IFM,1000) NOMESC 
      WRITE(IFM,2000) IPC                
 1000 FORMAT (' <CONTACT>     * LA MAILLE ESCLAVE ',A8) 
 2000 FORMAT (' <CONTACT>     ** DONT LE POINT DE CONTACT ',I3) 
C
C --- PROPRIETES
C
      IF (LVITES) THEN
        WRITE(IFM,1001)
      ELSE
        WRITE(IFM,1002)      
      ENDIF
 1001 FORMAT (' <CONTACT>        (FORMULATION VITESSE)') 
 1002 FORMAT (' <CONTACT>        (FORMULATION DEPLACEMENT)') 
      IF (LGLISS) THEN
        WRITE(IFM,3001)    
      ENDIF
 3001 FORMAT (' <CONTACT>        (GLISSIERE)')       
      IF (LCOMPL) THEN
        WRITE(IFM,4001)
      ELSE
        WRITE(IFM,4002)      
      ENDIF
 4001 FORMAT (' <CONTACT>        (AVEC COMPLIANCE)') 
 4002 FORMAT (' <CONTACT>        (SANS COMPLIANCE)')             
C
C --- ETAT DE CONTACT INITIAL
C                 
      IF (XSINI.EQ.0) THEN
        STATUT = ' PAS EN CONTACT '
      ELSE
        STATUT = ' EN CONTACT     '
      ENDIF
      WRITE(IFM,5000) STATUT 
           
      IF (LCOMPL) THEN
        IF (XAINI.EQ.0) THEN
          STATUT = ' HORS ASPERITES '
        ELSE
          STATUT = ' DANS ASPERITES '
        ENDIF
        WRITE(IFM,5001) STATUT        
      ENDIF
 5000 FORMAT (' <CONTACT>         -> ETAT DE CONTACT    INITIAL:',A16) 
 5001 FORMAT (' <CONTACT>         -> ETAT DE COMPLIANCE INITIAL:',A16)
C
C --- PROPRIETES
C
      IF (LVITES) THEN
        WRITE(IFM,6001) JEU,JEUVIT,LAMBDC
      ELSE
        WRITE(IFM,6000) JEU,LAMBDC
      ENDIF
 6000 FORMAT (' <CONTACT>         <> JEU:',E10.3,
     &        ' - LAGR_C :',E10.3) 
 6001 FORMAT (' <CONTACT>         <> JEU:',E10.3,
     &        ' - SAUT VITESSE:',E10.3,
     &        ' - LAGR_C :',E10.3)       
C
C --- ETAT DE CONTACT FINAL
C
      XS     = NINT(ZR(JTABF+ZTABF*NTPC+ZTABF*(IPC-1)+13))
      XA     = NINT(ZR(JTABF+ZTABF*NTPC+ZTABF*(IPC-1)+21))
      IF (XS.EQ.0) THEN
        STATUT = ' PAS EN CONTACT '
      ELSE
        STATUT = ' EN CONTACT     '
      ENDIF
      WRITE(IFM,7000) STATUT 
           
      IF (LCOMPL) THEN
        IF (XA.EQ.0) THEN
          STATUT = ' HORS ASPERITES '
        ELSE
          STATUT = ' DANS ASPERITES '
        ENDIF
        WRITE(IFM,7001) STATUT        
      ENDIF      
 7000 FORMAT (' <CONTACT>         -> ETAT DE CONTACT    FINAL  :',A16) 
 7001 FORMAT (' <CONTACT>         -> ETAT DE COMPLIANCE FINAL  :',A16)
C
C --- FORMATS AFFICHAGE
C
 999  continue
      CALL JEDEMA()
C
      END
