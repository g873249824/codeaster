      SUBROUTINE DISEXC(NINDEX,ILFEX1,ILLEX,NPDSC3,IADSC3)
      IMPLICIT REAL*8 (A-H,O-Z)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 02/09/97   AUTEUR T8BHHAD A.DUMOND 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C***********************************************************************
C    C. DUVAL
C-----------------------------------------------------------------------
C  BUT: CALCULER LES INTERSPECTRES EXCITATION DANS LA DISCRETISATION
C       FREQUENTIELLE DE LA REPONSE
C        (CALCUL DYNAMIQUE ALEATOIRE)
C
C-----------------------------------------------------------------------
C
C NINDEX   /IN /: NOMBRE  D INDICES RECUPERES
C ILFEX1   /IN /: ADRESSE DANS ZI DE LA LISTE DES ADR DES .VALE
C ILLEX    /IN /: ADR DANS ZI DE LA LISTE DES LONGUEURS DES .VALE
C NPDSC3   /IN/: NOMBRE DE VALEURS DE FREQUENCE
C IADSC3   /IN/: POINTEUR DANS ZR DES VALEURS DE FREQUENCES
C ILFEX2   /OUT /: POINTEUR DANS ZI DES DEBUTS DE SEGMENTS ZR DES
C                 VALEURS R,I DES FONCTIONS INTERSPECTRALES  DE 
C                 L EXCITATION RECALCULEES SUR DISCR REPONSE
C
C
C-------- DEBUT COMMUNS NORMALISES  JEVEUX  ----------------------------
C
      INTEGER         ZI
      COMMON  /IVARJE/ZI(1)
      REAL*8          ZR
      COMMON  /RVARJE/ZR(1)
      COMPLEX*16      ZC
      COMMON  /CVARJE/ZC(1)
      LOGICAL         ZL
      COMMON  /LVARJE/ZL(1)
      CHARACTER*8     ZK8
      CHARACTER*16             ZK16
      CHARACTER*24                       ZK24
      CHARACTER*32                                 ZK32
      CHARACTER*80                                           ZK80
      COMMON  /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C
C
C----------  FIN  COMMUNS NORMALISES  JEVEUX  --------------------------
C
      CHARACTER*8 CHLIST(5),KBID
      CHARACTER*24 K24BD1
C
      CALL JEMARQ()
      ITAIL1=(NINDEX*(NINDEX+1))/2
      CALL WKVECT('&&OP0131.LIADRFOE.FRQRE','V V I',ITAIL1,ILFEX2)
      DO 403 I1=1,NINDEX
        DO 404 I2=I1,NINDEX
          WRITE(K24BD1,'(A8,A3,2I4.4,A5)')'&&OP0131','.FO',I1,I2,
     &                       '.VALE'
          IJ1=(I2*(I2-1))/2+I1
          CALL JECREO(K24BD1,'V V R8')
          CALL JEECRA(K24BD1,'LONMAX',NPDSC3*3,KBID)
          CALL JEECRA(K24BD1,'LONUTI',NPDSC3*3,KBID)
          CALL JEVEUT(K24BD1,'E',ZI(ILFEX2-1+IJ1))
 404    CONTINUE
 403  CONTINUE
      CALL WKVECT('&&OP0131.REIM.ARRIVE','V V R8',2*NPDSC3,IREIM2)
      DO 411 I1=1,ITAIL1
        ILONG1=ZI(ILLEX+I1-1)/3
        CALL WKVECT('&&OP0131.REIM.DEPART','V V R8',2*ILONG1,IREIM1)
        DO 428 I2=1,ILONG1
          ZR(IREIM1-1+I2)=ZR(ZI(ILFEX1+I1-1)+ILONG1-1+2*(I2-1)+1)
          ZR(IREIM1+ILONG1-1+I2)=ZR(ZI(ILFEX1+I1-1)+ILONG1-1+
     &          2*(I2-1)+2)
 428    CONTINUE
        CHLIST(1)='FONCTION'
        CHLIST(2)='LIN LIN '
        CHLIST(3)='TOTO'
        CHLIST(4)='TOTO'
        CHLIST(5)='CC      '
        CALL FOINTR(' ',CHLIST(1),ILONG1,ZR(ZI(ILFEX1+I1-1)),
     &    ZR(IREIM1),NPDSC3,ZR(IADSC3),ZR(IREIM2),IBID2)
        CALL FOINTR(' ',CHLIST(1),ILONG1,ZR(ZI(ILFEX1+I1-1)),
     &   ZR(IREIM1+ILONG1),NPDSC3,ZR(IADSC3),ZR(IREIM2+NPDSC3)
     &           ,IBID2)
        DO 429 I2=1,NPDSC3
          ZR(ZI(ILFEX2+I1-1)+NPDSC3-1+2*(I2-1)+1)=ZR(IREIM2-1+I2)
          ZR(ZI(ILFEX2+I1-1)+NPDSC3-1+2*(I2-1)+2)=
     &          ZR(IREIM2+NPDSC3-1+I2)
 429    CONTINUE
        CALL JEDETC('V','&&OP0131.REIM.DEPART',1)
 411  CONTINUE
      CALL JEDETC('V','&&OP0131.REIM.ARRIVE',1)
      CALL JEDEMA()
      END
