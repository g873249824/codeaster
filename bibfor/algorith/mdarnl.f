      SUBROUTINE MDARNL (ISTO1,IPAS,T,DT,NBMODE,
     +                   DEPGEN,VITGEN,ACCGEN,
     +                   ISTO2,NBCHOC,SAUCHO,NBSCHO,
     +                   ISTO3,NBREDE,SAURED,SAREDI,
     +                   ISTO4,NBREVI,SAUREV,SAREVI,
     +                   DEPSTO,VITSTO,ACCSTO,PASSTO,IORSTO,
     +                   TEMSTO,FCHOST,DCHOST,VCHOST,ICHOST,VINT,
     +                   IREDST,DREDST,IREVST,DREVST)
      IMPLICIT NONE
      INTEGER    IORSTO(*),IREDST(*),SAREDI(*),IREVST(*),SAREVI(*)
      INTEGER    ICHOST(*)
      REAL*8     DEPGEN(*),VITGEN(*),ACCGEN(*),DEPSTO(*),VITSTO(*),
     +           SAUCHO(NBCHOC,*),SAURED(*),DREDST(*),SAUREV(*),
     +           DREVST(*),PASSTO(*),ACCSTO(*),TEMSTO(*),FCHOST(*),
     +           DCHOST(*),VCHOST(*)
      REAL*8     VINT(*)
C ----------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 09/11/2012   AUTEUR DELMAS J.DELMAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C TOLE CRP_21
C
C     ARCHIVAGE DES DES CHAMPS GENERALISES OBLIGATOIRES ET OPTIONELS
C     POUR LA SD_DYNA_GENE DANS LE CADRE D'UN CALCUL TRANSITOIRE
C     ------------------------------------------------------------------
C
C-----------------------------------------------------------------------
      INTEGER IC,IND,IPAS,IRD,IRV,ISTO1,ISTO2,IBID,NDEC,NBSCHO
      INTEGER ISTO3,ISTO4,NBCHOC,NBMODE,NBREDE,NBREVI
      CHARACTER*4 TYPCAL,KBID
      REAL*8 DT,T
      COMPLEX*16 CBID
C-----------------------------------------------------------------------
      TYPCAL = 'TRAN'
C
C --- ENREGISTREMENT DES DONNES OBLIGATOIRES

      CALL MDARCH(ISTO1,IPAS,T,DT,NBMODE,TYPCAL,IBID,KBID,
     &            DEPGEN,VITGEN,ACCGEN,DEPSTO,VITSTO,ACCSTO,
     &            CBID,CBID,CBID,CBID,CBID,CBID,
     &            PASSTO,IORSTO,TEMSTO)
C
C
C --- ENREGISTREMENT DES DONNES OPTIONELLES
C
      IF ( NBCHOC.NE.0 ) THEN
         NDEC = NBCHOC*ISTO1
         IND = NBCHOC * ISTO1
         DO 204 IC = 1,NBCHOC
            ISTO2 = ISTO2 + 1
            FCHOST(ISTO2) = SAUCHO(IC,1)
            DCHOST(ISTO2) = SAUCHO(IC,4)
            VCHOST(ISTO2) = SAUCHO(IC,7)
            DCHOST(NBSCHO+ISTO2) = SAUCHO(IC,10)
            ISTO2 = ISTO2 + 1
            FCHOST(ISTO2) = SAUCHO(IC,2)
            DCHOST(ISTO2) = SAUCHO(IC,5)
            VCHOST(ISTO2) = SAUCHO(IC,8)
            DCHOST(NBSCHO+ISTO2) = SAUCHO(IC,11)
            ISTO2 = ISTO2 + 1
            FCHOST(ISTO2) = SAUCHO(IC,3)
            DCHOST(ISTO2) = SAUCHO(IC,6)
            VCHOST(ISTO2) = SAUCHO(IC,9)
            DCHOST(NBSCHO+ISTO2) = SAUCHO(IC,12)
            ICHOST(NDEC+IC) = NINT(SAUCHO(IC,13))
C           --- VARIABLES INTERNES : FLAMBAGE ---
            VINT(IND+IC) = SAUCHO(IC,14)
 204     CONTINUE
      ENDIF
C
C--- CAS DES RELATIONS EFFORT-DEPLACEMENT
C
      IF ( NBREDE.NE.0 ) THEN
         DO 206 IRD = 1,NBREDE
            ISTO3 = ISTO3 + 1
            IREDST(ISTO3) = SAREDI(IRD)
            DREDST(ISTO3) = SAURED(IRD)
 206     CONTINUE
      ENDIF

C
C--- CAS DES RELATIONS EFFORT-VITESSE
C
      IF ( NBREVI.NE.0 ) THEN
         DO 207 IRV = 1,NBREVI
            ISTO4 = ISTO4 + 1
            IREVST(ISTO4) = SAREVI(IRV)
            DREVST(ISTO4) = SAUREV(IRV)
 207     CONTINUE
      ENDIF
C
      END
