      SUBROUTINE CGLECC(TYPFIS,RESU,VECORD,CALSIG)
      IMPLICIT NONE

      INCLUDE 'jeveux.h'

      CHARACTER*8  TYPFIS,RESU,CALSIG
      CHARACTER*19 VECORD

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 17/12/2012   AUTEUR DELMAS J.DELMAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE GENIAUT S.GENIAUT
C
C     SOUS-ROUTINE DE L'OPERATEUR CALC_G
C
C     BUT : LECTURE DE LA CARTE DE COMPORTEMENT UTILISEE DANS LE CALCUL
C
C  IN :
C     TYPFIS : TYPE D'OBJET POUR DECRIRE LE FOND DE FISSURE
C              'FONDFISS' OU 'FISSURE' OU 'THETA'
C     RESU   : MOT-CLE RESULTAT
C     VECORD : VECTEUR DES NUME_ORDRE DU RESU
C  OUT :
C     CALSIG : 'OUI' S'IL FAUT RECALCULER LES CONTRAITNES
C              'NON' S'IL NE FAUT PAS RECALCULER LES CONTRAINTES
C ======================================================================
C
      INTEGER      NCELAS,IARG,IER,I,JVEC,NBORD,IORD,VALI
      CHARACTER*8  K8B
      CHARACTER*24 K24B

      CALL JEMARQ()

C     RECUPERATION DU MOT-CLE CALCUL_CONTRAINTE

C     PAR DEFAUT, ON RECALCULE LES CONTRAINTES
      CALSIG='OUI'

      CALL GETFAC('COMP_ELAS',NCELAS)

      IF (NCELAS.GT.0) THEN
        CALL GETVTX(' ','CALCUL_CONTRAINTE',0,IARG,1,CALSIG,IER)
      ENDIF

C     CALSIG='NON' N'EST PAS COMPATIBLE AVEC X-FEM
      IF (CALSIG.EQ.'NON') THEN
        IF (TYPFIS.EQ.'FISSURE') CALL U2MESS('F','RUPTURE1_39')
      ENDIF

C     LES AUTRES VERIF SONF FAITES DANS LE CAPY (OPTION...)

C     VERIFICATION DE LA PRESENCE DU CHAMP SIEF_ELGA
C     LORSQUE CALCUL_CONTRAINTE='NON', SINON ERREUR 'F'
      IF (CALSIG.EQ.'NON') THEN

        CALL JEVEUO(VECORD,'L',JVEC)
        CALL JELIRA(VECORD,'LONMAX',NBORD,K8B)

        DO 10  I = 1 , NBORD
          IORD = ZI(JVEC-1+I)
          CALL RSEXCH(' ',RESU,'SIEF_ELGA',IORD,K24B,IER)
          IF (IER.NE.0) THEN
C           PROBLEME DANS LA RECUP DE SIEF_ELGA POUR CE NUME_ORDRE
            VALI=IORD
            CALL U2MESI('F','RUPTURE0_93',1,VALI)
          ENDIF
 10     CONTINUE
      ENDIF

      CALL JEDEMA()

      END
