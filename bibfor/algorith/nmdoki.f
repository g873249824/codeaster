      SUBROUTINE NMDOKI(MOCLEF,MODELE,COMP,K,DIMAKI,
     &               NBKIT,NOMKIT,NBNVI,NCOMEL,LCOMEL,NUMLC,NBVARI)
C RESPONSABLE PROIX J-M.PROIX
      IMPLICIT NONE
      INTEGER DIMAKI,NBKIT,NCOMEL,K,NBNVI(*),NUMLC
      CHARACTER*(*) MODELE
      CHARACTER*16  COMP
      CHARACTER*16 LCOMEL(*),NOMKIT(DIMAKI),MOCLEF
C ----------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 05/11/2012   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C    SAISIE ET VERIFICATION DE LA RELATION DE COMPORTEMENT KIT UTILISEE
C
C IN      MODELE  : NOM DU MODELE
C IN      COMP    : NOM DU COMPORTEMENT (ICI KIT_*)
C IN      K       : NUMERO D'OCCURRENCE DE COMP_INCR
C IN      DIMAKI  : DIM MAX DE NOMKIT
C OUT     NBKIT   : NOMBRE DE RELATIONS KIT
C OUT     NOMKIT  : NOM DES RELATIONS KIT
C OUT     NBNVI   : NOMBRE DE VARIABLES INTERNES DES RELATIONS KIT
C IN/OUT  NCOMEL  : NOMBRE TOTAL DE COMPORTEMENTS ELEMENTAIRES
C IN/OUT  LCOMEL  : NOMS DES COMPORTEMENTS ELEMENTAIRES
C OUT     NUMLC   : NUMERO DE LC POUR LA METALLURGIE
C OUT     NBVARI  : NOMBRE DE VARI POUR LA METALLURGIE
C ----------------------------------------------------------------------
      INTEGER II,N1,NUMLC2,NBVARI,NBVARM
      CHARACTER*16 COMCOD
      INTEGER      IARG
      
      NBKIT=0
      IF ((COMP(1:4).EQ.'KIT_') .OR. (COMP(1:4).EQ.'META')) THEN
         DO 101 II = 1,DIMAKI
            NOMKIT(II)=' '
  101    CONTINUE
C        KIT META
         IF (COMP(1:4).EQ.'META') THEN
           CALL GETVTX(MOCLEF,'RELATION_KIT',K,IARG,1,NOMKIT(1),N1)
           CALL LCCREE(1, LCOMEL(1),   COMCOD)
           CALL LCINFO(COMCOD, NUMLC,  NBVARI)
C          NOMBRE DE VARIABLES INTERNES POUR LES PHASES METALLURGIQUES
           CALL LCCREE(1, NOMKIT(1),   COMCOD)
           CALL LCINFO(COMCOD, NUMLC2, NBVARM)
C          FAIRE UN TRAITEMENT SPECIFIQUE META CAR 
           NBVARI = NBVARI*NBVARM + NBVARI + 1
         ELSEIF (COMP.EQ.'KIT_DDI')  THEN
           NBKIT=2
           CALL GETVTX(MOCLEF,'RELATION_KIT',K,IARG,2,NOMKIT(1),N1)
           DO 102 II=1,NBKIT
              NCOMEL=NCOMEL+1
              LCOMEL(NCOMEL)=NOMKIT(II)                
  102      CONTINUE
         ELSEIF ((COMP(1:5).EQ.'KIT_H')
     &       .OR.(COMP(1:6).EQ.'KIT_TH')) THEN
           CALL GETVTX(MOCLEF,'RELATION_KIT',K,IARG,0,NOMKIT(1),N1)
           NBKIT = -N1
           CALL GETVTX(MOCLEF,'RELATION_KIT',K,IARG,
     &                 NBKIT,NOMKIT(1),N1)
           CALL NMTHMC(COMP,MODELE,MOCLEF,K,NOMKIT,NBKIT,NBNVI)
           DO 103 II=1,4
              NCOMEL=NCOMEL+1
              CALL ASSERT(NCOMEL.LE.10)
              IF (NOMKIT(II).EQ.' ') THEN
                 LCOMEL(NCOMEL)='VIDE'
              ELSE
                 LCOMEL(NCOMEL)=NOMKIT(II)
              ENDIF            
  103      CONTINUE
         ENDIF
      ENDIF
      END
