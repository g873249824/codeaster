      SUBROUTINE LIARED (NOMRES,FMLI,ICAR,FPLIO,II,SST,INTF,FACT)
      IMPLICIT NONE
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 30/08/2004   AUTEUR NICOLAS O.NICOLAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2004  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C***********************************************************************
C  O. NICOLAS     DATE 01/08/04
C-----------------------------------------------------------------------
C  BUT : < CALCUL DES LIAISONS CAS REDUIT>
C
C  CALCULER LES NOUVELLES MATRICES DE LIAISON SANS TENIR COMPTE DE
C  L'ORIENTATION DES SOUS-STRUCTURES
C  ON DETERMINE LES MATRICES DE LIAISON, LES DIMENSIONS DE CES MATRICES
C  ET LE PRONO ASSOCIE
C
C-----------------------------------------------------------------------
C
C NOMRES /I/ : NOM UTILISATEUR DU RESULTAT MODELE_GENE
C II     /I/ : NUMERO INTERFACE COURANTE
C FMLI   /I/ : FAMILLE DES MATRICES DE LIAISON
C ICAR   /I/ : CARACTERISTIQUE DE LA LIAISON
C FPLIO  /I/ : FAMILLE DES PROFNO DES MATRICES DE LIAISON ORIENTEES
C SST    /I/ : NOM DE LA SOUS-STRUCTURE MISE EN JEU PAR LA LIAISON
C INTF   /I/ : NOM DE L'INTERFACE MISE EN JEU PAR LA LIAISON
C
C-------- DEBUT COMMUNS NORMALISES  JEVEUX  ----------------------------
C
      INTEGER          ZI
      COMMON  /IVARJE/ ZI(1)
      REAL*8           ZR
      COMMON  /RVARJE/ ZR(1)
      COMPLEX*16       ZC
      COMMON  /CVARJE/ ZC(1)
      LOGICAL          ZL
      COMMON  /LVARJE/ ZL(1)
      CHARACTER*8      ZK8
      CHARACTER*16              ZK16
      CHARACTER*24                        ZK24
      CHARACTER*32                                  ZK32
      CHARACTER*80                                            ZK80
      COMMON  /KVARJE/ ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C
      CHARACTER*32  JEXNOM,JEXNUM
C
C----------  FIN  COMMUNS NORMALISES  JEVEUX  --------------------------
C
C   PARAMETER REPRESENTANT LE NOMBRE MAX DE COMPOSANTES DE LA GRANDEUR
C   SOUS-JACENTE TRAITEE
C
      INTEGER      IERD,IBID,LLROT,NTAIL,
     &             IADN,IADO,I,J,K,L,NBLIGO,ICOMPO,LDMAT,II,LLPLIN,
     &             NBNOE,LLPLIO,LDLID,NBLIGN,NBCOLN,LLMAT,NBCOLO,
     &             ICOMPN,IBLO,ICAR(3)
      CHARACTER*1  K1BID
      CHARACTER*8  NOMRES,SST,INTF,NOMMCL,BASMOD,NOMG,KBID
      CHARACTER*24 FMLI,FPLIN,FPLIO,FAMLI
      REAL*8       ROT(3),FACT
C
C-----------------------------------------------------------------------
C
      CALL JEMARQ()
C
C-----RECUPERATION DU NOMBRE DU NOMBRE D'ENTIERS CODES ASSOCIE A DEPL_R
C
C
C --- RECUPERATION DES NOMS DU MACR-ELEMENT ET DE LA BASE MODALE DE SST
C
      CALL MGUTDM(NOMRES,SST,IBID,'NOM_MACR_ELEM',IBID,NOMMCL)
      CALL MGUTDM(NOMRES,SST,IBID,'NOM_BASE_MODALE',IBID,BASMOD)
C
      CALL BMNBMD(BASMOD,'DEFORMEE',NBLIGO)
      ICAR(1)=NBLIGO
      CALL BMNBMD(BASMOD,'TOUT',NBCOLO)
      ICAR(2)=NBCOLO

C
C --- RECUPERATION DE LA MATRICE DE LIAISON ET ECRITURE DES DIMENSIONS
C     DE LA MATRICE ORIENTEE
C
C --- CREATION DE LA NOUVELLE MATRICE DE LIAISON
C
      IBLO=ICAR(3)
      CALL JECROC(JEXNUM(FMLI,IBLO))
      CALL JEECRA(JEXNUM(FMLI,IBLO),'LONMAX',NBCOLO*NBLIGO,' ')
      CALL JEVEUO(JEXNUM(FMLI,IBLO),'E',LDMAT)
C
C --- CALCUL PROPREMENT DIT DES MATRICES ORIENTEES DE LIAISON----------

      DO 99 I=1,NBLIGO
        DO 98 J=1,NBCOLO
            ZR(LDMAT+(J-1)*NBLIGO+I-1)=0.D0
  98    CONTINUE
  99  CONTINUE
C
      DO 100 I=1,NBLIGO
            ZR(LDMAT+(I+(NBCOLO-NBLIGO)-1)*NBLIGO+I-1)=1.D0*FACT
  100 CONTINUE
C
      CALL JEDEMA()
      END
