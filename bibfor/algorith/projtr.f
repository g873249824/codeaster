      SUBROUTINE PROJTR(MATYP ,PROJ  ,MOYEN ,
     &                  UNORM ,MNORM,
     &                  COORDA,COORDB,COORDC,COORDP,
     &                  COORDM,LAMOLD,LAMBDA,DEBORD)
C
C ======================================================================
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 24/09/2007   AUTEUR ABBAS M.ABBAS 
C TOLE CRP_21
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT NONE
      CHARACTER*4 MATYP
      REAL*8      COORDA(3)
      REAL*8      COORDB(3)
      REAL*8      COORDC(3)
      REAL*8      COORDP(3)
      INTEGER     PROJ
      INTEGER     MOYEN
      REAL*8      UNORM(3),MNORM(3)
      REAL*8      COORDM(3)
      REAL*8      LAMBDA(3),LAMOLD(3)
      REAL*8      DEBORD
C      
C ----------------------------------------------------------------------
C
C ROUTINE CONTACT (METHODES DISCRETES - APPARIEMENT - MAIT/ESCL - TRI)
C
C PROJECTION D'UN NOEUD ESCLAVE SUR UN TRIANGLE
C
C ----------------------------------------------------------------------
C
C
C IN  MATYP  : TYPE DE LA MAILLE ( TRI3 , TRI6 )
C IN  COORDA : COORDONNEES DU SOMMET A DU TRIANGLE
C IN  COORDB : COORDONNEES DU SOMMET B DU TRIANGLE
C IN  COORDC : COORDONNEES DU SOMMET C DU TRIANGLE
C IN  COORDP : COORDONNEES DU NOEUD ESCLAVE P
C IN  PROJ   : PROJECTION LINEAIRE (1) OU QUADRATIQUE (2) SUR LA MAILLE
C              OU PAS DE NOUVELLE PROJECTION (0)
C IN  MOYEN  : NORMALES D'APPARIEMENT
C               0 MAIT
C               1 MAIT_ESCL
C IN  UNORM  : NORMALE MOYENNE MAITRE/ESCLAVE
C IN  MNORM  : NORMALE A LA MAILLE MAITRE
C OUT COORDM : COORDONNEES DE LA "PROJECTION" M
C OUT LAMOLD : COORDONNEES PARAMETRIQUES DE LA "PROJECTION" M AVANT
C                RABATTEMENT DANS LA MAILLE SI ON DEPASSE
C OUT LAMBDA : COORDONNEES PARAMETRIQUES DE LA "PROJECTION" M APRES
C                RABATTEMENT DANS LA MAILLE SI ON DEPASSE
C OUT DEBORD : PROJECTION HORS DE LA MAILLE
C              >0 : PROJECTION HORS DE LA MAILLE
C              <0 : PROJECTION SUR LA MAILLE
C
C ----------------------------------------------------------------------
C    
  
C
C --- VERIFICATION TYPE PROJECTION
C
      IF ((MATYP.EQ.'TRI6').AND.(PROJ.EQ.2)) THEN
        CALL U2MESS('F','CONTACT_14')
      END IF
      IF ((MATYP.EQ.'TRI7').AND.(PROJ.EQ.2)) THEN
        CALL U2MESS('F','CONTACT_14')
      END IF    
C
C --- PROJECTION EFFECTIVE
C
      IF (MOYEN.EQ.0) THEN
        CALL PROJT1(COORDA,COORDB,COORDC,COORDP,
     &              COORDM,LAMOLD,LAMBDA,DEBORD)
      ELSEIF (MOYEN.EQ.1) THEN
        CALL PROJT2(COORDA,COORDB,COORDC,COORDP,MNORM,
     &              UNORM ,COORDM,LAMOLD,LAMBDA,DEBORD)
      ELSE
        CALL CFIMPA('PROJTR',1) 
      END IF
C  

      END
