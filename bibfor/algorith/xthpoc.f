      SUBROUTINE XTHPOC(MODELE,CHTN,CHTPG)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 11/03/2013   AUTEUR CUVILLIE M.CUVILLIEZ 
C ======================================================================
C COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
      IMPLICIT NONE
      INCLUDE 'jeveux.h'
      CHARACTER*19 CHTN,CHTPG
      CHARACTER*24 MODELE
C ----------------------------------------------------------------------
C
C THER_LINEAIRE + XFEM : APPEL A CALCUL POUR L'OPTION 'TEMP_ELGA'
C
C IN  MODELE  : NOM DU MODELE
C IN  CHTN    : CHAMP DE TEMPERATURE AUX NOEUDS
C OUT CHTPG   : CHAMP DE TEMPERATURE AUX PG
C
C ----------------------------------------------------------------------
      INTEGER      NBIN,NBOUT
      PARAMETER    (NBIN=9)
      PARAMETER    (NBOUT=1)
      CHARACTER*8  LPAIN(NBIN),LPAOUT(NBOUT)
      CHARACTER*16 OPTION
      CHARACTER*19 LIGRMO,PINTTO,CNSETO,HEAVTO,LONCHA,BASLOC,LSN,LST
      CHARACTER*24 LCHIN(NBIN),LCHOUT(NBOUT),CHGEOM
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
      CALL MEGEOM(MODELE,CHGEOM)
      PINTTO = MODELE(1:8)//'.TOPOSE.PIN'
      CNSETO = MODELE(1:8)//'.TOPOSE.CNS'
      HEAVTO = MODELE(1:8)//'.TOPOSE.HEA'
      LONCHA = MODELE(1:8)//'.TOPOSE.LON'
      BASLOC = MODELE(1:8)//'.BASLOC'
      LSN    = MODELE(1:8)//'.LNNO'
      LST    = MODELE(1:8)//'.LTNO'
C
      LPAIN(1) = 'PGEOMER'
      LCHIN(1) = CHGEOM
      LPAIN(2) = 'PTEMPER'
      LCHIN(2) = CHTN
      LPAIN(3) = 'PPINTTO'
      LCHIN(3) = PINTTO
      LPAIN(4) = 'PCNSETO'
      LCHIN(4) = CNSETO
      LPAIN(5) = 'PHEAVTO'
      LCHIN(5) = HEAVTO
      LPAIN(6) = 'PLONCHA'
      LCHIN(6) = LONCHA
      LPAIN(7) = 'PBASLOR'
      LCHIN(7) = BASLOC
      LPAIN(8) = 'PLSN'
      LCHIN(8) = LSN
      LPAIN(9) = 'PLST'
      LCHIN(9) = LST
C
      LPAOUT(1) = 'PTEMPPG'
      LCHOUT(1) = CHTPG
C
      OPTION = 'TEMP_ELGA'
      LIGRMO = MODELE(1:8)//'.MODELE'
C
C     RQ : LIGRMO CONTIENT TOUS LES EF DU MODELE, MAIS SEULS LES EF 
C     ---  X-FEM SAVENT CALCULER L'OPTION 'TEMP_ELGA'
      CALL CALCUL('S',OPTION,LIGRMO,NBIN,LCHIN,LPAIN,NBOUT,LCHOUT,
     &            LPAOUT,'V','OUI')
C
      CALL JEDEMA()
C
      END
