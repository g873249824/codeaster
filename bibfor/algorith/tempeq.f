      SUBROUTINE TEMPEQ(Z,TDEQ,TFEQ,K,N,TEQ,DVTEQ)

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 17/12/2012   AUTEUR SFAYOLLE S.FAYOLLE 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================

      IMPLICIT NONE
      REAL*8   Z,TDEQ,TFEQ,K,N,TEQ,DVTEQ
      REAL*8   ZERO,R8PREM

C............................................
C CALCUL PHASE METALLURGIQUE POUR EDGAR
C CALCUL DE LA TEMPERTURE EQUIVALENTE
C............................................

C IN   Z    : PROPORTION DE PHASE BETA
C IN   TDEQ : TEMPERATURE QUASISTATIQUE DE DEBUT DE TRANSFORMATION
C IN   TFEQ : TEMPERATURE QUASISTATIQUE DE FIN DE TRANSFORMATION
C             CORRESPONDANT A 0.99 DE PHASE BETA
C IN   K    : PARAMETRE MATERIAU
C IN   N    : PARAMETRE MATERIAU
C OUT TEQ   : TEMPERATURE EQUIVALENTE
C OUT DVTEQ : DERIVEE DE TEQ PAR RAPPORT A Z

      ZERO=R8PREM()
      IF (Z .LE. ZERO) THEN
        TEQ=TDEQ
        DVTEQ=1000.D0
      ELSEIF (Z .LE. 0.99D0) THEN
        TEQ=TDEQ+(LOG(1.D0/(1.D0-Z)))**(1.D0/N)/K
        DVTEQ=-(LOG(1.D0/(1.D0-Z)))**(1.D0/N)/(K*N*(1.D0-Z)*LOG(1.D0-Z))
      ELSE
        TEQ=TFEQ
        DVTEQ=-(LOG(100.D0))**(1.D0/N)/(K*N*(0.01D0)*LOG(0.01D0))
      ENDIF

      END
