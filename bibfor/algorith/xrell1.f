      SUBROUTINE XRELL1(TABNOZ,NDIM  ,NAR ,PICKNO,
     &                  NBPINO,NLISEQ)
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 19/12/2012   AUTEUR PELLET J.PELLET 
C TOLE CRS_1404
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE GENIAUT S.GENIAUT
C
      IMPLICIT NONE
      INCLUDE 'jeveux.h'
      INTEGER        NDIM,NAR,NBPINO
      INTEGER        TABNOZ(3,NAR),PICKNO(NBPINO)
      REAL*8         TABCO(NDIM,NAR)
      CHARACTER*19   NLISEQ
C
C ----------------------------------------------------------------------
C
C ROUTINE XFEM (PREPARATION)
C
C CHOIX DE L'ESPACE DES LAGRANGES POUR LE CONTACT - V1:
C                    (VOIR BOOK VI 15/07/05)
C    - CREATION DES RELATIONS DE LIAISONS ENTRE LAGRANGE
C
C ----------------------------------------------------------------------
C
C
C IN  TABNOZ : TABLEAU DES NOEUDS EXTREMITES ET NOEUD MILIEU
C IN  NAR    : NOMBRE D'ARETES COUPEES
C IN  NDIM   : DIMENSION DU PROBLEME
C IN  TABCO  : TABLEAU DES COORDONNEES DE NOEUDS MILIEU
C IN  PICKNO : NUMEROS DES NOEUDS SELECTIONNE
C IN  NBPINO : NOMBRE DE NOEUDS SELECTIONNE
C OUT NLISRL : LISTE REL. LIN. POUR V1 ET V2
C OUT NLISCO : LISTE REL. LIN. POUR V1 ET V2
C OUT NLISEQ : LISTE REL. LIN. POUR V2 SEULEMENT
C
C
C
C
      INTEGER      I,J,IN,DIMEQ,IA,EXT,LIBRE,K,EQ(100),TABNO(NAR,3),IE
      INTEGER      LISEQT(NAR,2),NRELEQ,JLIS1,PICKED
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
C --- INITIALISATIONS
C
      DO 10 I=1,NAR
        DO 11 J=1,3
          TABNO(I,J)=TABNOZ(J,I)
 11     CONTINUE
 10   CONTINUE
      NRELEQ = 0
C
C --- CREATION DU TABLEAU TEMPORAIRE DES RELATION D'EGALITE : LISEQT
C
      DO 100 I=1,NBPINO
        IN     = PICKNO(I)
        DIMEQ  = 0
        DO 110 IA=1,NAR
          DO 111 J=1,2
C           ON CHERCHE LES ARETES EMANANTES
            IF (TABNO(IA,J).EQ.IN) THEN
              EXT=TABNO(IA,3-J)
C             ON REGARDE SI L'AUTRE EXTREMITE EST LIBRE
              LIBRE=1
              DO 112 K=1,NBPINO
                IF (EXT.EQ.PICKNO(K)) LIBRE=0
 112          CONTINUE
              IF (LIBRE.EQ.1) THEN
                DIMEQ=DIMEQ+1
                EQ(DIMEQ)=IA
              ENDIF
            ENDIF
 111      CONTINUE
 110    CONTINUE
        DO 121 IE=1,DIMEQ
           NRELEQ=NRELEQ+1
           LISEQT(NRELEQ,1)=TABNO(EQ(IE) , 1)
           LISEQT(NRELEQ,2)=TABNO(EQ(IE) , 2)
 121    CONTINUE
 100  CONTINUE
C
C --- STOCKAGE DE LISEQT
C
      IF (NRELEQ.GT.0) THEN
        CALL WKVECT(NLISEQ,'G V I',NRELEQ*2,JLIS1)
        DO 130 IE=1,NRELEQ
          ZI(JLIS1-1+2*(IE-1)+1)=LISEQT(IE,1)
          ZI(JLIS1-1+2*(IE-1)+2)=LISEQT(IE,2)
 130    CONTINUE
      ENDIF
C
      CALL JEDEMA()
      END
