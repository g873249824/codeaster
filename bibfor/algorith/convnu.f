      SUBROUTINE CONVNU(NUMIN,NUMOUT,NOMVEC,BASE,NEQOUT)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 26/05/98   AUTEUR D6BHHJP J.P.LEFEBVRE 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C***********************************************************************
C    P. RICHARD     DATE 25/01/92
C-----------------------------------------------------------------------
C  BUT:  <  CONVECRSION DE NUMEROTATION >
C    CREER UN VECTEUR PERMETTANT DE PASSER D'UNE NUMEROTATION
C  A UNE AUTRE, CE VECTEUR DONNE POUR CHAQUEEQUATION DE LA NUMEROTATION
C  RESULTAT LE RANG DE L'EQUTION CORRESPONDANTE DANS LA NUMEROTATION
C   DE DEPART
      IMPLICIT REAL*8 (A-H,O-Z)
C
C   SEULS LES DDL PHYSIQUES SONT RESTITUE, DONC SLES LAGRANGES SONT
C   AUTOMATIQUEMENT MIS A ZERO
C
C  CETTE ROUTINE ENVOIE UN MESSAGE D'ALARME SI IL APPARAIT UNE PERTE
C  AU NIVEAU DES DDL PHYSIQUE
C  CE QUI REVIENT A DIRE QUE LA DIFFERENCE DOIT RESIDER
C   DANS LES LAGRANGES
C-----------------------------------------------------------------------
C
C NUMIN    /I/: NOM UT DE LA NUMEROTATION DE DEPART
C NUMOUT   /I/: NOM UT DE LA NUMEROTATION FINALE
C NOMVEC   /I/: NOM K24 DU VECTEUR D'ENTIER RESULTAT
C BASE     /I/: TYPE DE LA BASE JEVEUX 'G' OU 'V'
C NEQOUT   /O/: NOMBRE D'EQUATION DE LA NUMEROTATION RESULTAT
C
C-------- DEBUT COMMUNS NORMALISES  JEVEUX  ----------------------------
C
      INTEGER          ZI
      COMMON  /IVARJE/ ZI(1)
      REAL*8           ZR
      COMMON  /RVARJE/ ZR(1)
      COMPLEX*16       ZC
      COMMON  /CVARJE/ ZC(1)
      LOGICAL          ZL
      COMMON  /LVARJE/ ZL(1)
      CHARACTER*8      ZK8
      CHARACTER*16              ZK16
      CHARACTER*24                        ZK24
      CHARACTER*32                                  ZK32
      CHARACTER*80                                            ZK80
      COMMON  /KVARJE/ ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C
C----------  FIN  COMMUNS NORMALISES  JEVEUX  --------------------------
C
      CHARACTER*6      PGC
      CHARACTER*1 BASE
      CHARACTER*8 MAIIN,MAIOUT
      CHARACTER*8 K8BID
      CHARACTER*19 NUMIN,NUMOUT
      CHARACTER*24 NOMVEC
      LOGICAL ERREUR
C
      INTEGER IBID
C
C-----------------------------------------------------------------------
      DATA PGC /'CONVNU'/
      DATA IBID/0/
C-----------------------------------------------------------------------
C
C
C
C--------RECUPERATION DES MAILLAGE ET VERIFICATION COMPATIBILITE--------
C
      CALL JEMARQ()
      ERREUR = .FALSE.
      CALL DISMOI('F','NOM_MAILLA',NUMIN,'NUME_DDL',NBID,MAIIN,IRET)
      CALL DISMOI('F','NOM_MAILLA',NUMOUT,'NUME_DDL',NBID,MAIOUT,IRET)
C
      IF (MAIIN.NE.MAIOUT) THEN
        CALL UTDEBM('F',PGC,'LES DEUX NUMEROTATIONS N''ONT PAS
     & MEME MAILLAGE D''ORIGINE')
        CALL UTIMPK('L',' NUMEROTATION 1:',1,NUMIN)
        CALL UTIMPK('L','MAILLAGE 1:',1,MAIIN)
        CALL UTIMPK('L',' NUMEROTATION 2:',1,NUMOUT)
        CALL UTIMPK('L','MAILLAGE 2:',1,MAIOUT)
        CALL UTFINM
      ENDIF
C
C
C------------RECUPERATION DES DIMENSIONS DES NUMEROTATIONS--------------
C
      CALL DISMOI('F','NB_EQUA',NUMIN,'NUME_DDL',NEQIN,K8BID,IBID)
      CALL DISMOI('F','NB_EQUA',NUMOUT,'NUME_DDL',NEQOUT,K8BID,IBID)
C
C-------------------ALLOCATION DU VECTEUR RESULTAT----------------------
C
      CALL WKVECT(NOMVEC,BASE//' V I',NEQOUT,LDCVN)
C
C
C-----------REQUETTE DES DEEQ DES NUMEROTATIONS-------------------------
C
      CALL JEVEUO(NUMIN//'.DEEQ','L',LLDEIN)
      CALL JEVEUO(NUMOUT//'.DEEQ','L',LLDEOU)
C
C
C------------------BOUCLE SUR LES DDL-----------------------------------
C
      DO 10 I=1,NEQOUT
        NUNO=ZI(LLDEOU+2*(I-1))
        ITYP=ZI(LLDEOU+2*(I-1)+1)
        IF(ITYP.GT.0) THEN
          CALL CHEDDL(ZI(LLDEIN),NEQIN,NUNO,ITYP,IRAN,1)
          IF(IRAN.EQ.0) THEN
             ERREUR=.TRUE.
             CALL UTDEBM('A',PGC,'PERTE INFORMATION SUR DDL PHYSIQUE
     & A LA CONVERSION DE NUMEROTATION')
            CALL UTIMPI('L','NOEUD NUMERO: ',1,NUNO)
            CALL UTIMPI('L','TYPE DDL NUMERO: ',1,ITYP)
            CALL UTFINM
          ELSE
            ZI(LDCVN+I-1)=IRAN
          ENDIF
        ENDIF
C
 10   CONTINUE
C
C--------------------------TRAITEMENT ERREUR EVENTUELLE----------------
C
      IF(ERREUR) THEN
        CALL UTDEBM('F',PGC,'ARRET SUR PERTE INFORMATION DDL PHYSIQUE')
        CALL UTFINM
      ENDIF
C
C------------------------LIBERATION DES OBJETS -------------------------
C
C
 9999 CONTINUE
      CALL JEDEMA()
      END
