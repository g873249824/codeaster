      SUBROUTINE ECLAU1 ( NOMTE, FAMIL, ELREFA, FAPG )
      IMPLICIT   NONE
      CHARACTER*8         FAMIL, ELREFA, FAPG
      CHARACTER*16        NOMTE
C MODIF UTILIFOR  DATE 05/10/2005   AUTEUR VABHHTS J.PELLET 
C ======================================================================
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C -----------------------------------------------------------
C IN  : NOMTE  : NOM DU TYPE D'ELEMENT (K16)
C       FAMIL  : NOM (LOCAL) DE LA FAMILLE DE POINTS DE GAUSS :
C                'RIGI', 'MASS', ...
C OUT : ELREFA : NOM DE L'ELREFA   (OU ' ')
C       FAPG   : FAMILLE DE POINT DE GAUSS  (OU ' ')
C -----------------------------------------------------------
C --------- DEBUT DECLARATIONS NORMALISEES  JEVEUX ---------------------
      INTEGER ZI
      COMMON /IVARJE/ZI(1)
      REAL*8 ZR
      COMMON /RVARJE/ZR(1)
      COMPLEX*16 ZC
      COMMON /CVARJE/ZC(1)
      LOGICAL ZL
      COMMON /LVARJE/ZL(1)
      CHARACTER*8 ZK8
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*32 ZK32,JEXNUM
      CHARACTER*80 ZK80
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C --------- FIN DECLARATIONS NORMALISEES  JEVEUX ---------------------

      INTEGER      NTROU, JPNLFP, JNOLFP, NBLFPG, NUFLPG, NUFGPG
      INTEGER      INDK32
      CHARACTER*8  K8B, LIELRF(10)
      CHARACTER*16 NOFGPG
      CHARACTER*32 NOFLPG
C DEB ------------------------------------------------------------------

      FAPG   = ' '
      ELREFA = ' '

      CALL ELREF2 ( NOMTE, 10, LIELRF, NTROU )
      IF ( NTROU .EQ. 0 ) GOTO 9999
      ELREFA = LIELRF(1)

      NOFLPG = NOMTE//ELREFA//FAMIL

      CALL JEVEUO ( '&CATA.TE.PNLOCFPG', 'L', JPNLFP )
      CALL JEVEUO ( '&CATA.TE.NOLOCFPG', 'L', JNOLFP )
      CALL JELIRA ( '&CATA.TE.NOLOCFPG', 'LONMAX', NBLFPG, K8B )

      NUFLPG = INDK32(ZK32(JPNLFP),NOFLPG,1,NBLFPG)
      IF (NUFLPG.GT.0) THEN
         NUFGPG = ZI(JNOLFP-1+NUFLPG)

C        -- POUR LES FAMILLES "LISTE" : ON NE SAIT PAS FAIRE => FAPG=' '
         IF (NUFGPG.EQ.0) GO TO 9999

         CALL JENUNO(JEXNUM('&CATA.TM.NOFPG',NUFGPG),NOFGPG)
         FAPG = NOFGPG(9:16)

      ELSE
         CALL ASSERT(.FALSE.)
      END IF

 9999 CONTINUE
      END
