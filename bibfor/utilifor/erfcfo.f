      REAL*8 FUNCTION ERFCFO(X)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF UTILIFOR  DATE 19/12/2012   AUTEUR PELLET J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C
C UTILISEE SOUS NT POUR L'EVALUATION DE LA FONCTION D'ERREUR
C ERFC (PROVIENT DE LA BIBLIOTHEQUE SLATEC)
C
C***BEGIN PROLOGUE  DERFC
C***PURPOSE  COMPUTE THE COMPLEMENTARY ERROR FUNCTION.
C***LIBRARY   SLATEC (FNLIB)
C***CATEGORY  C8A, L5A1E
C***TYPE      DOUBLE PRECISION (ERFC-S, DERFC-D)
C***KEYWORDS  COMPLEMENTARY ERROR FUNCTION, ERFC, FNLIB,
C             SPECIAL FUNCTIONS
C***AUTHOR  FULLERTON, W., (LANL)
C***DESCRIPTION
C
C DERFC(X) CALCULATES THE DOUBLE PRECISION COMPLEMENTARY ERROR FUNCTION
C FOR DOUBLE PRECISION ARGUMENT X.
C
C SERIES FOR ERF        ON THE INTERVAL  0.          TO  1.00000E+00
C                                        WITH WEIGHTED ERROR   1.28E-32
C                                         LOG WEIGHTED ERROR  31.89
C                               SIGNIFICANT FIGURES REQUIRED  31.05
C                                    DECIMAL PLACES REQUIRED  32.55
C
C SERIES FOR ERC2       ON THE INTERVAL  2.50000E-01 TO  1.00000E+00
C                                        WITH WEIGHTED ERROR   2.67E-32
C                                         LOG WEIGHTED ERROR  31.57
C                               SIGNIFICANT FIGURES REQUIRED  30.31
C                                    DECIMAL PLACES REQUIRED  32.42
C
C SERIES FOR ERFC       ON THE INTERVAL  0.          TO  2.50000E-01
C                                        WITH WEIGHTED ERROR   1.53E-31
C                                         LOG WEIGHTED ERROR  30.82
C                               SIGNIFICANT FIGURES REQUIRED  29.47
C                                    DECIMAL PLACES REQUIRED  31.70
C
C***END PROLOGUE  DERFC
      IMPLICIT NONE
      REAL*8 X,ERFCS(21),ERFCCS(59),ERC2CS(49),SQEPS,SQRTPI,XMAX,TXMAX,
     &       XSML,Y,RMINEM,RMIREM,CSEVL
      LOGICAL FIRST
      INTEGER INITS
      SAVE ERFCS,ERC2CS,ERFCCS,SQRTPI,NTERF,NTERFC,NTERC2,XSML,XMAX,
     &     SQEPS,FIRST
C-----------------------------------------------------------------------
      INTEGER NTERC2,NTERF,NTERFC
      REAL*8 ETA
C-----------------------------------------------------------------------
      DATA ERFCS(1)/-.49046121234691808039984544033376D-1/
      DATA ERFCS(2)/-.14226120510371364237824741899631D+0/
      DATA ERFCS(3)/+.10035582187599795575754676712933D-1/
      DATA ERFCS(4)/-.57687646997674847650827025509167D-3/
      DATA ERFCS(5)/+.27419931252196061034422160791471D-4/
      DATA ERFCS(6)/-.11043175507344507604135381295905D-5/
      DATA ERFCS(7)/+.38488755420345036949961311498174D-7/
      DATA ERFCS(8)/-.11808582533875466969631751801581D-8/
      DATA ERFCS(9)/+.32334215826050909646402930953354D-10/
      DATA ERFCS(10)/-.79910159470045487581607374708595D-12/
      DATA ERFCS(11)/+.17990725113961455611967245486634D-13/
      DATA ERFCS(12)/-.37186354878186926382316828209493D-15/
      DATA ERFCS(13)/+.71035990037142529711689908394666D-17/
      DATA ERFCS(14)/-.12612455119155225832495424853333D-18/
      DATA ERFCS(15)/+.20916406941769294369170500266666D-20/
      DATA ERFCS(16)/-.32539731029314072982364160000000D-22/
      DATA ERFCS(17)/+.47668672097976748332373333333333D-24/
      DATA ERFCS(18)/-.65980120782851343155199999999999D-26/
      DATA ERFCS(19)/+.86550114699637626197333333333333D-28/
      DATA ERFCS(20)/-.10788925177498064213333333333333D-29/
      DATA ERFCS(21)/+.12811883993017002666666666666666D-31/
      DATA ERC2CS(1)/-.6960134660230950112739150826197D-1/
      DATA ERC2CS(2)/-.4110133936262089348982212084666D-1/
      DATA ERC2CS(3)/+.3914495866689626881561143705244D-2/
      DATA ERC2CS(4)/-.4906395650548979161280935450774D-3/
      DATA ERC2CS(5)/+.7157479001377036380760894141825D-4/
      DATA ERC2CS(6)/-.1153071634131232833808232847912D-4/
      DATA ERC2CS(7)/+.1994670590201997635052314867709D-5/
      DATA ERC2CS(8)/-.3642666471599222873936118430711D-6/
      DATA ERC2CS(9)/+.6944372610005012589931277214633D-7/
      DATA ERC2CS(10)/-.1371220902104366019534605141210D-7/
      DATA ERC2CS(11)/+.2788389661007137131963860348087D-8/
      DATA ERC2CS(12)/-.5814164724331161551864791050316D-9/
      DATA ERC2CS(13)/+.1238920491752753181180168817950D-9/
      DATA ERC2CS(14)/-.2690639145306743432390424937889D-10/
      DATA ERC2CS(15)/+.5942614350847910982444709683840D-11/
      DATA ERC2CS(16)/-.1332386735758119579287754420570D-11/
      DATA ERC2CS(17)/+.3028046806177132017173697243304D-12/
      DATA ERC2CS(18)/-.6966648814941032588795867588954D-13/
      DATA ERC2CS(19)/+.1620854541053922969812893227628D-13/
      DATA ERC2CS(20)/-.3809934465250491999876913057729D-14/
      DATA ERC2CS(21)/+.9040487815978831149368971012975D-15/
      DATA ERC2CS(22)/-.2164006195089607347809812047003D-15/
      DATA ERC2CS(23)/+.5222102233995854984607980244172D-16/
      DATA ERC2CS(24)/-.1269729602364555336372415527780D-16/
      DATA ERC2CS(25)/+.3109145504276197583836227412951D-17/
      DATA ERC2CS(26)/-.7663762920320385524009566714811D-18/
      DATA ERC2CS(27)/+.1900819251362745202536929733290D-18/
      DATA ERC2CS(28)/-.4742207279069039545225655999965D-19/
      DATA ERC2CS(29)/+.1189649200076528382880683078451D-19/
      DATA ERC2CS(30)/-.3000035590325780256845271313066D-20/
      DATA ERC2CS(31)/+.7602993453043246173019385277098D-21/
      DATA ERC2CS(32)/-.1935909447606872881569811049130D-21/
      DATA ERC2CS(33)/+.4951399124773337881000042386773D-22/
      DATA ERC2CS(34)/-.1271807481336371879608621989888D-22/
      DATA ERC2CS(35)/+.3280049600469513043315841652053D-23/
      DATA ERC2CS(36)/-.8492320176822896568924792422399D-24/
      DATA ERC2CS(37)/+.2206917892807560223519879987199D-24/
      DATA ERC2CS(38)/-.5755617245696528498312819507199D-25/
      DATA ERC2CS(39)/+.1506191533639234250354144051199D-25/
      DATA ERC2CS(40)/-.3954502959018796953104285695999D-26/
      DATA ERC2CS(41)/+.1041529704151500979984645051733D-26/
      DATA ERC2CS(42)/-.2751487795278765079450178901333D-27/
      DATA ERC2CS(43)/+.7290058205497557408997703680000D-28/
      DATA ERC2CS(44)/-.1936939645915947804077501098666D-28/
      DATA ERC2CS(45)/+.5160357112051487298370054826666D-29/
      DATA ERC2CS(46)/-.1378419322193094099389644800000D-29/
      DATA ERC2CS(47)/+.3691326793107069042251093333333D-30/
      DATA ERC2CS(48)/-.9909389590624365420653226666666D-31/
      DATA ERC2CS(49)/+.2666491705195388413323946666666D-31/
      DATA ERFCCS(1)/+.715179310202924774503697709496D-1/
      DATA ERFCCS(2)/-.265324343376067157558893386681D-1/
      DATA ERFCCS(3)/+.171115397792085588332699194606D-2/
      DATA ERFCCS(4)/-.163751663458517884163746404749D-3/
      DATA ERFCCS(5)/+.198712935005520364995974806758D-4/
      DATA ERFCCS(6)/-.284371241276655508750175183152D-5/
      DATA ERFCCS(7)/+.460616130896313036969379968464D-6/
      DATA ERFCCS(8)/-.822775302587920842057766536366D-7/
      DATA ERFCCS(9)/+.159214187277090112989358340826D-7/
      DATA ERFCCS(10)/-.329507136225284321486631665072D-8/
      DATA ERFCCS(11)/+.722343976040055546581261153890D-9/
      DATA ERFCCS(12)/-.166485581339872959344695966886D-9/
      DATA ERFCCS(13)/+.401039258823766482077671768814D-10/
      DATA ERFCCS(14)/-.100481621442573113272170176283D-10/
      DATA ERFCCS(15)/+.260827591330033380859341009439D-11/
      DATA ERFCCS(16)/-.699111056040402486557697812476D-12/
      DATA ERFCCS(17)/+.192949233326170708624205749803D-12/
      DATA ERFCCS(18)/-.547013118875433106490125085271D-13/
      DATA ERFCCS(19)/+.158966330976269744839084032762D-13/
      DATA ERFCCS(20)/-.472689398019755483920369584290D-14/
      DATA ERFCCS(21)/+.143587337678498478672873997840D-14/
      DATA ERFCCS(22)/-.444951056181735839417250062829D-15/
      DATA ERFCCS(23)/+.140481088476823343737305537466D-15/
      DATA ERFCCS(24)/-.451381838776421089625963281623D-16/
      DATA ERFCCS(25)/+.147452154104513307787018713262D-16/
      DATA ERFCCS(26)/-.489262140694577615436841552532D-17/
      DATA ERFCCS(27)/+.164761214141064673895301522827D-17/
      DATA ERFCCS(28)/-.562681717632940809299928521323D-18/
      DATA ERFCCS(29)/+.194744338223207851429197867821D-18/
      DATA ERFCCS(30)/-.682630564294842072956664144723D-19/
      DATA ERFCCS(31)/+.242198888729864924018301125438D-19/
      DATA ERFCCS(32)/-.869341413350307042563800861857D-20/
      DATA ERFCCS(33)/+.315518034622808557122363401262D-20/
      DATA ERFCCS(34)/-.115737232404960874261239486742D-20/
      DATA ERFCCS(35)/+.428894716160565394623737097442D-21/
      DATA ERFCCS(36)/-.160503074205761685005737770964D-21/
      DATA ERFCCS(37)/+.606329875745380264495069923027D-22/
      DATA ERFCCS(38)/-.231140425169795849098840801367D-22/
      DATA ERFCCS(39)/+.888877854066188552554702955697D-23/
      DATA ERFCCS(40)/-.344726057665137652230718495566D-23/
      DATA ERFCCS(41)/+.134786546020696506827582774181D-23/
      DATA ERFCCS(42)/-.531179407112502173645873201807D-24/
      DATA ERFCCS(43)/+.210934105861978316828954734537D-24/
      DATA ERFCCS(44)/-.843836558792378911598133256738D-25/
      DATA ERFCCS(45)/+.339998252494520890627359576337D-25/
      DATA ERFCCS(46)/-.137945238807324209002238377110D-25/
      DATA ERFCCS(47)/+.563449031183325261513392634811D-26/
      DATA ERFCCS(48)/-.231649043447706544823427752700D-26/
      DATA ERFCCS(49)/+.958446284460181015263158381226D-27/
      DATA ERFCCS(50)/-.399072288033010972624224850193D-27/
      DATA ERFCCS(51)/+.167212922594447736017228709669D-27/
      DATA ERFCCS(52)/-.704599152276601385638803782587D-28/
      DATA ERFCCS(53)/+.297976840286420635412357989444D-28/
      DATA ERFCCS(54)/-.126252246646061929722422632994D-28/
      DATA ERFCCS(55)/+.539543870454248793985299653154D-29/
      DATA ERFCCS(56)/-.238099288253145918675346190062D-29/
      DATA ERFCCS(57)/+.109905283010276157359726683750D-29/
      DATA ERFCCS(58)/-.486771374164496572732518677435D-30/
      DATA ERFCCS(59)/+.152587726411035756763200828211D-30/
      DATA SQRTPI/1.77245385090551602729816748334115D0/
      DATA FIRST/.TRUE./
C***FIRST EXECUTABLE STATEMENT  DERFC
      IF (FIRST) THEN
        ETA=0.1D0*RMIREM()
        NTERF=INITS(ERFCS,21,ETA)
        NTERFC=INITS(ERFCCS,59,ETA)
        NTERC2=INITS(ERC2CS,49,ETA)
C
        XSML=-SQRT(-LOG(SQRTPI*RMIREM()))
        TXMAX=SQRT(-LOG(SQRTPI*RMINEM()))
        XMAX=TXMAX-0.5D0*LOG(TXMAX)/TXMAX-0.01D0
        SQEPS=SQRT(2.0D0*RMIREM())
      ENDIF
      FIRST=.FALSE.
C
      IF (X.GT.XSML)GOTO 10
C
C ERFC(X) = 1.0 - ERF(X)  FOR  X .LT. XSML
C
      ERFCFO=2.0D0
      GOTO 40
C
   10 CONTINUE
      IF (X.GT.XMAX)GOTO 30
      Y=ABS(X)
      IF (Y.GT.1.0D0)GOTO 20
C
C ERFC(X) = 1.0 - ERF(X)  FOR ABS(X) .LE. 1.0
C
      IF (Y.LT.SQEPS)ERFCFO=1.0D0-2.0D0*X/SQRTPI
      IF (Y.GE.SQEPS)ERFCFO=1.0D0-X*(1.0D0+
     &                      CSEVL(2.D0*X*X-1.D0,ERFCS,NTERF))
      GOTO 40
C
C ERFC(X) = 1.0 - ERF(X)  FOR  1.0 .LT. ABS(X) .LE. XMAX
C
   20 CONTINUE
      Y=Y*Y
      IF (Y.LE.4.D0)ERFCFO=EXP(-Y)/ABS(X)*
     &                     (0.5D0+CSEVL((8.D0/Y-5.D0)/3.D0,ERC2CS,
     &                     NTERC2))
      IF (Y.GT.4.D0)ERFCFO=EXP(-Y)/ABS(X)*
     &                     (0.5D0+CSEVL(8.D0/Y-1.D0,ERFCCS,NTERFC))
      IF (X.LT.0.D0)ERFCFO=2.0D0-ERFCFO
      GOTO 40
C
   30 CONTINUE
C
C     CAS X TROP GRAND
C
      ERFCFO=0.D0
C
   40 CONTINUE
      END
