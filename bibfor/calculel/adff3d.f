          SUBROUTINE ADFF3D(NDIM,NNO,NBFAM,NBPG,FAMU,
     >     IPOIDS,IVF,IDFDE,IDFDN,IDFDK) 
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 20/03/2002   AUTEUR MJBHHPE J.L.FLEJOU 
C ======================================================================
C COPYRIGHT (C) 1991 - 2002  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C                                                                       
C                                                                       
C ======================================================================
          IMPLICIT NONE          
          INTEGER NDIM,NNO,NBFAM,NBPG(NBFAM),FAMU
          INTEGER IPOIDS,IVF,IDFDE,IDFDN,IDFDK
C    IN 
C       NDIM DIMENSION ESPACE
C       NNO NOMBRE DE NOEUDS
C       NBFAM NOMBRE DE FAMILLES
C       NBPG(NBFAM) NBRE DE POINTS DE GAUSS DE CHAQUE FAMILLE
C    OUT
C           IPOIDS ADRESSE RELATIVE DES POIDS DE GAUSS
C           IVF    ADRESSE RELATIVE DES FCTIONS DE FORME
C           IDFDE  ADRESSE RELATIVE DERIVEE KSI DES FCTIONS DE FORME
C           IDFDN  ADRESSE RELATIVE DERIVEE ETA DES FCTIONS DE FORME
C           IDFDK  ADRESSE RELATIVE DERIVEE DSETA DES FCTIONS DE FORME
C  PROGRAMMATION D4.05.04
C
C
           INTEGER JDEC,IFA
           JDEC = NNO*NNO*(NDIM+1)
           DO 10 IFA = 1 , FAMU
            IPOIDS = JDEC
            IVF    = IPOIDS + NBPG(FAMU)
            IDFDE  = IVF    + NBPG(FAMU)*NNO
            IDFDN  = IDFDE  + 1
            IDFDK  = IDFDN  + 1
            JDEC = JDEC + NBPG(IFA)*(1+(NDIM+1)*NNO)
   10      CONTINUE
         END
