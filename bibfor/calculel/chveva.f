      SUBROUTINE CHVEVA(NBMA  ,LIGR1 ,LIGR2 ,IRET)
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 23/04/2013   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE PELLET J.PELLET
C
      IMPLICIT NONE
      INCLUDE 'jeveux.h'
      CHARACTER*19 LIGR1,LIGR2
      INTEGER      NBMA,IRET
C
C ----------------------------------------------------------------------
C
C VERIFIER LA COHERENCE DES LIGREL ENTRE DES CHAMPS PORTANT DES 
C COMPOSANTES DYNAMIQUES DE TYPE VARI_ELGA
C
C ----------------------------------------------------------------------
C
C
C IN  NBMA   : NOMBRE DE MAILLES TOTALES DU MAILLAGE
C IN  LIGR1  : PREMIER LIGREL
C IN  LIGR2  : SECOND LIGREL
C OUT IRET   : 0  - SI LE SECOND LIGREL EST INCLU DANS LE PREMIER
C              -1 - SINON
C
C ----------------------------------------------------------------------
C
      INTEGER      NBMA1,NBMA2,NUMA,IMA
      INTEGER      IPRES1,IPRES2
      CHARACTER*24 LINUM1,LINUM2
      INTEGER      JLIGR1,JLIGR2
      CHARACTER*24 LINUT1,LINUT2
      CHARACTER*24 TBTRAV
      INTEGER      JTRAV
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
C --- OBJETS POUR TOUT LE MAILLAGE
C
      IRET   = 0
      TBTRAV = '&&CHVEVA.TABLE'
      CALL WKVECT(TBTRAV,'V V I',2*NBMA,JTRAV)
C
C --- EXTRACTION DU PREMIER LIGREL DE LA LISTE DES NUMEROS DE MAILLES
C
      LINUM1 = '&&CHVEVA.LINUM1'
      LINUT1 = '&&CHVEVA.LINUT1'
      CALL LIGLMA(LIGR1,NBMA1,LINUM1,LINUT1)
      CALL JEVEUO(LINUM1,'L',JLIGR1)
      DO 10 IMA = 1,NBMA1
        NUMA   = ZI(JLIGR1-1+IMA)
        ZI(JTRAV+2*(NUMA-1)-1+1) = 1
 10   CONTINUE
      CALL JEDETR(LINUM1)
      CALL JEDETR(LINUT1)
C
C --- EXTRACTION DU SECOND LIGREL DE LA LISTE DES NUMEROS DE MAILLES
C
      LINUM2 = '&&CHVEVA.LINUM2'
      LINUT2 = '&&CHVEVA.LINUT2'
      CALL LIGLMA(LIGR2,NBMA2,LINUM2,LINUT2)
      CALL JEVEUO(LINUM2,'L',JLIGR2)
      DO 20 IMA = 1,NBMA2
        NUMA   = ZI(JLIGR2-1+IMA)
        ZI(JTRAV+2*(NUMA-1)-1+2) = 1
 20   CONTINUE
      CALL JEDETR(LINUM2)
      CALL JEDETR(LINUT2)
C
C --- VERIFICATION
C
      DO 30 IMA = 1,NBMA
        IPRES1 = ZI(JTRAV+2*(NUMA-1)-1+1)
        IPRES2 = ZI(JTRAV+2*(NUMA-1)-1+2)
        IF ((IPRES1.EQ.0).AND.(IPRES2.NE.0)) THEN
          IRET = -1
          GOTO 99
        ENDIF
 30   CONTINUE
C
 99   CONTINUE
C
      CALL JEDETR(TBTRAV)
      CALL JEDEMA()
      END
