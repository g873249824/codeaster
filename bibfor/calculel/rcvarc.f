      SUBROUTINE RCVARC(ARRET,NOVRC,POUM,KPGVRC,VALVRC,IRET)
      IMPLICIT NONE
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 23/06/2005   AUTEUR VABHHTS J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2005  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
      CHARACTER*(*) NOVRC,POUM
      CHARACTER*8 PARAM
      CHARACTER*1 ARRET
      INTEGER  IRET
      REAL*8 VALVRC
C-----------------------------------------------------------------------
C  BUT : RECUPERER LA VALEUR D'UNE VARIABLE DE COMMANDE SUR UN POINT
C        DE GAUSS (KPGVRC) ET POUR UNE VALEUR D'INSTANT ('+','-','REF')
C
C ARGUMENTS :
C  IN   ARRET  (K2) : /'FM'
C  IN   ARRET (K1)  : CE QU'IL FAUT FAIRE EN CAS DE PROBLEME
C              = ' ' : ON REMPLIT CODRET ET ON SORT SANS MESSAGE.
C              = 'F' : SI LA VARIABLE N'EST PAS TROUVEE, ON ARRETE
C                       EN FATAL.
C  IN   NOVRC  (K8) : NOM DE LA VARIABLE DE COMMANDE SOUHAITEE
C  IN   POUM   (K*) : /'+', /'-', /'REF'
C  IN   KPGVRC (I)  : NUMERO DU (SOUS)POINT DE GAUSS
C  OUT  VALVRC (R)  : VALEUR DE LA VARIABLE DE COMMANDE
C  OUT  IRET   (I)  : CODE RETOUR : 0 -> OK
C                                   1 -> VARIABLE NON TROUVEE

C---------------- COMMUNS NORMALISES  JEVEUX  --------------------------
      CHARACTER*32 JEXNUM,JEXNOM,JEXATR,JEXR8
      COMMON /IVARJE/ZI(1)
      COMMON /RVARJE/ZR(1)
      COMMON /CVARJE/ZC(1)
      COMMON /LVARJE/ZL(1)
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
      INTEGER ZI
      REAL*8 ZR
      COMPLEX*16 ZC
      LOGICAL ZL
      CHARACTER*8 ZK8,NOVR8
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*32 ZK32
      CHARACTER*80 ZK80
C ---------------- FIN COMMUNS NORMALISES  JEVEUX  --------------------
      INTEGER NBCVRC,JVCNOM
      COMMON /CAII14/NBCVRC,JVCNOM

      INTEGER KCVRC,ITAB(8),IBID,NPGVRC,KPGVRC,INDIK8
      INTEGER IADZI,IAZK24
      CHARACTER*8 NOMAIL
      REAL*8 R8VIDE
C ---------------------------------------------------------------


      NOVR8=NOVRC
      KCVRC=INDIK8(ZK8(JVCNOM),NOVR8,1,NBCVRC)

C     -- SI LA CVRC N'EST PAS FOURNIE, ON REND "R8VIDE" :
      IF (KCVRC.EQ.0) THEN
        IRET=1
        IF (ARRET.EQ.' ') THEN
          VALVRC=R8VIDE()
          GO TO 9999
        ELSE
          CALL TECAEL(IADZI,IAZK24)
          NOMAIL=ZK24(IAZK24-1+3)(1:8)
          CALL UTMESS('F','RCVARC','PAS DE VARIABLE: '//NOVR8//
     &    ' POUR LA MAILLE: '//NOMAIL)
        END IF
      END IF

      IF (POUM.EQ.'-') THEN
        PARAM='PVARCMR'
      ELSE IF (POUM.EQ.'+') THEN
        PARAM='PVARCPR'
      ELSE IF (POUM.EQ.'REF') THEN
        PARAM='PVARCRR'
      ELSE
        CALL ASSERT(.FALSE.)
      END IF

      CALL TECACH ('OOO',PARAM,8,ITAB,IBID)
      CALL ASSERT(ITAB(6).EQ.NBCVRC)
      NPGVRC=ITAB(3)*ITAB(7)
      CALL ASSERT((KPGVRC.GE.1) .AND. (KPGVRC.LE.NPGVRC))

      VALVRC=ZR(ITAB(1) -1 + (KPGVRC-1)*NBCVRC + KCVRC)
      IRET=0

9999  CONTINUE
      END
