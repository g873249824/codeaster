      SUBROUTINE ELREF5(ELRZ,FAMIL,NDIM,NNO,NNOS,NPG,IPOIDS,JCOOPG,IVF,
     &                  IDFDE,JDFD2,JGANO)
      IMPLICIT NONE
      INCLUDE 'jeveux.h'
      CHARACTER*(*) ELRZ,FAMIL
      INTEGER NDIM,NNO,NNOS,NPG,IPOIDS,JCOOPG,IVF,IDFDE,JDFD2,JGANO
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 04/09/2012   AUTEUR PELLET J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE PELLET J.PELLET

C ----------------------------------------------------------------------
C BUT: RECUPERER DANS UNE ROUTINE TE00IJ LES ADRESSES DANS ZR
C      - DES POIDS DES POINTS DE GAUSS  : IPOIDS
C      - DES COORDONNEES DES POINTS DE GAUSS  : JCOOPG
C      - DES VALEURS DES FONCTIONS DE FORME : IVF
C      - DES VALEURS DES DERIVEES 1ERES DES FONCTIONS DE FORME : IDFDE
C      - DES VALEURS DES DERIVEES 2EMES DES FONCTIONS DE FORME : JDFD2
C      - DE LA MATRICE DE PASSAGE GAUSS -> NOEUDS : JGANO
C ----------------------------------------------------------------------
C   IN   ELRZ : NOM DE L'ELREFA (K8) OU ' '
C                 SI ELRZ=' ' : ON PREND L'ELREFA "PRINCIPAL"
C        FAMIL  : NOM (LOCAL) DE LA FAMILLE DE POINTS DE GAUSS :
C                 'STD','RICH',...
C   OUT  NDIM   : DIMENSION DE L'ESPACE (=NB COORDONNEES)
C        NNO    : NOMBRE DE NOEUDS DU TYPE_MAILLE
C        NNOS   : NOMBRE DE NOEUDS SOMMETS DU TYPE_MAILLE
C        NPG    : NOMBRE DE POINTS DE GAUSS
C        IPOIDS : ADRESSE DANS ZR DU TABLEAU POIDS(IPG)
C        JCOOPG : ADRESSE DANS ZR DU TABLEAU COOPG(IDIM,IPG)
C        IVF    : ADRESSE DANS ZR DU TABLEAU FF(INO,IPG)
C        IDFDE  : ADRESSE DANS ZR DU TABLEAU DFF(IDIM,INO,IPG)
C        JDFD2  : ADRESSE DANS ZR DU TABLEAU DFF2(IDIM,JDIM,INO,IPG)
C        JGANO  : ADRESSE DANS ZR DE LA MATRICE DE PASSAGE
C                      GAUSS -> NOEUDS (DIM= 2+NNO*NPG)
C                 ATTENTION : LES 2 1ERS TERMES SONT LES
C                             DIMMENSIONS DE LA MATRICE: NNO ET NPG

C   -------------------------------------------------------------------
      CHARACTER*16 OPTION,NOMTE,NOMTM,PHENO,MODELI
      COMMON /CAKK01/OPTION,NOMTE,NOMTM,PHENO,MODELI
      INTEGER NUTE,JNBELR,JNOELR,IACTIF,JPNLFP,JNOLFP,NBLFPG
      COMMON /CAII11/NUTE,JNBELR,JNOELR,IACTIF,JPNLFP,JNOLFP,NBLFPG

      CHARACTER*8 ELRF
C DEB ------------------------------------------------------------------

      IF (ELRZ.EQ.' ') THEN
        CALL ELREF1(ELRF)
        CALL ASSERT(ELRF.NE.'XXXXXXXX')
      ELSE
        ELRF = ELRZ
      END IF

      CALL ELREF6 ( ELRF,NOMTE,FAMIL,NDIM,NNO,NNOS,NPG,IPOIDS,
     &                    JCOOPG,IVF,IDFDE,JDFD2,JGANO )

      END
