      SUBROUTINE BOITE(MAIL  ,NGRMA ,NORM  ,DIME  ,TYPMAI,
     &                 NHQUA ,PRECBO,NOMBOI)
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 09/01/2007   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT NONE
      CHARACTER*19  NGRMA
      CHARACTER*16  NOMBOI
      CHARACTER*10  NORM
      CHARACTER*8   MAIL
      INTEGER       DIME,NHQUA    
      CHARACTER*16  TYPMAI  
      REAL*8        PRECBO     
C      
C ----------------------------------------------------------------------
C
C CONSTRUCTION DE BOITES ENGLOBANTES POUR UN ENSEMBLE DE MAILLES
C 
C ROUTINE PRINCIPALE D'AIGUILLAGE SUIVANT DIMENSION DES MAILLES
C
C ----------------------------------------------------------------------
C
C
C IN  MAIL   : NOM DU MAILLAGE
C IN  NGRMA  : LISTE DES MAILLES A METTRE EN BOITE
C IN  NORM   : NORMALES LISSEES POUR LES COQUES
C IN  DIME   : DIMENSION DE L'ESPACE
C IN  TYPMAI : SD CONTENANT NOM DES TYPES ELEMENTS (&&CATA.NOMTM)
C IN  PRECBO : PRECISION RELATIVE POUR AGRANDIR LA BOITE ENGLOBANTE
C              MAILLE 
C IN  NHQUA  : ECHANTILLONNAGE DES FACES POUR MISE EN BOITE ELEMENTS
C              QUADRATIQUES
C I/O NOMBOI : SD BOITE
C
C
C SD EN ENTREE:
C
C  * NGRMA : LISTE TRIEE DES NMA MAILLES DU DOMAINE NOM (MA1,MA2,...)
C     CALL WKVECT(NOMSD(1:10)//'.GROUPEMA','V V I',NMA,JGRMA)
C
C  * NORM  : NORMALES EN CHAQUE NOEUD SUR TOUTES LES COQUES DU MAILLAGE
C     CALL WKVECT(NORM,'V V R',DIME*NNO,JNORM)
C      NOEUD DU MAILLAGE -> NORMALE NORMEE * EPAISSEUR MOYENNE / 2
C          ( NX1, NY1, [NZ1], NX2, ...)
C
C SD EN SORTIE (OBJETS CREES PAR BOITCR):
C
C NOMBOI(1:16)//'.DIME'   : DIMENSIONS ET INDEX DE LA SD BOITE
C               ( DIME, NMA, PAN1, SOM1, PAN2, ...)
C                 DIME : DIMENSION DE L'ESPACE
C                 NMA  : NOMBRE DE MAILLES
C                 PAN* : INDEX DES PANS DE MA* DANS BOITE.PAN
C                 SOM* : INDEX DES SOMMETS DE MA* DANS BOITE.SOMMET
C                INDEX DES _PANS_ PAS DES COEFFICIENTS !
C                SEULE INFO PORTEE DIRECTE: NOMBRE PANS/BOITE
C                IF FAUT MULTIPLIER PAR 4 OU 5 SUIVANT DIMENSIONS
C                IDEM POUR LES SOMMETS
C NOMBOI(1:16)//'.MINMAX' : BOITES ENGLOBANT LES MAILLES 
C                 SUIVANT X, Y, [Z]
C                (X1MIN,X1MAX,Y1MIN,Y1MAX,[Z1MIN],[Z1MAX],X2MIN,...)
C NOMBOI(1:16)//'.PAN'    : PANS (2D = ARETES, 3D = FACES) DES CONVEXES
C                ENGLOBANTS ET INSCRITS DES MAILLES
C                (A1,B1,[C1],D1,E1,A2...)
C                   TELS QUE AX+BY+[CZ]+D<=0 (CONVEXE ENGLOBANT)
C                   ET       AX+BY+[CZ]+E<=0 (CONVEXE INSCRIT)
C NOMBOI(1:16)//'.SOMMET' : SOMMETS DES CONVEXES ENGLOBANT LES MAILLES
C                (X1,Y1,[Z1],X2,...)
C NOMBOI(1:16)//'.MMGLOB' : BOITE ENGLOBANT TOUTES LES MAILLES DE NGRMA
C                (XMIN,XMAX,YMIN,YMAX,[ZMIN,ZMAX])
C NOMBOI(1:16)//'.H'      : TAILLE MOYENNE DES MAILLES
C                (H1,H2,...)
C      
C ----------------------------------------------------------------------
C 
      CALL JEMARQ()  
C
C --- CALCUL DES BOITES ET DES PANS
C
      IF (DIME.EQ.2) THEN
        CALL BOIT2D(MAIL  ,TYPMAI,NGRMA ,NORM  ,PRECBO,
     &              NOMBOI)
      ELSE IF (DIME.EQ.3) THEN
        CALL BOIT3D(MAIL  ,TYPMAI,NGRMA ,NORM  ,PRECBO,
     &              NHQUA ,NOMBOI)
      ELSE
        CALL ASSERT(.FALSE.)
      ENDIF
C
      CALL JEDEMA()

      END
