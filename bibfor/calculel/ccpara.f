      SUBROUTINE CCPARA(OPTION,MODELE,RESUIN,RESUOU,NUMORD,
     &                  NORDM1,EXITIM,MATECO,CARAEL)
      IMPLICIT NONE
C     --- ARGUMENTS ---
      INCLUDE 'jeveux.h'

      CHARACTER*32 JEXNUM,JEXNOM
      INTEGER      NUMORD,NORDM1
      CHARACTER*8  MODELE,RESUIN,RESUOU,MATECO,CARAEL
      CHARACTER*16 OPTION
      LOGICAL      EXITIM
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 05/02/2013   AUTEUR DELMAS J.DELMAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE SELLENET N.SELLENET
      INTEGER      NPARIN,IRET,IBID,JAINST,JFREQ,IAOPDS,IAOPLO,IPARA
      INTEGER      JNMO,OPT,INUME,IARG,JAINS2

      REAL*8       RBID,TPS(6),RUNDF,R8NNEM,OMEGA2,FREQ,TIME,ZERO
      PARAMETER   (ZERO = 0.0D0)

      COMPLEX*16   CBID
C
      CHARACTER*2  CHDRET
      CHARACTER*8  MAILLA,K8B,NOMCMP(6)
      CHARACTER*16 VARI
      CHARACTER*24 CURCHA,CHTIME,CHFREQ,CHOME2,CHHARM,CHVREF
      CHARACTER*24 CHMASS,CHNOVA,CHSIGF,CHSIG,CHVARC,CHVAC2
      PARAMETER   (CHTIME = '&&CCPARA.CH_INST_R')
      PARAMETER   (CHFREQ = '&&CCPARA.FREQ')
      PARAMETER   (CHOME2 = '&&CCPARA.OMEGA2')
      PARAMETER   (CHHARM = '&&CCPARA.NUME_MODE')
      PARAMETER   (CHVARC = '&&CCPARA.VARI_INT_N')
      PARAMETER   (CHVREF = '&&CCPARA.VARI_INT_REF')
      PARAMETER   (CHVAC2 = '&&CCPARA.VARI_INT_NM1')
      PARAMETER   (CHMASS = '&&CCPARA.MASS_MECA_D')
      PARAMETER   (CHNOVA = '&&CCPARA.NOM_VARI')
      PARAMETER   (CHSIGF = '&&CCPARA.CHAM_SI2D')
C
      DATA NOMCMP  /'INST    ','DELTAT  ','THETA   ','KHI     ',
     &              'R       ','RHO     '/
C
      CALL JENONU(JEXNOM('&CATA.OP.NOMOPT',OPTION),OPT)
      CALL JEVEUO(JEXNUM('&CATA.OP.DESCOPT',OPT),'L',IAOPDS)
      CALL JEVEUO(JEXNUM('&CATA.OP.LOCALIS',OPT),'L',IAOPLO)
      NPARIN = ZI(IAOPDS-1+2)
C
      RUNDF  = R8NNEM()
C
      CALL DISMOI('F','NOM_MAILLA',MODELE,'MODELE',IBID,MAILLA,IRET)
C
      IF (EXITIM) THEN
        CALL RSADPA(RESUIN,'L',1,'INST',NUMORD,0,JAINST,K8B)
        TIME = ZR(JAINST)
      ELSE
        TIME = ZERO
      ENDIF
      CALL VRCREF(MODELE,MATECO,CARAEL,CHVREF(1:19))
      CALL VRCINS(MODELE,MATECO,CARAEL,TIME,CHVARC(1:19),CHDRET)
C
      DO 10 IPARA = 1,NPARIN
        CURCHA = ZK24(IAOPLO+3*IPARA-2)
        IF ( CURCHA.EQ.CHTIME ) THEN
          CALL JENONU(JEXNOM(RESUIN//'           .NOVA','INST'),IRET)
          IF ( IRET.NE.0 ) THEN
            CALL RSADPA(RESUIN,'L',1,'INST',NUMORD,0,JAINST,K8B)
C
            TPS(1) = ZR(JAINST)
            TPS(2) = RUNDF
            TPS(3) = RUNDF
            TPS(4) = RUNDF
            TPS(5) = RUNDF
            TPS(6) = RUNDF
C
            CALL MECACT('V',CHTIME,'MAILLA',MAILLA,'INST_R',6,
     &                  NOMCMP,IBID,TPS,CBID,K8B)
          ENDIF
C
        ELSE IF ( CURCHA.EQ.CHFREQ ) THEN
          CALL JENONU(JEXNOM(RESUIN//'           .NOVA','FREQ'),IRET)
          IF ( IRET.NE.0 ) THEN
            CALL RSADPA(RESUIN,'L',1,'FREQ',NUMORD,0,JFREQ,K8B)
            FREQ = ZR(JFREQ)
          ELSE
            FREQ = 1.D0
          ENDIF
          CALL MECACT('V',CHFREQ,'MAILLA',MAILLA,'FREQ_R',1,
     &                'FREQ',IBID,FREQ,CBID,K8B)
C
        ELSE IF ( CURCHA.EQ.CHOME2 ) THEN
          CALL JENONU(JEXNOM(RESUIN//'           .NOVA','OMEGA2'),IRET)
          IF ( IRET.NE.0 ) THEN
            CALL RSADPA(RESUIN,'L',1,'OMEGA2',NUMORD,0,JFREQ,K8B)
            OMEGA2 = ZR(JFREQ)
          ELSE
            OMEGA2 = 1.0D0
          ENDIF
          CALL MECACT('V',CHOME2,'MAILLA',MAILLA,'OME2_R',1,
     &                'OMEG2',IBID,OMEGA2,CBID,K8B)
C
        ELSE IF ( CURCHA.EQ.CHHARM ) THEN
          CALL JENONU(JEXNOM(RESUIN//'           .NOVA','NUME_MODE'),
     &                IRET)
          IF ( IRET.NE.0 ) THEN
            CALL RSADPA(RESUIN,'L',1,'NUME_MODE',NUMORD,0,JNMO,K8B)
            CALL MECACT('V',CHHARM,'MAILLA',MAILLA,'HARMON',1,
     &                  'NH',ZI(JNMO),RBID,CBID,' ')
          ENDIF
C
        ELSE IF ( CURCHA.EQ.CHMASS ) THEN
          INUME=1
          CALL MECACT('V',CHMASS,'MAILLA',MAILLA,'POSI',1,'POS',INUME,
     &                RBID,CBID,K8B)
C
        ELSE IF ( CURCHA.EQ.CHVAC2 ) THEN
          IF (EXITIM) THEN
            CALL RSADPA(RESUIN,'L',1,'INST',NORDM1,0,JAINS2,K8B)
            TIME = ZR(JAINS2)
          ELSE
            TIME = ZERO
          ENDIF
          CALL VRCINS(MODELE,MATECO,CARAEL,TIME,CHVAC2(1:19),CHDRET)
C
        ELSE IF ( CURCHA.EQ.CHNOVA ) THEN
          CALL GETVTX(' ','NOM_VARI',0,IARG,1,VARI,IBID)
          CALL MECACT('V',CHNOVA,'MAILLA',MAILLA,'NEUT_K24',1,'Z1',
     &                IBID,RBID,CBID,VARI)
C
        ELSE IF ( CURCHA.EQ.CHSIGF ) THEN
          CALL RSEXCH(' ',RESUIN,'SIGM_ELNO',NUMORD,CHSIG,IRET)
          IF ( IRET.NE.0 ) THEN
            CALL RSEXCH('F',RESUOU,'SIGM_ELNO',NUMORD,CHSIG,IRET)
          ENDIF
          CALL MEARCC(OPTION,MODELE,CHSIG,CHSIGF)
C
        ENDIF
  10  CONTINUE
C
      END
