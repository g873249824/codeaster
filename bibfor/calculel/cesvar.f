      SUBROUTINE CESVAR(CARELE,COMPOR,LIGREL,DCEL)
      IMPLICIT NONE
      CHARACTER*(*) CARELE,COMPOR,LIGREL,DCEL
C ----------------------------------------------------------------------
C MODIF CALCULEL  DATE 16/06/2009   AUTEUR PELLET J.PELLET 
C ======================================================================
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.

C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.

C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE PELLET J.PELLET
C ----------------------------------------------------------------------
C  BUT : CREER UN CHAM_ELEM_S (DCEL_I) PERMETTANT D'ETENDRE LES
C        CHAM_ELEM(VARI_R) "OUT" DE CALCUL.

C  IN/JXIN  CARELE K19 : CARA_ELEM  (OU ' ')
C                        C'EST CARA_ELEM QUI PERMET LES SOUS-POINTS
C  IN/JXIN  COMPOR K19 : / CARTE DE COMPORTEMENT
C                        / ' '
C  IN/JXIN  LIGREL K19 : LIGREL SUR LEQUEL SERA FAIT LE CALCUL
C  IN/JXOUT DCEL   K19 : CHAM_ELEM_S(DCEL_I) CONTENANT LE NOMBRE
C                        REEL DE VARIABLES INTERNES (ET DE SOUS-POINT)
C                        (MAILLE PAR MAILLE)
C  REMARQUES :
C   1) CETTE SD EST NECESSAIRE POUR ALLOUER "AU PLUS PRES" LES CHAM_ELEM
C      "DYNAMIQUES" : SOUS-POINTS OU  VARIABLES INTERNES (VARI_R)
C   2) SI LE CARA_ELEM N'A PAS DE SOUS-POINTS ET QUE COMPOR EST ' '
C      DCEL EST QUAND MEME CREE : IL CONTIENT NBSP=1, NBCDYN=0
C ----------------------------------------------------------------------
      CHARACTER*8 CAREL2,LPAIN(2)
      CHARACTER*19 LCHIN(2)
      INTEGER NBCH,IRET
C-----------------------------------------------------------------------
      CAREL2 = CARELE

      NBCH=0
      IF (COMPOR.NE.' ') THEN
        NBCH=NBCH+1
        LPAIN(NBCH) = 'PCOMPOR'
        LCHIN(NBCH) = COMPOR
      END IF


      CALL JEEXIN(CAREL2//'.CANBSP    .CELD',IRET)
      IF (IRET.GT.0) THEN
        NBCH=NBCH+1
        LPAIN(NBCH) = 'PNBSP_I'
        LCHIN(NBCH) = CAREL2//'.CANBSP'
      END IF


      CALL CALCUL('S','NSPG_NBVA',LIGREL,NBCH,LCHIN,LPAIN,1,
     &            '&&CESVAR.DCEL','PDCEL_I','V')

      CALL CELCES('&&CESVAR.DCEL','V',DCEL)
      CALL DETRSD('CHAM_ELEM','&&CESVAR.DCEL')

      END
