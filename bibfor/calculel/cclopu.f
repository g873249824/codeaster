      SUBROUTINE CCLOPU(RESUCO,LISOPT,NBROPT)
      IMPLICIT NONE
      INTEGER      NBROPT
      CHARACTER*8  RESUCO
      CHARACTER*19 LISOPT
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 23/05/2011   AUTEUR SELLENET N.SELLENET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE SELLENET N.SELLENET
C ----------------------------------------------------------------------
C  CALC_CHAMP - DETERMINATION DE LA LISTE D'OPTIONS DE L'UTILISATEUR
C  -    -                           -       --           -
C ----------------------------------------------------------------------
C
C  ROUTINE SERVANT A RECUPERER LA LISTE D'OPTIONS DE CALC_CHAMP
C    SOUHAITEES PAR L'UTILISATEUR
C
C  LES OPTIONS SONT FOURNIES DANS DES MOTS-CLES FACTEURS :
C    - CONTRAINTE
C    - DEFORMATION
C    - ENERGIE
C    - CRITERES
C    - VARI_INTERNE
C    - HYDRAULIQUE
C    - THERMIQUE
C    - ACOUSTIQUE
C
C  LES INVARIANTS NE SONT PAS TRAITES PAR CETTE ROUTINE
C
C IN  :
C   RESUCO K8   NOM DE LA SD IN
C
C IN/OUT :
C   LISOPT K19  NOM DE LA LISTE D'OPTIONS
C
C OUT :
C   NBOPT  I    NOMBRE D'OPTIONS
C ----------------------------------------------------------------------
C   ----- DEBUT DECLARATIONS NORMALISEES  JEVEUX ---------------------
      INTEGER        ZI
      COMMON /IVARJE/ZI(1)
      REAL*8         ZR
      COMMON /RVARJE/ZR(1)
      COMPLEX*16     ZC
      COMMON /CVARJE/ZC(1)
      LOGICAL        ZL
      COMMON /LVARJE/ZL(1)
      CHARACTER*8    ZK8
      CHARACTER*16          ZK16
      CHARACTER*24                  ZK24
      CHARACTER*32                          ZK32
      CHARACTER*80                                  ZK80
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C     ----- FIN  DECLARATIONS  NORMALISEES  JEVEUX ---------------------
      INTEGER NTYMAX
      PARAMETER (NTYMAX = 8)
C
      INTEGER      ITYP,N1,JOPT,JOPTY,POSTMP,NBOPFA
C
      CHARACTER*8  K8B
      CHARACTER*12 TYPOPT,TYGROP(NTYMAX)
C
      DATA TYGROP  /'CONTRAINTE  ','DEFORMATION ','ENERGIE     ',
     &              'CRITERES    ','VARI_INTERNE','HYDRAULIQUE ',
     &              'THERMIQUE   ','ACOUSTIQUE  '/
C
      CALL JEMARQ()
C
C     PREMIERE BOUCLE POUR DETERMINER LE NOMBRE TOTAL D'OPTIONS
      CALL WKVECT('&&CCLOPU.NB_OP_TY','V V I',NTYMAX,JOPTY)
      NBROPT = 0
      DO 10 ITYP = 1,NTYMAX
        TYPOPT = TYGROP(ITYP)
C
        CALL GETVTX(' ',TYPOPT,1,1,0,K8B,N1)
        ZI(JOPTY+ITYP-1) = -N1
        NBROPT = NBROPT-N1
  10  CONTINUE
C
      CALL WKVECT(LISOPT,'V V K16',NBROPT,JOPT)
C
C     DEUXIEME BOUCLE POUR REMPLIR LE TABLEAU DES OPTIONS
      POSTMP = 0
      DO 20 ITYP = 1,NTYMAX
        TYPOPT = TYGROP(ITYP)
C
        NBOPFA = ZI(JOPTY+ITYP-1)
        IF ( NBOPFA.EQ.0 ) GOTO 20
C
        CALL GETVTX(' ',TYPOPT,1,1,NBOPFA,
     &              ZK16(JOPT+POSTMP),N1)
        POSTMP = POSTMP+NBOPFA
  20  CONTINUE
C
      CALL JEDETR('&&CCLOPU.NB_OP_TY')
      CALL JEDEMA()
C
      END
