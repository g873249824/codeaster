      SUBROUTINE VSDIDC(NOMZ,M80,NVU,NOBJ)

      IMPLICIT NONE
      CHARACTER*(*) NOMZ,M80
      INTEGER NVU,NOBJ
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF UTILITAI  DATE 05/02/2007   AUTEUR PELLET J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2007  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C ----------------------------------------------------------------------
C BUT : VERISD/INTERF_DYNA_CLAS
C ----------------------------------------------------------------------
C TOLE CRS_512
C     ----- DEBUT COMMUNS NORMALISES  JEVEUX  --------------------------
      INTEGER ZI
      COMMON /IVARJE/ZI(1)
      REAL*8 ZR
      COMMON /RVARJE/ZR(1)
      COMPLEX*16 ZC
      COMMON /CVARJE/ZC(1)
      LOGICAL ZL
      COMMON /LVARJE/ZL(1)
      CHARACTER*8 ZK8
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*32 ZK32
      CHARACTER*80 ZK80
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C     ----- FIN COMMUNS NORMALISES  JEVEUX  --------------------------
C -DEB------------------------------------------------------------------

      INTEGER         JREFE,JDESC,JDEFO,JNOEU,JFREQ,JLINO,JTYPE
      INTEGER         NBINT,NBTOT,NBEC,I,J,VERIOB,IER,LONG
      CHARACTER*8     NOM,K8BID
      CHARACTER*16    NOEUD
      CHARACTER*32    JEXNUM

      CALL JEMARQ()
      
      NOM=NOMZ(1:8)
      NOEUD='&&VSDIDC.NOEUD'


C---- 1.VERIFICATION DE L OBJET .IDC_REFE


      IER=VERIOB('O',NOM//'.IDC_REFE','EXIS_V',0,' ')
      IER=VERIOB('O',NOM//'.IDC_REFE','TYPE_K24',0,' ')
      IER=VERIOB('O',NOM//'.IDC_REFE','LONMAX',3,' ')

      CALL JEVEUO(NOM//'.IDC_REFE','L',JREFE)

C     NORMALEMENT LE PREMIER EST UN MAILLAGE
C     LE SECOND EST UN NUME_DDL
      CALL VERIJA('O','MAILLAGE',ZK24(JREFE),M80,NVU,NOBJ)
      CALL VERIJA('O','NUME_DDL',ZK24(JREFE+1),M80,NVU,NOBJ)

      CALL ASSERT(ZK24(JREFE+2)(1:24).EQ.'                       ')
      
C---- 2.VERIFICATION DE L OBJET .IDC_DESC

      
      IER=VERIOB('O',NOM//'.IDC_DESC','EXIS_V',0,' ')
      IER=VERIOB('O',NOM//'.IDC_DESC','TYPE_I',0,' ')
      IER=VERIOB('O',NOM//'.IDC_DESC','LONMAX',5,' ')
      CALL JEVEUO(NOM//'.IDC_DESC','L',JDESC)

      CALL ASSERT(ZI(JDESC).EQ.1)

C     NOMBRE D ENTIER CODES POUR STOCKER LA GRANDEUR (DEPL_R TOUJOURS)
      CALL ASSERT(ZI(JDESC+1).EQ.3)
      NBEC=ZI(JDESC+1)

C     NOMBRE DE COMPOSANTES MAXIMUM DE LA GRANDEUR
      CALL ASSERT(ZI(JDESC+2).EQ.87)

C     NUMERO DE LA GRANDEUR
      CALL ASSERT(ZI(JDESC+3).EQ.37)

C     NOMBRE DE DEFORMEE STATIQUE CALCULEE
      CALL ASSERT(ZI(JDESC+4).GT.0)

C---- 3.VERIFICATION DE L OBJET .IDC_DDAC

      IER=VERIOB('O',NOM//'.IDC_DDAC','EXIS_XD',0,' ')
      IER=VERIOB('O',NOM//'.IDC_DDAC','TYPE_I',0,' ')


C     RECUPERATION DU NOMBRE D INTERFACE ET VERIFICATION
      CALL JELIRA(NOM//'.IDC_DDAC','NUTIOC',NBINT,K8BID)
      CALL WKVECT(NOEUD,'V V I',NBINT,JNOEU)
C     BOUCLE DE VERIFICATION ET DE STOCKAGE DU NOMBRE DE NOEUD
C     POUR VERIFICATIONS ULTERIEURES     
      DO 10 I=1,NBINT
        CALL JELIRA(JEXNUM(NOM//'.IDC_DDAC',I),'LONMAX',LONG,K8BID)
        ZI(JNOEU-1+I)=LONG/NBEC
        CALL ASSERT(LONG.GT.0)
 10   CONTINUE
      
C---- 4.VERIFICATION DE L OBJET .IDC_DEFO
  
      IER=VERIOB('O',NOM//'.IDC_DEFO','EXIS_V',0,' ')
      IER=VERIOB('O',NOM//'.IDC_DEFO','TYPE_I',0,' ')
      
C     CALCUL DU NOMBRE DE NOEUD TOTAL (TOUT INTERFACE COMPRIS)
      NBTOT=0
      DO 20 I=1,NBINT
        NBTOT=NBTOT+ZI(JNOEU-1+I)
 20   CONTINUE

      IER=VERIOB('O',NOM//'.IDC_DEFO','LONMAX',(2+NBEC)*NBTOT,' ')
      CALL JEVEUO(NOM//'.IDC_DEFO','L',JDEFO)

      DO 30 I=1,NBTOT

C     DE 1 A NBTOT, IL S AGIT DU NUMERO ABSOLUE DU NOEUD (DONC >0)
      CALL ASSERT(ZI(JDEFO-1+I).GT.0)

C     DE NBTOT A 2*NBTOT, IL S AGIT DU PREMIER NUMERO D ORDRE 
C     DU NOEUD COURANT
 
      CALL ASSERT(ZI(JDEFO+NBTOT+I).GT.0)
      DO 40 J=1,I-1
        CALL ASSERT(ZI(JDEFO+NBTOT+I).NE.ZI(JDEFO+NBTOT+J))
40    CONTINUE

30    CONTINUE

C---- 5.VERIFICATION DE L OBJET .IDC_DY_FREQ

      IER=VERIOB('O',NOM//'.IDC_DY_FREQ','EXIS_V',0,' ')
      IER=VERIOB('O',NOM//'.IDC_DY_FREQ','TYPE_R',0,' ')
      IER=VERIOB('O',NOM//'.IDC_DY_FREQ','LONMAX',1,' ')
      CALL JEVEUO(NOM//'.IDC_DY_FREQ','L',JFREQ)
      
      CALL ASSERT(ZR(JFREQ).GT.0)



C---- 6.VERIFICATION DE L OBJET .IDC_LINO

      IER=VERIOB('O',NOM//'.IDC_LINO','EXIS_XD',0,' ')
      IER=VERIOB('O',NOM//'.IDC_LINO','TYPE_I',0,' ')
      IER=VERIOB('O',NOM//'.IDC_LINO','NUTIOC',NBINT,' ')
      
      DO 50 I=1,NBINT
        IER=VERIOB('O',JEXNUM(NOM//'.IDC_LINO',I),'LONMAX',
     &      ZI(JNOEU-1+I),' ')
        CALL JEVEUO(JEXNUM(NOM//'.IDC_LINO',I),'L',JLINO)
      
        DO 60 J=1,ZI(JNOEU-1+I)
          CALL ASSERT(ZI(JLINO-1+J).GT.0)
 60     CONTINUE
 50   CONTINUE

C---- 7.VERIFICATION DE L OBJET .IDC_NOMS

      IER=VERIOB('O',NOM//'.IDC_NOMS','EXIS_N',0,' ')
      IER=VERIOB('O',NOM//'.IDC_NOMS','TYPE_K8',0,' ')
      IER=VERIOB('O',NOM//'.IDC_NOMS','NOMUTI',NBINT,' ')
    
C---- 8.VERIFICATION DE L OBJET .IDC_TYPE

      IER=VERIOB('O',NOM//'.IDC_TYPE','EXIS_V',0,' ')
      IER=VERIOB('O',NOM//'.IDC_TYPE','TYPE_K8',0,' ')
      IER=VERIOB('O',NOM//'.IDC_TYPE','LONMAX',NBINT,' ')
      CALL JEVEUO(NOM//'.IDC_TYPE','L',JTYPE)

      DO 70 I=1,NBINT
       CALL ASSERT((ZK8(JTYPE-1+I).EQ.'MNEAL').OR.
     &             (ZK8(JTYPE-1+I).EQ.'CRAIGB').OR.
     &             (ZK8(JTYPE-1+I).EQ.'CB_HARMO').OR.
     &             (ZK8(JTYPE-1+I).EQ.'AUCUN'))
 70   CONTINUE

      CALL JEDEMA()
      END
