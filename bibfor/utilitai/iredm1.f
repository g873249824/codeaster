      SUBROUTINE IREDM1 ( MASSE, NOMA, BASEMO, NBMODE, NBMODS, IAMOR,
     &                    MASS , RIGI , AMORED, FREQ,
     &                    SMASS, SRIGI, SAMOR, CMASS, CRIGI, CAMOR )
      IMPLICIT NONE
      INCLUDE 'jeveux.h'
      CHARACTER*8        MASSE, NOMA, BASEMO
      REAL*8             MASS(*), RIGI(*), SMASS(*), SRIGI(*),
     &                   SAMOR(*), CMASS(*),CRIGI(*), CAMOR(*),
     &                   AMORED(*), FREQ(*)
C     ------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF UTILITAI  DATE 16/10/2012   AUTEUR DEVESA G.DEVESA 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C  TOLE CRP_20
C  ----
C              INTERFACE ASTER - MISS3D : PROCEDURE  IMPR_MACR_ELEM
C     ------------------------------------------------------------------
C
      INTEGER      APRNO, NBEC, GD, TABL(8), TAB2(8)
      CHARACTER*8  K8B, TYPI, IMPMOD, IMPMEC, INTERF, FORMIM
      CHARACTER*14 NUME
      CHARACTER*16 NOMCMD
      CHARACTER*24  MAGRMA, MANOMA, NPRNO
      CHARACTER*24 NOMCH0
      CHARACTER*80 TITRE
      LOGICAL      LAMOR
      INTEGER      IARG
C     ------------------------------------------------------------------
C
C-----------------------------------------------------------------------
      INTEGER I ,IADMO1 ,IADMO2 ,IAMOR ,IBID ,IC ,IDBASE 
      INTEGER IDDL ,IDDL0 ,IDGM ,IDGM2 ,IDGM3 ,IDGM4 ,IDGM5 
      INTEGER IDNO ,IE ,IFMIS ,II ,IJ ,IMESS ,IN 
      INTEGER INO ,INOE ,IPARNO ,IUNIFI ,J ,J2 ,JCOOR 
      INTEGER JTYP ,JVAL ,K ,L ,LDGM ,LDNM ,NB 
      INTEGER NBGR ,NBGR2 ,NBGR3 ,NBGR4 ,NBGR5 ,NBMA ,NBMA2 
      INTEGER NBMA3 ,NBMA4 ,NBMA5 ,NBMODE ,NBMODS ,NBMODT ,NBNO 
      INTEGER NBNOEU ,NBV ,NCMP ,NEC ,NEQ ,NF ,NI 
      INTEGER NM ,NN ,NTI ,NU 
      REAL*8 ZERO 
C-----------------------------------------------------------------------
      CALL JEMARQ()
      IMESS = IUNIFI('MESSAGE')
      ZERO = 0.D0
      NOMCH0 = '&&IREDM1.CHAMNO'
      MAGRMA = NOMA//'.GROUPEMA'
      MANOMA = NOMA//'.CONNEX'
      LAMOR = IAMOR .NE. 0
      CALL GETRES( K8B, K8B, NOMCMD )
      CALL GETVIS(' ','UNITE'     ,1,IARG,1,IFMIS ,NU)
      CALL ULOPEN( IFMIS,' ',' ','NEW','O')
      CALL GETVTX(' ','IMPR_MODE_STAT' ,1,IARG,1,IMPMOD,NI)
      CALL GETVTX(' ','IMPR_MODE_MECA' ,1,IARG,1,IMPMEC,NI)
      CALL GETVTX(' ','FORMAT_R',1,IARG,1,FORMIM,NF)
      CALL GETVTX(' ','SOUS_TITRE',1,IARG,1,TITRE ,NTI)
C
C
C     --- ON RECUPERE LE TYPE D'INTERFACE ---
C
      CALL JEVEUO(BASEMO//'           .REFD','L',JVAL)
      INTERF = ZK24(JVAL+4) (1:8)
      IF (INTERF.NE.' ') THEN
       CALL JEVEUO(INTERF//'.IDC_TYPE','L',JTYP)
       TYPI   = ZK8(JTYP)
      ELSE
       TYPI = 'CRAIGB'
      ENDIF
C
      WRITE(IMESS,'(1X,I6,1X,''MODES DYNAMIQUES'',1X,A8)') NBMODE,TYPI
      WRITE(IMESS,'(1X,I6,1X,''MODES STATIQUES'' ,2X,A8)') NBMODS,TYPI
C
      CALL DISMOI('F','NOM_NUME_DDL',MASSE,'MATR_ASSE',IBID ,NUME,IE)
      CALL DISMOI('F','NB_EQUA'     ,MASSE,'MATR_ASSE',NEQ   ,K8B,IE)
      CALL DISMOI('F','NB_NO_MAILLA',NOMA ,'MAILLAGE' ,NBNOEU,K8B,IE)
      CALL DISMOI('F','NUM_GD_SI'   ,NUME ,'NUME_DDL' ,GD    ,K8B,IE)
      IF (INTERF.EQ.' ') CALL VTCREB(NOMCH0, NUME, 'V', 'R', NEQ)
CCC
C     ----- DEBUT DES IMPRESSIONS DE MISS3D -----
CCC
C
      WRITE(IFMIS,1200) 'DYNA', NBMODE, TYPI
      WRITE(IFMIS,1200) 'STAT', NBMODS, TYPI
      NBMODT = NBMODE + NBMODS
C
      IF (NTI.NE.0) THEN
         WRITE(IFMIS,'(''TITRE'',/A80)') TITRE
         WRITE(IMESS,'(A80)') TITRE
      ENDIF
      CALL GETVEM(NOMA,'GROUP_MA',' ','GROUP_MA_INTERF',
     &          1,IARG,0,K8B,NBGR)
      NBGR = -NBGR
      CALL WKVECT('&&IREDM1.GROUP_SOLSTRU','V V K8',NBGR,IDGM)
      CALL GETVEM(NOMA,'GROUP_MA',' ','GROUP_MA_INTERF',
     &          1,IARG,NBGR,ZK8(IDGM),NBV)
      CALL GETVEM(NOMA,'GROUP_MA',' ','GROUP_MA_FLU_STR',
     &           1,IARG,0,K8B,NBGR2)
      NBGR2 = -NBGR2
      IF (NBGR2.EQ.0) THEN
       CALL WKVECT('&&IREDM1.GROUP_FLUSTRU','V V K8',1,IDGM2)
      ELSE
       CALL WKVECT('&&IREDM1.GROUP_FLUSTRU','V V K8',NBGR2,IDGM2)
      ENDIF
      CALL GETVEM(NOMA,'GROUP_MA',' ','GROUP_MA_FLU_STR',
     &           1,IARG,NBGR2,ZK8(IDGM2),NBV)
      CALL GETVEM(NOMA,'GROUP_MA',' ','GROUP_MA_FLU_SOL',
     &           1,IARG,0,K8B,NBGR3)
      NBGR3 = -NBGR3
      IF (NBGR3.EQ.0) THEN
       CALL WKVECT('&&IREDM1.GROUP_FLUSOL','V V K8',1,IDGM3)
      ELSE
       CALL WKVECT('&&IREDM1.GROUP_FLUSOL','V V K8',NBGR3,IDGM3)
      ENDIF
      CALL GETVEM(NOMA,'GROUP_MA',' ','GROUP_MA_FLU_SOL',
     &           1,IARG,NBGR3,ZK8(IDGM3),NBV)
      CALL GETVEM(NOMA,'GROUP_MA',' ','GROUP_MA_SOL_SOL',
     &           1,IARG,0,K8B,NBGR4)
      NBGR4 = -NBGR4
      IF (NBGR4.EQ.0) THEN
       CALL WKVECT('&&IREDM1.GROUP_LIBRE','V V K8',1,IDGM4)
      ELSE
       CALL WKVECT('&&IREDM1.GROUP_LIBRE','V V K8',NBGR4,IDGM4)
      ENDIF
      CALL GETVEM(NOMA,'GROUP_MA',' ','GROUP_MA_SOL_SOL',
     &           1,IARG,NBGR4,ZK8(IDGM4),NBV)
      CALL GETVEM(NOMA,'GROUP_MA',' ','GROUP_MA_CONTROL',
     &           1,IARG,0,K8B,NBGR5)
      NBGR5 = -NBGR5
      IF (NBGR5.EQ.0) THEN
       CALL WKVECT('&&IREDM1.GROUP_CONTROL','V V K8',1,IDGM5)
      ELSE
       CALL WKVECT('&&IREDM1.GROUP_CONTROL','V V K8',NBGR5,IDGM5)
      ENDIF
      CALL GETVEM(NOMA,'GROUP_MA',' ','GROUP_MA_CONTROL',
     &           1,IARG,NBGR5,ZK8(IDGM5),NBV)
C
C
C        TABLEAU DE PARTICIPATION DES NOEUDS DE L INTERFACE
C
      CALL WKVECT('&&IREDM1.PARNO','V V I',NBNOEU,IPARNO)
C
      NBMA = 0
      NBMA2 = 0
      NBMA3 = 0
      NBMA4 = 0
      NBMA5 = 0
      DO 70 I = 1,NBGR
         CALL JELIRA(JEXNOM(MAGRMA,ZK8(IDGM+I-1)),'LONUTI',NB,K8B)
         CALL JEVEUO(JEXNOM(MAGRMA,ZK8(IDGM+I-1)),'L',LDGM)
         NBMA = NBMA + NB
         DO 72 IN = 0,NB-1
           CALL JELIRA(JEXNUM(MANOMA,ZI(LDGM+IN)),'LONMAX',NM,K8B)
           IF (NM.NE.3.AND.NM.NE.4.AND.NM.NE.6.AND.NM.NE.8) THEN
             CALL U2MESS('F','UTILITAI2_36')
           ENDIF
           CALL JEVEUO(JEXNUM(MANOMA,ZI(LDGM+IN)),'L',LDNM)
           DO 74 NN = 1, NM
              INOE = ZI(LDNM+NN-1)
              ZI(IPARNO+INOE-1) = ZI(IPARNO+INOE-1) + 1
 74        CONTINUE
 72      CONTINUE
 70   CONTINUE
      DO 80 I = 1,NBGR2
         CALL JELIRA(JEXNOM(MAGRMA,ZK8(IDGM2+I-1)),'LONUTI',NB,K8B)
         CALL JEVEUO(JEXNOM(MAGRMA,ZK8(IDGM2+I-1)),'L',LDGM)
         NBMA2 = NBMA2 + NB
         DO 82 IN = 0,NB-1
           CALL JELIRA(JEXNUM(MANOMA,ZI(LDGM+IN)),'LONMAX',NM,K8B)
           IF (NM.NE.3.AND.NM.NE.4.AND.NM.NE.6.AND.NM.NE.8) THEN
             CALL U2MESS('F','UTILITAI2_37')
           ENDIF
           CALL JEVEUO(JEXNUM(MANOMA,ZI(LDGM+IN)),'L',LDNM)
           DO 84 NN = 1, NM
              INOE = ZI(LDNM+NN-1)
              ZI(IPARNO+INOE-1) = ZI(IPARNO+INOE-1) + 1
 84        CONTINUE
 82      CONTINUE
 80   CONTINUE
      DO 90 I = 1,NBGR3
         CALL JELIRA(JEXNOM(MAGRMA,ZK8(IDGM3+I-1)),'LONUTI',NB,K8B)
         CALL JEVEUO(JEXNOM(MAGRMA,ZK8(IDGM3+I-1)),'L',LDGM)
         NBMA3 = NBMA3 + NB
         DO 92 IN = 0,NB-1
           CALL JELIRA(JEXNUM(MANOMA,ZI(LDGM+IN)),'LONMAX',NM,K8B)
           IF (NM.NE.3.AND.NM.NE.4.AND.NM.NE.6.AND.NM.NE.8) THEN
             CALL U2MESS('F','UTILITAI2_38')
           ENDIF
           CALL JEVEUO(JEXNUM(MANOMA,ZI(LDGM+IN)),'L',LDNM)
           DO 94 NN = 1, NM
              INOE = ZI(LDNM+NN-1)
              ZI(IPARNO+INOE-1) = ZI(IPARNO+INOE-1) + 1
 94        CONTINUE
 92      CONTINUE
 90   CONTINUE
      DO 100 I = 1,NBGR4
         CALL JELIRA(JEXNOM(MAGRMA,ZK8(IDGM4+I-1)),'LONUTI',NB,K8B)
         CALL JEVEUO(JEXNOM(MAGRMA,ZK8(IDGM4+I-1)),'L',LDGM)
         NBMA4 = NBMA4 + NB
         DO 102 IN = 0,NB-1
           CALL JELIRA(JEXNUM(MANOMA,ZI(LDGM+IN)),'LONMAX',NM,K8B)
           IF (NM.NE.3.AND.NM.NE.4.AND.NM.NE.6.AND.NM.NE.8) THEN
             CALL U2MESS('F','UTILITAI2_39')
           ENDIF
           CALL JEVEUO(JEXNUM(MANOMA,ZI(LDGM+IN)),'L',LDNM)
           DO 104 NN = 1, NM
              INOE = ZI(LDNM+NN-1)
              ZI(IPARNO+INOE-1) = ZI(IPARNO+INOE-1) + 1
 104       CONTINUE
 102     CONTINUE
 100  CONTINUE
      DO 110 I = 1,NBGR5
         CALL JELIRA(JEXNOM(MAGRMA,ZK8(IDGM5+I-1)),'LONUTI',NB,K8B)
         CALL JEVEUO(JEXNOM(MAGRMA,ZK8(IDGM5+I-1)),'L',LDGM)
         NBMA5 = NBMA5 + NB
         DO 112 IN = 0,NB-1
           CALL JEVEUO(JEXNUM(MANOMA,ZI(LDGM+IN)),'L',LDNM)
           INOE = ZI(LDNM)
           ZI(IPARNO+INOE-1) = ZI(IPARNO+INOE-1) + 1
 112     CONTINUE
 110  CONTINUE
C
      NBNO = 0
      DO 105 IJ = 1, NBNOEU
         IF (ZI(IPARNO+IJ-1).EQ.0) GOTO 105
         NBNO = NBNO + 1
 105  CONTINUE
C
      CALL WKVECT('&&IREDM1.NOEUD','V V I',NBNO,IDNO)
      II = 0
      DO 106 IJ = 1, NBNOEU
         IF (ZI(IPARNO+IJ-1).EQ.0) GOTO 106
         II = II + 1
         ZI(IDNO+II-1) = IJ
 106  CONTINUE
C
C
C     --- ECRITURE DESCRIPTION NOEUDS STRUCTURE ---
      CALL JEVEUO(NOMA//'.COORDO    .VALE','L',JCOOR)
      NPRNO = NUME//'.NUME.PRNO'
      CALL JENONU(JEXNOM(NPRNO(1:19)//'.LILI','&MAILLA'),IBID)
      CALL JEVEUO(JEXNUM(NPRNO,IBID),'L',APRNO)
      NEC = NBEC(GD)
      WRITE(IMESS,'(1X,I6,1X,''NOEUDS'')') NBNO
      WRITE(IFMIS,'(''NOEU'',1X,I6)') NBNO
      DO 40 INO = 1,NBNO
         INOE = ZI(IDNO+INO-1)
         NCMP = ZI( APRNO + (NEC+2)*(INOE-1) + 2 - 1 )
         WRITE(IFMIS,'(3(1X,1PE12.5))')
     &                ( ZR(JCOOR+3*(INOE-1)+IN-1) , IN=1,3    )
 40   CONTINUE
      WRITE(IMESS,'(1X,I6,1X,''ELEMENTS SOLSTRU'')') NBMA
      WRITE(IFMIS,'(''ELEM'',1X,I6)') NBMA
      DO 21 I = 1,NBGR
         CALL JELIRA(JEXNOM(MAGRMA,ZK8(IDGM+I-1)),'LONUTI',NB,K8B)
         CALL JEVEUO(JEXNOM(MAGRMA,ZK8(IDGM+I-1)),'L',LDGM)
         DO 23 IN = 0,NB-1
           DO 26 K = 1, 8
              TABL(K) = 0
              TAB2(K) = 0
 26        CONTINUE
           CALL JELIRA(JEXNUM(MANOMA,ZI(LDGM+IN)),'LONMAX',NM,K8B)
           CALL JEVEUO(JEXNUM(MANOMA,ZI(LDGM+IN)),'L',LDNM)
           DO 25 NN = 1, NM
             DO 27 IJ = 1, NBNO
               IF (ZI(LDNM+NN-1).EQ.ZI(IDNO+IJ-1)) TAB2(NN) = IJ
 27          CONTINUE
           IF (NM.LE.4) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.6.AND.NN.LE.3) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.6.AND.NN.GT.3) TABL(2*NN-NM) = TAB2(NN)
           IF (NM.EQ.8.AND.NN.LE.4) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.8.AND.NN.GT.4) TABL(2*NN-NM) = TAB2(NN)
 25        CONTINUE
           WRITE(IFMIS,'(8(1X,I6))') (TABL(K),K=1,8)
 23      CONTINUE
 21   CONTINUE
      WRITE(IMESS,'(1X,I6,1X,''ELEMENTS FLUSTRU'')') NBMA2
      IF (NBMA2.NE.0) WRITE(IFMIS,'(''ELEM'',1X,I6)') NBMA2
      DO 121 I = 1,NBGR2
         CALL JELIRA(JEXNOM(MAGRMA,ZK8(IDGM2+I-1)),'LONUTI',NB,K8B)
         CALL JEVEUO(JEXNOM(MAGRMA,ZK8(IDGM2+I-1)),'L',LDGM)
         DO 123 IN = 0,NB-1
           DO 126 K = 1, 8
              TABL(K) = 0
              TAB2(K) = 0
 126       CONTINUE
           CALL JELIRA(JEXNUM(MANOMA,ZI(LDGM+IN)),'LONMAX',NM,K8B)
           CALL JEVEUO(JEXNUM(MANOMA,ZI(LDGM+IN)),'L',LDNM)
           DO 125 NN = 1, NM
             DO 127 IJ = 1, NBNO
               IF (ZI(LDNM+NN-1).EQ.ZI(IDNO+IJ-1)) TAB2(NN) = IJ
 127         CONTINUE
           IF (NM.LE.4) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.6.AND.NN.LE.3) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.6.AND.NN.GT.3) TABL(2*NN-NM) = TAB2(NN)
           IF (NM.EQ.8.AND.NN.LE.4) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.8.AND.NN.GT.4) TABL(2*NN-NM) = TAB2(NN)
 125       CONTINUE
           WRITE(IFMIS,'(8(1X,I6))') (TABL(K),K=1,8)
 123     CONTINUE
 121  CONTINUE
      WRITE(IMESS,'(1X,I6,1X,''ELEMENTS FLUSOL'')') NBMA3
      IF (NBMA3.NE.0) WRITE(IFMIS,'(''ELEM'',1X,I6)') NBMA3
      DO 131 I = 1,NBGR3
         CALL JELIRA(JEXNOM(MAGRMA,ZK8(IDGM3+I-1)),'LONUTI',NB,K8B)
         CALL JEVEUO(JEXNOM(MAGRMA,ZK8(IDGM3+I-1)),'L',LDGM)
         DO 133 IN = 0,NB-1
           DO 136 K = 1, 8
              TABL(K) = 0
              TAB2(K) = 0
 136       CONTINUE
           CALL JELIRA(JEXNUM(MANOMA,ZI(LDGM+IN)),'LONMAX',NM,K8B)
           CALL JEVEUO(JEXNUM(MANOMA,ZI(LDGM+IN)),'L',LDNM)
           DO 135 NN = 1, NM
             DO 137 IJ = 1, NBNO
               IF (ZI(LDNM+NN-1).EQ.ZI(IDNO+IJ-1)) TAB2(NN) = IJ
 137         CONTINUE
           IF (NM.LE.4) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.6.AND.NN.LE.3) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.6.AND.NN.GT.3) TABL(2*NN-NM) = TAB2(NN)
           IF (NM.EQ.8.AND.NN.LE.4) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.8.AND.NN.GT.4) TABL(2*NN-NM) = TAB2(NN)
 135       CONTINUE
           WRITE(IFMIS,'(8(1X,I6))') (TABL(K),K=1,8)
 133     CONTINUE
 131  CONTINUE
      WRITE(IMESS,'(1X,I6,1X,''ELEMENTS LIBRE'')') NBMA4
      IF (NBMA4.NE.0) WRITE(IFMIS,'(''ELEM'',1X,I6)') NBMA4
      DO 141 I = 1,NBGR4
         CALL JELIRA(JEXNOM(MAGRMA,ZK8(IDGM4+I-1)),'LONUTI',NB,K8B)
         CALL JEVEUO(JEXNOM(MAGRMA,ZK8(IDGM4+I-1)),'L',LDGM)
         DO 143 IN = 0,NB-1
           DO 146 K = 1, 8
              TABL(K) = 0
              TAB2(K) = 0
 146       CONTINUE
           CALL JELIRA(JEXNUM(MANOMA,ZI(LDGM+IN)),'LONMAX',NM,K8B)
           CALL JEVEUO(JEXNUM(MANOMA,ZI(LDGM+IN)),'L',LDNM)
           DO 145 NN = 1, NM
             DO 147 IJ = 1, NBNO
               IF (ZI(LDNM+NN-1).EQ.ZI(IDNO+IJ-1)) TAB2(NN) = IJ
 147         CONTINUE
           IF (NM.LE.4) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.6.AND.NN.LE.3) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.6.AND.NN.GT.3) TABL(2*NN-NM) = TAB2(NN)
           IF (NM.EQ.8.AND.NN.LE.4) TABL(2*NN-1) = TAB2(NN)
           IF (NM.EQ.8.AND.NN.GT.4) TABL(2*NN-NM) = TAB2(NN)
 145       CONTINUE
           WRITE(IFMIS,'(8(1X,I6))') (TABL(K),K=1,8)
 143     CONTINUE
 141  CONTINUE
      WRITE(IMESS,'(1X,I6,1X,''POINTS CONTROLE'')') NBMA5
      IF (NBMA5.NE.0) WRITE(IFMIS,'(''POINT'',1X,I6)') NBMA5
      DO 151 I = 1,NBGR5
         CALL JELIRA(JEXNOM(MAGRMA,ZK8(IDGM5+I-1)),'LONUTI',NB,K8B)
         CALL JEVEUO(JEXNOM(MAGRMA,ZK8(IDGM5+I-1)),'L',LDGM)
         DO 153 IN = 0,NB-1
           CALL JEVEUO(JEXNUM(MANOMA,ZI(LDGM+IN)),'L',LDNM)
           DO 157 IJ = 1, NBNO
             IF (ZI(LDNM).EQ.ZI(IDNO+IJ-1)) INOE = IJ
 157       CONTINUE
           WRITE(IFMIS,'(1X,I6)') INOE
 153     CONTINUE
 151  CONTINUE
C
      CALL WKVECT('&&IREDM1.BASEMO','V V R',NBMODT*NEQ,IDBASE)
      CALL COPMO2(BASEMO,NEQ,NUME,NBMODT,ZR(IDBASE))
C
C --- ALLOCATION VECTEUR DE TRAVAIL
C
      CALL WKVECT('&&IREDM1.VECT1','V V R',NEQ,IADMO1)
      CALL WKVECT('&&IREDM1.VECT2','V V R',NEQ,IADMO2)
C
      IF ( TYPI(1:5).NE.'CRAIG' .OR. IMPMEC.EQ.'OUI' ) THEN
         DO 50 J = 1,NBMODE
            CALL DCOPY(NEQ,ZR(IDBASE+(J-1)*NEQ),1,ZR(IADMO1),1)
            WRITE(IFMIS,'(''MODE DYNA INTER'',1X,I6)') J
            DO 52 INO = 1,NBNO
               INOE = ZI(IDNO+INO-1)
               IDDL = ZI( APRNO + (NEC+2)*(INOE-1) + 1 - 1 ) - 1
               NCMP = ZI( APRNO + (NEC+2)*(INOE-1) + 2 - 1 )
               IDDL0 = IDDL+1
               IF (IDDL0.EQ.0) THEN
                WRITE(IFMIS,1100) ZERO,ZERO,ZERO,ZERO,ZERO,ZERO
               ELSE
                WRITE(IFMIS,1100) ( ZR(IADMO1+IDDL+IC-1), IC=1,NCMP )
               ENDIF
 52         CONTINUE
 50      CONTINUE
      ENDIF

      IF (FORMIM.EQ.'1PE16.9') THEN
       WRITE(IFMIS,1000) 'DYNA FREQ', ( FREQ(K) , K=1,NBMODE )
       WRITE(IFMIS,1000) 'DYNA AMOR', ( AMORED(K) , K=1,NBMODE )
       WRITE(IFMIS,1000) 'DYNA MASS',(MASS(K+(K-1)*NBMODE), K=1,NBMODE)
       WRITE(IFMIS,1000) 'DYNA RIGI',(RIGI(K+(K-1)*NBMODE), K=1,NBMODE)
      ELSE
       WRITE(IFMIS,1300) 'DYNA FREQ', ( FREQ(K) , K=1,NBMODE )
       WRITE(IFMIS,1300) 'DYNA AMOR', ( AMORED(K) , K=1,NBMODE )
       WRITE(IFMIS,1300) 'DYNA MASS',(MASS(K+(K-1)*NBMODE), K=1,NBMODE)
       WRITE(IFMIS,1300) 'DYNA RIGI',(RIGI(K+(K-1)*NBMODE), K=1,NBMODE)
      ENDIF
C
      IF ( TYPI(1:5).NE.'CRAIG' .OR. IMPMOD.EQ.'OUI' ) THEN
         DO 60 J = 1,NBMODS
            J2 = J + NBMODE
            CALL DCOPY(NEQ,ZR(IDBASE+(J2-1)*NEQ),1,ZR(IADMO2),1)
            WRITE(IFMIS,'(''MODE STAT INTER'',1X,I6)') J
            DO 62 INO = 1,NBNO
               INOE = ZI(IDNO+INO-1)
               IDDL = ZI( APRNO + (NEC+2)*(INOE-1) + 1 - 1 ) - 1
               NCMP = ZI( APRNO + (NEC+2)*(INOE-1) + 2 - 1 )
               IDDL0 = IDDL+1
               IF (IDDL0.EQ.0) THEN
                WRITE(IFMIS,1100) ZERO,ZERO,ZERO,ZERO,ZERO,ZERO
               ELSE
                WRITE(IFMIS,1100) ( ZR(IADMO2+IDDL+IC-1) , IC=1,NCMP )
               ENDIF
 62         CONTINUE
 60      CONTINUE
      ENDIF
      IF (FORMIM.EQ.'1PE16.9') THEN
       WRITE(IFMIS,1000) 'STAT MASS',
     &               ((SMASS(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODS)
       WRITE(IFMIS,1000) 'STAT RIGI' ,
     &               ((SRIGI(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODS)
       IF ( LAMOR ) WRITE(IFMIS,1000) 'STAT AMOR' ,
     &               ((SAMOR(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODS)
       WRITE(IFMIS,'(''COUPL'',2(1X,I6))') NBMODE,NBMODS
       WRITE(IFMIS,1000) 'COUPL MASS' ,
     &               ((CMASS(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODE)
       WRITE(IFMIS,1000) 'COUPL RIGI' ,
     &               ((CRIGI(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODE)
       IF ( LAMOR ) WRITE(IFMIS,1000) 'COUPL AMOR' ,
     &               ((CAMOR(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODE)
      ELSE
       WRITE(IFMIS,1300) 'STAT MASS',
     &               ((SMASS(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODS)
       WRITE(IFMIS,1300) 'STAT RIGI' ,
     &               ((SRIGI(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODS)
       IF ( LAMOR ) WRITE(IFMIS,1300) 'STAT AMOR' ,
     &               ((SAMOR(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODS)
       WRITE(IFMIS,'(''COUPL'',2(1X,I6))') NBMODE,NBMODS
       WRITE(IFMIS,1300) 'COUPL MASS' ,
     &               ((CMASS(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODE)
       WRITE(IFMIS,1300) 'COUPL RIGI' ,
     &               ((CRIGI(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODE)
       IF ( LAMOR ) WRITE(IFMIS,1300) 'COUPL AMOR' ,
     &               ((CAMOR(K+(L-1)*NBMODS),K=1,NBMODS),L=1,NBMODE)
      ENDIF
C
      IF (FORMIM.EQ.'1PE16.9') THEN
         WRITE(IFMIS,'(A)') 'FORMAT_REAL_LONG'
      ELSE
         WRITE(IFMIS,'(A)') 'FORMAT_REAL_COURT'
      ENDIF

CCC
C     ----- FIN DES IMPRESSIONS DE MISS3D -----
CCC
C
 1000 FORMAT(A,/,4(2X,1P,D16.9) )
 1100 FORMAT( 6(1X,1P,D12.5) )
 1200 FORMAT( A4, 1X, I6, 1X, A8 )
 1300 FORMAT(A,/,6(1X,1P,D12.5) )
C
C
C --- MENAGE
C
      CALL DETRSD('CHAM_NO','&&IREDM1.CHAMNO')
      CALL JEDETR('&&IREDM1.GROUP_SOLSTRU')
      CALL JEDETR('&&IREDM1.GROUP_FLUSTRU')
      CALL JEDETR('&&IREDM1.GROUP_FLUSOL')
      CALL JEDETR('&&IREDM1.GROUP_LIBRE')
      CALL JEDETR('&&IREDM1.GROUP_CONTROL')
      CALL JEDETR('&&IREDM1.PARNO')
      CALL JEDETR('&&IREDM1.NOEUD')
      CALL JEDETR('&&IREDM1.BASEMO')
      CALL JEDETR('&&IREDM1.VECT1')
      CALL JEDETR('&&IREDM1.VECT2')
C
      CALL JEDEMA()
      END
