      SUBROUTINE FOLENA
     +               ( NOMCMD,NPS,VAR,NBPARA,PARA,SPECTR,IER)
      IMPLICIT REAL*8 (A-H,O-Z)
      INTEGER            NPS,    NBPARA
      REAL*8                   VAR(*),  PARA(*),SPECTR(NPS,*)
      CHARACTER*16     NOMCMD
C     ------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF UTILITAI  DATE 08/03/2004   AUTEUR REZETTE C.REZETTE 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C     LECTURE D'UN SPECTRE D'OSCILLATEUR  /NORME SISPOU/
C     ------------------------------------------------------------------
C IN  NOMCMD : K16 : NOM DE LA COMMANDE
C IN  NPS    : I   : NOMBRE DE POINT PAR FONCTION
C IN  NBPARA : I   : NOMBRE DE PARAMETRE
C OUT PARA   : R   : LISTE DES VALEURS DES PARAMETRES
C OUT VAR    : R   : LISTE DES VALEURS DES FONCTIONS
C OUT SPECTR : R   : LISTE DES VALEURS DU SPECTRE
C     ----------------------------------------------------------------
C
C     LA LECTURE SE FAIT OBLIGATOIREMENT EN FORMAT LIBRE 
C      (BLANC SEPARATEUR)
C     A RAISON DE NBPARA PAR LIGNE
C
      CHARACTER*80 CVAL
      REAL*8       RVAL
C
C
    1 CONTINUE
      CALL LXLIRE(ICLASS,IVAL,RVAL,CVAL)  
      IF ( ICLASS .EQ. -1 ) THEN
        IER = IER + 1
        CALL UTMESS('E',NOMCMD//'(ERREUR 43)',
     +                              'FIN PREMATUREE DU FICHIER.')
        GOTO 2
      ELSE
        DO 10 IPARA = 1 , NBPARA
           CALL LXLIRE(ICLASS,IVAL,RVAL,CVAL)
           PARA(IPARA) = RVAL
   10   CONTINUE
      ENDIF
C
      DO 100 IPT = 1,NPS
        CALL LXLIRE(ICLASS,IVAL,RVAL,CVAL) 
        IF ( ICLASS .EQ. -1 ) THEN
          IER = IER + 1
          CALL UTMESS('E',NOMCMD//'(ERREUR 43)',
     +                              'FIN PREMATUREE DU FICHIER.')
          GOTO 2
        ELSEIF ( ICLASS .NE. 2  ) THEN
          IER = IER + 1
          CALL UTMESS('E',NOMCMD//'(ERREUR 45)',
     +                      'ON ATTENDAIT UN REEL.')
          GOTO 1
        ELSE
          VAR(IPT) = RVAL
          DO 15 IPARA = 1 , NBPARA
            CALL LXLIRE(ICLASS,IVAL,RVAL,CVAL) 
            SPECTR(IPT,IPARA) = RVAL
   15     CONTINUE
        ENDIF
  100 CONTINUE
C
    2 CONTINUE
C
      END
