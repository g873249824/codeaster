# MODIF  DATE 15/01/2013   AUTEUR LADIER A.LADIER 
# TITRE Zmat en grandes deformations, test de cisaillement simple
# zmat009a.para = tps_job 60 mem_job 768Mo ncpus 1 liste_test Z
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================

DEBUT(CODE=_F(NOM='ZMAT009A',NIV_PUB_WEB='INTERNET',),DEBUG=_F(SDVERI='OUI',),);

MA=LIRE_MAILLAGE();

modele=AFFE_MODELE(MAILLAGE=MA,
                   AFFE=_F(TOUT='OUI',
                           PHENOMENE='MECANIQUE',
                           MODELISATION='3D',),);

acier=DEFI_MATERIAU(ELAS=_F(E=2000000.0,
                            NU=0.,),);

mat=AFFE_MATERIAU(MAILLAGE=MA,
                  AFFE=_F(TOUT='OUI',
                          MATER=acier,),);

L_inst=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=_F(JUSQU_A=10.0,
                                    PAS=0.1,),);


F_cis=DEFI_FONCTION(NOM_PARA='INST',VALE=(0.0,0.0,
                          10.0,10.0,
                          ),);

DEP=AFFE_CHAR_MECA(MODELE=modele,
                   FACE_IMPO=_F(MAILLE='M1',
                                DX=1.0,
                                DY=0.0,
                                DZ=0.0,),);

clim_cis=AFFE_CHAR_MECA(MODELE=modele,
                        DDL_IMPO=_F(MAILLE='M2',
                                    DX=0.0,
                                    DY=0.0,
                                    DZ=0.0,),);

#-------------------------ZMAT:Lagrange_Rotate--------------------------------

RES_ZR=STAT_NON_LINE(MODELE=modele,
                   CHAM_MATER=mat,
                   EXCIT=(_F(CHARGE=DEP,
                             FONC_MULT=F_cis,),
                          _F(CHARGE=clim_cis,),),
                   COMP_INCR=_F(RELATION='ZMAT',
                                             UNITE=33,
                                                  NB_VARI=34,
                              DEFORMATION='GDEF_HYPO_ELAS',),
                   INCREMENT=_F(LIST_INST=L_inst,
                                NUME_INST_INIT=0,
                                NUME_INST_FIN=100,),
                   NEWTON=_F(REAC_INCR=1,
                             MATRICE='TANGENTE',
                             REAC_ITER=1,),);


SXZ_ZR=RECU_FONCTION(RESULTAT=RES_ZR,PROL_DROITE='CONSTANT',PROL_GAUCHE='CONSTANT',
                    NOM_CHAM='SIEF_ELGA',
                    NOM_CMP='SIXZ',
                    MAILLE='M3',
                    POINT=8,);
                    
SXX_ZR=RECU_FONCTION(RESULTAT=RES_ZR,PROL_DROITE='CONSTANT',PROL_GAUCHE='CONSTANT',
                    NOM_CHAM='SIEF_ELGA',
                    NOM_CMP='SIXX',
                    MAILLE='M3',
                    POINT=8,);
                    
dx=RECU_FONCTION(RESULTAT=RES_ZR,
                 NOM_CHAM='DEPL',
                 NOM_CMP='DX',
                 NOEUD='N6',);
                 
                 

# Solution analytique                 
def S12(DX) :
   C=100.
   D=1.
   R=200.
   gamma=DX
   Ed=exp(-D* gamma / sqrt(3.)) 
   s12=C/3. * Ed * sin (gamma)
   s12=s12+C*D*(1- Ed*(cos(gamma)+D*sin(gamma)/sqrt(3.)))/sqrt(3.)/(D**2+3.)
   s12=s12+ R/sqrt(3.)
   return s12                 

# Solution analytique                 
def S11(DX) :
   C=100.
   D=1.
   R=200.
   gamma=DX
   Ed=exp(-D* gamma / sqrt(3.)) 
   s11=C/3.*(1- Ed*(cos(gamma)+D*sin(gamma)/sqrt(3.)))
   return s11                 

LDX=DEFI_LIST_REEL(DEBUT=0.0,INTERVALLE=_F(JUSQU_A=10.0,PAS=0.01,),);

S11A=FORMULE(NOM_PARA='DX',VALE='S11(DX)')
S11B=CALC_FONC_INTERP(FONCTION=S11A,LIST_PARA=LDX,NOM_PARA='DX',INTERPOL='LIN',PROL_DROITE='CONSTANT',PROL_GAUCHE='CONSTANT')

S12A=FORMULE(NOM_PARA='DX',VALE='S12(DX)')
S12B=CALC_FONC_INTERP(FONCTION=S12A,LIST_PARA=LDX,NOM_PARA='DX',INTERPOL='LIN',PROL_DROITE='CONSTANT',PROL_GAUCHE='CONSTANT')

TEST_FONCTION(VALEUR=(_F(VALE_CALC=136.643938819,
                         VALE_REFE=S12A(1.),
                         VALE_PARA=1.0,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=0.070000000000000007,
                         NOM_PARA='DX',
                         FONCTION=SXZ_ZR,),
                      _F(VALE_CALC=138.254002454,
                         VALE_REFE=S12A(2.),
                         VALE_PARA=2.0,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=0.080000000000000002,
                         NOM_PARA='DX',
                         FONCTION=SXZ_ZR,),
                      _F(VALE_CALC=132.271594286,
                         VALE_REFE=S12A(3.),
                         VALE_PARA=3.0,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=0.040000000000000001,
                         NOM_PARA='DX',
                         FONCTION=SXZ_ZR,),
                      _F(VALE_CALC=128.052010864,
                         VALE_REFE=S12A(4.),
                         VALE_PARA=4.0,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=1.E-2,
                         NOM_PARA='DX',
                         FONCTION=SXZ_ZR,),
                      _F(VALE_CALC=127.397633165,
                         VALE_REFE=S12A(5.),
                         VALE_PARA=5.0,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=1.E-2,
                         NOM_PARA='DX',
                         FONCTION=SXZ_ZR,),
                      _F(VALE_CALC=128.36915231,
                         VALE_REFE=S12A(6.),
                         VALE_PARA=6.0,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=1.E-2,
                         NOM_PARA='DX',
                         FONCTION=SXZ_ZR,),
                      _F(VALE_CALC=129.181937742,
                         VALE_REFE=S12A(7.),
                         VALE_PARA=7.0,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=1.E-2,
                         NOM_PARA='DX',
                         FONCTION=SXZ_ZR,),
                      _F(VALE_CALC=129.366907406,
                         VALE_REFE=S12A(8.),
                         VALE_PARA=8.0,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=1.E-2,
                         NOM_PARA='DX',
                         FONCTION=SXZ_ZR,),
                      _F(VALE_CALC=129.21615733,
                         VALE_REFE=S12A(9.),
                         VALE_PARA=9.0,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=1.E-2,
                         NOM_PARA='DX',
                         FONCTION=SXZ_ZR,),
                      _F(VALE_CALC=129.062829323,
                         VALE_REFE=S12A(10.),
                         VALE_PARA=10.0,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=1.E-2,
                         NOM_PARA='DX',
                         FONCTION=SXZ_ZR,),
                      ),
              )

#-------------------------impression--------------------------------
IMPR_FONCTION(COURBE=(_F(FONC_X=dx,
                         FONC_Y=SXZ_ZR),
                      _F(FONCTION=S12B,
                         LEGENDE='SXZ_Analytique',),
                         ),)


DEFI_FICHIER(UNITE=38,
             FICHIER='./REPE_OUT/zmat_sigma13_DX_plas.agr',);

IMPR_FONCTION(FORMAT='XMGRACE',
              UNITE=38,
              COURBE=(
                      _F(FONC_X=dx,
                         FONC_Y=SXZ_ZR,
                         LEGENDE='SXZ_Lagrange_Rotate',),
                      _F(FONCTION=S12B,
                         LEGENDE='SXZ_Analytique',),
                      _F(FONC_X=dx,
                         FONC_Y=SXX_ZR,
                         LEGENDE='SXX_Lagrange_Rotate',),
                      _F(FONCTION=S11B,
                         LEGENDE='SXX_Analytique',),
                         ),
              TITRE='CONTRAINTE DE CAUCHY CISAILLEMENT SIMPLE',
              LEGENDE_X='DX',
              LEGENDE_Y='SXZ-SXX',);

DEFI_FICHIER(ACTION='LIBERER',
             UNITE=38,);
             
IMPR_RESU(RESU=_F(RESULTAT=RES_ZR))

FIN();
