# TITRE VALIDATION ARCHITECTURE D'UN CALCUL FETI + CONTACT CONTINUE
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# (CAS 2)
# ======================================================================
# PLAQUE 2D MODELISEE VIA 24 TRIA3 ET DECOUPEE EN 2 SOUS-DOMAINES
# EN PAPILLON AVEC UN NOEUD CENTRAL DE MULTIPLICITE 2.
# TEST INFORMATIQUE DU SOLVEUR FETI-1 AVEC LA METHODE DE CONTACT CONTINU
# LE PARTITIONNEMENT EN SOUS-DOMAINES EST MANUEL.
# LE SOUS-DOMAINE 1 EST RESPONSABLE DES 2 ZONES DE CONTACT.
# LE SOUS-DOMAINE 2 N'EST PAS CONCERNE PAR LE CONTACT.
# LES SOUS-DOMAINES SONT EN 2 PARTIES QUASI-NON CONNEXES
# (ELLES NE SE TOUCHENT QU'AU POINT N3, D'OU LE PAPILLON !)
# LES ZONES DE CONTACT NE TOUCHENT PAS L'INTERFACE.
# MEME CAS QUE FETI008A MAIS AVEC UN DECOUPAGE DIFFERENT.
# PARALLELE: VALEUR CONSEILLEE 2 PROCS.
# ======================================================================
# person_in_charge: olivier.boiteau at edf.fr

DEBUT(CODE=_F(NOM='FETI008B',NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

MATER=DEFI_MATERIAU(
           ELAS=_F(E = 180000., NU = 0.30, ALPHA = 15.E-6, RHO = 7700.,))
MAIL=LIRE_MAILLAGE(FORMAT='MED',)
MODM=AFFE_MODELE(MAILLAGE=MAIL,
                 AFFE=(_F(GROUP_MA = 'STRU',PHENOMENE = 'MECANIQUE',
                          MODELISATION = 'D_PLAN',   ),))
CHMAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                    AFFE=(_F(TOUT='OUI',MATER=MATER),))
CH1=AFFE_CHAR_MECA(MODELE=MODM,
                   PRES_REP=(_F(GROUP_MA='PRES',PRES = 2.E3,),),)
CH2=AFFE_CHAR_MECA(MODELE=MODM,
                   DDL_IMPO=(_F(GROUP_NO=('DIRI'),DX=0.0,DY=0.0,),),),


CH3 = DEFI_CONTACT( MODELE         = MODM,
                    FORMULATION    = 'CONTINUE',
                    ALGO_RESO_CONT = 'NEWTON',
                    ALGO_RESO_GEOM = 'NEWTON',
                    ZONE = (
                             _F(GROUP_MA_MAIT='CONTACT1',
                                GROUP_MA_ESCL='CONTACT2',
                               ),
                             _F(GROUP_MA_MAIT='CONTACT3',
                                GROUP_MA_ESCL='CONTACT4',
                               )
                       ),
                    );

SDFETI=DEFI_PART_OPS(NOM='SD',
                     MODELE=MODM,
                     INFO=1,
                     EXCIT=(
                            _F(CHARGE=CH1),
                            _F(CHARGE=CH2),
                         ),
                     DEFI=(
                           _F(GROUP_MA = 'FETI1', GROUP_MA_BORD = 'B1',),
                           _F(GROUP_MA = 'FETI2', GROUP_MA_BORD = 'B2',),
                           ),)
#IMPR_CO(UNITE=6,CONCEPT=_F(NOM='SDFETI'))
RAMPE=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(0.0,0.0,
                          10.0,5.),
                    PROL_DROITE='CONSTANT',
                    PROL_GAUCHE='LINEAIRE',)
INSTNL=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=(_F(JUSQU_A=0.1,
                                     NOMBRE=3,),),);

RESU=STAT_NON_LINE(MODELE=MODM,
                   CHAM_MATER=CHMAT,
                   SOLVEUR=_F(METHODE='MUMPS',
                              MATR_DISTRIBUEE='OUI',),
                   CONTACT=CH3,
                 EXCIT=(_F(CHARGE=CH1,FONC_MULT=RAMPE),
                        _F(CHARGE=CH2,FONC_MULT=RAMPE),
                        ),
                 NEWTON=(_F(REAC_INCR=1,
                            PREDICTION='TANGENTE',
                            MATRICE='TANGENTE',
                            PAS_MINI_ELAS=0.0,
                            REAC_ITER=1,
                            REAC_ITER_ELAS=0)),
                 CONVERGENCE=(_F(RESI_GLOB_RELA=1.E-6,
                                 ARRET='OUI',
                                 ITER_GLOB_ELAS=20,
                                 ITER_GLOB_MAXI=20)),
                 INCREMENT=_F( LIST_INST = INSTNL),
                 COMPORTEMENT=(_F(RELATION='ELAS',GROUP_MA = 'STRU'))
                    )


#IMPR_RESU(UNITE=6,RESU=_F(RESULTAT=RESU,),);
# TEST DEPLACEMENTS
# 2 NOEUDS DIRICHLET, 1 NOEUD AU MILIEU DE LA STRUCTURE
# LES 4 NOEUDS DES ZONES DE CONTACT
TEST_RESU(RESU=(_F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N1',
                   NOM_CMP='DX',
                   VALE_CALC=0.0,

                   CRITERE='ABSOLU',
                   ),
                _F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N1',
                   NOM_CMP='DY',
                   VALE_CALC=0.0,

                   CRITERE='ABSOLU',
                   ),
                _F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N3',
                   NOM_CMP='DX',
                   VALE_CALC=-6.6982574393289999E-07,

                   CRITERE='ABSOLU',
                   ),
                _F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N3',
                   NOM_CMP='DY',
                   VALE_CALC=-1.0337311383402E-06,

                   CRITERE='ABSOLU',
                   ),
                _F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N5',
                   NOM_CMP='DX',
                   VALE_CALC=0.0,

                   CRITERE='ABSOLU',
                   ),
                _F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N5',
                   NOM_CMP='DY',
                   VALE_CALC=0.0,

                   CRITERE='ABSOLU',
                   ),
                _F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N20',
                   NOM_CMP='DX',
                   VALE_CALC=-1.4121935999999999E-3,

                   CRITERE='RELATIF',
                   ),
                _F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N20',
                   NOM_CMP='DY',
                   VALE_CALC=-3.8377240000000003E-4,

                   CRITERE='RELATIF',
                   ),
                _F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N20',
                   NOM_CMP='LAGS_C',
                   VALE_CALC=-68.946802371578002,

                   CRITERE='RELATIF',
                   ),
                _F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N22',
                   NOM_CMP='DX',
                   VALE_CALC=-2.3728679999999999E-4,

                   CRITERE='RELATIF',
                   ),
                _F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N22',
                   NOM_CMP='DY',
                   VALE_CALC=-7.3395100000000005E-4,

                   CRITERE='RELATIF',
                   ),
                _F(NUME_ORDRE=3,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N22',
                   NOM_CMP='LAGS_C',
                   VALE_CALC=-65.492467998547994,

                   CRITERE='RELATIF',
                   ),
                ),
          )

FIN( )
