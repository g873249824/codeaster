# MODIF  DATE 12/05/2009   AUTEUR PELLET J.PELLET 
# TITRE VALIDATION DE PRE_IDEAS POUR DATASET 82
# zzzz176a.para = tps_job 60 mem_job 100Mo ncpus 1 liste_test R
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2003  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#
#         *** VALIDATION DE LA COMMANDE PRE_IDEAS ***
#
# LECTURE D'UN FICHIER UNIVERSEL ISSU D'UN LOGICIEL D'IDENTIFICATION
# MODALE
# TEST DE LECTURE DU MAILLAGE EXPERIMENTAL ET DE LECTURE
# DES DEFORMEES EXPERIMENTALES

DEBUT(CODE=_F(NOM='ZZZZ176A', NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

PRE_IDEAS(CREA_GROUP_COUL='NON',);

MAYA=LIRE_MAILLAGE( );

MODELE=AFFE_MODELE(MAILLAGE=MAYA,
                   AFFE=_F(TOUT='OUI',
                           PHENOMENE='MECANIQUE',
                           MODELISATION='POU_D_T',),);

MATELAS=DEFI_MATERIAU(ELAS=_F(E=71000000000.0,
                              NU=0.3,
                              RHO=7820,),);

CHMAT=AFFE_MATERIAU(MAILLAGE=MAYA,
                    AFFE=_F(TOUT='OUI',
                            MATER=MATELAS,),);


MODEXP=LIRE_RESU(TYPE_RESU='MODE_MECA_C',
                 FORMAT='IDEAS',
                 MODELE=MODELE,
                 UNITE=19,
                 NOM_CHAM='DEPL',
                 FORMAT_IDEAS=_F(NOM_CHAM='DEPL',
                                 NUME_DATASET=55,
                                 RECORD_6=(1,2,2,8,5,3,),
                                 POSI_ORDRE=(7,4,),
                                 POSI_FREQ=(8,1,),
                                 NOM_CMP=('DX','DY','DZ',),),
                 NUME_ORDRE=(1,2,3),);

IMPR_RESU(RESU=_F(RESULTAT=MODEXP,NUME_ORDRE=2),)
IMPR_RESU(FORMAT='MED',RESU=_F(RESULTAT=MODEXP,PARTIE='REEL',NUME_ORDRE=2),)

# ------------------------------------
# TEST DES FREQUENCES PROPRES LUES
# ------------------------------------

TEST_RESU(RESU=(_F(RESULTAT=MODEXP,
                   NUME_ORDRE=1,
                   PARA='FREQ',
                   VALE=1.66258E+02,
                   CRITERE='RELATIF',
                   PRECISION=0.05,
                   REFERENCE='NON_REGRESSION',),
                _F(RESULTAT=MODEXP,
                   NUME_ORDRE=2,
                   PARA='FREQ',
                   VALE=2.25885E+02,
                   CRITERE='RELATIF',
                   PRECISION=0.05,
                   REFERENCE='NON_REGRESSION',),
                _F(RESULTAT=MODEXP,
                   NUME_ORDRE=3,
                   PARA='FREQ',
                   VALE=3.49164E+02,
                   CRITERE='RELATIF',
                   PRECISION=0.05,
                   REFERENCE='NON_REGRESSION',),
                   ),);

# ------------------------------------
# TEST ECRITURE ET LECTURE DU MAILLAGE
# ------------------------------------

# FORMAT GMSH
# -----------

IMPR_RESU(FORMAT='GMSH', UNITE=60, RESU=_F(MAILLAGE=MAYA,),);

DEFI_FICHIER (ACTION='LIBERER',UNITE=60)

PRE_GMSH(UNITE_GMSH=60,UNITE_MAILLAGE=22)

MA22=LIRE_MAILLAGE(UNITE=22)


# FORMAT IDEAS
# ------------

IMPR_RESU(FORMAT='IDEAS', UNITE=62, RESU=_F(MAILLAGE=MAYA,),);

DEFI_FICHIER (ACTION='LIBERER',UNITE=62)

PRE_IDEAS(UNITE_IDEAS=62,UNITE_MAILLAGE=23,)

MA23=LIRE_MAILLAGE(UNITE=23)

# FORMAT IDEAS POUR TESTER LE RETOUR DE DEFI_FICHIER
# --------------------------------------------------
uniideas=DEFI_FICHIER(FICHIER='./REPE_OUT/fic_ideas');

IMPR_RESU(FORMAT='IDEAS', UNITE=uniideas, RESU=_F(MAILLAGE=MAYA,),);

DEFI_FICHIER (ACTION='LIBERER',UNITE=uniideas)

TEST_FICHIER(FICHIER='./REPE_OUT/fic_ideas',
             NB_VALE=859,
             VALE=14327.25,
             VALE_K='3b89c286ed816e625b97227f8d41344a',
             EXPR_IGNORE=('[0-9]{2}/[0-9]{2}/[0-9]{4}',),
             REFERENCE='NON_REGRESSION',
             VERSION='9.3.10',
             INFO=1)

# FORMAT CASTEM
# -------------

IMPR_RESU(FORMAT='CASTEM', UNITE=64, RESU=_F(MAILLAGE=MAYA,),);

DEFI_FICHIER (ACTION='LIBERER',UNITE=64)

PRE_GIBI(UNITE_GIBI=64,UNITE_MAILLAGE=24)

MA24=LIRE_MAILLAGE(UNITE=24)


TEST_RESU(OBJET=(
  #GMSH
        _F( NOM='MA22    .COORDO    .VALE',
             S_R=3.5325000000000E+02,  # LES NOEUDS ORPHELINS SONT SUPPRIMES
             REFERENCE='NON_REGRESSION',
             VERSION='7.02.8'),
  #IDEAS
         _F( NOM='MA23    .COORDO    .VALE',
             S_R=5.5425000000000E+02,
             REFERENCE='NON_REGRESSION',
             VERSION='7.02.8'),
  #CASTEM
         _F( NOM='MA24    .COORDO    .VALE',
             S_R=5.5425000000000E+02,
             REFERENCE='NON_REGRESSION',
             VERSION='7.02.8')))



FIN();

