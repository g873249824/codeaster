# MODIF  DATE 07/03/2005   AUTEUR CIBHHLV L.VIVAN 
# RESPONSABLE MABBAS M.ABBAS
#
# TITRE TEST DE REFERENCE POUR LA MACRO DE CALCUL DE BRIDES CABRI
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2003  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

DEBUT(CODE=_F(  NOM = 'CABRI02A',NIV_PUB_WEB='INTRANET'));

# Creation du maillage
MA = MACR_CABRI_MAIL(EXEC_MAILLAGE=_F(LOGICIEL='GIBI2000',),
                       RAFF_MAILLAGE = _F(NB_RADIAL = 4,
                                      NB_CIRCONF = 3,
                                       NB_VERTICAL = 3,
                                       NB_ALESAGE = 10,
                                      ),
                       GEOM_BRID = _F(NORME = 'NON',
                          TUBU_D_EXT     = 88.9,
                          TUBU_H         = 50.,
                          BRID_D_EXT     = 267.,
                          BRID_D_INT     = 66.7,
                          BRID_H         = 51.2,
                          BRID_D_CONGE   = 133.,
                          BRID_R_CONGE   = 10.,
                          BRID_D_EPAUL   = 168.,
                          BRID_H_EPAUL   = 6,
                          BRID_D_ALESAG  = 31.8,
                          BRID_P_ALESAG  = 203.2,
                          BRID_H_ALESAG  = 47.8,
                          GOUJ_N_GOUJON  = 8,
                          GOUJ_D_GOUJON  = 29.9,
                          GOUJ_E_FILET   = 3.8,
                          GOUJ_D_RONDEL  = 60.5,
                          GOUJ_E_RONDEL  = 4.,
                          GOUJ_D_ECROU   = 53.1,
                          GOUJ_E_ECROU   = 30.,
                          ETAN_E_JOINT   = 8.,
                                      ),
                       VERI_MAIL = _F(VERIF = 'OUI',),
                        IMPRESSION=_F(FORMAT='IDEAS'),
                               );


# DEFINITION DES DONNEES MATERIAUX

# Temperature initiale, assemblage libre de contraintes
TEMP_INI=25.0;

# Temperature moyenne du transitoire pour calcul de lambda et rhoCp
TEMP_MOY = 170.0;

INCLUDE_MATERIAU(NOM_AFNOR='Z2CN1810',
                 TYPE_MODELE='REF',
                 VARIANTE='A',
                 TYPE_VALE='NOMI',
                 NOM_MATER='MA_BRI',
                 EXTRACTION=_F(COMPOR='THER',
                               TEMP_EVAL= TEMP_MOY,),
                 UNITE_LONGUEUR='MM',);

INCLUDE_MATERIAU(NOM_AFNOR='Z12CN13',
                 TYPE_MODELE='REF',
                 VARIANTE='A',
                 TYPE_VALE='NOMI',
                 NOM_MATER='MA_ECR',
                 EXTRACTION=_F(COMPOR='THER',
                               TEMP_EVAL= TEMP_MOY,),
                 UNITE_LONGUEUR='MM',);

INCLUDE_MATERIAU(NOM_AFNOR='Z12CN13',
                 TYPE_MODELE='REF',
                 VARIANTE='A',
                 TYPE_VALE='NOMI',
                 NOM_MATER='MA_RON',
                 EXTRACTION=_F(COMPOR='THER',
                               TEMP_EVAL= TEMP_MOY,),
                 UNITE_LONGUEUR='MM',);

INCLUDE_MATERIAU(NOM_AFNOR='Z2CN1810',
                 TYPE_MODELE='REF',
                 VARIANTE='A',
                 TYPE_VALE='NOMI',
                 NOM_MATER='MA_GOU',
                 EXTRACTION=_F(COMPOR='THER',
                               TEMP_EVAL= TEMP_MOY,),
                 UNITE_LONGUEUR='MM',);

INCLUDE_MATERIAU(NOM_AFNOR='Z6CND1712',
                 TYPE_MODELE='REF',
                 VARIANTE='A',
                 TYPE_VALE='NOMI',
                 NOM_MATER='MA_LIM',
                 EXTRACTION=_F(COMPOR='THER',
                               TEMP_EVAL= TEMP_MOY,),
                 UNITE_LONGUEUR='MM',);

# Definition des parametres thermiques
T_INT=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(0.0,TEMP_INI,1.0,TEMP_INI,11.0,60.0,20.0,60.0,),
                    PROL_DROITE='CONSTANT',
                    PROL_GAUCHE='CONSTANT',);

H_INT=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(0.0,0.016,20.0,0.016,),
                    PROL_DROITE='CONSTANT',
                    PROL_GAUCHE='CONSTANT',);

T_EXT=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(0.0,20.0,20.0,20.0,),
                    PROL_DROITE='CONSTANT',
                    PROL_GAUCHE='CONSTANT',);

H_EXT=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(0.0,1e-05,20.0,1e-05,),
                    PROL_DROITE='CONSTANT',
                    PROL_GAUCHE='CONSTANT',);
# Pretensionnement
# Valeur cible de Sizz : 30 MPa
# Valeur de l'allongement a determiner par tatonnements
F_PRET=DEFI_FONCTION(NOM_PARA='INST',
                     VALE=(0.0,0.0,1.0,-0.02,),
                     PROL_DROITE='CONSTANT',
                     PROL_GAUCHE='CONSTANT',);

# Pression due au fluide
PRE_INT=DEFI_FONCTION(NOM_PARA='INST',
                      VALE=(0.0,0.0,1.0,0.0,11.0,16.0,),
                      PROL_DROITE='CONSTANT',
                      PROL_GAUCHE='CONSTANT',);

# Effet de fond
EFF_FOND=DEFI_FONCTION(NOM_PARA='INST',
                       VALE=(0.0,-0.0,1.0,-0.0,11.0,-20.607059,),
                       PROL_DROITE='CONSTANT',
                       PROL_GAUCHE='CONSTANT',);

# Definition des pas de temps thermiques et mecaniques

# Liste complete du transitoire

LR_T1=DEFI_LIST_REEL(DEBUT=0.0,
                     INTERVALLE=(_F(JUSQU_A=1.0,
                                    NOMBRE=1,),
                                 _F(JUSQU_A=11.0,
                                    NOMBRE=10,),
                                 _F(JUSQU_A=20.0,
                                    NOMBRE=10,),),);

LR_T2=DEFI_LIST_REEL(DEBUT=0.0,
                     INTERVALLE=(_F(JUSQU_A=1.0,
                                    NOMBRE=2,),
                                 _F(JUSQU_A=11.0,
                                    NOMBRE=10,),
                                 _F(JUSQU_A=20.0,
                                    NOMBRE=10,),),);


MA=DEFI_GROUP(reuse =MA,
              MAILLAGE=MA,
              CREA_GROUP_NO=(_F(GROUP_MA='M_GOU',
                                NOM='N_M_GOU',),
                             _F(GROUP_MA='M_JOI',
                                NOM='N_M_JOI',),
                             _F(GROUP_MA='SCBJ',
                                NOM='N_SCBJ',),
                             _F(GROUP_MA='SCJB',
                                NOM='N_SCJB',),
                             _F(GROUP_MA='M_L_AA',
                                NOM='N_M_L_AA',),
                             _F(GROUP_MA='SCEG',
                                NOM='N_SCEG',),
                             _F(GROUP_MA='SCGE',
                                NOM='N_SCGE',),),);

# Creation du modele thermique
MO_TH=AFFE_MODELE(MAILLAGE=MA,
                  AFFE=_F(GROUP_MA=('VTOT','M_GOU','M_TUB','M_JOI','SCBJ','SCJB','M_L_AA','M_INT','M_L_SA','M_EXT','SCEG','SCGE',),
                          PHENOMENE='THERMIQUE',
                          MODELISATION='3D_DIAG',),);

# Creation du modele mecanique
MO_ME=AFFE_MODELE(MAILLAGE=MA,
                  AFFE=_F(GROUP_MA=('VTOT','M_GOU','M_TUB','M_JOI','SCBJ','SCJB','M_L_AA','M_L_SA','SCEG','SCGE','M_INT','M_EXT',),
                          PHENOMENE='MECANIQUE',
                          MODELISATION='3D',),);

# Orientation des mailles
MA=MODI_MAILLAGE(reuse =MA,
                 MAILLAGE=MA,
                 ORIE_PEAU_3D=(_F(GROUP_MA=('M_INT','M_TUB',),),
                               _F(GROUP_MA=('M_L_AA','M_JOI','M_L_SA',),),),
                 MODELE=MO_ME,);

# Affectation des materiaux
CHMAT=AFFE_MATERIAU(MAILLAGE=MA,
                    MODELE=MO_TH,
                    AFFE=(_F(GROUP_MA='BRIDE',
                             MATER=MA_BRI,
                             TEMP_REF=TEMP_INI,),
                          _F(GROUP_MA='ROND',
                             MATER=MA_RON,
                             TEMP_REF=TEMP_INI,),
                          _F(GROUP_MA='ECROU',
                             MATER=MA_ECR,
                             TEMP_REF=TEMP_INI,),
                          _F(GROUP_MA='GOUJON',
                             MATER=MA_GOU,
                             TEMP_REF=TEMP_INI,),
                          _F(GROUP_MA='JOINT',
                             MATER=MA_LIM,
                             TEMP_REF=TEMP_INI,),),);

#----- CONDITIONS AUX LIMITES THERMIQUES --------------------
# ECHANGES THERMIQUES INTERNES ENTRE LE FLUIDE ET LA BRIDE

CL_TH1=AFFE_CHAR_THER_F(MODELE=MO_TH,
                        ECHANGE=_F(GROUP_MA='M_INT',
                                   COEF_H=H_INT,
                                   TEMP_EXT=T_INT,),);

# ECHANGES THERMIQUES EXTERNES ENTRE BRIDE ET AIR AMBIANT

CL_TH2=AFFE_CHAR_THER_F(MODELE=MO_TH,
                        ECHANGE=_F(GROUP_MA='M_EXT',
                                   COEF_H=H_EXT,
                                   TEMP_EXT=T_EXT,),);
# ECHANGES THERMIQUES ENTRE ECROU ET GOUJON

CH_L_G1=AFFE_CHAR_THER(MODELE=MO_TH,
                       LIAISON_GROUP=_F(GROUP_NO_1='N_SCEG',
                                        GROUP_NO_2='N_SCGE',
                                        DDL_1='TEMP',
                                        COEF_MULT_1=1.0,
                                        DDL_2='TEMP',
                                        COEF_MULT_2=-1.0,
                                        COEF_IMPO=0.0,),);
# ECHANGES THERMIQUES ENTRE BRIDE ET JOINT

CH_L_G2=AFFE_CHAR_THER(MODELE=MO_TH,
                       LIAISON_GROUP=_F(GROUP_NO_1='N_SCBJ',
                                        GROUP_NO_2='N_SCJB',
                                        DDL_1='TEMP',
                                        COEF_MULT_1=1.0,
                                        DDL_2='TEMP',
                                        COEF_MULT_2=-1.0,
                                        COEF_IMPO=0.0,),);
# LANCEMENT CALCUL THERMIQUE
#---------------------------

TH1=THER_LINEAIRE(MODELE=MO_TH,
                  CHAM_MATER=CHMAT,
                  EXCIT=(_F(CHARGE=CL_TH1,),
                         _F(CHARGE=CL_TH2,),
                         _F(CHARGE=CH_L_G1,),
                         _F(CHARGE=CH_L_G2,),),
                  INCREMENT=_F(LIST_INST=LR_T1,),
                  TEMP_INIT=_F(VALE=TEMP_INI,),
                  TITRE='CABRI THERMIQUE &DATE &HEURE',);

# CONDITIONS AUX LIMITES MECANIQUES
#----------------------------------
# Blocage bas du goujon

CL_ME1=AFFE_CHAR_MECA(MODELE=MO_ME,
                      DDL_IMPO=_F(GROUP_NO='N_M_GOU',
                                  DZ=0.0,),);
# BLOCAGE BAS DU JOINT ########

CL_ME2=AFFE_CHAR_MECA(MODELE=MO_ME,
                      DDL_IMPO=_F(GROUP_NO='N_M_JOI',
                                  DZ=0.0,),);
# BLOCAGE LATERAL #########FACE LATERALE AVEC ALESAGE

CL_ME3=AFFE_CHAR_MECA(MODELE=MO_ME,
                      DDL_IMPO=_F(GROUP_NO='N_M_L_AA',
                                  DY=0.0,),);
# FACE LATERALE SANS ALESAGE #########

CL_ME4=AFFE_CHAR_MECA(MODELE=MO_ME,
                      FACE_IMPO=_F(GROUP_MA='M_L_SA',
                                   DNOR=0.0,),);
# CONDITION DE PLANEITE DE LA FACE DE COUPE DU TUBE #########

CL_ME5=AFFE_CHAR_MECA(MODELE=MO_ME,
                      LIAISON_UNIF=_F(GROUP_MA='M_TUB',
                                      DDL='DZ',),);
# PRESSION DUE AU FLUIDE

CHA_ME1=AFFE_CHAR_MECA_F(MODELE=MO_ME,
                         PRES_REP=_F(GROUP_MA='M_INT',
                                     PRES=PRE_INT,),);
# EFFET DE FOND

CHA_ME2=AFFE_CHAR_MECA_F(MODELE=MO_ME,
                         PRES_REP=_F(GROUP_MA='M_TUB',
                                     PRES=EFF_FOND,),);
# CONTACT ZONE DE JOINT

CON_BJ1=AFFE_CHAR_MECA(MODELE=MO_ME,
                       CONTACT=_F(GROUP_MA_MAIT='SCBJ',
                                  GROUP_MA_ESCL='SCJB',),);
# DEFORMATION THERMIQUE

CHA_TH1=AFFE_CHAR_MECA(MODELE=MO_ME,
                       TEMP_CALCULEE=TH1,);
# SERRAGE ECROU/GOUJON

CHA_ME3=AFFE_CHAR_MECA_F(MODELE=MO_ME,
                         LIAISON_GROUP=_F(GROUP_NO_1='N_SCEG',
                                          GROUP_NO_2='N_SCGE',
                                          DDL_1='DZ',
                                          COEF_MULT_1=1.0,
                                          DDL_2='DZ',
                                          COEF_MULT_2=-1.0,
                                          COEF_IMPO=F_PRET,),);

CHA_ME4=AFFE_CHAR_MECA(MODELE=MO_ME,
                       LIAISON_GROUP=_F(GROUP_NO_1='N_SCEG',
                                        GROUP_NO_2='N_SCGE',
                                        DDL_1='DX',
                                        COEF_MULT_1=1.0,
                                        DDL_2='DX',
                                        COEF_MULT_2=-1.0,
                                        COEF_IMPO=0.0,),);
# LANCEMEMT DE CALCUL MECANIQUE
#------------------------------

ME1TH=STAT_NON_LINE(MODELE=MO_ME,
                    CHAM_MATER=CHMAT,
                    EXCIT=(_F(CHARGE=CL_ME1,),
                           _F(CHARGE=CL_ME2,),
                           _F(CHARGE=CL_ME3,),
                           _F(CHARGE=CL_ME4,),
                           _F(CHARGE=CL_ME5,),
                           _F(CHARGE=CON_BJ1,),
                           _F(CHARGE=CHA_TH1,),
                           _F(CHARGE=CHA_ME1,),
                           _F(CHARGE=CHA_ME2,),
                           _F(CHARGE=CHA_ME3,),
                           _F(CHARGE=CHA_ME4,),),
                    COMP_ELAS=_F(RELATION='ELAS',),
                    INCREMENT=_F(LIST_INST=LR_T2,),
                    NEWTON=_F(REAC_ITER=3,),
                    TITRE='CABRI THERMOM\xe9CANIQUE &DATE &HEURE',);

MA=DEFI_GROUP(reuse =MA,
              MAILLAGE=MA,
              CREA_GROUP_NO=(_F(GROUP_MA='ECROU',
                                NOM='N_ECROU',),
                             _F(GROUP_MA='TRANCHE',
                                NOM='N_TRANCHE',),),);

ME1TH=CALC_ELEM(reuse =ME1TH,
                RESULTAT=ME1TH,
                TOUT_ORDRE='OUI',
                OPTION=('SIEF_ELNO_ELGA','EQUI_ELNO_SIGM',),
                  );


TB=POST_RELEVE_T(ACTION=_F(INTITULE='TEMP_BRI',
                           GROUP_NO='P_BRI',
                           RESULTAT=TH1,
                           NOM_CHAM='TEMP',
                           TOUT_CMP='OUI',
                           OPERATION='EXTRACTION',),);

IMPR_TABLE(TABLE=TB,
           FILTRE=_F(NOM_PARA='INST',
                     VALE=20.0,),
                     );

TEST_TABLE(TABLE=TB,
           NOM_PARA='TEMP',
           VALE=2.78182E+01,
           PRECISION = 0.001,
           FILTRE=_F(NOM_PARA='INST',
                     VALE=20.0,),
           REFERENCE='NON_REGRESSION',
            );

TG=POST_RELEVE_T(ACTION=_F(INTITULE='TEMP_GOU',
                           GROUP_NO='P_GOU',
                           RESULTAT=TH1,
                           NOM_CHAM='TEMP',
                           TOUT_CMP='OUI',
                           OPERATION='EXTRACTION',),);

IMPR_TABLE(TABLE=TG,
           FILTRE=_F(NOM_PARA='INST',
                     VALE=20.0,),);

TEST_TABLE(TABLE=TG,
           NOM_PARA='TEMP',
           VALE=2.50000E+01,
           PRECISION = 0.001,
           REFERENCE='NON_REGRESSION',
           FILTRE=_F(NOM_PARA='INST',
                     VALE=20.0,),
            );

TE=POST_RELEVE_T(ACTION=_F(INTITULE='TEMP_ECR',
                           GROUP_NO='N_ECROU',
                           RESULTAT=TH1,
                           NOM_CHAM='TEMP',
                           TOUT_CMP='OUI',
                           OPERATION='MOYENNE',),);

IMPR_TABLE(TABLE=TE,
           FILTRE=(_F(NOM_PARA='INST',
                     VALE=20.0,),
                  _F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),),);

TEST_TABLE(TABLE=TE,
           NOM_PARA='TEMP',
           VALE=2.49694E+01,
           PRECISION = 0.001,
           FILTRE=(_F(NOM_PARA='INST',
                     VALE=20.0,),
                  _F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),),
           REFERENCE='NON_REGRESSION',
            );

TSZGOU=POST_RELEVE_T(ACTION=_F(INTITULE='SZP_GOU',
                               GROUP_NO='P_GOU',
                               RESULTAT=ME1TH,
                               NOM_CHAM='SIEF_ELNO_ELGA',
                               NOM_CMP='SIZZ',
                               OPERATION='EXTRACTION',),);


IMPR_TABLE(TABLE=TSZGOU,
           FILTRE=_F(NOM_PARA='INST',
                     VALE=20.0,),);

TEST_TABLE(TABLE=TSZGOU,
           NOM_PARA='SIZZ',
           VALE=2.55508E+01,
           PRECISION = 0.001,
           FILTRE=_F(NOM_PARA='INST',
                     VALE=20.0,),
           REFERENCE='NON_REGRESSION',
            );

SZTRA=POST_RELEVE_T(ACTION=_F(INTITULE='PRET',
                              GROUP_NO='N_TRANCHE',
                              RESULTAT=ME1TH,
                              NOM_CHAM='SIEF_ELNO_ELGA',
                              NOM_CMP='SIZZ',
                              OPERATION='MOYENNE',),);


IMPR_TABLE(TABLE=SZTRA,
           FILTRE=(_F(NOM_PARA='INST',
                     VALE=20.0,),
                  _F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),),);

TEST_TABLE(TABLE=SZTRA,
           NOM_PARA='SIZZ',
           VALE=2.31100E+01,
           PRECISION = 0.001,
           FILTRE=(_F(NOM_PARA='INST',
                     VALE=20.0,),
                  _F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),),
           REFERENCE='NON_REGRESSION',
            );


FIN();
