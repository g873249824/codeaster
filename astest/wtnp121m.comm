# TITRE  MODELISATION D UN BARREAU SATURE EN LIQUIDE COMPRESSIBLE
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
# wtnp121m.para = tps_job 100 mem_job 512Mo ncpus 1 liste_test S
# VALIDATION DE LA MODELISATION HYDRAULIQUE SATUREE H EN 2D


DEBUT(CODE=_F(NOM='WTNP121M', NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'))

#=============================================================
#                     donnees
#=============================================================

EMMAG=1.E-10 
UN_SUR_K= 0


#*********************************************************
# CI/CL
#*********************************************************
#
P0=10000.
PRE1GAUCHE=0

#*********************************************************
# PAS DE TEMPS
#*********************************************************
#
TFINAL=100.
NBDECOUP=100

#*********************************************************
# CRITERES DE CONVERGENCE
#*********************************************************
#
RESI_GLOB_MAXI = 1.E-17
ITER_GLOB_MAXI = 0

#*********************************************************
# Definition des caracteristiques fluides
#**********************************************************

UN=DEFI_CONSTANTE(VALE=1.0,);
ZERO=DEFI_CONSTANTE(VALE=0.0,);
PERMINT=DEFI_CONSTANTE(VALE=1.E-13,);

#*********************
# Lecture du maillage
#*********************

MAIL=LIRE_MAILLAGE(FORMAT='MED',);

MAIL=DEFI_GROUP(reuse =MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=(
                _F(GROUP_MA='MHAUT',),
                _F(GROUP_MA='MBAS',),
                _F(GROUP_MA='MDROIT',),
                _F(GROUP_MA='MGAUCHE',),
                   ),);        
        
        

#*********************************************************
# Modele de calcul
#*********************************************************
#
MODELT=AFFE_MODELE(MAILLAGE=MAIL,
                   VERI_JACOBIEN='NON',
                   AFFE=_F(TOUT='OUI',
                           PHENOMENE='MECANIQUE',
                           MODELISATION='D_PLAN_HS',),
                  );

#*********************************************************
# DEFI_MATERIAU
#*********************************************************
#                                    
MATERIAU=DEFI_MATERIAU(  

   THM_LIQU=_F(  
         RHO = 1.,
         UN_SUR_K = UN_SUR_K,
         VISC = UN, 
         D_VISC_TEMP = ZERO,),
         
   COMP_THM = 'LIQU_SATU',
   
   THM_DIFFU=_F(
            EMMAG      = EMMAG,
            RHO        = 1.,
            BIOT_L     = 1.,
            BIOT_T     = 1.,
            BIOT_N     = 1.,
            PESA_X     = 0.0,
            PESA_Y     = 0.,
            PESA_Z     = 0.,
            PERMIN_L   = PERMINT,
            PERMIN_T   = ZERO,
            PERM_LIQU  = UN,
            D_PERM_LIQU_SATU=ZERO,
              ),
            
   THM_INIT=_F( 
         PRE1 = 0.,
         PORO = 0.5,
              ),
   )
#****************************************************************
# Affectation des materiaux
#****************************************************************
#
 
CHMAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                    AFFE=(_F(GROUP_MA='TOUT',
                             MATER=MATERIAU,),),);   
                
#*************************************************************
# Affectation de l etat initial
#*************************************************************
#
PINIT=CREA_CHAMP(MAILLAGE=MAIL,
                    OPERATION='AFFE', 
                    TYPE_CHAM='NOEU_DEPL_R',
                    AFFE=(
                    _F( GROUP_MA = 'TOUT'  ,
                    NOM_CMP  = 'PRE1' ,
                    VALE = -P0, ),
                ),)
#*************************************************************
# Affectation des CL
#*************************************************************

CHIMP=AFFE_CHAR_CINE(MODELE=MODELT,
       MECA_IMPO=_F(GROUP_MA = 'MGAUCHE',PRE1=PRE1GAUCHE,),
                 );
    
#
#
#*************************************************************
# Liste des instants de calculs
#*************************************************************
#
              
INST1=DEFI_LIST_REEL(DEBUT=0.0,
                     INTERVALLE=(_F(JUSQU_A=TFINAL,
                                    NOMBRE=NBDECOUP,),),
                     );
        
LI =DEFI_LIST_INST(DEFI_LIST=_F(LIST_INST =INST1 ,),
                                ECHEC=_F(EVENEMENT     = 'ERREUR',
                                 ACTION        = 'ARRET',),)        
#
#
#*************************************************************
#     STAT NON LINE
#*************************************************************
#
cal1=STAT_NON_LINE(MODELE=MODELT,
                 CHAM_MATER=CHMAT, 
                 
                 EXCIT=( _F(CHARGE=CHIMP,),),
                 
                 COMP_INCR=_F(RELATION='KIT_H',
                              RELATION_KIT=('LIQU_SATU','HYDR_UTIL'),
                 ),

                INCREMENT=_F(  
                   LIST_INST = LI,
                     INST_FIN=TFINAL,
                ), 
              
                 ETAT_INIT  = _F ( DEPL = PINIT  ,
                                  ),
                                               
                 SOLVEUR=_F(METHODE='MUMPS',),
                 
                 NEWTON=_F(MATRICE='TANGENTE',
                           REAC_ITER=1,),
              
                 CONVERGENCE=_F( RESI_GLOB_MAXI = RESI_GLOB_MAXI,
                                 ITER_GLOB_MAXI = ITER_GLOB_MAXI,),
                    
                 ARCHIVAGE=_F(LIST_INST     = INST1 ),
                 );
#
#*************************************************************
# Impressions
#*************************************************************
#                           
L_INST=DEFI_LIST_REEL(VALE=(0.,1.,10.,100.,),);


PR1_BAS=POST_RELEVE_T(ACTION=_F(INTITULE='DEPL',
               GROUP_NO=('MBAS'),
               RESULTAT=cal1,
               NOM_CHAM='DEPL',
               LIST_INST=L_INST,
               NOM_CMP=('PRE1'),
               OPERATION='EXTRACTION',),);
              
IMPR_TABLE(TABLE=PR1_BAS,
             PAGINATION = 'INST' ,
             NOM_PARA=('INST','COOR_X','PRE1'),
             TRI   = (_F( NOM_PARA = ('COOR_X' ,),
             ORDRE    = 'CROISSANT',),),);

TEST_RESU(RESU=_F(NUME_ORDRE=100,
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=cal1,
                  NOM_CHAM='DEPL',
                  NOEUD='N104',
                  NOM_CMP='PRE1',
                  VALE_CALC=-894.000955949,
                  VALE_REFE=-889.31760999999995,
                  CRITERE='RELATIF',
                  PRECISION=1.E-2,),
          )

#NOEUD DU HAUT
TEST_RESU(RESU=_F(NUME_ORDRE=100,
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=cal1,
                  NOM_CHAM='DEPL',
                  NOEUD='N103',
                  NOM_CMP='PRE1',
                  VALE_CALC=-894.000955949,
                  VALE_REFE=-889.31760999999995,
                  CRITERE='RELATIF',
                  PRECISION=1.E-2,),
          )

# NOEUD DU BAS
TEST_RESU(RESU=_F(NUME_ORDRE=100,
                  RESULTAT=cal1,
                  NOM_CHAM='DEPL',
                  NOEUD='N104',
                  NOM_CMP='PRE1',
                  VALE_CALC=-894.00095594877996,
                  CRITERE='RELATIF',
                  ),
          )

#NOEUD DU HAUT
TEST_RESU(RESU=_F(NUME_ORDRE=100,
                  RESULTAT=cal1,
                  NOM_CHAM='DEPL',
                  NOEUD='N103',
                  NOM_CMP='PRE1',
                  VALE_CALC=-894.00095594895004,
                  CRITERE='RELATIF',
                  ),
          )

FIN();
