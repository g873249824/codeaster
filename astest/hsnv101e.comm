# -*- coding: utf-8 -*-
# ======================================================================
# COPYRIGHT (C) 1991 - 2016  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# ( SANS PLASTICITE DE TRANSFORMATION)
#======================================================================

DEBUT( CODE=_F(NIV_PUB_WEB='INTERNET'),IMPR_MACRO='OUI')


# evolutions issues de HSNV101A

temp=DEFI_FONCTION(NOM_PARA='INST',VALE=(
 0.00000E+00, 9.00000E+02, 
 2.00000E+00, 8.90000E+02, 
 4.00000E+00, 8.80000E+02, 
 6.00000E+00, 8.70000E+02, 
 8.00000E+00, 8.60000E+02, 
 1.00000E+01, 8.50000E+02, 
 1.20000E+01, 8.40000E+02, 
 1.40000E+01, 8.30000E+02, 
 1.60000E+01, 8.20000E+02, 
 1.80000E+01, 8.10000E+02, 
 2.00000E+01, 8.00000E+02, 
 2.20000E+01, 7.90000E+02, 
 2.40000E+01, 7.80000E+02, 
 2.60000E+01, 7.70000E+02, 
 2.80000E+01, 7.60000E+02, 
 3.00000E+01, 7.50000E+02, 
 3.20000E+01, 7.40000E+02, 
 3.40000E+01, 7.30000E+02, 
 3.60000E+01, 7.20000E+02, 
 3.80000E+01, 7.10000E+02, 
 4.00000E+01, 7.00000E+02, 
 4.20000E+01, 6.90000E+02, 
 4.40000E+01, 6.80000E+02, 
 4.60000E+01, 6.70000E+02, 
 4.80000E+01, 6.60000E+02, 
 5.00000E+01, 6.50000E+02, 
 5.20000E+01, 6.40000E+02, 
 5.40000E+01, 6.30000E+02, 
 5.60000E+01, 6.20000E+02, 
 5.80000E+01, 6.10000E+02, 
 6.00000E+01, 6.00000E+02, 
 6.20000E+01, 5.90000E+02, 
 6.40000E+01, 5.80000E+02, 
 6.60000E+01, 5.70000E+02, 
 6.80000E+01, 5.60000E+02, 
 7.00000E+01, 5.50000E+02, 
 7.20000E+01, 5.40000E+02, 
 7.40000E+01, 5.30000E+02, 
 7.60000E+01, 5.20000E+02, 
 7.80000E+01, 5.10000E+02, 
 8.00000E+01, 5.00000E+02, 
 8.20000E+01, 4.90000E+02, 
 8.40000E+01, 4.80000E+02, 
 8.60000E+01, 4.70000E+02, 
 8.80000E+01, 4.60000E+02, 
 9.00000E+01, 4.50000E+02, 
 9.20000E+01, 4.40000E+02, 
 9.40000E+01, 4.30000E+02, 
 9.60000E+01, 4.20000E+02, 
 9.80000E+01, 4.10000E+02, 
 1.00000E+02, 4.00000E+02, 
 1.02000E+02, 3.90000E+02, 
 1.04000E+02, 3.80000E+02, 
 1.06000E+02, 3.70000E+02, 
 1.08000E+02, 3.60000E+02, 
 1.10000E+02, 3.50000E+02, 
 1.12000E+02, 3.40000E+02, 
 1.14000E+02, 3.30000E+02, 
 1.16000E+02, 3.20000E+02, 
 1.18000E+02, 3.10000E+02, 
 1.20000E+02, 3.00000E+02, 
 1.22000E+02, 2.90000E+02, 
 1.24000E+02, 2.80000E+02, 
 1.26000E+02, 2.70000E+02, 
 1.28000E+02, 2.60000E+02, 
 1.30000E+02, 2.50000E+02, 
 1.32000E+02, 2.40000E+02, 
 1.34000E+02, 2.30000E+02, 
 1.36000E+02, 2.20000E+02, 
 1.38000E+02, 2.10000E+02, 
 1.40000E+02, 2.00000E+02, 
 1.42000E+02, 1.90000E+02, 
 1.44000E+02, 1.80000E+02, 
 1.46000E+02, 1.70000E+02, 
 1.48000E+02, 1.60000E+02, 
 1.50000E+02, 1.50000E+02, 
 1.52000E+02, 1.40000E+02, 
 1.54000E+02, 1.30000E+02, 
 1.56000E+02, 1.20000E+02, 
 1.58000E+02, 1.10000E+02, 
 1.60000E+02, 1.00000E+02, 
 1.62000E+02, 9.00000E+01, 
 1.64000E+02, 8.00000E+01, 
 1.66000E+02, 7.00000E+01, 
 1.68000E+02, 6.00000E+01, 
 1.70000E+02, 5.00000E+01, 
 1.72000E+02, 4.00000E+01, 
 1.74000E+02, 3.00000E+01, 
 1.76000E+02, 2.00000E+01,
 ))


phase0=DEFI_CONSTANTE(VALE=0)

phase3=DEFI_FONCTION(NOM_PARA='INST',VALE=(
 0.00000E+00 , 0.00000E+00, 
 6.00000E+01 , 0.00000E+00, 
 6.20000E+01 , 3.92003E-02, 
 6.40000E+01 , 7.84006E-02, 
 6.60000E+01 , 1.17601E-01, 
 6.80000E+01 , 1.56801E-01, 
 7.00000E+01 , 1.96002E-01, 
 7.20000E+01 , 2.35202E-01, 
 7.40000E+01 , 2.74402E-01, 
 7.60000E+01 , 3.13603E-01, 
 7.80000E+01 , 3.52803E-01, 
 8.00000E+01 , 3.92003E-01, 
 8.20000E+01 , 4.31203E-01, 
 8.40000E+01 , 4.70404E-01, 
 8.60000E+01 , 5.09604E-01, 
 8.80000E+01 , 5.48804E-01, 
 9.00000E+01 , 5.88005E-01, 
 9.20000E+01 , 6.27205E-01, 
 9.40000E+01 , 6.66405E-01, 
 9.60000E+01 , 7.05606E-01, 
 9.80000E+01 , 7.44806E-01, 
 1.00000E+02 , 7.84006E-01, 
 1.02000E+02 , 8.23207E-01, 
 1.04000E+02 , 8.62407E-01, 
 1.06000E+02 , 9.01607E-01, 
 1.08000E+02 , 9.40808E-01, 
 1.10000E+02 , 9.80008E-01, 
 1.12000E+02 , 1.00000E+00, 
 1.76000E+02 , 1.00000E+00, 
 ))
 
v7=DEFI_FONCTION(NOM_PARA='INST',VALE=(
 0.00000E+00, 2.00000E+02, 
 8.20000E+01, 2.00000E+02, 
 8.40000E+01, 1.99972E+02, 
 8.60000E+01, 1.98747E+02, 
 8.80000E+01, 1.97522E+02, 
 9.00000E+01, 1.96297E+02, 
 9.20000E+01, 1.95072E+02, 
 9.40000E+01, 1.93847E+02, 
 9.60000E+01, 1.92622E+02, 
 9.80000E+01, 1.91397E+02, 
 1.00000E+02, 1.90172E+02, 
 1.02000E+02, 1.88947E+02, 
 1.04000E+02, 1.87722E+02, 
 1.06000E+02, 1.86497E+02, 
 1.08000E+02, 1.85272E+02, 
 1.10000E+02, 1.84047E+02, 
 1.12000E+02, 1.83435E+02, 
 1.14000E+02, 1.83435E+02, 
 1.16000E+02, 1.83435E+02, 
 1.18000E+02, 1.83435E+02, 
 1.20000E+02, 1.83435E+02, 
 1.22000E+02, 1.83435E+02, 
 1.24000E+02, 1.83435E+02, 
 1.26000E+02, 1.83435E+02, 
 1.28000E+02, 1.83435E+02, 
 1.30000E+02, 1.83435E+02, 
 1.32000E+02, 1.83435E+02, 
 1.34000E+02, 1.83435E+02, 
 1.36000E+02, 1.83435E+02, 
 1.38000E+02, 1.83435E+02, 
 1.40000E+02, 1.83435E+02, 
 1.42000E+02, 1.83435E+02, 
 1.44000E+02, 1.83435E+02, 
 1.46000E+02, 1.83435E+02, 
 1.48000E+02, 1.83435E+02, 
 1.50000E+02, 1.83435E+02, 
 1.52000E+02, 1.83435E+02, 
 1.54000E+02, 1.83435E+02, 
 1.56000E+02, 1.83435E+02, 
 1.58000E+02, 1.83435E+02, 
 1.60000E+02, 1.83435E+02, 
 1.62000E+02, 1.83435E+02, 
 1.64000E+02, 1.83435E+02, 
 1.66000E+02, 1.83435E+02, 
 1.68000E+02, 1.83435E+02, 
 1.70000E+02, 1.83435E+02, 
 1.72000E+02, 1.83435E+02, 
 1.74000E+02, 1.83435E+02, 
 1.76000E+02, 1.83435E+02, 
 ))


FBM1=DEFI_FONCTION(      NOM_PARA='TEMP',
                            PROL_DROITE='LINEAIRE',
                           PROL_GAUCHE='LINEAIRE',
                                 VALE=( 0.,  4353.14E+6,  20., 4257.40E+6,
                                       40.,  4161.57E+6,  60., 4065.64E+6,
                                       80.,  3969.62E+6, 100., 3873.50E+6,
                                      120.,  3777.29E+6, 140., 3680.98E+6,
                                      160.,  3584.58E+6, 180., 3488.09E+6,
                                      200.,  3391.50E+6, 220., 3294.81E+6,
                                      240.,  3198.03E+6, 260., 3101.16E+6,
                                      280.,  3004.19E+6, 300., 2907.12E+6,
                                      320.,  2809.96E+6, 340., 2712.70E+6,
                                      360.,  2615.35E+6, 380., 2517.90E+6,
                                      400.,  2420.35E+6, 420., 2322.71E+6,
                                      440.,  2224.97E+6, 460., 2127.13E+6,
                                      480.,  2029.20E+6, 500., 1931.17E+6,
                                      520.,  1833.04E+6, 540., 1734.82E+6,
                                      560.,  1636.50E+6, 580., 1538.08E+6,
                                      600.,  1439.56E+6, 620., 1340.95E+6,
                                      640.,  1242.24E+6, 660., 1143.42E+6,
                                      680.,  1044.52E+6, 700.,  945.51E+6,
                                      720.,   846.40E+6, 740.,  747.20E+6,
                                      760.,   647.89E+6, 780.,  548.49E+6,
                                      800.,   448.99E+6, 820.,  349.39E+6,
                                      840.,   249.69E+6, 860.,  149.89E+6,
                                      880.,    49.99E+6, 900.,  -50.01E+6,
                                      ))

FBM2=DEFI_FONCTION(      NOM_PARA='TEMP',
                            PROL_DROITE='LINEAIRE',
                           PROL_GAUCHE='LINEAIRE',
                                 VALE=( 0.,  80.E+6,  900., 530.E+6, ))

AUS1=DEFI_FONCTION(      NOM_PARA='TEMP',
                            PROL_DROITE='LINEAIRE',
                           PROL_GAUCHE='LINEAIRE',
                                 VALE=( 0.,  5589.31E+6,  20., 5494.77E+6,
                                       40.,  5400.14E+6,  60., 5305.43E+6,
                                       80.,  5210.62E+6, 100., 5115.71E+6,
                                      120.,  5020.72E+6, 140., 4925.63E+6,
                                      160.,  4830.45E+6, 180., 4735.17E+6,
                                      200.,  4639.80E+6, 220., 4544.34E+6,
                                      240.,  4448.79E+6, 260., 4353.14E+6,
                                      280.,  4257.40E+6, 300., 4161.57E+6,
                                      320.,  4065.64E+6, 340., 3969.62E+6,
                                      360.,  3873.50E+6, 380., 3777.29E+6,
                                      400.,  3680.98E+6, 420., 3584.58E+6,
                                      440.,  3488.09E+6, 460., 3391.50E+6,
                                      480.,  3294.81E+6, 500., 3198.03E+6,
                                      520.,  3101.16E+6, 540., 3004.19E+6,
                                      560.,  2907.12E+6, 580., 2809.96E+6,
                                      600.,  2712.70E+6, 620., 2615.35E+6,
                                      640.,  2517.90E+6, 660., 2420.35E+6,
                                      680.,  2322.71E+6, 700., 2224.97E+6,
                                      720.,  2127.13E+6, 740., 2029.20E+6,
                                      760.,  1931.17E+6, 780., 1833.04E+6,
                                      800.,  1734.82E+6, 820., 1636.50E+6,
                                      840.,  1538.08E+6, 860., 1439.56E+6,
                                      880.,  1340.95E+6, 900., 1242.24E+6,
                                      ))

AUS2=DEFI_FONCTION(      NOM_PARA='TEMP',
                            PROL_DROITE='LINEAIRE',
                           PROL_GAUCHE='LINEAIRE',
                                 VALE=( 0., -50.E+6,  900., 400.E+6, ))

ALP1=DEFI_FONCTION(      NOM_PARA='TEMP',
                            PROL_DROITE='CONSTANT',
                           PROL_GAUCHE='CONSTANT',
                                 VALE=( 0., 15.E-6,  900., 15.E-6, ))

ALP2=DEFI_FONCTION(      NOM_PARA='TEMP',
                            PROL_DROITE='CONSTANT',
                           PROL_GAUCHE='CONSTANT',
                                 VALE=( 0., 23.5E-6,  900., 23.5E-6, ))

FMEL=DEFI_FONCTION(      NOM_PARA='META',
                          PROL_DROITE='CONSTANT',
                         PROL_GAUCHE='CONSTANT',
                               VALE=( 0.,  0.,   1., 1., ))

YOUNG=DEFI_CONSTANTE( VALE=200000.E+6)

NU=DEFI_CONSTANTE( VALE=0.3)

ACIER2=DEFI_MATERIAU(
            ELAS_META_FO=_F( E = YOUNG,
                            NU = NU,
                            F_ALPHA = ALP1,
                            C_ALPHA = ALP2,
                            PHASE_REFE = 'CHAUD',
                            EPSF_EPSC_TREF = 2.52E-3,
                            F1_SY = FBM2,
                            F2_SY = FBM2,
                            F3_SY = FBM2,
                            F4_SY = FBM2,
                            C_SY = AUS2,
                            SY_MELANGE = FMEL,
                            TEMP_DEF_ALPHA=900.),
             META_ECRO_LINE=_F(
                            F1_D_SIGM_EPSI = FBM1,
                            F2_D_SIGM_EPSI = FBM1,
                            F3_D_SIGM_EPSI = FBM1,
                            F4_D_SIGM_EPSI = FBM1,
                            C_D_SIGM_EPSI = AUS1)
           )


RAMPE=DEFI_FONCTION(   NOM_PARA='INST',
           PROL_GAUCHE='LINEAIRE',  PROL_DROITE='CONSTANT',
           VALE=(0.0,0.0, 60.,360.0E+6,))

L_INST=DEFI_LIST_REEL(  DEBUT=0.0,INTERVALLE=(
             _F( JUSQU_A = 46.,      NOMBRE = 4),
             _F( JUSQU_A = 48.,      NOMBRE = 2),
             _F( JUSQU_A = 60.,      NOMBRE = 6),
             _F( JUSQU_A = 112.,      NOMBRE = 26),
             _F( JUSQU_A = 176.,      NOMBRE = 32))
           )
           
           
DEFLIST=DEFI_LIST_INST(DEFI_LIST=_F(LIST_INST=       L_INST))    
           
           
RESPM=SIMU_POINT_MAT(  
                COMPORTEMENT=_F(RELATION = 'META_P_IL',RELATION_KIT = ('ACIER',)   ),
                AFFE_VARC=(
                          _F(V1=phase0,V2=phase0,V3=phase3,V4=phase0,V5=phase0,V6=temp,V7=v7,NOM_VARC='M_ACIER',),
                          _F(VALE_FONC=temp,
                              VALE_REF=900.,
                              NOM_VARC='TEMP',),),
                NEWTON=_F(MATRICE='TANGENTE',REAC_ITER=1,REAC_INCR=5),
                CONVERGENCE=_F(ITER_GLOB_MAXI=50,),
                MATER      = ACIER2,
                INCREMENT=_F(LIST_INST=L_INST),
                SIGM_IMPOSE=_F(SIYY=RAMPE),
                        );


TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_REFE=0.041071624044260,
           VALE_CALC=0.041071624044260,
           NOM_PARA='V3',
           TABLE=RESPM,
           FILTRE=_F(NOM_PARA='INST',VALE=114.0,),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_REFE=0.036841623953657,
           VALE_CALC=0.036841623953657,
           NOM_PARA='EPYY',
           TABLE=RESPM,
           FILTRE=_F(NOM_PARA='INST',VALE=114.0,),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_REFE=0.062068878377520,
           VALE_CALC=0.0620689881148,
           NOM_PARA='V3',
           TABLE=RESPM,
           FILTRE=_F(NOM_PARA='INST',VALE=176.0,),
           )

FIN( )
#
