# TITRE FORMATION GC : PLAQUE CONSOLE EN FLEXION
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# MODELISATION B : DKT + GRILLE_EXCENTREE

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'));

#-----------------------------------------------------------------------
# VALIDATION DES GRILLES EXCENTREE SUR POUTRE CONSOLE (QUADRANGLE)
#-----------------------------------------------------------------------

MAILL1=LIRE_MAILLAGE(FORMAT='MED',);

MAILL2=CREA_MAILLAGE(MAILLAGE=MAILL1,
                     CREA_GROUP_MA=_F(NOM='ACPLUS',
                                      GROUP_MA='CONSOLE',
                                      PREF_MAILLE='B',),);

MAILTOT=CREA_MAILLAGE(MAILLAGE=MAILL2,
                      CREA_GROUP_MA=_F(NOM='ACMOINS',
                                       GROUP_MA='CONSOLE',
                                       PREF_MAILLE='C',),);

MAILTOT=DEFI_GROUP(reuse =MAILTOT,
                   MAILLAGE=MAILTOT,
                   CREA_GROUP_NO=_F(TOUT_GROUP_MA='OUI',),);

#
# -----------------------------------------------------
# DEFINITION DES MATERIAUX
# -----------------------------------------------------

ACIER=DEFI_MATERIAU(ELAS=_F(E=2.E11,
                            NU=0.,
                            RHO=7800.,
                            ),);

BETON=DEFI_MATERIAU(ELAS=_F(E=3.E10,
                            NU=0.,
                            RHO=2500.,
                            ),);

#
# -------------------------------------------------
# AFFECTATION DES MATERIAUX
# -------------------------------------------------

MATAF=AFFE_MATERIAU(MAILLAGE=MAILTOT,
                    AFFE=(_F(GROUP_MA=('ACPLUS','ACMOINS',),
                             MATER=ACIER,),
                          _F(GROUP_MA='CONSOLE',
                             MATER=BETON,),),);

#
# -------------------------------------------------
# AFFECTATION DES MODELES
# -------------------------------------------------

LEMOD=AFFE_MODELE(MAILLAGE=MAILTOT,
                  VERIF='MAILLE',
                  AFFE=(
                         _F(GROUP_MA=('ACPLUS','ACMOINS',),
                           PHENOMENE='MECANIQUE',
                          MODELISATION='GRILLE_EXCENTRE',),
                        _F(GROUP_MA='CONSOLE',
                           PHENOMENE='MECANIQUE',
                           MODELISATION='DKT',),),);

# -------------------------------------------------
# AFFECTATION DES CARACTERISTIQUES
# -------------------------------------------------

LACAR=AFFE_CARA_ELEM(MODELE=LEMOD,
                     COQUE=_F(GROUP_MA=('CONSOLE',),
                              EPAIS=.2,
                              ANGL_REP=(0.0,0.0,),),
                     GRILLE=(_F(GROUP_MA='ACPLUS',
                                SECTION=.2,
                                ANGL_REP=(0,0,),
                                EXCENTREMENT=.05,),
                             _F(GROUP_MA='ACMOINS',
                                SECTION=.2,
                                ANGL_REP=(0,0,),
                                EXCENTREMENT=-.05,),)
                       );

# ----------------------------------------------
# CHARGEMENT
# ----------------------------------------------

CLIM=AFFE_CHAR_MECA(MODELE=LEMOD,
                    PESANTEUR=_F(GRAVITE=9.81,
                                 DIRECTION=(0.,0.,-1.,),),
                    DDL_IMPO=_F(GROUP_MA='B0X',
                                DX=0.,
                                DY=0.,
                                DZ=0.,
                                DRX=0.,
                                DRY=0.,
                                DRZ=0.,),);

CHAR=AFFE_CHAR_MECA(MODELE=LEMOD,
                    DDL_IMPO=_F(GROUP_MA='B1X',
                                DZ=-0.1,),);

FMULT=DEFI_FONCTION(NOM_PARA='INST',
                     VALE=(0.,0.,
                           1.,0.,
                           2.,1.,),);

# ----------------------------------------------
# CALCUL
# ----------------------------------------------

ZLIST=DEFI_LIST_REEL(DEBUT=0.,
                     INTERVALLE=_F(JUSQU_A=2.0,
                                   NOMBRE=2,),);

LEDEP=STAT_NON_LINE(MODELE=LEMOD,
                    CHAM_MATER=MATAF,
                    CARA_ELEM=LACAR,
                    EXCIT=(_F(CHARGE=CLIM,),
                           _F(CHARGE=CHAR,
                              FONC_MULT=FMULT,),),
                    COMPORTEMENT=_F(RELATION='ELAS',),
                    INCREMENT=_F(LIST_INST=ZLIST,),
                    CONVERGENCE =_F(RESI_GLOB_MAXI=0.1));


# -------------------------------------------------
# POST TRAITEMENT DES RESULTATS
# -------------------------------------------------
# CALCUL DES GRANDEURS INTERESSANTES

LEDEP=CALC_CHAMP(reuse =LEDEP,
                 RESULTAT=LEDEP,
                 DEFORMATION='EPSI_ELNO',
                 CONTRAINTE=('SIEF_ELNO','SIGM_ELNO',),
                 CRITERES=('SIEQ_ELNO'),
                 FORCE='FORC_NODA');

IMPR_RESU(FORMAT='MED',
          RESU=_F(RESULTAT=LEDEP,
                  GROUP_MA='CONSOLE',),);
#
#IMPR_RESU(RESU=_F(RESULTAT=LEDEP))
# OBTENTION DE LA COURBE FORCE-DEPLACEMENT

TAB_UZ=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                               INTITULE='DEPLACEMENT',
                               RESULTAT=LEDEP,
                               NOM_CHAM='DEPL',
                               TOUT_ORDRE='OUI',
                               PRECISION=1.E-06,
                               GROUP_NO='B1X',
                               NOM_CMP='DZ',),);

TAB_FZ=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                               INTITULE='RESU',
                               RESULTAT=LEDEP,
                               NOM_CHAM='FORC_NODA',
                               TOUT_ORDRE='OUI',
                               GROUP_NO='B1X',
                               RESULTANTE='DZ',),);

IMPR_TABLE(TABLE=TAB_UZ,);

IMPR_TABLE(TABLE=TAB_FZ,);

UZ=RECU_FONCTION(TABLE=TAB_UZ,
                 PARA_X='INST',
                 PARA_Y='DZ',
                 FILTRE=_F(NOM_PARA='NOEUD',
                           CRIT_COMP='EQ',
                           VALE_K='N3',),);

FZ=RECU_FONCTION(TABLE=TAB_FZ,
                 PARA_X='INST',
                 PARA_Y='DZ',);

IMPR_FONCTION(FORMAT='XMGRACE',
              UNITE=38,
              COURBE=_F(FONC_X=UZ,
                        FONC_Y=FZ,),
              TITRE='EFFORT-DEPLACEMENT GLOBAL DE LA POUTRE',
              LEGENDE_X='UZ',
              LEGENDE_Y='FZ',);

DEFO=MACR_LIGN_COUPE(RESULTAT=LEDEP,
                     NOM_CHAM='DEPL',
                     INST=2.,
                     LIGN_COUPE=_F(TYPE='SEGMENT',
                                   NB_POINTS=15,
                                   COOR_ORIG=(-5.0,0.,0.0,),
                                   COOR_EXTR=(5.0,0.,0.0,),),);

IMPR_TABLE(TABLE=DEFO,
           FORMAT='TABLEAU',);

IMPR_TABLE(TABLE=DEFO,
           FORMAT='XMGRACE',
           UNITE=29,
           FILTRE=_F(NOM_PARA='INST',
                     CRIT_COMP='EQ',
                     VALE=2.0,),
           NOM_PARA=('COOR_X','DZ',),);

SIG_ACM=POST_RELEVE_T(ACTION=_F(OPERATION='EXTREMA',
                               INTITULE='ACIERINF',
                               RESULTAT=LEDEP,
                               NOM_CHAM='SIEF_ELNO',
                               GROUP_MA='ACMOINS'
                               ,),);
IMPR_TABLE(TABLE=SIG_ACM)
SIG_ACP=POST_RELEVE_T(ACTION=_F(OPERATION='EXTREMA',
                               INTITULE='ACIERSUP',
                               RESULTAT=LEDEP,
                               NOM_CHAM='SIEF_ELNO',
                               GROUP_MA='ACPLUS'
                               ,),);
IMPR_TABLE(TABLE=SIG_ACP)
SIG_BET=POST_RELEVE_T(ACTION=_F(OPERATION='EXTREMA',
                               INTITULE='BETON',
                               RESULTAT=LEDEP,
                               NOM_CHAM='SIEF_ELNO',
                               GROUP_MA='CONSOLE'
                               ,),);
IMPR_TABLE(TABLE=SIG_BET)
###################################################################################
# TEST DE NON-REGRESSION


TEST_TABLE(CRITERE='RELATIF',
           VALE_CALC=2.95443E5,
           NOM_PARA='DZ',
           TABLE=TAB_FZ,
           FILTRE=_F(NOM_PARA='INST',
                     VALE=2.0,),
           )

TEST_TABLE(CRITERE='RELATIF',
           VALE_CALC=2.884270E6,
           NOM_PARA='VALE',
           TABLE=SIG_ACM,
           FILTRE=(_F(NOM_PARA='NUME_ORDRE',
                      VALE_I=2,),
                   _F(NOM_PARA='EXTREMA',
                      VALE_K='MAX',),
                   ),
           )

TEST_TABLE(CRITERE='RELATIF',
           VALE_CALC=2.4431400E7,
           NOM_PARA='VALE',
           TABLE=SIG_BET,
           FILTRE=(_F(NOM_PARA='NUME_ORDRE',
                      VALE_I=2,),
                   _F(NOM_PARA='EXTREMA',
                      VALE_K='MAX',),
                   ),
           )

FIN();

#
