# MODIF  DATE 29/05/2002   AUTEUR CIBHHAB S.VANDENBERGHE 
# RESPONSABLE ADBHHPM P.MASSIN
# DATE   : 10/07/2000
# AUTEUR : F. LEBOUVIER
# TITRE  : FLAMBEMENT D'UNE ENVELOPPE CYLINDRIQUE SOUS PRESSION
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
# (AT YOUR OPTION) ANY LATER VERSION.                                 
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
# ======================================================================
#          EXTERNE
#---------------------------------------------------------------------
#  - CALCUL DE STABILITE D'UNE ENVELOPPE CYLINDRIQUE MINCE
#    CALCUL DES CHARGES CRITIQUES CONDUISANT AU FLAMBEMENT ELASTIQUE
#  - MODELISATION AVEC DES ELEMENTS 'COQUE_3D'(TRIA7)
#---------------------------------------------------------------------
#
DEBUT( CODE=_F( NOM = 'SDLS505A',NIV_PUB_WEB='INTERNET'))

#
#PRE_IDEAS ();
#
MA=LIRE_MAILLAGE( )

#
MAIL=CREA_MAILLAGE(     MAILLAGE=MA,
                       MODI_MAILLE=_F( TOUT = 'OUI',    
                                    OPTION = 'TRIA6_7',  
                                   )
                     )

MAIL=DEFI_GROUP(reuse=MAIL,  MAILLAGE=MAIL,         
               CREA_GROUP_NO=_F( NOM = 'A',   NOEUD = 'NO7',  ))
#
#
MOEL=AFFE_MODELE(   MAILLAGE=MAIL,
                          AFFE=(_F( GROUP_MA='TOUT_ELT',
                                PHENOMENE = 'MECANIQUE',     
                                MODELISATION = 'COQUE_3D',)  ,
                                
                               _F( GROUP_MA='ARETE',
                                 PHENOMENE = 'MECANIQUE',     
                                 MODELISATION = '3D',)
                            ) 
                   )

#
#---------------------------------------------------------------------
#                     CARACTERISTIQUES ELEMENTAIRES
#---------------------------------------------------------------------
#
CAEL=AFFE_CARA_ELEM(   MODELE=MOEL,
                          COQUE=_F( GROUP_MA = 'TOUT_ELT',  
                                 EPAIS = 0.00045,     
                                 A_CIS = 9000.,     
                                 ANGL_REP = (90.,0.,),  
                                 )
                       )

#
#---------------------------------------------------------------------
#                     CARACTERISTIQUES MATERIAUX
#---------------------------------------------------------------------
#
MATERIAU=DEFI_MATERIAU(   ELAS=_F( E = 2.E+11,   
                                  NU = 0.3,  
                                  )
                          )

#
CHAM_MAT=AFFE_MATERIAU(   MAILLAGE=MAIL,
                                AFFE=_F( TOUT = 'OUI',   MATER = MATERIAU,  )
                          )

#
#---------------------------------------------------------------------
#                     CHARGEMENTS
#---------------------------------------------------------------------
#
CON_LI=AFFE_CHAR_MECA(        MODELE=MOEL,DDL_IMPO=(
                              _F( GROUP_NO = 'O_PRIME',  
                                        DX = 0.,   DY = 0.,  
                                       ),
                              _F( GROUP_NO = 'E',  
                                        DY = 0.,  
                                       ),
                              _F( GROUP_NO = 'CONTOUR',  
                                        DZ = 0.,  
                                       ))
                         )

#
CHARGE=AFFE_CHAR_MECA(        MODELE=MOEL,
                           FORCE_COQUE=_F( GROUP_MA = 'CYLINDRE',  
                                        PRES = -1.,      
                                        ),
                           FORCE_ARETE=_F( GROUP_MA = 'ARETE',  
                                         FZ = -0.025,        
                                        ) 
                        )

#
#---------------------------------------------------------------------
#                        RESOLUTION
#---------------------------------------------------------------------
#
RES=MECA_STATIQUE(      MODELE=MOEL,
                      CHAM_MATER=CHAM_MAT,
                       CARA_ELEM=CAEL,EXCIT=(
                           _F( CHARGE = CON_LI,  ),
                           _F( CHARGE = CHARGE,  )),
                    )

#
SIG=CREA_CHAMP(   RESULTAT=RES,
                   OPERATION='EXTR',
                   TYPE_CHAM='ELGA_SIEF_R',
                    NOM_CHAM='SIEF_ELGA_DEPL',
                   TYPE_MAXI='MINI',
                   TYPE_RESU='VALE'
                 )

#
MEL_RI_G=CALC_MATR_ELEM(     OPTION='RIGI_GEOM',
                               MODELE=MOEL,
                            CARA_ELEM=CAEL,
                            SIEF_ELGA=SIG
                          )

#
MEL_RI_M=CALC_MATR_ELEM(      OPTION='RIGI_MECA',
                                MODELE=MOEL,
                            CHAM_MATER=CHAM_MAT,
                             CARA_ELEM=CAEL,
                                CHARGE=(CHARGE, CON_LI,)
                          )

#
NUM=NUME_DDL(   MATR_RIGI=MEL_RI_M)

#
MAS_RI_M=ASSE_MATRICE(   MATR_ELEM=MEL_RI_M,   NUME_DDL=NUM)

#
MAS_RI_G=ASSE_MATRICE(   MATR_ELEM=MEL_RI_G,   NUME_DDL=NUM)

#
RESULT=MODE_ITER_SIMULT(      MATR_A=MAS_RI_M,
                                MATR_B=MAS_RI_G,
#                               METHODE='TRI_DIAG',
                               METHODE='SORENSEN',
                             CALC_FREQ=_F( OPTION = 'PLUS_PETITE',     ),
                             TYPE_RESU='MODE_FLAMB',
                             VERI_MODE=_F( SEUIL = 1.E-5,   )
                           )

RES_NORM=NORM_MODE(      MODE=RESULT,
                          NORME='TRAN'
                      )

CHA_DEPL=CREA_CHAMP(     RESULTAT=RESULT,
                          OPERATION='EXTR',
                          TYPE_CHAM='NOEU_DEPL_R',
                           NOM_CHAM='DEPL',
                          NUME_MODE=1
                       )

IMPR_RESU(  MODELE=MOEL, 
               RESU=_F( FORMAT = 'IDEAS',    
                     MAILLAGE = MAIL,  
                     RESULTAT = RES_NORM,  
                     )
           )

MODE_1=CREA_CHAMP(     RESULTAT=RES_NORM,
                        OPERATION='EXTR',
                        TYPE_CHAM='NOEU_DEPL_R',
                         NOM_CHAM='DEPL',
                       NUME_ORDRE=10 
                    )

RESU2=MODI_REPERE(
                  RESULTAT    = RES_NORM,
                  NUME_ORDRE  = 10,
                  MODI_CHAM   = (_F(NOM_CHAM    = 'DEPL',
                                   NOM_CMP     = ('DX','DY','DZ',),
                                   TYPE_CHAM   = 'VECT_3D',),),
                DEFI_REPERE = _F(
                                   REPERE     = 'CYLINDRIQUE',
                                   ORIGINE    = (0.0, 0.0, 0.0,),
                                   AXE_Z      = (0.0, 0.0, 1.0,),
                                  ),
                  INFO=2,
                )

#
#---------------------------------------------------------------------
#                        VERIFICATION DES RESULTATS
#---------------------------------------------------------------------
#
TEST_RESU(
      RESU=_F( RESULTAT = RESULT,             NUME_MODE = 10,  
            PARA = 'CHAR_CRIT',      
            VALE = -1.523E6,               PRECISION = 0.108,  
            CRITERE = 'RELATIF',   
            ),CHAM_NO=(
   _F( CHAM_GD = MODE_1,              NOEUD = 'NO6',
            NOM_CMP = 'DX',   
            VALE = -0.01021,                     PRECISION = 0.01,  
            CRITERE = 'RELATIF',   
            ),
   _F( CHAM_GD = MODE_1,              NOEUD = 'NO6', 
            NOM_CMP = 'DY',   
            VALE = 1.,                     PRECISION = 0.01,  
            CRITERE = 'RELATIF',   
            ),
   _F( CHAM_GD = MODE_1,              NOEUD = 'NO172',      
            NOM_CMP = 'DX',   
            VALE = -0.392,                PRECISION = 0.045,  
            CRITERE = 'RELATIF',   
            ),
   _F( CHAM_GD = MODE_1,              NOEUD = 'NO172',      
            NOM_CMP = 'DY',   
            VALE = -0.928,                PRECISION = 0.045,  
            CRITERE = 'RELATIF',   
            ),
   _F( CHAM_GD = MODE_1,              NOEUD = 'NO6',      
            NOM_CMP = 'DX',   
            VALE = -0.01021,                     PRECISION = 0.001,  
            CRITERE = 'RELATIF',  REFERENCE = 'NON_REGRESSION',
            ),
   _F( CHAM_GD = MODE_1,              NOEUD = 'NO6',      
            NOM_CMP = 'DY',   
            VALE = 1.,                     PRECISION = 0.001,  
            CRITERE = 'RELATIF',   REFERENCE = 'NON_REGRESSION', 
            ),
   _F( CHAM_GD = MODE_1,              NOEUD = 'NO172',      
            NOM_CMP = 'DX',   
            VALE = -0.376,                PRECISION = 0.001,  
            CRITERE = 'RELATIF',   REFERENCE = 'NON_REGRESSION', 
            ),
   _F( CHAM_GD = MODE_1,              NOEUD = 'NO172',      
            NOM_CMP = 'DY',   
            VALE = -0.9498,                PRECISION = 0.001,  
            CRITERE = 'RELATIF',   REFERENCE = 'NON_REGRESSION', 
            ))
            )

TEST_RESU(RESU=(

   # MODI_REPERE
   # -----------
        
         _F(    CRITERE = 'RELATIF',   PRECISION = 1.E-2,
         RESULTAT = RESU2, NOM_CHAM = 'DEPL',   NUME_ORDRE = 10,
         NOEUD = 'NO6',     NOM_CMP = 'DX',           VALE=-1.,),
         _F(    CRITERE = 'RELATIF',   PRECISION = 1.E-2,
         RESULTAT = RESU2, NOM_CHAM = 'DEPL',   NUME_ORDRE = 10,
         NOEUD = 'NO6',     NOM_CMP = 'DZ',           VALE=-0.01021,),
         _F(    CRITERE = 'RELATIF',   PRECISION = 2.5E-2,
         RESULTAT = RESU2, NOM_CHAM = 'DEPL',   NUME_ORDRE = 10,
         NOEUD = 'NO172',     NOM_CMP = 'DX',           VALE=1.,),
         _F(    CRITERE = 'RELATIF',   PRECISION = 2.5E-2,
         RESULTAT = RESU2, NOM_CHAM = 'DEPL',   NUME_ORDRE = 10,
         NOEUD = 'NO172',     NOM_CMP = 'DZ',         VALE=0.01021,),
        ))
#
FIN()
#
# 
