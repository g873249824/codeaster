# TITRE CALCUL 3D DE G FISSURE CIRCULAIRE EN MILIEU INFINI
# ======================================================================
# COPYRIGHT (C) 1991 - 2016  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# QUART DE FISSURE. CALCUL DU G BILINEAIRE

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'))

MA=LIRE_MAILLAGE(FORMAT='MED',)

MA=DEFI_GROUP( reuse=MA,   MAILLAGE=MA,CREA_GROUP_NO=(
                     _F(  GROUP_MA = 'SSUP_S'),
                     _F(  GROUP_MA = 'SAV_S'),
                     _F(  GROUP_MA = 'SLAT_S'),
                     _F(  GROUP_MA = 'LFF'))
                 )

MO=AFFE_MODELE(  MAILLAGE=MA,
                               AFFE=_F( TOUT = 'OUI',
                                     PHENOMENE = 'MECANIQUE',
                                     MODELISATION = '3D'))

MAT=DEFI_MATERIAU(ELAS=_F(  E = 2.E11, NU = 0.3))

CHMAT=AFFE_MATERIAU(  MAILLAGE=MA,
                           AFFE=_F(  TOUT = 'OUI',MATER = MAT))

F1=DEFI_FONCTION(    NOM_PARA='INST',
                             PROL_GAUCHE='LINEAIRE',
                              PROL_DROITE='CONSTANT',
                             VALE=( 0., 0.,
                                    1., 1.,
                                    2., 0.,
                                    3., 1.,
                                    4., 1.,  )  )

F2=DEFI_FONCTION(    NOM_PARA='INST',
                             PROL_GAUCHE='LINEAIRE',
                              PROL_DROITE='CONSTANT',
                             VALE=( 0., 0.,
                                    1., 0.,
                                    2., 1.,
                                    3., 1.,
                                    4., -1., )  )

LIST=DEFI_LIST_REEL(
                                DEBUT=0.E+0,

                              INTERVALLE=_F(
                      JUSQU_A = 4.,
                      NOMBRE = 4),
                                 INFO=1
                       )

#-----------------------------------------------------------------------
CHCL=AFFE_CHAR_MECA(  MODELE=MO,DDL_IMPO=(
                               _F( GROUP_NO = 'SSUP_S',   DZ = 0.),
                               _F( GROUP_NO = 'SLAT_S',   DX = 0.),
                               _F( GROUP_NO = 'SAV_S',    DY = 0.))
                            )

CH1=AFFE_CHAR_MECA(  MODELE=MO,
                              PRES_REP=_F( GROUP_MA = 'SINF',     PRES = -1.E6)
                            )

CH2=AFFE_CHAR_MECA(  MODELE=MO,FORCE_FACE=(
                             _F( GROUP_MA = 'SLAT',     FZ = +1.E6),
                             _F( GROUP_MA = 'SINF',     FX = +1.E6))
                           )

#-----------------------------------------------------------------------


RESU=STAT_NON_LINE(
                            MODELE=MO,
                        CHAM_MATER=CHMAT,EXCIT=(
                             _F(
                CHARGE = CHCL), _F(
                CHARGE = CH1,
                FONC_MULT = F1), _F(
                CHARGE = CH2,
                FONC_MULT = F2)),
                         COMPORTEMENT=_F(
                RELATION = 'ELAS'),
                         INCREMENT=_F(
                LIST_INST = LIST),
                       CONVERGENCE=_F(
                RESI_GLOB_RELA = 1.E-6),
                              INFO=1
              )

RESU=CALC_CHAMP(reuse=RESU,CONTRAINTE=('SIGM_ELNO'),VARI_INTERNE=('VARI_ELNO'),RESULTAT=RESU)


FOND=DEFI_FOND_FISS(MAILLAGE=MA,
                    SYME='OUI',
                    FOND_FISS=_F(GROUP_MA = 'LFF',
                                 DTAN_ORIG=(1., 0., 0.,),
                                 ),
                   )


G=CALC_G(  RESULTAT=RESU,OPTION='CALC_G_GLOB',
           THETA=_F(R_INF=0.2,
                    FOND_FISS=FOND,
                    MODULE=1.,
                    R_SUP=0.5),
        );


GBIL=CALC_G(  THETA=_F(R_INF=0.2,
                       FOND_FISS=FOND,
                       MODULE=1.,
                       R_SUP=0.5),
              RESULTAT=RESU,
              NUME_ORDRE=(1,2,3,4),
              OPTION='G_BILI_GLOB',
            );

GMAX=CALC_G(  THETA=_F(R_INF=0.2,
                       FOND_FISS=FOND,
                       MODULE=1.,
                       R_SUP=0.5),
                        RESULTAT=RESU,
                        NUME_ORDRE=(1,2,3,4),
                        BORNES=( _F( NUME_ORDRE = 1,
                                     VALE_MIN = 0.,
                                     VALE_MAX = 1.),
                                 _F( NUME_ORDRE = 2,
                                     VALE_MIN = 0.,
                                     VALE_MAX = 1.),
                                 _F( NUME_ORDRE = 3,
                                     VALE_MIN = 0.,
                                     VALE_MAX = 1.),
                                 _F( NUME_ORDRE = 4,
                                     VALE_MIN = 0.,
                                     VALE_MAX = 1.)),
                        OPTION='G_MAX_GLOB',
                );


IMPR_TABLE      ( UNITE=8,
                  TABLE           =  GMAX,
                );

IMPR_TABLE      ( TABLE           =  GBIL,
                  UNITE=8,
                );

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           PRECISION=4.3E-3,
           VALE_CALC= 36.555214573001,
           VALE_REFE=36.399999999999999,
           NOM_PARA='G',
           TABLE=G,
           FILTRE=_F(NOM_PARA='NUME_ORDRE',
                     VALE_I=1,),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           PRECISION=4.3E-3,
           VALE_CALC= 36.555214573001,
           VALE_REFE=36.399999999999999,
           NOM_PARA='G_BILIN',
           TABLE=GBIL,
           FILTRE=(_F(NOM_PARA='NUME_CMP_I',
                      VALE_I=1,),
                   _F(NOM_PARA='NUME_CMP_J',
                      VALE_I=1,),
                   ),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_CALC= 13.717257165123,
           VALE_REFE=13.720000000000001,
           NOM_PARA='G',
           TABLE=G,
           FILTRE=_F(NOM_PARA='NUME_ORDRE',
                     VALE_I=2,),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_CALC= 13.717257165123 ,
           VALE_REFE=13.720000000000001,
           NOM_PARA='G_BILIN',
           TABLE=GBIL,
           FILTRE=(_F(NOM_PARA='NUME_CMP_I',
                      VALE_I=2,),
                   _F(NOM_PARA='NUME_CMP_J',
                      VALE_I=2,),
                   ),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_CALC= 95.064697924297,
           VALE_REFE=95.040000000000006,
           NOM_PARA='G',
           TABLE=G,
           FILTRE=_F(NOM_PARA='NUME_ORDRE',
                     VALE_I=3,),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_CALC= 95.064697924297,
           VALE_REFE=95.040000000000006,
           NOM_PARA='G_BILIN',
           TABLE=GBIL,
           FILTRE=(_F(NOM_PARA='NUME_CMP_I',
                      VALE_I=3,),
                   _F(NOM_PARA='NUME_CMP_J',
                      VALE_I=3,),
                   ),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_CALC=5.4802455519517 ,
           VALE_REFE=5.4800000000000004,
           NOM_PARA='G',
           TABLE=G,
           FILTRE=_F(NOM_PARA='NUME_ORDRE',
                     VALE_I=4,),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_CALC= 5.4802455519517,
           VALE_REFE=5.4800000000000004,
           NOM_PARA='G_BILIN',
           TABLE=GBIL,
           FILTRE=(_F(NOM_PARA='NUME_CMP_I',
                      VALE_I=4,),
                   _F(NOM_PARA='NUME_CMP_J',
                      VALE_I=4,),
                   ),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           PRECISION=1.5E-3,
           VALE_CALC= 22.396113093086,
           VALE_REFE=22.41,
           NOM_PARA='G_BILIN',
           TABLE=GBIL,
           FILTRE=(_F(NOM_PARA='NUME_CMP_I',
                      VALE_I=2,),
                   _F(NOM_PARA='NUME_CMP_J',
                      VALE_I=1,),
                   ),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_CALC=22.837957407878 ,
           VALE_REFE=22.82,
           NOM_PARA='G_BILIN',
           TABLE=GBIL,
           FILTRE=(_F(NOM_PARA='NUME_CMP_I',
                      VALE_I=4,),
                   _F(NOM_PARA='NUME_CMP_J',
                      VALE_I=3,),
                   ),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_CALC= 95.064697924297 ,
           VALE_REFE=94.978274807445999,
           NOM_PARA='G',
           TABLE=GMAX,
           FILTRE=(_F(NOM_PARA='Q_1',
                      VALE=1.0,),
                   _F(NOM_PARA='Q_2',
                      VALE=1.0,),
                   _F(NOM_PARA='Q_3',
                      VALE=0.0,),
                   _F(NOM_PARA='Q_4',
                      VALE=0.0,),
                   ),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           VALE_CALC=477.09086688065  ,
           VALE_REFE=476.66324081187997,
           NOM_PARA='G',
           TABLE=GMAX,
           FILTRE=(_F(NOM_PARA='Q_1',
                      VALE=1.0,),
                   _F(NOM_PARA='Q_2',
                      VALE=1.0,),
                   _F(NOM_PARA='Q_3',
                      VALE=1.0,),
                   _F(NOM_PARA='Q_4',
                      VALE=1.0,),
                   ),
           )

FIN()
#
