# MODIF  DATE 01/07/2008   AUTEUR ASSIRE A.ASSIRE 
# TITRE VALIDATION DU CHAINAGE ASTER-EUROPLEXUS
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2008  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================

DEBUT(CODE=_F(NOM='ZZZZ235A',NIV_PUB_WEB='INTRANET',),IMPR_MACRO='OUI',);

MPa = 1000000.0;


# ------------------- Lecture du maillage

MA0=LIRE_MAILLAGE();

MA=CREA_MAILLAGE(MAILLAGE=MA0,
                 CREA_POI1=_F(NOM_GROUP_MA='PDALLE',
                              GROUP_MA='DALLE',),);


# ------------------- Affectation du modele

IMPR_RESU(FORMAT='ASTER',UNITE=94,
          RESU=_F(MAILLAGE=MA,
                     ),);



MO=AFFE_MODELE(MAILLAGE=MA,
               AFFE=(_F(GROUP_MA = 'DALLE',PHENOMENE = 'MECANIQUE',MODELISATION = 'DKTG'),  
                     _F(GROUP_MA = ['POUTRE_X','POUTRE_Y','POTEAUX'],PHENOMENE = 'MECANIQUE',MODELISATION = 'POU_D_E'),
                    )
               );


# ------------------- Definition des materiaux

BETON = DEFI_MATERIAU(ELAS=_F(
                    E = 30000*MPa,
                    NU = 0.3,
                    RHO = 2500,
                   ) 
                  );


ACIER = DEFI_MATERIAU(ELAS=_F(
                    E = 200000*MPa,
                    NU = 0.3,
                    RHO = 7500,
                   ) 
                  );


MATER=AFFE_MATERIAU(MAILLAGE=MA,
                       AFFE=( _F(GROUP_MA = 'DALLE',MATER = BETON),
                              _F(GROUP_MA = ['POUTRE_X','POUTRE_Y','POTEAUX'] ,MATER = ACIER),
                             
                            ), 
                           )




# ------------------- Caracteristiques des elements de structure

COQUE = []
COQUE =[_F(EPAIS=0.5,
            GROUP_MA = 'DALLE',
            COQUE_NCOU  = 1,
            INER_ROTA = 'OUI',
            ANGL_REP=(15,0.0,),
            EXCENTREMENT = 0)
         ]   


POUTRE = []
poutre1 = {'GROUP_MA':'POTEAUX', 'SECTION':'RECTANGLE',
           'CARA':('HY','HZ'),  
           'VALE':(0.4,0.6),  
                }

POUTRE.append(poutre1)

poutre1 = {'GROUP_MA':'POUTRE_X', 'SECTION':'RECTANGLE',
           'CARA':('HY','HZ'),  
           'VALE':(0.4,0.6),  
                }

POUTRE.append(poutre1)

poutre1 = {'GROUP_MA':'POUTRE_Y', 'SECTION':'RECTANGLE',
           'CARA':('HY','HZ'),  
           'VALE':(0.4,0.6),  
                }

POUTRE.append(poutre1)


ORIENTATION = []
ORIENTATION.append(_F(GROUP_MA='POUTRE_X',CARA = 'ANGL_VRIL',VALE=90))
ORIENTATION.append(_F(GROUP_MA='POUTRE_Y',CARA = 'ANGL_VRIL',VALE= 90))

#ORIENTATION.append(_F(GROUP_MA='POUTRE_Y',CARA = 'VECT_Y',VALE= [1,1,1]))


ELEM = AFFE_CARA_ELEM(MODELE = MO,
                      COQUE = COQUE,
                      POUTRE=POUTRE,
                      ORIENTATION = ORIENTATION,
                      RIGI_PARASOL=_F(GROUP_MA='DALLE',
                                    GROUP_MA_POI1 = 'PDALLE',
                                    COEF_GROUP=1.0,
                                    CARA='K_TR_D_N',
                                    UNITE_EUROPLEXUS=22,
                                    VALE=(
                                            0.13572E+12 ,
                                            0.13428E+12 ,
                                            0.13467E+12 ,
                                            0.24722E+15 ,
                                            0.22386E+15 ,
                                            0.30600E+15 ,
                                          ),                                    
                                    COOR_CENTRE=(0.0,0.0,-1.16E+01,),),
                     INFO=1,);
                         


# ------------------- Conditions aux limites

CH_PI=AFFE_CHAR_MECA(MODELE=MO,
                     PRES_REP=(_F(PRES = -0.01,GROUP_MA = 'DALLE',),),
                    );

#
# -----------------------------------------------------------
# DEFINITION DE LA FORCE D'IMPACT LINEAIRE
# -----------------------------------------------------------

FONCCB=DEFI_FONCTION(NOM_PARA='INST',
                     VALE=(0.0,    65.E6,
                           0.0010,  65.E6,
                           0.130,  65.E6,
                           0.170, 250.E6,
                           0.200, 250.E6,
                           0.210,  65.E6,
                           0.300,  65.E6,
                           0.400,   0.0,
                           100.0,    0.0),
                     INTERPOL='LIN',
                     PROL_DROITE='CONSTANT',
                     PROL_GAUCHE='CONSTANT',
                     VERIF='CROISSANT',);


NFKT=DEFI_FONCTION(NOM_PARA='INST',
                   VALE=(-1.0,     1.0,
                          0.0,     0.0,
                          1.0,     -1.0,
                        ),
                   );

NFKR=DEFI_FONCTION(NOM_PARA='INST',
                   VALE=(-10.,     10.,
                          0.0,     0.0,
                          10.,     -10.
                        ),
                   );

U = MACR_EUROPLEXUS(
#   LOGICIEL='/home/assire/bin/runepx_d',
   MODELE=MO,
   CHAM_MATER=MATER,
   CARA_ELEM=ELEM,
   FONC_PARASOL = _F(NFKT = NFKT,
                     NFKR = NFKR,
                    ),
   EXCIT=(_F(CHARGE=CH_PI,FONC_MULT=FONCCB,),),
   DIME = _F(UNITE_DIME = 40,
             TABLE = (5,6000),),
   CALCUL = _F(TYPE_DISCRETISATION  ='UTIL',
               TINI  = 0,
               TFIN  = 2e-3,
               NMAX  = 5,
               PASFIX = 1e-3,                                                            
               ),
   OBSERVATION = _F(PAS_NBRE=1,
                    TOUT_GROUP_NO = 'OUI',
                    TOUT_GROUP_MA = 'OUI',
                    NOM_CHAM = ('DEPL','VITE','ACCE'),
                    ),
   RESULTAT   = _F(PAS_NBRE=1,),
   );

IMPR_RESU(RESU=_F(RESULTAT=U, NUME_ORDRE=2),)

STANLEY()

TEST_RESU(
   RESU=(
        _F(
          RESULTAT   = U,
          INST       = 2.E-03,
          NOM_CHAM   = 'DEPL',
          NOM_CMP    = 'DZ',
          NOEUD      = 'N1',
          REFERENCE  = 'SOURCE_EXTERNE', 
          VALE       = 5.56E-03,
        ),
        _F(
          RESULTAT   = U,
          INST       = 2.E-03,
          NOM_CHAM   = 'VITE',
          NOM_CMP    = 'DRZ',
          NOEUD      = 'N50',
          REFERENCE  = 'SOURCE_EXTERNE',
          VALE       = -4.78204E-05,
        ),
        _F(
          RESULTAT   = U,
          INST       = 2.E-03,
          NOM_CHAM   = 'ACCE',
          NOM_CMP    = 'DRX',
          NOEUD      = 'N1',
          REFERENCE  = 'SOURCE_EXTERNE',
          VALE       = 2.43886E+08,
        ),
    )
  );


FIN()
