# MODIF  DATE 25/02/2013   AUTEUR FLEJOU J-L.FLEJOU 
#
# TITRE VALIDATION DES CARACTERISTIQUES DE COQUES/GRILLE FONCTION DE L'ESPACE
# zzzz331a.para = tps_job 60 mem_job 256Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#
DEBUT(CODE=_F(NOM='ZZZZ331A',NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'), )

mail=LIRE_MAILLAGE(UNITE=17, FORMAT='MED',)

modelco=AFFE_MODELE(
   MAILLAGE=mail,
   AFFE=_F(GROUP_MA='surfco', PHENOMENE='MECANIQUE', MODELISATION='DKT',),
)

modelgr=AFFE_MODELE(
   MAILLAGE=mail,
   AFFE=_F(GROUP_MA='surfgr', PHENOMENE='MECANIQUE', MODELISATION='GRILLE_EXCENTRE',),
)

model=AFFE_MODELE(
   MAILLAGE=mail,
   AFFE=(
      _F(GROUP_MA='surfco', PHENOMENE='MECANIQUE', MODELISATION='DKT',),
      _F(GROUP_MA='surfgr', PHENOMENE='MECANIQUE', MODELISATION='GRILLE_EXCENTRE',),
   ),
)

# Coques
epais   = FORMULE(VALE='0.001*Z', NOM_PARA=('X','Y','Z',),)
decal   = FORMULE(VALE='0.002*Z', NOM_PARA=('X','Y','Z',),)
# Grilles
section = FORMULE(VALE='0.001*Z+0.001*X*Y', NOM_PARA=('X','Y','Z',),)
excent  = FORMULE(VALE='0.002*(Z+X+Y)',  NOM_PARA=('X','Y','Z',),)

# Pour vérifier que cela fonctionne sur les COQUE et/ou GRILLE
caraco=AFFE_CARA_ELEM(MODELE=modelco,
   COQUE=_F(GROUP_MA='surfco', EPAIS_FO=epais, EXCENTREMENT_FO=decal, INER_ROTA='OUI',),
)
caragr=AFFE_CARA_ELEM(MODELE=modelgr,
   GRILLE=_F(GROUP_MA='surfgr', SECTION_FO=section, EXCENTREMENT_FO=excent,),
)
carael=AFFE_CARA_ELEM(MODELE=model,
   COQUE= _F(GROUP_MA='surfco', EPAIS_FO  =epais,   EXCENTREMENT_FO=decal, INER_ROTA='OUI',),
   GRILLE=_F(GROUP_MA='surfgr', SECTION_FO=section, EXCENTREMENT_FO=excent,),
)
# Pour vérifier qu'en croisant les _FO cela fonctionne sur les COQUE et/ou GRILLE
CQext = 0.123 ; CQep  = 0.222 ; GRext = 0.456 ; GRsec = 0.325
#
caco01=AFFE_CARA_ELEM(MODELE=modelco,
   COQUE=_F(GROUP_MA='surfco', EPAIS_FO=epais, EXCENTREMENT=CQext, INER_ROTA='OUI',),
)
caco02=AFFE_CARA_ELEM(MODELE=modelco,
   COQUE=_F(GROUP_MA='surfco', EPAIS=CQep, EXCENTREMENT_FO=decal, INER_ROTA='OUI',),
)
cagr01=AFFE_CARA_ELEM(MODELE=modelgr,
   GRILLE=_F(GROUP_MA='surfgr', SECTION_FO=section, EXCENTREMENT=GRext,),
)
cagr02=AFFE_CARA_ELEM(MODELE=modelgr,
   GRILLE=_F(GROUP_MA='surfgr', SECTION=GRsec, EXCENTREMENT_FO=excent,),
)
cael01=AFFE_CARA_ELEM(MODELE=model,
   COQUE= _F(GROUP_MA='surfco', EPAIS_FO  =epais,   EXCENTREMENT=CQext, INER_ROTA='OUI',),
   GRILLE=_F(GROUP_MA='surfgr', SECTION_FO=section, EXCENTREMENT=GRext,),
)
cael02=AFFE_CARA_ELEM(MODELE=model,
   COQUE= _F(GROUP_MA='surfco', EPAIS     =CQep,   EXCENTREMENT_FO=decal, INER_ROTA='OUI',),
   GRILLE=_F(GROUP_MA='surfgr', SECTION   =GRsec,  EXCENTREMENT_FO=excent,),
)
cael03=AFFE_CARA_ELEM(MODELE=model,
   COQUE= _F(GROUP_MA='surfco', EPAIS_FO  =epais,   EXCENTREMENT   =CQext, INER_ROTA='OUI',),
   GRILLE=_F(GROUP_MA='surfgr', SECTION   =GRsec,   EXCENTREMENT_FO=excent,),
)
cael04=AFFE_CARA_ELEM(MODELE=model,
   COQUE= _F(GROUP_MA='surfco', EPAIS     =CQep,    EXCENTREMENT_FO=decal, INER_ROTA='OUI',),
   GRILLE=_F(GROUP_MA='surfgr', SECTION_FO=section, EXCENTREMENT   =GRext,),
)
cael05=AFFE_CARA_ELEM(MODELE=model,
   COQUE= _F(GROUP_MA='surfco', EPAIS  =CQep,   EXCENTREMENT=CQext, INER_ROTA='OUI',),
   GRILLE=_F(GROUP_MA='surfgr', SECTION=GRsec,  EXCENTREMENT=GRext,),
)

# Création des champs et des tables
Ccaraco  = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=caraco,  NOM_CHAM='.CARCOQUE',)
Tcaraco  = CREA_TABLE(RESU=_F(CHAM_GD=Ccaraco,  GROUP_MA='surfco', NOM_CMP=('EP',    'EXCENT',),),)

Ccaragr  = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=caragr,  NOM_CHAM='.CARCOQUE',)
Tcaragr  = CREA_TABLE(RESU=_F(CHAM_GD=Ccaragr,  GROUP_MA='surfgr', NOM_CMP=('SECT_L','DIST_N',),),)

Ccaraelc = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=carael, NOM_CHAM='.CARCOQUE',)
Tcaraelc = CREA_TABLE(RESU=_F(CHAM_GD=Ccaraelc, GROUP_MA='surfco', NOM_CMP=('EP',    'EXCENT',),),)
Ccaraelg = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=carael, NOM_CHAM='.CARCOQUE',)
Tcaraelg = CREA_TABLE(RESU=_F(CHAM_GD=Ccaraelc, GROUP_MA='surfgr', NOM_CMP=('SECT_L','DIST_N',),),)

Ccaco01  = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=caco01,  NOM_CHAM='.CARCOQUE',)
Tcaco01  = CREA_TABLE(RESU=_F(CHAM_GD=Ccaco01,  GROUP_MA='surfco', NOM_CMP=('EP',    'EXCENT',),),)

Ccaco02  = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=caco02,  NOM_CHAM='.CARCOQUE',)
Tcaco02  = CREA_TABLE(RESU=_F(CHAM_GD=Ccaco02,  GROUP_MA='surfco', NOM_CMP=('EP',    'EXCENT',),),)

Ccagr01  = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cagr01,  NOM_CHAM='.CARCOQUE',)
Tcagr01  = CREA_TABLE(RESU=_F(CHAM_GD=Ccagr01,  GROUP_MA='surfgr', NOM_CMP=('SECT_L','DIST_N',),),)

Ccagr02  = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cagr02,  NOM_CHAM='.CARCOQUE',)
Tcagr02  = CREA_TABLE(RESU=_F(CHAM_GD=Ccagr02,  GROUP_MA='surfgr', NOM_CMP=('SECT_L','DIST_N',),),)

Ccael01c = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cael01,  NOM_CHAM='.CARCOQUE',)
Tcael01c = CREA_TABLE(RESU=_F(CHAM_GD=Ccael01c, GROUP_MA='surfco', NOM_CMP=('EP',    'EXCENT',),),)
Ccael01g = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cael01,  NOM_CHAM='.CARCOQUE',)
Tcael01g = CREA_TABLE(RESU=_F(CHAM_GD=Ccael01g, GROUP_MA='surfgr', NOM_CMP=('SECT_L','DIST_N',),),)

Ccael02c = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cael02,  NOM_CHAM='.CARCOQUE',)
Tcael02c = CREA_TABLE(RESU=_F(CHAM_GD=Ccael02c, GROUP_MA='surfco', NOM_CMP=('EP',    'EXCENT',),),)
Ccael02g = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cael02,  NOM_CHAM='.CARCOQUE',)
Tcael02g = CREA_TABLE(RESU=_F(CHAM_GD=Ccael02g, GROUP_MA='surfgr', NOM_CMP=('SECT_L','DIST_N',),),)

Ccael03c = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cael03,  NOM_CHAM='.CARCOQUE',)
Tcael03c = CREA_TABLE(RESU=_F(CHAM_GD=Ccael03c, GROUP_MA='surfco', NOM_CMP=('EP',    'EXCENT',),),)
Ccael03g = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cael03,  NOM_CHAM='.CARCOQUE',)
Tcael03g = CREA_TABLE(RESU=_F(CHAM_GD=Ccael03g, GROUP_MA='surfgr', NOM_CMP=('SECT_L','DIST_N',),),)

Ccael04c = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cael04,  NOM_CHAM='.CARCOQUE',)
Tcael04c = CREA_TABLE(RESU=_F(CHAM_GD=Ccael04c, GROUP_MA='surfco', NOM_CMP=('EP',    'EXCENT',),),)
Ccael04g = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cael04,  NOM_CHAM='.CARCOQUE',)
Tcael04g = CREA_TABLE(RESU=_F(CHAM_GD=Ccael04g, GROUP_MA='surfgr', NOM_CMP=('SECT_L','DIST_N',),),)

Ccael05c = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cael05,  NOM_CHAM='.CARCOQUE',)
Tcael05c = CREA_TABLE(RESU=_F(CHAM_GD=Ccael05c, GROUP_MA='surfco', NOM_CMP=('EP',    'EXCENT',),),)
Ccael05g = CREA_CHAMP(TYPE_CHAM='CART_CACOQU',  OPERATION='EXTR',  CARA_ELEM=cael05,  NOM_CHAM='.CARCOQUE',)
Tcael05g = CREA_TABLE(RESU=_F(CHAM_GD=Ccael05g, GROUP_MA='surfgr', NOM_CMP=('SECT_L','DIST_N',),),)

# Valeurs pour les COQUE des sommes absolues des fonctions
SFepais = 11.049149815875911
SFdecal = 22.098299631751825
# Valeur pour les GRILLE_EXCENTRE des sommes absolues des fonctions
SFsect  = 207.04394008891009
SFexce  =  32.044471796679
# Pour les constantes
NbCoque = 186 ; NbGrille = 220
#IMPR_RESU(FORMAT='RESULTAT',RESU=_F(MAILLAGE=mail),)

TEST_TABLE(TABLE=Tcaraco,  NOM_PARA='EP',     TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFepais)
TEST_TABLE(TABLE=Tcaraco,  NOM_PARA='EXCENT', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFdecal)

TEST_TABLE(TABLE=Tcaragr,  NOM_PARA='SECT_L', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFsect)
TEST_TABLE(TABLE=Tcaragr,  NOM_PARA='DIST_N', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFexce)

TEST_TABLE(TABLE=Tcaraelc, NOM_PARA='EP',     TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFepais)
TEST_TABLE(TABLE=Tcaraelc, NOM_PARA='EXCENT', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFdecal)

TEST_TABLE(TABLE=Tcaraelg, NOM_PARA='SECT_L', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFsect)
TEST_TABLE(TABLE=Tcaraelg, NOM_PARA='DIST_N', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFexce)

TEST_TABLE(TABLE=Tcaco01,  NOM_PARA='EP',     TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFepais)
TEST_TABLE(TABLE=Tcaco01,  NOM_PARA='EXCENT', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbCoque*CQext)

TEST_TABLE(TABLE=Tcaco02,  NOM_PARA='EP',     TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbCoque*CQep )
TEST_TABLE(TABLE=Tcaco02,  NOM_PARA='EXCENT', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFdecal)

TEST_TABLE(TABLE=Tcagr01,  NOM_PARA='SECT_L', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFsect)
TEST_TABLE(TABLE=Tcagr01,  NOM_PARA='DIST_N', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbGrille*GRext)

TEST_TABLE(TABLE=Tcagr02,  NOM_PARA='SECT_L', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbGrille*GRsec)
TEST_TABLE(TABLE=Tcagr02,  NOM_PARA='DIST_N', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFexce)

TEST_TABLE(TABLE=Tcael01c, NOM_PARA='EP',     TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFepais)
TEST_TABLE(TABLE=Tcael01c, NOM_PARA='EXCENT', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbCoque*CQext)

TEST_TABLE(TABLE=Tcael01g, NOM_PARA='SECT_L', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFsect)
TEST_TABLE(TABLE=Tcael01g, NOM_PARA='DIST_N', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbGrille*GRext)

TEST_TABLE(TABLE=Tcael02c, NOM_PARA='EP',     TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbCoque*CQep )
TEST_TABLE(TABLE=Tcael02c, NOM_PARA='EXCENT', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFdecal)

TEST_TABLE(TABLE=Tcael02g, NOM_PARA='SECT_L', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbGrille*GRsec)
TEST_TABLE(TABLE=Tcael02g, NOM_PARA='DIST_N', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFexce)

TEST_TABLE(TABLE=Tcael03c, NOM_PARA='EP',     TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFepais)
TEST_TABLE(TABLE=Tcael03c, NOM_PARA='EXCENT', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbCoque*CQext)

TEST_TABLE(TABLE=Tcael03g, NOM_PARA='SECT_L', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbGrille*GRsec)
TEST_TABLE(TABLE=Tcael03g, NOM_PARA='DIST_N', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFexce)

TEST_TABLE(TABLE=Tcael04c, NOM_PARA='EP',     TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbCoque*CQep )
TEST_TABLE(TABLE=Tcael04c, NOM_PARA='EXCENT', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFdecal)

TEST_TABLE(TABLE=Tcael04g, NOM_PARA='SECT_L', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=SFsect)
TEST_TABLE(TABLE=Tcael04g, NOM_PARA='DIST_N', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbGrille*GRext)

TEST_TABLE(TABLE=Tcael05c, NOM_PARA='EP',     TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbCoque*CQep )
TEST_TABLE(TABLE=Tcael05c, NOM_PARA='EXCENT', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbCoque*CQext)

TEST_TABLE(TABLE=Tcael05g, NOM_PARA='SECT_L', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbGrille*GRsec)
TEST_TABLE(TABLE=Tcael05g, NOM_PARA='DIST_N', TYPE_TEST='SOMM_ABS', TOLE_MACHINE=1.0E-11, VALE_CALC=NbGrille*GRext)


FIN()
