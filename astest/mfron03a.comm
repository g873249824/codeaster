# -*- coding: utf-8 -*-
# person_in_charge: jean-michel.proix at edf.fr
# ======================================================================
# COPYRIGHT (C) 1991 - 2016  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# Comparaison entre la loi OrthotropicElast (MFront) et la loi 
# ELAS orthotrope (ELAS_ORTH) (Code_Aster)
# Validation bas√©e sur les deplacements, deformations totales, 
# contraintes et la densite d energie elastique

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

CUBE=LIRE_MAILLAGE(    )

MA=LIRE_MAILLAGE( )

DEFI_GROUP( reuse=MA,   MAILLAGE=MA,
            CREA_GROUP_MA=_F(  NOM = 'TOUT', TOUT = 'OUI'))


MOD3D=AFFE_MODELE(  MAILLAGE=MA,
           AFFE=_F( MAILLE = 'TET1', MODELISATION = '3D',
           PHENOMENE = 'MECANIQUE'))

CAREL3D=AFFE_CARA_ELEM(MODELE=MOD3D,
                       MASSIF=_F(  GROUP_MA = 'TOUT',
                                   ANGL_REP = (30.,20.,10.,)))

CHAR3D=AFFE_CHAR_MECA(  MODELE=MOD3D,DDL_IMPO=(
              _F( NOEUD = 'A',   DX = 0.,       DY = 0.,     DZ = 0.),
              _F( NOEUD = 'B',   DX = 9.,       DY = 14.,    DZ = 18.),
              _F( NOEUD = 'C',   DX = 13.,      DY = 21.,    DZ = 26.),
              _F( NOEUD = 'D',   DX = 5.,      DY = 8.,    DZ = 11.)))


LISTE=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=_F(JUSQU_A=1.0,
                                    NOMBRE=5,),);




#=======================

# MATERIAU ORTHOTROPE  =

#=======================

MATORTH=DEFI_MATERIAU(
           ELAS_ORTH=_F(
              E_L = 11000.,     E_T = 5000.,   E_N = 8000.,
              NU_TN = 0.11,       NU_LN = 0.15,    NU_LT = 0.396,
              G_TN = 13000.,     G_LN = 7000.,   G_LT = 10500.) )

CHMATORT=AFFE_MATERIAU(  MAILLAGE=MA,
           AFFE=_F(  TOUT = 'OUI',   MATER = MATORTH) )


MATFRONT=DEFI_MATERIAU(
                 ELAS_ORTH=_F(
                               E_L = 11000.,
                               E_T = 5000.,
                               E_N = 8000.,
                               NU_LT = 0.396,
                               NU_TN = 0.11,
                               NU_LN = 0.15,
                               G_LT = 10500.,
                               G_TN = 13000.,
                               G_LN = 7000.,
                               ) ,
                 OrthotropicElast=_F(
                               YoungModulus1 = 11000. ,
                               YoungModulus2 = 5000. ,
                               YoungModulus3 = 8000.,
                               PoissonRatio12 = 0.396,
                               PoissonRatio23 = 0.11,
                               PoissonRatio13 = 0.15,
                               ShearModulus12 = 10500.,
                               ShearModulus23 = 13000.,
                               ShearModulus13 = 7000.,
                               ),
                               )

CHMATF=AFFE_MATERIAU(MAILLAGE=MA,
                    AFFE=_F(TOUT='OUI',
                            MATER=MATFRONT,),);

LISTE2=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=_F(JUSQU_A=1.0,
                                    NOMBRE=1,),);

MEST2=STAT_NON_LINE(MODELE=MOD3D,
                    CHAM_MATER=CHMATORT,
                    CARA_ELEM=CAREL3D,
                    EXCIT=_F( CHARGE = CHAR3D),
                    COMPORTEMENT=_F(RELATION='ELAS'),
                    INCREMENT=_F(LIST_INST=LISTE2),);


MFRONT=STAT_NON_LINE(INFO=1,
                    MODELE=MOD3D,
                    CHAM_MATER=CHMATF,
                    CARA_ELEM=CAREL3D,
                    EXCIT=_F( CHARGE = CHAR3D),
                    COMPORTEMENT=_F(RELATION='OrthotropicElast',
                                    RESI_INTE_RELA=1.E-8,),
                    INCREMENT=_F(LIST_INST=LISTE),);

CALC_CHAMP(reuse=MEST2,RESULTAT=MEST2,DEFORMATION=('EPSI_ELGA'),ENERGIE=('ENEL_ELGA','ENEL_ELNO'))

CALC_CHAMP(reuse=MFRONT,RESULTAT=MFRONT,DEFORMATION=('EPSI_ELGA'),ENERGIE=('ENEL_ELGA','ENEL_ELNO'))

TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=MEST2,
                   NOM_CHAM='DEPL',
                   NOEUD='C',
                   NOM_CMP='DY',
                   VALE_CALC=21.000000000,
                   VALE_REFE=21.0,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MEST2,
                   NOM_CHAM='EPSI_ELGA',
                   NOM_CMP='EPXY',
                   VALE_CALC=3.000000000,
                   VALE_REFE=3.0,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MEST2,
                   NOM_CHAM='EPSI_ELGA',
                   NOM_CMP='EPXZ',
                   VALE_CALC=4.000000000,
                   VALE_REFE=4.0,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MEST2,
                   NOM_CHAM='EPSI_ELGA',
                   NOM_CMP='EPYZ',
                   VALE_CALC=6.000000000,
                   VALE_REFE=6.0,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MEST2,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXX',
                   VALE_CALC=601.875405719,
                   VALE_REFE=601.87540022300004,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MEST2,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIYY',
                   VALE_CALC= 8.00536651E+04,
                   VALE_REFE=8.0053665130599999E4,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MEST2,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIZZ',
                   VALE_CALC= 7.85966068E+04,
                   VALE_REFE=7.8596606758199996E4,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MEST2,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXY',
                   VALE_CALC= 8.39482633E+04,
                   VALE_REFE=8.3948263250200005E4,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MEST2,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXZ',
                   VALE_CALC= 1.73390930E+04,
                   VALE_REFE=1.7339093049800002E4,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MEST2,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIYZ',
                   VALE_CALC= 1.26571710E+05,
                   VALE_REFE=1.26571710097E5,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MEST2,
                   NOM_CHAM='ENEL_ELGA',
                   NOM_CMP='TOTALE',
                   VALE_CALC= 1.55645558E+06,
                   VALE_REFE=1.5564555844099999E6,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-07,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=MEST2,
                   NOM_CHAM='ENEL_ELNO',
                   NOEUD='A',
                   NOM_CMP='TOTALE',
                   VALE_CALC= 1.55645558E+06,
                   VALE_REFE=1.5564555844099999E6,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-07,
                   MAILLE='TET1',),
                ),
          )


TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=MFRONT,
                   NOM_CHAM='DEPL',
                   NOEUD='C',
                   NOM_CMP='DY',
                   VALE_CALC=21.000000000,
                   VALE_REFE=21.0,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MFRONT,
                   NOM_CHAM='EPSI_ELGA',
                   NOM_CMP='EPXY',
                   VALE_CALC=3.000000000,
                   VALE_REFE=3.0,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MFRONT,
                   NOM_CHAM='EPSI_ELGA',
                   NOM_CMP='EPXZ',
                   VALE_CALC=4.000000000,
                   VALE_REFE=4.0,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MFRONT,
                   NOM_CHAM='EPSI_ELGA',
                   NOM_CMP='EPYZ',
                   VALE_CALC=6.000000000,
                   VALE_REFE=6.0,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MFRONT,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXX',
                   VALE_CALC=601.875405719,
                   VALE_REFE=601.87540022300004,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MFRONT,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIYY',
                   VALE_CALC= 8.00536651E+04,
                   VALE_REFE=8.0053665130599999E4,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MFRONT,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIZZ',
                   VALE_CALC= 7.85966068E+04,
                   VALE_REFE=7.8596606758199996E4,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MFRONT,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXY',
                   VALE_CALC= 8.39482633E+04,
                   VALE_REFE=8.3948263250200005E4,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MFRONT,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXZ',
                   VALE_CALC= 1.73390930E+04,
                   VALE_REFE=1.7339093049800002E4,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MFRONT,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIYZ',
                   VALE_CALC= 1.26571710E+05,
                   VALE_REFE=1.26571710097E5,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-08,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=MFRONT,
                   NOM_CHAM='ENEL_ELGA',
                   NOM_CMP='TOTALE',
                   VALE_CALC= 1.55645558E+06,
                   VALE_REFE=1.5564555844099999E6,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-07,
                   MAILLE='TET1',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=MFRONT,
                   NOM_CHAM='ENEL_ELNO',
                   NOEUD='A',
                   NOM_CMP='TOTALE',
                   VALE_CALC= 1.55645558E+06,
                   VALE_REFE=1.5564555844099999E6,
                   CRITERE='RELATIF',
                   PRECISION=9.9999999999999995E-07,
                   MAILLE='TET1',),
                ),
          )
FIN()
#
