# MODIF  DATE 06/05/2008   AUTEUR CNGUYEN C.NGUYEN 
# TITRE CONTACT DE DEUX POUTRES EN PETITES DEFORMATIONS
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2006  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#       ELEMENTS DE POUTRE, METHODE LAGRANGIENNE
#       REPRISE DU SSNV505F POUR VALIDER DIST_POUTRE
#

DEBUT(CODE=_F(NOM='SSNV505G', NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'))

# ---------------------  MAILLAGE ----------------

PRE_GIBI();

MAILL1=LIRE_MAILLAGE();

MAILL1=DEFI_GROUP(reuse =MAILL1,
                  MAILLAGE=MAILL1,
                  CREA_GROUP_NO=(_F(GROUP_MA=('POU1',),
                                   NOM='GROUP1',),
                                 _F(GROUP_MA=('POU2',),
                                   NOM='GROUP2',),
                                 ));

# ---- MODELE : POUTRE DROITE D'EULER ----

MODE=AFFE_MODELE(MAILLAGE=MAILL1,
                 AFFE=(_F(GROUP_MA='POU1',
                         PHENOMENE='MECANIQUE',
                         MODELISATION='POU_D_E',),
                       _F(GROUP_MA='POU2',
                         PHENOMENE='MECANIQUE',
                         MODELISATION='POU_D_E',),
                       ),);

# ------------- DEFINITON DU MATERIAU -----------

MPOUTRE=DEFI_MATERIAU(ELAS=_F(E=6.8948E3,NU=0.33333,RHO=7800.,),);

CM=AFFE_MATERIAU(MAILLAGE=MAILL1,
                 AFFE=_F(GROUP_MA=('POU1','POU2'),
                         MATER=MPOUTRE,),);

CHAMPCAR=AFFE_CARA_ELEM(MODELE=MODE,
                        POUTRE=(_F(GROUP_MA='POU1',
                                   SECTION='RECTANGLE',
                                   CARA=('HY','HZ',),
                                   VALE=(63.5,10.16,),),
                                _F(GROUP_MA='POU2',
                                   SECTION='RECTANGLE',
                                   CARA=('HY','HZ',),
                                   VALE=(63.5,10.16,),),
                                ),);

# ------------- DEFINITION D'UN CARA_ELEM POUR LE CONTACT -----------

MOD2=AFFE_MODELE(MAILLAGE=MAILL1,
                 AFFE=(_F(GROUP_MA='POU2',
                         PHENOMENE='MECANIQUE',
                         MODELISATION='POU_D_E',),
                       ),);

DEFI_R=AFFE_CARA_ELEM(MODELE=MOD2,
                        POUTRE=(_F(GROUP_MA='POU2',
                                   SECTION = 'CERCLE',
                                   CARA = ('R' , 'EP',),
                                   VALE = ( 31.75 ,  1.0 ),),
                                ),);

# ---------- CONDITIONS AUX LIMITES --------------

COND_LIM=AFFE_CHAR_MECA(MODELE=MODE,
                        DDL_IMPO=(_F(GROUP_NO=('A','B',),
                                     DX=0.0,DY=0.0,DZ=0.0,
                                     DRX=0.0,DRY=0.0,DRZ=0.0),
                                  _F(GROUP_NO=('GROUP1','GROUP2'),
                                     DZ=0.0,DRX=0.0,DRY=0.0,),
                                  ),);

CH1=AFFE_CHAR_MECA(MODELE=MODE,
                   DDL_IMPO=_F(GROUP_NO=('C'), DY=-790.,), );

# ---- METHODE LAGRANGIENNE ----

F_DIST_M=DEFI_CONSTANTE(VALE=31.75);
F_DIST_E=DEFI_CONSTANTE(VALE=31.75);

CHLAG=AFFE_CHAR_MECA(MODELE=MODE,
                   CONTACT=_F(GROUP_MA_MAIT='POU1',
                              GROUP_MA_ESCL='POU2',

                              METHODE='LAGRANGIEN',
                                  DIST_MAIT=F_DIST_M,
                                  DIST_ESCL=F_DIST_E,
                                  NORMALE = 'MAIT',
                                  VECT_MAIT = 'VECT_Y',
                                  MAIT_VECT_Y=(0.,0.,-1.,),
                                 

                              ),);

CHPOU=AFFE_CHAR_MECA(MODELE=MODE, INFO=2,
                   CONTACT=_F(GROUP_MA_MAIT='POU1',
                              GROUP_MA_ESCL='POU2',

                              METHODE='LAGRANGIEN',
                                  DIST_MAIT=F_DIST_M,
                                  DIST_POUTRE='OUI',
                                  CARA_ELEM=DEFI_R,
                                   NORMALE = 'MAIT',
                                  VECT_MAIT = 'VECT_Y',
                                  MAIT_VECT_Y=(0.,0.,-1.,),   

                              ),);

RAMPE=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(0.0,0.0,1.0,1.0),
                    PROL_DROITE='LINEAIRE',
                    PROL_GAUCHE='LINEAIRE',);

L_INST=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=(_F(JUSQU_A=1.,
                                     NOMBRE=50,),),);

L_ARCH=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=(_F(JUSQU_A=1.,
                                     NOMBRE=25,),),);

# ------------------------------------------------------------------------
#  CALCUL DE REFERENCE
# ------------------------------------------------------------------------

ULAG=STAT_NON_LINE(SOLVEUR=_F(SYME='OUI',),
                   MODELE=MODE,
                CHAM_MATER=CM,
                CARA_ELEM=CHAMPCAR,
                EXCIT=(_F(CHARGE=COND_LIM,),
                       _F(CHARGE=CH1,
                          FONC_MULT=RAMPE,),
                       _F(CHARGE=CHLAG,),
                      ),
                COMP_INCR=_F(RELATION='ELAS',),
                INCREMENT=_F(LIST_INST=L_INST,
                             INST_FIN=0.4,
                             SUBD_METHODE='UNIFORME', SUBD_PAS=4,
                             SUBD_PAS_MINI=1E-8,
                             ),
                NEWTON=_F(REAC_ITER=5,),
                CONVERGENCE=_F(ITER_GLOB_MAXI=20,),
                ARCHIVAGE=_F(ARCH_ETAT_INIT='OUI',
                             LIST_INST=L_ARCH),
                INFO=1,);

ULAG=CALC_NO( reuse =ULAG, RESULTAT=ULAG,
              OPTION='FORC_NODA', );

T_REA_LA=POST_RELEVE_T(ACTION=_F(INTITULE='REAC',
                                 GROUP_NO=('A','B'),
                                 RESULTAT=ULAG,
                                 NOM_CHAM='FORC_NODA',
                                 RESULTANTE='DY',
                                 OPERATION='EXTRACTION',),);

IMPR_TABLE(TABLE=T_REA_LA,);

# ------------------------------------------------------------------------
#  CALCUL VALIDANT DIST_POUTRE
# ------------------------------------------------------------------------

ULAG2=STAT_NON_LINE(SOLVEUR=_F(SYME='OUI',),
                    MODELE=MODE,
                CHAM_MATER=CM,
                CARA_ELEM=CHAMPCAR,
                EXCIT=(_F(CHARGE=COND_LIM,),
                       _F(CHARGE=CH1,
                          FONC_MULT=RAMPE,),
                       _F(CHARGE=CHPOU,),
                      ),
                COMP_INCR=_F(RELATION='ELAS',),
                INCREMENT=_F(LIST_INST=L_INST,
                             INST_FIN=0.4,
                             SUBD_METHODE='UNIFORME', SUBD_PAS=4,
                             SUBD_PAS_MINI=1E-8,
                             ),
                NEWTON=_F(REAC_ITER=5,),
                CONVERGENCE=_F(ITER_GLOB_MAXI=20,),
                ARCHIVAGE=_F(ARCH_ETAT_INIT='OUI',
                             LIST_INST=L_ARCH),
                INFO=1,);

ULAG2=CALC_NO( reuse =ULAG2, RESULTAT=ULAG2,
               OPTION='FORC_NODA', );

T_REA_L2=POST_RELEVE_T(ACTION=_F(INTITULE='REAC',
                                 GROUP_NO=('A','B'),
                                 RESULTAT=ULAG2,
                                 NOM_CHAM='FORC_NODA',
                                 RESULTANTE='DY',
                                 OPERATION='EXTRACTION',),);

IMPR_TABLE(TABLE=T_REA_L2,);

# ------------------------------------------------------------------------
TEST_TABLE(TABLE=T_REA_LA,
           NOM_PARA='DY',
           FILTRE=_F(NOM_PARA='INST',
                     VALE=1.60000E-01),
           VALE= 2.45987E+02,
           REFERENCE='NON_REGRESSION',
           VERSION='8.2.4',);

TEST_TABLE(TABLE=T_REA_LA,
           NOM_PARA='DY',
           FILTRE=_F(NOM_PARA='INST',
                     VALE=4.00000E-01),
           VALE= 1.25149E+03,
           REFERENCE='NON_REGRESSION',
           VERSION='8.2.4',);

# ------------------------------------------------------------------------
TEST_TABLE(TABLE=T_REA_L2,
           NOM_PARA='DY',
           FILTRE=_F(NOM_PARA='INST',
                     VALE=1.60000E-01),
           VALE= 2.45987E+02,
           REFERENCE='AUTRE_ASTER',);

TEST_TABLE(TABLE=T_REA_L2,
           NOM_PARA='DY',
           FILTRE=_F(NOM_PARA='INST',
                     VALE=4.00000E-01),
           VALE= 1.25149E+03,
           REFERENCE='AUTRE_ASTER',);

# ------------------------------------------------------------------------
FIN();
