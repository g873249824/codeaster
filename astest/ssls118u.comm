# TITRE  PLAQUE CARREE EN APPUI SIMPLE SOUS PRESSION SINUSOIDALE
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
#---------------------------------------------------------------------
#         - MODELISATION AVEC DES ELEMENTS 'Q4GG'(QUAD4+TRIA3)
#---------------------------------------------------------------------
#
DEBUT(CODE=_F(NOM='SSLS118U',NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))
EP = 0.1;            # Epaisseur
AX = 0.;             # Taux de ferraillage
AY = 0.;             # Taux de ferraillage
EZ = 0.038;          # Distance grille/surface moyenne de la dalle
EZ = 0.5*EP - EZ     # Enrobage
# R0 = EZ/(0.5*EP)   # Distance normalisee du ferraillage par rapport
                     # au feuillet moyen
R0 = 0.1  # Valeur Bidon

# Caracteristiques du beton

EB  = 25.;    # Module d'Young
NUB = 0.25;

# Caracteristiques de l'acier (armatures)

E  = 25.;    # Module d'Young
NU = 0.25;   # Coefficient de poisson


MA=LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='OUI'),FORMAT='MED',INFO=2);
MA=DEFI_GROUP(reuse =MA,
              CREA_GROUP_MA=_F(TOUT='OUI',
                               NOM='TOUT',),
              MAILLAGE=MA,
              CREA_GROUP_NO=(_F(GROUP_MA='AB',),
                             _F(GROUP_MA='BC',),
                             _F(GROUP_MA='CD',),
                             _F(GROUP_MA='DA',),),);
MO=AFFE_MODELE(AFFE=_F(TOUT='OUI',
                       PHENOMENE='MECANIQUE',
                       MODELISATION='Q4GG',),
               MAILLAGE=MA,);

MA=MODI_MAILLAGE( reuse=MA,
                  MAILLAGE=MA,
                  ORIE_NORM_COQUE=_F(  VECT_NORM = (0., 0., 1.,),
                                       GROUP_NO = 'O',
                                       GROUP_MA = 'MAIL1'),
                                       INFO=2
                                       )
CAR_ELE=AFFE_CARA_ELEM(MODELE=MO,
                       COQUE=_F(ANGL_REP=(0.0,0.0),
                                GROUP_MA='TOUT',
                                EPAIS=0.1,),);
CPRAG  = 0.
GAM    = 0.0

CPRG  = CPRAG
MF     = 1.0E16
QP     = 0.15E0

MAT_B=DEFI_MATERIAU(
                           ELAS = _F(
                                      E    =  EB,
                                      NU   =  NUB,
                                      RHO    = 2500.0,
                                     ),
                           BETON_ECRO_LINE = _F(
                                      D_SIGM_EPSI = 0.0,
                                      SYT   =  4.4E6,
                                      SYC    = -52.5E6,
                                     ),
                          );

MAT_A=DEFI_MATERIAU(
                           ELAS = _F(
                                      E    =  E,
                                      NU   =  NU,
                                     ),
                           ECRO_LINE = _F(
                                      D_SIGM_EPSI = 0.0,
                                      SY   =  5.E8,
                                     ),
                          );

MAT = DEFI_GLRC(RELATION='GLRC_DAMAGE',
                        BETON = _F(
                          MATER = MAT_B,
                          EPAIS = EP,
                          GAMMA = GAM,
                          QP1 = QP,
                          QP2 = QP,

                          C1N1 = CPRG,C1N2 = CPRG,C1N3 = CPRG,
                          C2N1 = CPRG,C2N2 = CPRG,C2N3 = CPRG,
                          C1M1 = CPRG,C1M2 = CPRG,C1M3 = CPRG,
                          C2M1 = CPRG,C2M2 = CPRG,C2M3 = CPRG,
                         ),
                        NAPPE = (_F(
                          MATER = MAT_A,
                          OMX = AX,
                          OMY = AY,
                          RX = R0,
                          RY = R0,
                         ),_F(
                          MATER = MAT_A,
                          OMX = AX,
                          OMY = AY,
                          RX = -R0,
                          RY = -R0,
                         )),
                         INFO=2,
                                             );


CHAM_MAT=AFFE_MATERIAU(AFFE=_F(MATER=MAT,
                               TOUT='OUI',),
                       MAILLAGE=MA,);
PO=1.0
P = FORMULE(NOM_PARA=('X','Y'),VALE='PO*sin(pi*X)*sin(pi*Y)''');

CHA=AFFE_CHAR_MECA(DDL_IMPO=(_F(
                                DX=0.0,
                                DY=0.0,
                                GROUP_NO='O',
                                DRZ=0.0,
                                DRX=0.0,
                                DRY=0.0,),
                             _F(DZ=0.0,
                                DX=0.0,
                                GROUP_NO='AB',
                                DRY=0.0,),
                             _F(DZ=0.0,
                                DY=0.0,
                                GROUP_NO='BC',
                                DRX=0.0,),
                             _F(DZ=0.0,
                                DX=0.0,
                                GROUP_NO='CD',
                                DRY=0.0,),
                             _F(DZ=0.0,
                                DY=0.0,
                                GROUP_NO='DA',
                                DRX=0.0,),),
                   MODELE=MO,
                   FORCE_ARETE=(_F(MY=0.0,
                                   GROUP_MA='AB',),
                                _F(MY=0.0,
                                   GROUP_MA='CD',),
                                _F(MX=0.0,
                                   GROUP_MA='BC',),
                                _F(MX=0.0,
                                   GROUP_MA='DA',),),);
CHA_P=AFFE_CHAR_MECA_F(MODELE=MO,
                       FORCE_COQUE=_F(PRES=P,
                                      GROUP_MA='MAIL1',),);
INST=DEFI_LIST_REEL(DEBUT=0.0,INTERVALLE=(
                          _F(JUSQU_A = 1.,NOMBRE = 1),
                      ),);

RESU=STAT_NON_LINE( MODELE=MO,
                      CHAM_MATER= CHAM_MAT,
                      CARA_ELEM = CAR_ELE,
                      COMP_INCR=_F(RELATION = 'ELAS',),
                      CONVERGENCE=_F(ITER_GLOB_MAXI=10),
                      INCREMENT=_F( LIST_INST = INST,
                                    PRECISION =1.E-1),
                       EXCIT=(_F(CHARGE=CHA,),
                              _F(CHARGE=CHA_P,),)
                     );
EFF=CALC_CHAMP(RESULTAT=RESU,CONTRAINTE=('EFGE_ELNO'))


TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DZ',
                   VALE_CALC=-1.200001741,
                   VALE_REFE=-1.1549229999999999,
                   PRECISION=0.044999999999999998,),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='NXX',
                   VALE_CALC= 0.00000000E+00,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=1.E-2,
                   MAILLE='M258',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='NYY',
                   VALE_CALC= 0.00000000E+00,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=1.E-2,
                   MAILLE='M258',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='NXY',
                   VALE_CALC= 0.00000000E+00,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=1.E-2,
                   MAILLE='M258',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='MXX',
                   VALE_CALC=-0.030831647,
                   VALE_REFE=-0.031662900000000001,
                   PRECISION=0.029999999999999999,
                   MAILLE='M258',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='MYY',
                   VALE_CALC=-0.030946106,
                   VALE_REFE=-0.031662900000000001,
                   PRECISION=0.029999999999999999,
                   MAILLE='M258',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='MXY',
                   VALE_CALC=-2.10713300E-04,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=1.E-2,
                   MAILLE='M258',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='QX',
                   VALE_CALC=-0.015171936,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=0.029999999999999999,
                   MAILLE='M258',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='QY',
                   VALE_CALC=0.017678340,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=0.029999999999999999,
                   MAILLE='M258',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='QX',
                   VALE_CALC=0.027482449,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=0.029999999999999999,
                   MAILLE='M54',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='QY',
                   VALE_CALC=-0.018688109,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=0.02,
                   MAILLE='M54',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='QX',
                   VALE_CALC=0.019832856,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=0.029999999999999999,
                   MAILLE='M126',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='O',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOM_CMP='QY',
                   VALE_CALC=0.020972284,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=0.029999999999999999,
                   MAILLE='M126',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1',
                   NOM_CMP='NXX',
                   VALE_CALC= 0.00000000E+00,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=1.E-2,
                   MAILLE='M108',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1',
                   NOM_CMP='NYY',
                   VALE_CALC= 0.00000000E+00,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=1.E-2,
                   MAILLE='M108',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1',
                   NOM_CMP='NXY',
                   VALE_CALC= 0.00000000E+00,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=1.E-2,
                   MAILLE='M108',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1',
                   NOM_CMP='MXX',
                   VALE_CALC= 2.13647653E-21,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=1.E-2,
                   MAILLE='M108',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1',
                   NOM_CMP='MYY',
                   VALE_CALC=-1.83676149E-21,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=1.E-2,
                   MAILLE='M108',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1',
                   NOM_CMP='MXY',
                   VALE_CALC=0.018494928,
                   VALE_REFE=0.018997199999999999,
                   PRECISION=0.029999999999999999,
                   MAILLE='M108',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1',
                   NOM_CMP='QX',
                   VALE_CALC= 6.61459483E-07,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=1.E-2,
                   MAILLE='M108',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=EFF,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1',
                   NOM_CMP='QY',
                   VALE_CALC=-6.61459483E-07,
                   VALE_REFE=0.0,
                   CRITERE='ABSOLU',
                   PRECISION=1.E-2,
                   MAILLE='M108',),
                ),
          )

#------- SIEF_ELGA A PARTIR DE MECA_STATIQUE (MS)

RESU_MS=MECA_STATIQUE( MODELE=MO,OPTION='SIEF_ELGA',
                       CHAM_MATER= CHAM_MAT,
                       CARA_ELEM = CAR_ELE,
                       EXCIT=(_F(CHARGE=CHA,),
                              _F(CHARGE=CHA_P,),)
                     );

#------- SIEF_ELGA A PARTIR DU DEPLACEMENT

U_MS=CREA_CHAMP(TYPE_CHAM='NOEU_DEPL_R',
                OPERATION='EXTR',
                RESULTAT=RESU_MS,
                NOM_CHAM='DEPL',);

RU_MS=CREA_RESU(OPERATION='AFFE', 
                TYPE_RESU='EVOL_ELAS', 
                NOM_CHAM='DEPL',
                AFFE= _F( CHAM_GD = U_MS, 
                          INST=1.,
                          MODELE=MO,
                          CHAM_MATER= CHAM_MAT,
                          CARA_ELEM = CAR_ELE,))

EF_RU_MS=CALC_CHAMP(RESULTAT=RU_MS,CONTRAINTE=('SIEF_ELGA'))

TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=RESU,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='MXX',
                   VALE_CALC=-0.031314405428197,
                   VALE_REFE=-0.031422380999999999,
                   CRITERE='RELATIF',
                   PRECISION=0.02,
                   MAILLE='M126',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=3,
                   RESULTAT=RESU,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='MYY',
                   VALE_CALC=-0.030929840534941,
                   VALE_REFE=-0.031566080000000003,
                   CRITERE='RELATIF',
                   PRECISION=0.035000000000000003,
                   MAILLE='M259',),
                ),
          )

TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=RESU_MS,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='MXX',
                   VALE_CALC=-0.031314405428197,
                   VALE_REFE=-0.031422380999999999,
                   CRITERE='RELATIF',
                   PRECISION=0.02,
                   MAILLE='M126',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=3,
                   RESULTAT=RESU_MS,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='MYY',
                   VALE_CALC=-0.030929840534941,
                   VALE_REFE=-0.031566080000000003,
                   CRITERE='RELATIF',
                   PRECISION=0.035000000000000003,
                   MAILLE='M259',),
                ),
          )

TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=EF_RU_MS,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='MXX',
                   VALE_CALC=-0.031314405428197,
                   VALE_REFE=-0.031422380999999999,
                   CRITERE='RELATIF',
                   PRECISION=0.02,
                   MAILLE='M126',),
                _F(NUME_ORDRE=1,
                   REFERENCE='ANALYTIQUE',
                   POINT=3,
                   RESULTAT=EF_RU_MS,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='MYY',
                   VALE_CALC=-0.030929840534941,
                   VALE_REFE=-0.031566080000000003,
                   CRITERE='RELATIF',
                   PRECISION=0.035000000000000003,
                   MAILLE='M259',),
                ),
          )

TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   POINT=1,
                   RESULTAT=EF_RU_MS,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='MXX',
                   VALE_CALC=-0.031314405428197,
                   CRITERE='RELATIF',
                   MAILLE='M126',),
                _F(NUME_ORDRE=1,
                   POINT=3,
                   RESULTAT=EF_RU_MS,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='MYY',
                   VALE_CALC=-0.030929840534941,
                   CRITERE='RELATIF',
                   MAILLE='M259',),
                ),
          )

FIN()
