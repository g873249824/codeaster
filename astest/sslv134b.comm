# MODIF  DATE 21/06/2011   AUTEUR MACOCCO K.MACOCCO 
# TITRE CALCUL 3D DE G FISSURE CIRCULAIRE EN MILIEU INFINI
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# QUART DE FISSURE. TEST DE POST_K1_K2_K3. MAILLAGE BARSOUM

DEBUT(CODE=_F(NOM='SSLV134B', NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'),
      MEMOIRE=_F(DYNAMIQUE=1),)

PRE_GIBI()

MA=LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='OUI'),)

MA=DEFI_GROUP( reuse=MA,   MAILLAGE=MA,
                     CREA_GROUP_NO=_F(
              GROUP_MA = ('SLA2_I', 'SLA2_S', 'SAV_I', 'SAV_S',))
                 )

MO=AFFE_MODELE(  MAILLAGE=MA,
                      AFFE=_F(  TOUT = 'OUI',
                             PHENOMENE = 'MECANIQUE',
                             MODELISATION = '3D') )

MA=MODI_MAILLAGE(reuse =MA,
                 MAILLAGE=MA,
                 ORIE_PEAU_3D=_F(GROUP_MA=('SLA2_I','SLA2_S','SAV_I','SAV_S',),),
                 );

MAT=DEFI_MATERIAU(ELAS=_F(  E = 2.E11,
                             NU = 0.3,
                             ALPHA = 0.) )

CHMAT=AFFE_MATERIAU(  MAILLAGE=MA,
                       AFFE=_F(  TOUT = 'OUI',
                              MATER = MAT) )

SYMETR1=AFFE_CHAR_MECA(MODELE=MO,
                       DDL_IMPO=_F(GROUP_NO='D',
                                   DZ=0.0,),
                       FACE_IMPO=_F(GROUP_MA=('SLA2_I','SLA2_S',),
                                    DNOR=0.0,),);

SYMETR2=AFFE_CHAR_MECA(MODELE=MO,
                       FACE_IMPO=_F(GROUP_MA=('SAV_I','SAV_S',),
                                    DNOR=0.0,),);

PRESSION=AFFE_CHAR_MECA(    MODELE=MO,FORCE_FACE=(
        _F(  GROUP_MA = 'SINF_S', FZ = 1.E6),
        _F(  GROUP_MA = 'SINF_1', FZ = -1.E6))
                         )

CHAMDEPL=MECA_STATIQUE(MODELE=MO,
                       CHAM_MATER=CHMAT,
                       EXCIT=(_F(CHARGE=PRESSION,),
                              _F(CHARGE=SYMETR1,),
                              _F(CHARGE=SYMETR2,),),);

CHAMDEPL=CALC_ELEM( reuse=CHAMDEPL,
                           OPTION='SIGM_ELNO',
                         RESULTAT=CHAMDEPL )

CHAMDEPL=CALC_NO( reuse=CHAMDEPL,
                           OPTION='SIGM_NOEU',
                         RESULTAT=CHAMDEPL )



TB2=MACR_LIGN_COUPE( RESULTAT= CHAMDEPL,
                     NOM_CHAM= 'SIGM_NOEU',
                     LIGN_COUPE = _F( TYPE='ARC',
                                      NB_POINTS= 16,
                                      CENTRE= (0. , 2., 0.), #N1710
                                      COOR_ORIG= (9.18855088244361E-17,  1.76000036554081E+00, -4.18878807815594E-04),#N4968
                                      ANGLE=360.,
                                      DNOR=(1.,0.,0.),
                                      DISTANCE_MAX=0.001,
                                      ),)
IMPR_TABLE(TABLE=TB2)

TEST_TABLE(  TABLE=TB2,
             FILTRE=_F( NOM_PARA = 'ANGLE',
                        VALE = 45.),
             REFERENCE='NON_REGRESSION',
             NOM_PARA='SIXX',
             VALE=-2.4471209706301E+05,
             PRECISION=0.00001)
TEST_TABLE(  TABLE=TB2,
             FILTRE=_F( NOM_PARA = 'ANGLE',
                        VALE = 45.),
             REFERENCE='NON_REGRESSION',
             NOM_PARA='SIYY',
             VALE= 3.6534668877556E+04,
             PRECISION=0.00001)
TEST_TABLE(  TABLE=TB2,
             FILTRE=_F( NOM_PARA = 'ANGLE',
                        VALE = 45.),
             REFERENCE='NON_REGRESSION',
             NOM_PARA='SIZZ',
             VALE= 3.5420343989978E+05,
             PRECISION=0.00001)

TB2L=MACR_LIGN_COUPE( RESULTAT= CHAMDEPL,
                     NOM_CHAM= 'SIGM_NOEU',
                     LIGN_COUPE = _F( TYPE='ARC',
                                      NB_POINTS= 16,
                                      CENTRE= (0. , 2., 0.), #N1710
                                      COOR_ORIG= (9.18855088244361E-17,  1.76000036554081E+00, -4.18878807815594E-04),#N4968
                                      ANGLE=360.,REPERE='CYLINDRIQUE',
                                      DNOR=(1.,0.,0.),
                                      DISTANCE_MAX=0.001,
                                      ),)
IMPR_TABLE(TABLE=TB2L)

TEST_TABLE(  TABLE=TB2L,
             FILTRE=_F( NOM_PARA = 'ANGLE',
                        VALE = 45.),
             REFERENCE='NON_REGRESSION',
             NOM_PARA='SIXX',
             VALE= 6.8308472910625E+05,
             PRECISION=0.00001)

TEST_TABLE(  TABLE=TB2L,
             FILTRE=_F( NOM_PARA = 'ANGLE',
                        VALE = 45.),
             REFERENCE='NON_REGRESSION',
             NOM_PARA='SIYY',
             VALE=-2.4471209706301E+05,
             PRECISION=0.00001)

TEST_TABLE(  TABLE=TB2L,
             FILTRE=_F( NOM_PARA = 'ANGLE',
                        VALE = 45.),
             REFERENCE='NON_REGRESSION',
             NOM_PARA='SIZZ',
             VALE=-2.9234662032891E+05,
             PRECISION=0.00001)

FISS=DEFI_FOND_FISS(MAILLAGE=MA,
                    FOND_FISS=_F(GROUP_MA = 'LFF1',
                                 GROUP_NO_ORIG = 'NFF1',
                                 GROUP_NO_EXTR = 'NFF2',
                                 DTAN_ORIG=(  1.,  0.,  0., ),
                                 DTAN_EXTR=(  0.,  1.,  0., ),),
                    LEVRE_SUP=_F(  GROUP_MA = 'LEVINFS'),
                    LEVRE_INF=_F(  GROUP_MA = 'LEVINF1'),
                   )

RSUP=0.5

RINF=0.2

# VALEUR DE REFERENCE MILIEU INFINI :
Gref  = 11.58648
K1ref =  1.595769E6

GLOC1=CALC_G(           RESULTAT=CHAMDEPL,
                        NUME_ORDRE = 1,
                        THETA=_F(FOND_FISS=FISS,
                                 R_SUP=RSUP,
                                 R_INF=RINF,),
                    )

TEST_TABLE(TABLE=GLOC1,
           NOM_PARA='G',
           FILTRE=_F(NOM_PARA = 'NOEUD',
                     VALE_K = 'N49'),
           VALE=Gref,
           PRECISION=0.03,
           REFERENCE='ANALYTIQUE'       )

TEST_TABLE(TABLE=GLOC1,
           NOM_PARA='G',
           FILTRE=_F(NOM_PARA = 'NOEUD',
                     VALE_K = 'N1710'),
           VALE=Gref,
           PRECISION=0.02,
           REFERENCE='ANALYTIQUE'       )

TEST_TABLE(TABLE=GLOC1,
           NOM_PARA='G',
           FILTRE=_F(NOM_PARA = 'NOEUD',
                     VALE_K = 'N77'),
           VALE=Gref,
           PRECISION=0.03,
           REFERENCE='ANALYTIQUE'       )

RAY_INF1=DEFI_CONSTANTE(VALE=RINF)

RAY_SUP1=DEFI_CONSTANTE(VALE=RSUP)

MOD_T1=DEFI_CONSTANTE(   VALE=1.    )

THETA1=CALC_THETA(      OPTION='COURONNE',
                          MODELE=MO,
                         FOND_FISS=FISS,
                        THETA_3D=_F(  TOUT = 'OUI',
                                   MODULE_FO = MOD_T1,
                                   R_INF_FO = RAY_INF1,
                                   R_SUP_FO = RAY_SUP1)
                    )

G0=CALC_G (                     OPTION='CALC_G_GLOB',
                                RESULTAT=CHAMDEPL,
                                NUME_ORDRE = 1,
                                THETA=_F(THETA=THETA1),
                       )

# VALEUR DE REFERENCE MILIEU INFINI : G=145.6
# POUR UN QUART DE FISSURE G=36.4


TEST_TABLE(       TABLE=G0,
                  NOM_PARA='G',
                      VALE=36.4,
                 PRECISION=0.012        )

# POST_K1_K2_K3

MA=DEFI_GROUP( reuse=MA,   MAILLAGE=MA,CREA_GROUP_NO=(
                   _F(  GROUP_MA = ( 'LEVINF1', 'LEVINFS', )),
                   _F(  NOM = 'N1',
                                   OPTION = 'PLAN',
                                   POINT = (0., 0., 0.,),
                                   VECT_NORMALE = (0., 1., 0.,),
                                   PRECISION = 1.E-4),
                   _F(  NOM = 'L1INF1',
                                   INTERSEC = ('LEVINF1', 'N1', )),
                   _F(  NOM = 'L1SUP1',
                                   INTERSEC = ('LEVINFS', 'N1', )),
                   _F(  NOM = 'N2',
                                   OPTION = 'PLAN',
                                   POINT = (0., 0., 0.,),
                                   VECT_NORMALE = (1., 0., 0.,),
                                   PRECISION = 1.E-4),
                   _F(  NOM = 'L2INF1',
                                   INTERSEC = ('LEVINF1', 'N2', )),
                   _F(  NOM = 'L2SUP1',
                                   INTERSEC = ('LEVINFS', 'N2', )),
                   _F(  NOM = 'N3',
                                   OPTION = 'PLAN',
                                   POINT = ( 0., 0., 0.,),
                                   VECT_NORMALE = (-1., 1., 0.,),
                                   PRECISION = 1.E-4),
                   _F(  NOM = 'L3INF1',
                                   INTERSEC = ('LEVINF1', 'N3', )),
                   _F(  NOM = 'L3SUP1',
                                   INTERSEC = ('LEVINFS', 'N3', )))
                   )

MA=DEFI_GROUP( reuse=MA,   MAILLAGE=MA,CREA_GROUP_NO=(
                   _F(  NOM = 'L1INF',
                                   OPTION = 'SEGM_DROI_ORDO',
                                   PRECISION = 1.E-3,
                                   CRITERE = 'ABSOLU',
                                   GROUP_NO = 'L1INF1',
                                   NOEUD_ORIG = 'N49',
                                   NOEUD_EXTR = 'N3751'),
                   _F(  NOM = 'L1SUP',
                                   OPTION = 'SEGM_DROI_ORDO',
                                   PRECISION = 1.E-3,
                                   CRITERE = 'ABSOLU',
                                   GROUP_NO = 'L1SUP1',
                                   NOEUD_ORIG = 'N49',
                                   NOEUD_EXTR = 'N3791'),
                   _F(  NOM = 'L2INF',
                                   OPTION = 'SEGM_DROI_ORDO',
                                   PRECISION = 1.E-3,
                                   CRITERE = 'RELATIF',
                                   GROUP_NO = 'L2INF1',
                                   NOEUD_ORIG = 'N1710',
                                   NOEUD_EXTR = 'N3751'),
                   _F(  NOM = 'L2SUP',
                                   OPTION = 'SEGM_DROI_ORDO',
                                   PRECISION = 1.E-3,
                                   CRITERE = 'RELATIF',
                                   GROUP_NO = 'L2SUP1',
                                   NOEUD_ORIG = 'N1710',
                                   NOEUD_EXTR = 'N3791'),
                   _F(  NOM = 'L3INF',
                                   OPTION = 'SEGM_DROI_ORDO',
                                   PRECISION = 1.E-3,
                                   CRITERE = 'ABSOLU',
                                   GROUP_NO = 'L3INF1',
                                   NOEUD_ORIG = 'N77',
                                   NOEUD_EXTR = 'N3751'),
                   _F(  NOM = 'L3SUP',
                                   OPTION = 'SEGM_DROI_ORDO',
                                   PRECISION = 1.E-3,
                                   CRITERE = 'ABSOLU',
                                   GROUP_NO = 'L3SUP1',
                                   NOEUD_ORIG = 'N77',
                                   NOEUD_EXTR = 'N3791'))
                 )

DEPB1=POST_RELEVE_T( ACTION=_F(  INTITULE = 'TAB1',
      # NOEUD : (N49 N245 N609 N2559 N3034 N3384 N617 N876 N618  )
                                GROUP_NO = 'L1INF',
                                RESULTAT = CHAMDEPL,
                                NOM_CHAM = 'DEPL',
                                NOM_CMP = ('DX', 'DY', 'DZ',),
                                OPERATION = 'EXTRACTION')
                              )

DEPH1=POST_RELEVE_T( ACTION=_F(  INTITULE = 'TAB2',
      # NOEUD : (N49 N449 N728 N2867 N3112 N3675 N736 N1064 N737 )
                                GROUP_NO = 'L1SUP',
                                RESULTAT = CHAMDEPL,
                                NOM_CHAM = 'DEPL',
                                NOM_CMP = ('DX', 'DY', 'DZ',),
                                OPERATION = 'EXTRACTION')
                              )

TABL_K1=POST_K1_K2_K3(  MODELISATION='3D',
                        MATER=MAT,
                        TABL_DEPL_SUP=DEPH1,
                        TABL_DEPL_INF=DEPB1,
                        ABSC_CURV_MAXI=0.35,
                        VECT_K1=(0., 0., 1.,)
                      )

IMPR_TABLE(TABLE=TABL_K1)

DEPB2=POST_RELEVE_T( ACTION=_F( INTITULE = 'TAB3',
                                GROUP_NO = 'L2INF',
                                RESULTAT = CHAMDEPL,
                                NOM_CHAM = 'DEPL',
                                NOM_CMP = ('DX', 'DY', 'DZ',),
                                OPERATION = 'EXTRACTION')
                              )

DEPH2=POST_RELEVE_T( ACTION=_F( INTITULE = 'TAB4',
                                GROUP_NO = 'L2SUP',
                                RESULTAT = CHAMDEPL,
                                NOM_CHAM = 'DEPL',
                                NOM_CMP = ('DX', 'DY', 'DZ',),
                                OPERATION = 'EXTRACTION')
                              )

TABL_K2=POST_K1_K2_K3(  MODELISATION='3D',
                        MATER=MAT,
                        TABL_DEPL_SUP=DEPH2,
                        TABL_DEPL_INF=DEPB2,
                        ABSC_CURV_MAXI=0.35,
                        VECT_K1=(0., 0., 1.,)
                      )

IMPR_TABLE(TABLE=TABL_K2)

DEPB3=POST_RELEVE_T( ACTION=_F(  INTITULE = 'TAB5',
                                GROUP_NO = 'L3INF',
                                RESULTAT = CHAMDEPL,
                                NOM_CHAM = 'DEPL',
                                NOM_CMP = ('DX', 'DY', 'DZ',),
                                OPERATION = 'EXTRACTION')
                              )

DEPH3=POST_RELEVE_T( ACTION=_F(  INTITULE = 'TAB6',
                                GROUP_NO = 'L3SUP',
                                RESULTAT = CHAMDEPL,
                                NOM_CHAM = 'DEPL',
                                NOM_CMP = ('DX', 'DY', 'DZ',),
                                OPERATION = 'EXTRACTION')
                              )

TABL_K3=POST_K1_K2_K3(MODELISATION='3D',
                      MATER=MAT,
                      TABL_DEPL_SUP=DEPH3,
                      TABL_DEPL_INF=DEPB3,
                      ABSC_CURV_MAXI=0.35,
                      VECT_K1=(0., 0., 1.,)
                      )

IMPR_TABLE(  TABLE=TABL_K3 )

DEPTS=POST_RELEVE_T( ACTION=_F( INTITULE = 'TAB1',
                                GROUP_NO = 'LEVINFS',
                                RESULTAT = CHAMDEPL,
                                NOM_CHAM = 'DEPL',
                                NOM_CMP = ('DX', 'DY', 'DZ',),
                                OPERATION = 'EXTRACTION'),);

DEPTI=POST_RELEVE_T( ACTION=_F( INTITULE = 'TAB1',
                                GROUP_NO = 'LEVINF1',
                                RESULTAT = CHAMDEPL,
                                NOM_CHAM = 'DEPL',
                                NOM_CMP = ('DX', 'DY', 'DZ',),
                                OPERATION = 'EXTRACTION'),);

TABL_KTO=POST_K1_K2_K3(  MODELISATION='3D',
              MAILLAGE=MA,
              MATER=MAT,
              FOND_FISS = FISS,
              TABL_DEPL_SUP  = DEPTS,
              TABL_DEPL_INF  = DEPTI,
              ABSC_CURV_MAXI = 0.35,
              PREC_VIS_A_VIS = 0.05,
              VECT_K1        = ( 0., 0., 1., ),
           )

IMPR_TABLE(TABLE=TABL_KTO,);

# ---------------

TEST_TABLE(TABLE=TABL_K1,
           REFERENCE='ANALYTIQUE',
           NOM_PARA='K1',
           VALE=K1ref,
           PRECISION=0.01)


TEST_TABLE(TABLE=TABL_K1,
           REFERENCE='ANALYTIQUE',
           NOM_PARA='G',
           VALE=Gref,
           PRECISION=0.02)

# ---------------

TEST_TABLE(TABLE=TABL_K2,
           REFERENCE='ANALYTIQUE',
           NOM_PARA='K1',
           VALE=K1ref,
           PRECISION=0.01)


TEST_TABLE(TABLE=TABL_K2,
           REFERENCE='ANALYTIQUE',
           NOM_PARA='G',
           VALE=Gref,
           PRECISION=0.02)


# ---------------

TEST_TABLE(TABLE=TABL_K3,
           REFERENCE='ANALYTIQUE',
           NOM_PARA='K1',
           VALE=K1ref,
           PRECISION=0.01)


TEST_TABLE(TABLE=TABL_K3,
           REFERENCE='ANALYTIQUE',
           NOM_PARA='G',
           VALE=Gref,
           PRECISION=0.02)

# ---------------

TEST_TABLE(TABLE=TABL_KTO,
           FILTRE=_F(NOM_PARA = 'NOEUD_FOND',
                     VALE_K = 'N49'),
           REFERENCE='ANALYTIQUE',
           NOM_PARA='K1',
           VALE=K1ref,
           PRECISION=0.01)

# TEST INFORMATIQUE : VALIDATION DE DEFI_FOND_FISS
FISSM=DEFI_FOND_FISS(MAILLAGE=MA,
                     FOND_FISS=_F(GROUP_MA = 'LFF1',
                                  DTAN_ORIG=(  1.,  0., 0., ),
                                  DTAN_EXTR=(  0.,  1., 0., ),),
                     LEVRE_SUP=_F(  GROUP_MA = 'LEVINFS'),
                     LEVRE_INF=_F(  GROUP_MA = 'LEVINF1'),
                    )

TABL_KTM=POST_K1_K2_K3(MODELISATION='3D',
                       MAILLAGE=MA,
                       MATER=MAT,
                       FOND_FISS = FISSM,
                       TABL_DEPL_SUP  = DEPTS,
                       TABL_DEPL_INF  = DEPTI,
                       ABSC_CURV_MAXI = 0.35,
                       PREC_VIS_A_VIS = 0.05,
                       VECT_K1        = ( 0., 0., 1., ),
           )

IMPR_TABLE(TABLE=TABL_KTM,);

TEST_TABLE(TABLE=TABL_KTM,
           FILTRE=_F(NOM_PARA = 'NOEUD_FOND',
                      VALE_K = 'N49'),
           REFERENCE='ANALYTIQUE',
           NOM_PARA='K1',
           VALE=K1ref,
           PRECISION=0.01)

MA = DEFI_GROUP (reuse = MA,
                    MAILLAGE = MA,
                    CREA_GROUP_NO =_F( NOM = 'NLFF1',
                                       OPTION = 'NOEUD_ORDO',
                                       GROUP_MA = 'LFF1')
                   )

FISSN=DEFI_FOND_FISS(MAILLAGE=MA,
                     FOND_FISS=_F(GROUP_NO = 'NLFF1',
                                  DTAN_ORIG=(  1.,  0., 0., ),
                                  DTAN_EXTR=(  0.,  1., 0., ),),
                     LEVRE_SUP=_F(GROUP_MA = 'LEVINFS'),
                     LEVRE_INF=_F(GROUP_MA = 'LEVINF1'),
                    )

TABL_KTN=POST_K1_K2_K3(MODELISATION='3D',
                       MAILLAGE=MA,
                       MATER=MAT,
                       FOND_FISS = FISSN,
                       TABL_DEPL_SUP  = DEPTS,
                       TABL_DEPL_INF  = DEPTI,
                       ABSC_CURV_MAXI = 0.35,
                       PREC_VIS_A_VIS = 0.05,
                       VECT_K1        = ( 0., 0., 1., ),
           )

IMPR_TABLE(TABLE=TABL_KTN,);

TEST_TABLE(TABLE=TABL_KTN,
           FILTRE=_F(NOM_PARA = 'NOEUD_FOND',
                      VALE_K = 'N49'),
           REFERENCE='ANALYTIQUE',
           NOM_PARA='K1',
           VALE=K1ref,
           PRECISION=0.01)


# POST_K1_K2_K3 : VALIDATION GROUP_NO
MA=DEFI_GROUP( reuse=MA,   MAILLAGE=MA,
               CREA_GROUP_NO=(_F( NOEUD = ('N49','N56',),
                                  NOM = 'NOFF1'),
                              _F( NOEUD = ('N1388','N1346'),
                                 NOM = 'NOFF2'),),);

TABL_K4=POST_K1_K2_K3(MODELISATION='3D',
                      MATER=MAT,
                      FOND_FISS = FISSN,
                      RESULTAT = CHAMDEPL,
                      GROUP_NO = ('NOFF1','NOFF2',),
                      ABSC_CURV_MAXI = 0.35,
                      PREC_VIS_A_VIS = 0.05,
                      VECT_K1        = ( 0., 0., 1., ),
                   )

IMPR_TABLE(TABLE=TABL_K4)

TEST_TABLE(TABLE=TABL_K4,
           FILTRE=_F(NOM_PARA = 'NOEUD_FOND',
                      VALE_K = 'N49'),
           REFERENCE='ANALYTIQUE',
           NOM_PARA='K1',
           VALE=K1ref,
           PRECISION=0.01)

# POST_K1_K2_K3 : VALIDATION TYPE_MA = LIBRE
TABL_K5=POST_K1_K2_K3(MODELISATION='3D',
                      MATER=MAT,
                      FOND_FISS = FISSN,
                      RESULTAT = CHAMDEPL,
                      TYPE_MAILLAGE = 'LIBRE',
                      NB_NOEUD_COUPE = 4,
                      ABSC_CURV_MAXI = 0.31,
                      PREC_VIS_A_VIS = 0.05,
                      VECT_K1        = ( 0., 0., 1., ),
                      )

IMPR_TABLE(TABLE=TABL_K5,);

TEST_TABLE(TABLE=TABL_K5,
           FILTRE=_F(NOM_PARA = 'NOEUD_FOND',
                     VALE_K = 'N49'),
           REFERENCE='ANALYTIQUE',
           NOM_PARA='K1',
           VALE=K1ref,
           PRECISION=0.01)

# POST_K1_K2_K3/LIBRE : VALIDATION INFORMATIQUE (SENS PROPA.)
TABL_K6=POST_K1_K2_K3(MODELISATION='3D',
                      MATER=MAT,
                      FOND_FISS = FISSN,
                      RESULTAT = CHAMDEPL,
                      TYPE_MAILLAGE = 'LIBRE',
                      NB_NOEUD_COUPE = 4,
                      GROUP_NO = ('NOFF1','NOFF2',),
                      ABSC_CURV_MAXI = 0.31,
                      PREC_VIS_A_VIS = 0.05,
                      VECT_K1        = ( 0., 0., 1., ),
                   )

IMPR_TABLE(TABLE=TABL_K6)

TEST_TABLE(TABLE=TABL_K6,
           FILTRE=_F(NOM_PARA = 'NOEUD_FOND',
                      VALE_K = 'N49'),
           REFERENCE='ANALYTIQUE',
           NOM_PARA='K1',
           VALE=K1ref,
           PRECISION=0.01)
FIN()
