# MODIF  DATE 30/07/2012   AUTEUR LEFEBVRE J-P.LEFEBVRE 
# TITRE POST-FLAMBEMENT ELASTIQUE D'UNE STRUCTURE EN L
# ssnl133b.para = tps_job 300 mem_job 512Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

DEBUT(CODE=_F( NOM = 'SSNL133B',NIV_PUB_WEB='INTERNET',VISU_EFICAS='OUI'));

MA=LIRE_MAILLAGE(UNITE=17,FORMAT='MED',);

MA=DEFI_GROUP(reuse =MA,
              MAILLAGE=MA,
              CREA_GROUP_NO=_F(TOUT_GROUP_MA='OUI',),);

MA_SECT=LIRE_MAILLAGE(UNITE=18,FORMAT='MED',);

MO=AFFE_MODELE(MAILLAGE=MA,
               AFFE=_F(TOUT='OUI',
                       PHENOMENE='MECANIQUE',
                       MODELISATION='POU_D_TGM',),);

ACIER=DEFI_MATERIAU(ELAS=_F(E=71240.0,
                            NU=0.3,),);

GF=DEFI_GEOM_FIBRE(
   SECTION =_F(GROUP_FIBRE='SECF',
             GROUP_MA_SECT='SECT',
             MAILLAGE_SECT=MA_SECT,
            COOR_AXE_POUTRE=(0.,0.,),),)

COMPF=DEFI_COMPOR(GEOM_FIBRE=GF,MATER_SECT=ACIER,
                  MULTIFIBRE=_F(GROUP_FIBRE='SECF',MATER=ACIER,
                                 RELATION='ELAS',DEFORMATION='GROT_GDEP',),
                     )

MAT=AFFE_MATERIAU(MAILLAGE=MA,
                  AFFE=_F(TOUT='OUI',MATER=ACIER,),
                  AFFE_COMPOR=_F(TOUT='OUI',COMPOR=COMPF),
                 );

CARA=AFFE_CARA_ELEM(MODELE=MO,
                    POUTRE=_F(GROUP_MA='LAME',
                              SECTION='GENERALE',
                              CARA=('A','IY','IZ','AY','AZ','JX','JG',),
                              VALE=(18.0,0.54,1350.0,1.2,1.2,2.16,0.0,),),
                    ORIENTATION=_F(GROUP_MA='LAME',
                                   CARA='ANGL_VRIL',
                                   VALE=0.,),
                    GEOM_FIBRE=GF,
                    MULTIFIBRE=_F(GROUP_MA='LAME',
                                 GROUP_FIBRE='SECF',
                                 ),);

CL=AFFE_CHAR_MECA(MODELE=MO,
                  DDL_IMPO=_F(GROUP_NO='PA',
                              DX=0.,
                              DY=0.,
                              DZ=0.,
                              DRX=0.,
                              DRY=0.,
                              DRZ=0.,),);

FORCE=AFFE_CHAR_MECA(MODELE=MO,
                     FORCE_NODALE=_F(GROUP_NO='PC',
                                     FX=1.0,
                                     FZ=0.001,),);

FORCE_F=DEFI_FONCTION(NOM_PARA='INST',
                      VALE=(0.,0.,20.0,20.0,),);

tforc = 0.5
tsuiv = 5.0
tfin = 20.0

TEMPS=DEFI_LIST_REEL(DEBUT=0.,
                     INTERVALLE=(_F(JUSQU_A=tforc,
                                    NOMBRE=2,),
                                 _F(JUSQU_A=tfin,
                                    PAS=0.1,),),
                                 );

DEFLIST=DEFI_LIST_INST(DEFI_LIST=_F(LIST_INST=TEMPS,),
                       );

# PREMIER CALCUL SANS PILOTAGE POUR INITIALISER
# LE CHAMP DE DEPLACEMENT
RESO0=STAT_NON_LINE(MODELE=MO,
                    CHAM_MATER=MAT,
                    CARA_ELEM=CARA,
                    EXCIT=(_F(CHARGE=CL,),
                           _F(CHARGE=FORCE,
                              FONC_MULT=FORCE_F,),),
                    COMP_INCR=_F(RELATION='MULTIFIBRE'),
                    INCREMENT=_F(LIST_INST=TEMPS,
                                 INST_FIN=tforc,),
                    NEWTON=_F(MATRICE='TANGENTE',
                              REAC_ITER=1,),
                    CONVERGENCE=_F(RESI_GLOB_RELA=1.0E-6,
                                   ITER_GLOB_MAXI=50,),
                    INFO=1,
                    );

# SECOND CALCUL AVEC PILOTAGE LONGEUR D'ARC ET SELECTION PAR
# MINIMISATION DE L'ANGLE ENTRE 2 DEPLACEMENTS SUCCESSIFS
# ON NE FAIT PAS DE REPRISE POUR NE PAS AVOIR DE ETA_PILOTAGE
# NON DISPONIBLE DANS LES INSTANTS SANS PILOTAGE
RESO=STAT_NON_LINE(MODELE=MO,
                   CHAM_MATER=MAT,
                   CARA_ELEM=CARA,
                   EXCIT=(_F(CHARGE=CL,),
                          _F(CHARGE=FORCE,
                             TYPE_CHARGE='FIXE_PILO',),),
                   COMP_INCR=_F(RELATION='MULTIFIBRE'),
                   INCREMENT=_F(LIST_INST=DEFLIST,
                                INST_FIN=tsuiv,),
                   NEWTON=_F(MATRICE='TANGENTE',
                             REAC_ITER=1,),
                   PILOTAGE=_F(TYPE='LONG_ARC',
                               COEF_MULT=1.0,
                               ETA_PILO_MAX=1.1,
                               ETA_PILO_R_MIN=0.0,
                               SELECTION='ANGL_INCR_DEPL',
                               GROUP_NO='LAME',
                               NOM_CMP=('DX','DY','DZ',),),
                   ETAT_INIT = _F(EVOL_NOLI=RESO0,
                                  ) ,
                   CONVERGENCE=_F(RESI_GLOB_RELA=1.0E-6,
                                  ITER_GLOB_MAXI=50,),
                   );

# VALIDATION DE LA REPRISE D'UN CALCUL AVEC PILOTAGE
# ET SELECTION PAR ANGL_INCR_DEPL
RESO=STAT_NON_LINE(reuse=RESO,
                   MODELE=MO,
                   CHAM_MATER=MAT,
                   CARA_ELEM=CARA,
                   EXCIT=(_F(CHARGE=CL,),
                          _F(CHARGE=FORCE,
                             TYPE_CHARGE='FIXE_PILO',),),
                   COMP_INCR=_F(RELATION='MULTIFIBRE',
                                ),
                   INCREMENT=_F(LIST_INST=DEFLIST,
                                INST_FIN=tfin,),
                   NEWTON=_F(MATRICE='TANGENTE',
                             REAC_ITER=1,),
                   PILOTAGE=_F(TYPE='LONG_ARC',
                               COEF_MULT=0.1,
                               ETA_PILO_MAX=5.0,
                               SELECTION='ANGL_INCR_DEPL',
                               GROUP_NO='LAME',
                               NOM_CMP=('DX','DY','DZ',),),
                   ETAT_INIT = _F(EVOL_NOLI=RESO ,
                                  ) ,
                   CONVERGENCE=_F(RESI_GLOB_RELA=1.0E-6,
                                  ITER_GLOB_MAXI=50,),
                   );

ETA_PILO=RECU_FONCTION(RESULTAT=RESO,
                       NOM_PARA_RESU='ETA_PILOTAGE',);

DEPX=RECU_FONCTION(RESULTAT=RESO,
                   TOUT_ORDRE='OUI',
                   NOM_CHAM='DEPL',
                   NOM_CMP='DX',
                   GROUP_NO='PC',);

DEPZ=RECU_FONCTION(RESULTAT=RESO,
                   TOUT_ORDRE='OUI',
                   NOM_CHAM='DEPL',
                   NOM_CMP='DZ',
                   GROUP_NO='PC',);

IMPR_FONCTION(FORMAT='XMGRACE',
              UNITE=29,
              COURBE=(_F(FONC_X=DEPX,FONC_Y=ETA_PILO,LEGENDE='DX',MARQUEUR=0,),
                      _F(FONC_X=DEPZ,FONC_Y=ETA_PILO,LEGENDE='DZ',MARQUEUR=0,),
                      ),
              TITRE='Reponse force-deplacement',
              BORNE_X=(0.0,170.0,),
              BORNE_Y=(0.0,5.0,),
              ECHELLE_X='LIN',
              ECHELLE_Y='LIN',
              GRILLE_X=20,
              GRILLE_Y=1,
              LEGENDE_X='Deplacement (mm)',
              LEGENDE_Y='Force (N)',);

IMPR_RESU(FORMAT='CASTEM',
          RESU=_F(MAILLAGE=MA,
                  RESULTAT=RESO,
                  NOM_CHAM='DEPL',),);

# -------------------- TESTS / REFERENCE ET NON-REGRESSION ----------

T_ETA=CREA_TABLE(FONCTION=_F(FONCTION=ETA_PILO,),);
T_DEPX=CREA_TABLE(FONCTION=_F(FONCTION=DEPX,),);
T_DEPZ=CREA_TABLE(FONCTION=_F(FONCTION=DEPZ,),);

TAB_COMB=CALC_TABLE(TABLE=T_ETA,
                    ACTION=(_F(OPERATION='COMB', TABLE=T_DEPX, NOM_PARA='INST'),
                            _F(OPERATION='COMB', TABLE=T_DEPZ, NOM_PARA='INST'),),);

DX_ETA=RECU_FONCTION(TABLE=TAB_COMB,
                     PARA_X='ETA_PILO',
                     PARA_Y='DX',
                     INTERPOL='LIN',
                     PROL_DROITE='CONSTANT',
                     PROL_GAUCHE='CONSTANT',);

DZ_ETA=RECU_FONCTION(TABLE=TAB_COMB,
                     PARA_X='ETA_PILO',
                     PARA_Y='DZ',
                     INTERPOL='LIN',
                     PROL_DROITE='CONSTANT',
                     PROL_GAUCHE='CONSTANT',);


IMPR_FONCTION(FORMAT='TABLEAU',
              COURBE=(_F(FONCTION=DX_ETA,),
                      _F(FONCTION=DZ_ETA,),),);


# REFERENCE MODELISATION A (POU_D_T_GD)
TEST_FONCTION(VALEUR=(_F(FONCTION=DX_ETA,VALE_PARA=1.0,VALE_REFE=1.9557897264105E-01,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DX_ETA,VALE_PARA=1.2,VALE_REFE=2.2003741156650E+01,CRITERE='RELATIF',PRECISION=0.06,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DX_ETA,VALE_PARA=1.4,VALE_REFE=5.1370567219177E+01,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DX_ETA,VALE_PARA=1.6,VALE_REFE=7.2308828300357E+01,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DX_ETA,VALE_PARA=2.0,VALE_REFE=9.9955783482343E+01,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DX_ETA,VALE_PARA=3.0,VALE_REFE=1.3414461679369E+02,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DX_ETA,VALE_PARA=4.0,VALE_REFE=1.5069734947084E+02,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DX_ETA,VALE_PARA=5.0,VALE_REFE=1.6091941068726E+02,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),),)

TEST_FONCTION(VALEUR=(_F(FONCTION=DZ_ETA,VALE_PARA=1.0,VALE_REFE=8.1895376497696E-01,CRITERE='RELATIF',PRECISION=0.07,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=1.2,VALE_REFE=4.5086149006060E+01,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=1.4,VALE_REFE=5.9127395933839E+01,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=1.6,VALE_REFE=6.1007516217062E+01,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=2.0,VALE_REFE=5.5986094960435E+01,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=3.0,VALE_REFE=3.9191654438340E+01,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=4.0,VALE_REFE=2.7663660137343E+01,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=5.0,VALE_REFE=2.0201862127005E+01,CRITERE='RELATIF',PRECISION=0.05,REFERENCE='AUTRE_ASTER',),),)

# NON REGRESSION
TEST_FONCTION(VALEUR=(_F(FONCTION=DX_ETA,VALE_PARA=1.0,VALE_REFE=0.1992381          ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DX_ETA,VALE_PARA=1.2,VALE_REFE=23.30505139        ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DX_ETA,VALE_PARA=1.4,VALE_REFE=52.4533534         ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DX_ETA,VALE_PARA=1.6,VALE_REFE=73.161608          ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DX_ETA,VALE_PARA=2.0,VALE_REFE=100.40836826       ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DX_ETA,VALE_PARA=3.0,VALE_REFE=133.706511455      ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DX_ETA,VALE_PARA=4.0,VALE_REFE=149.673070308      ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DX_ETA,VALE_PARA=5.0,VALE_REFE=159.40021188       ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),),)

TEST_FONCTION(VALEUR=(_F(FONCTION=DZ_ETA,VALE_PARA=1.0,VALE_REFE=0.8723445          ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=1.2,VALE_REFE=45.286912          ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=1.4,VALE_REFE=58.322719          ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=1.6,VALE_REFE=59.905416772       ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=2.0,VALE_REFE=54.832682          ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=3.0,VALE_REFE=38.544111332       ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=4.0,VALE_REFE=27.46765935        ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),
                      _F(FONCTION=DZ_ETA,VALE_PARA=5.0,VALE_REFE=20.272971697       ,CRITERE='RELATIF',REFERENCE='NON_REGRESSION',VERSION='11.1.22',),),)

FIN();
