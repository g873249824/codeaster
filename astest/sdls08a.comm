
# MODIF  DATE 21/07/2003   AUTEUR NICOLAS O.NICOLAS 
# TITRE : MODE PROPRE D'UNE PLAQUE CARREE CALCULES SUR BASE REDUITE 
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2003  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
#     ** VALIDATION DE PROJECTION ET RESTITUTION SUR BASE 
#        DE MODES STATIQUES
#
#   CALCUL DES MODES D'UNE PLAQUE CARREE AVEC CONDENSATION STATIQUE
#   DES MATRICES ASSEMBLEES SUR LES DDL INTERNES 
#   RESTITUTION SUR BASE PHYSIQUE 

DEBUT(CODE=_F(NOM='SDLS08A',
              NIV_PUB_WEB='INTERNET',),);

MAYA=LIRE_MAILLAGE();

MODELE=AFFE_MODELE(MAILLAGE=MAYA,
                   AFFE=_F(GROUP_MA='ALL_EL',
                           PHENOMENE='MECANIQUE',
                           MODELISATION='DKT',),);

MATELAS=DEFI_MATERIAU(ELAS=_F(E=71000000000.0,
                              NU=0.3,
                              RHO=7820,
                              AMOR_ALPHA=0.5,
                              AMOR_BETA=0.1,),);

CHMAT=AFFE_MATERIAU(MAILLAGE=MAYA,
                    AFFE=_F(GROUP_MA='ALL_EL',
                            MATER=MATELAS,),);

CHCAR=AFFE_CARA_ELEM(MODELE=MODELE,
                     COQUE=_F(GROUP_MA='ALL_EL',
                              EPAIS=0.001,),);

CHARGE=AFFE_CHAR_MECA(MODELE=MODELE,
                      DDL_IMPO=_F(GROUP_NO=('CONT_NO','COND2_NO',),
                                  DX=0.0,
                                  DY=0.0,
                                  DZ=0.0,
                                  DRX=0.0,
                                  DRY=0.0,
                                  DRZ=0.0,),);

FORCE=AFFE_CHAR_MECA(MODELE=MODELE,
                     FORCE_NODALE=_F(NOEUD='NO21',
                                     FZ=1.0,),);
#CALCUL DES VECTEURS ET MATRICES ASSEMBLEES

KELEM=CALC_MATR_ELEM(OPTION='RIGI_MECA',
                     MODELE=MODELE,
                     CHAM_MATER=CHMAT,
                     CARA_ELEM=CHCAR,
                     CHARGE=CHARGE,);

MELEM=CALC_MATR_ELEM(OPTION='MASS_MECA',
                     MODELE=MODELE,
                     CHAM_MATER=CHMAT,
                     CARA_ELEM=CHCAR,
                     CHARGE=CHARGE,);

CELEM=CALC_MATR_ELEM(OPTION='AMOR_MECA',
                     MODELE=MODELE,
                     CARA_ELEM=CHCAR,
                     CHAM_MATER=CHMAT,
                     RIGI_MECA=KELEM,
                     MASS_MECA=MELEM,
                     CHARGE=CHARGE,);

FELEM=CALC_VECT_ELEM(OPTION='CHAR_MECA',
                     CHARGE=(FORCE,CHARGE,),);

NUME=NUME_DDL(MATR_RIGI=KELEM,);

KASS=ASSE_MATRICE(MATR_ELEM=KELEM,
                  NUME_DDL=NUME,);

MASS=ASSE_MATRICE(MATR_ELEM=MELEM,
                  NUME_DDL=NUME,);

CASS=ASSE_MATRICE(MATR_ELEM=CELEM,
                  NUME_DDL=NUME,);

FASS=ASSE_VECTEUR(VECT_ELEM=FELEM,
                  NUME_DDL=NUME,);
#CALCUL DE LA BASE DE MODES STATIQUES
#

MODSTA=MODE_STATIQUE(MATR_RIGI=KASS,
                     MATR_MASS=MASS,
                     MODE_STAT=_F(GROUP_NO='COND2_NO',
                                  TOUT_CMP='OUI',),);
#PROJECTION DES MATRICES ASSEMBLEES SUR LA BASE DE MODES STATIQUES

NUMGEN=NUME_DDL_GENE(BASE=MODSTA,
                     STOCKAGE='PLEIN',
                     NB_VECT=9999,);

KGEN=PROJ_MATR_BASE(BASE=MODSTA,
                    NUME_DDL_GENE=NUMGEN,
                    MATR_ASSE=KASS,);

MGEN=PROJ_MATR_BASE(BASE=MODSTA,
                    NUME_DDL_GENE=NUMGEN,
                    MATR_ASSE=MASS,);

CGEN=PROJ_MATR_BASE(BASE=MODSTA,
                    NUME_DDL_GENE=NUMGEN,
                    MATR_ASSE=CASS,);

FGEN=PROJ_VECT_BASE(BASE=MODSTA,
                    NUME_DDL_GENE=NUMGEN,
                    VECT_ASSE=FASS,);
#CALCUL DES MODES SUR BASE REDUITE

MODGEN=MODE_ITER_SIMULT(MATR_A=KGEN,
                        MATR_B=MGEN,
                        CALC_FREQ=_F(OPTION='PLUS_PETITE',
                                     NMAX_FREQ=5,),
                        VERI_MODE=_F(STOP_ERREUR='NON',),);
#RESTITUTION SUR BASE PHYSIQUE DES MODES PROPRES GENERALISES

MODEEXP=REST_BASE_PHYS(RESU_GENE=MODGEN,
                       TOUT_ORDRE='OUI',
                       NOM_CHAM='DEPL',);
#CALCUL DE REPONSE HARMONIQUE SUR BASE REDUITE DE MODES STATIQUES

LIFREQ=DEFI_LIST_REEL(DEBUT=3,
                      INTERVALLE=_F(JUSQU_A=6,
                                    NOMBRE=3,),);

DYNGEN=DYNA_LINE_HARM(MATR_MASS=MGEN,
                      MATR_RIGI=KGEN,
                      MATR_AMOR=CGEN,
                      LIST_FREQ=LIFREQ,
                      NOM_CHAM='DEPL',
                      EXCIT=_F(VECT_ASSE=FGEN,
                               COEF_MULT=1.0,),);

DYNEXP=REST_BASE_PHYS(RESU_GENE=DYNGEN,
                      TOUT_ORDRE='OUI',
                      LIST_FREQ=LIFREQ,
                      NOM_CHAM='DEPL',);
#

TEST_RESU(FICHIER='RESULTAT',
          RESU=_F(RESULTAT=MODEEXP,
                  NUME_MODE=1,
                  PARA='FREQ',
                  VALE=4.9762,
                  CRITERE='RELATIF',
                  PRECISION=0.1,
                  REFERENCE='AUTRE_ASTER',),);

TEST_RESU(FICHIER='RESULTAT',
          RESU=_F(RESULTAT=DYNEXP,
                  NUME_ORDRE=2,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DZ',
                  NOEUD='NO21',
                  VALE_C=('RI',2.02776701624e-06,-5.3882686139e-05,),
                  CRITERE='RELATIF',
                  PRECISION=0.1,
                  REFERENCE='AUTRE_ASTER',),);
#

FIN();
