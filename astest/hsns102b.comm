# MODIF  DATE 03/04/2012   AUTEUR SELLENET N.SELLENET 
# TITRE PLAQUE EN BETON ARME CHAUFFEE
# hsns102b.para = tps_job 60 mem_job 128Mo ncpus 1 liste_test R
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# MODELISATION B : 3D + GRILLE_MEMBRANE

DEBUT(CODE=_F(NOM='HSNS102B', NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'))

#-----------------------------------------------------------------------
# VALIDATION DU CHARGEMENT THERMIQUE SUR DES GRILLES MEMBRANE (EX BETON ARME)
#-----------------------------------------------------------------------

MA=LIRE_MAILLAGE(FORMAT='MED',)

# -----------------------------------------------------
# DEFINITION DES MATERIAUX
# -----------------------------------------------------

BETON=DEFI_MATERIAU(
                    ELAS=_F(
                            E = 3.E10,
                            NU = 0.0,
                            ALPHA = 1.E-5,
                            ),
                    )

ACIER=DEFI_MATERIAU(
                    ELAS=_F(
                            E = 2.E11,
                            NU = 0.0,
                            ALPHA = 1.E-5,
                            ),
                    )

# -------------------------------------------------
# AFFECTATION DES MODELES
# -------------------------------------------------
LEMOD = AFFE_MODELE(
                MAILLAGE=MA,
                VERIF='MAILLE',
                AFFE=(
                        _F( GROUP_MA = 'GEOB',
                            PHENOMENE = 'MECANIQUE',
                            MODELISATION = '3D',),
                        _F( GROUP_MA = 'GEOA',
                            PHENOMENE = 'MECANIQUE',
                            MODELISATION = 'GRILLE_MEMBRANE',),
                    )
                )

# -------------------------------------------------
# AFFECTATION DES CARACTERISTIQUES
# -------------------------------------------------

LECAR=AFFE_CARA_ELEM(
                    MODELE=LEMOD,
                    GRILLE=_F(GROUP_MA = 'GEOA',
                              SECTION = .01,
                              ANGL_REP=(0,0),
                              )
                 )
# -------------------------------------------------
# CONSTRUCTION DU CHAMP DE TEMPERATURE
# ------------------------------------------------
#
# LA TEMPERATURE DE REFERENCE TO EST COMMUNE AUX DEUX MAILLES
# ENSUITE IL FAUT TOUT FAIRE EN DOUBLE 5ACIER ET BETON) CAR LES MAILLES S'APPUIENT SUR LES MEMES NOEUDS

T0A=CREA_CHAMP(
                OPERATION='AFFE',
                TYPE_CHAM='NOEU_TEMP_R',
                MAILLAGE=MA,
                AFFE=_F(
                        TOUT = 'OUI',
                        NOM_CMP = ('TEMP', 'TEMP_INF', 'TEMP_SUP',),
                        VALE = (20., 20., 20.,),
                       )
            )

T1A=CREA_CHAMP(
                OPERATION='AFFE',
                TYPE_CHAM='NOEU_TEMP_R',
                MAILLAGE=MA,
                AFFE=_F(
                        GROUP_MA = 'GEOA',
                        NOM_CMP = ('TEMP', 'TEMP_INF', 'TEMP_SUP',),
                        VALE = (120., 120., 120.,),
                        ),
                )

T1B=CREA_CHAMP(
                OPERATION='AFFE',
                TYPE_CHAM='NOEU_TEMP_R',
                MAILLAGE=MA,
                AFFE=_F(
                        GROUP_MA = 'GEOB',
                        NOM_CMP = 'TEMP',
                        VALE = 20.,
                        ),
              )

TA=CREA_RESU(
            OPERATION='AFFE',
            TYPE_RESU='EVOL_THER',
            NOM_CHAM='TEMP',
            AFFE=(  _F(CHAM_GD = T0A, INST = 0.,),
                    _F(CHAM_GD = T1A, INST = 1.,),
                )
            )

TB=CREA_RESU(
            OPERATION='AFFE',
            TYPE_RESU='EVOL_THER',
            NOM_CHAM='TEMP',
            AFFE=(  _F(CHAM_GD = T1B, INST = 0.,),
                    _F(CHAM_GD = T1B, INST = 1.,),
                )
            )

TEMPERA=CREA_RESU(
                    OPERATION='PREP_VRC2',
                    TYPE_RESU='EVOL_THER',
                    PREP_VRC2= _F( MODELE=LEMOD, CARA_ELEM=LECAR, EVOL_THER = TA, ),)


# -------------------------------------------------
# AFFECTATION DES MATERIAUX
# -------------------------------------------------

MATAF=AFFE_MATERIAU(   INFO=1,
                    MAILLAGE=MA,
                    AFFE=(  _F(GROUP_MA = ('GEOA',),
                               MATER = ACIER,
                               ),
                            _F(GROUP_MA = ('GEOB'),
                               MATER = BETON,
                               ),
                        ),
                    AFFE_VARC=( _F( GROUP_MA='GEOA',
                                    EVOL=TEMPERA,
                                    NOM_VARC='TEMP',
                                    NOM_CHAM='TEMP',
                                    VALE_REF=20.0),
                                _F( GROUP_MA='GEOB',
                                    EVOL=TB,
                                    NOM_VARC='TEMP',
                                    NOM_CHAM='TEMP',
                                    VALE_REF=20.0),
                                ),
                )
# ----------------------------------------------
# CHARGEMENT
# ----------------------------------------------
#
CL=AFFE_CHAR_MECA(
                    MODELE=LEMOD,
                    DDL_IMPO=(  _F(GROUP_MA = 'FAA', DX = 0.),
                                _F(GROUP_MA = 'LIA', DZ = 0.),
                                _F(GROUP_NO = 'P1',  DY = 0.),
                                ),
                )

# ----------------------------------------------
# CALCUL
# ----------------------------------------------

ZLIST=DEFI_LIST_REEL(   DEBUT=0.,
                        INTERVALLE=_F( JUSQU_A = 1.0,  NOMBRE = 1, )
                    )

DEP=STAT_NON_LINE(  MODELE=LEMOD,
                    CHAM_MATER=MATAF,
                    CARA_ELEM=LECAR,
                    EXCIT=      _F( CHARGE = CL,),
                    COMP_INCR=  _F( RELATION = 'ELAS',),
                    INCREMENT=  _F( LIST_INST = ZLIST,),
                    NEWTON=     _F( MATRICE = 'ELASTIQUE',),
                    CONVERGENCE=_F(RESI_GLOB_MAXI = 1.E-3,
                                   ITER_GLOB_MAXI = 30,),
                                   )
DEPB=CALC_ELEM(OPTION='SIGM_ELNO',
               RESULTAT=DEP,
               GROUP_MA='GEOB',);

DEPB=CALC_CHAMP(reuse =DEPB,
                RESULTAT=DEPB,
                CONTRAINTE='SIGM_NOEU',);


# -------------------------------------------------
# TESTS DES RESULTATS (REFERENCE ANALYTIQUE)
# -------------------------------------------------
TEST_RESU(
          RESU=(
            _F( RESULTAT = DEP,
             INST = 1.,
             NOM_CHAM = 'DEPL',
             NOM_CMP = 'DX',
             GROUP_NO = 'PMB',
             VALE = 1.4285714E-04/2.,
             PRECISION = 1E-2,
             REFERENCE='ANALYTIQUE',
         ),
            _F( RESULTAT = DEP,
             INST = 1.,
             NOM_CHAM = 'DEPL',
             NOM_CMP = 'DZ',
             GROUP_NO = 'PMB',
             VALE = 2.1428571E-03/4.,
             PRECISION = 1.05E-2,
             REFERENCE='ANALYTIQUE',
            ),
            _F( RESULTAT = DEPB,
             INST = 1.,
             NOM_CHAM = 'SIGM_NOEU',
             NOM_CMP = 'SIXX',
             GROUP_NO = 'PMB',
             VALE = 8.571429E+05/0.2,
             PRECISION = 1E-2,
             REFERENCE='ANALYTIQUE',
            ),
         ))
DEPA=CALC_ELEM(
                OPTION     = ('SIGM_ELNO',),
                RESULTAT   = DEP,
                GROUP_MA='GEOA')

DEPA=CALC_CHAMP(reuse=DEPA,
                RESULTAT=DEPA,
                CONTRAINTE='SIGM_NOEU',);

TEST_RESU(
          RESU=(
            _F( RESULTAT = DEPA,
             INST = 1.,
             NOM_CHAM = 'SIGM_NOEU',
             NOM_CMP = 'SIXX',
             GROUP_NO = 'PMA',
             VALE = -8.571429E+07,
             PRECISION = 1E-2,
             REFERENCE='ANALYTIQUE',
            ),
         ))

FIN()
