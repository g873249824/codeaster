# TITRE VALIDATION DECOLLEMENT PAR CALCUL LINEAIRE ITERATIF+CONDENSATION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

# Pour des raisons de performances, on force SDVERI='NON'. 
DEBUT(   CODE=_F(NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='NON'));

MAIL0=LIRE_MAILLAGE(FORMAT='MED',);
MAIL = CREA_MAILLAGE(MAILLAGE=MAIL0,
                  CREA_POI1 =_F(NOM_GROUP_MA = 'PSI0',GROUP_NO = ('PSI0'),),);

#
# ----------------------------------------------------------------------
# DEFINITIONS DU MODELE ET DES GROUPE DE MAILLES
# ----------------------------------------------------------------------
#
#
#
#-----------------------------------------------------------------------
#               AFFECTATION DES ELEMENTS FINIS AU MODELE
#-----------------------------------------------------------------------
#

MODELE=AFFE_MODELE(MAILLAGE=MAIL,
                   AFFE=(_F(GROUP_MA=('SRADIER','ST_B_PRE',),
                            PHENOMENE='MECANIQUE',
                            MODELISATION='DKT',),
                         _F(GROUP_MA='LIGRAD',
                            PHENOMENE='MECANIQUE',
                            MODELISATION='DIS_T',),),);

MODELE1=AFFE_MODELE(MAILLAGE=MAIL,
                   AFFE=(_F(GROUP_MA=('SRADIER','ST_B_PRE',),
                            PHENOMENE='MECANIQUE',
                            MODELISATION='DKT',),
                         _F(GROUP_MA='PSI0',
                            PHENOMENE='MECANIQUE',
                            MODELISATION='DIS_TR',),),
                    );

#

FO1=DEFI_FONCTION(NOM_PARA='INST',
                  VALE=(-1.0,0.0,100.0,0.0,),);
#
# -------------------------------------------------------------------
# DEFINITION DES MATERIAUX
# -------------------------------------------------------------------
#
#
#----- BETON ARME -----

BETARM=DEFI_MATERIAU(ELAS=_F(E=4.0E10,
                             NU=0.31,
                             RHO=3000.0,
                             AMOR_ALPHA=0., AMOR_BETA=0.,
                             ),
                    );
#
#----- BETON PRECONTRAINT -----

BETPRE=DEFI_MATERIAU(ELAS=_F(E=40000000000.0,
                             NU=0.31,
                             RHO=2500.0,
                             AMOR_ALPHA=0., AMOR_BETA=0.,
                             ),
                     );

#
#----- MATERIAU CHOC -----

MAT_C=DEFI_MATERIAU(DIS_CONTACT=_F(RIGI_NOR=1.E+15,
                                   DIST_1 = 1.E-6,
                                   DIST_2 = 1.E-6),);
#
#-----------------------------------------------------------------------
#              AFFECTATION DES MATERIAUX AUX ELEMENTS
#-----------------------------------------------------------------------

CHMAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                      AFFE=(_F(GROUP_MA='ST_B_PRE',
                               MATER=BETPRE,),
                            _F(GROUP_MA='SRADIER',
                               MATER=BETARM,),
                            _F(GROUP_MA='LIGRAD',
                               MATER=MAT_C,),),);
#
# -------------------------------------------------------------------
# DEFINITION DES CARACTERISTIQUES DES ELEMENTS
# -------------------------------------------------------------------
#
#
#-----------------------------------------------------------------------
#             AFFECTATION DES ELEMENTS-FINIS SUR LE MODELE
#-----------------------------------------------------------------------

ELEM=AFFE_CARA_ELEM(MODELE=MODELE,
                    COQUE=(_F(GROUP_MA=('SRADIER',),
                              EPAIS=6.1,),
                           _F(GROUP_MA=('ST_B_PRE',),
                              EPAIS=1.4,),),
                    DISCRET=(
                             _F(GROUP_MA='LIGRAD',
                                CARA='K_T_D_L',
                                VALE=(1e+15,1e+15,1e+15,),),
                             _F(GROUP_MA='LIGRAD',
                                REPERE='GLOBAL',
                                CARA='M_T_L',
                                VALE=
                                (0.01,0.0,0.01,0.0,0.0,0.01,0.00,0.0,0.0,0.01,
                                 0.0,0.00,0.0,0.0,0.01,0.0,0.0,0.0,0.0,0.0,0.01,
                                 ),
                               ),
                             ),
                        );

ELEM1=AFFE_CARA_ELEM(MODELE=MODELE1,
                    COQUE=(_F(GROUP_MA=('SRADIER',),
                              EPAIS=6.0,),
                           _F(GROUP_MA=('ST_B_PRE',),
                              EPAIS=1.5,),),
                    DISCRET=(
                             _F(GROUP_MA='PSI0',
                                CARA='K_TR_D_N',
                                VALE=(0.,0.,0.,0.,0.,0.,),),
                             _F(GROUP_MA='PSI0',
                                CARA='A_TR_D_N',
                                VALE=(0.,0.,0.,0.,0.,0.,),),
                             _F(GROUP_MA='PSI0',
                                CARA='M_TR_D_N',
                                VALE=(0.,0.,0.,0.,0.,0.,0.,0.,0.,0.),))
                        );

#
# LA STRUCTURE EST ENCASTREE A L INTERFACE
#-----------------------------------------
COND_LIM=AFFE_CHAR_MECA(MODELE=MODELE,
                        DDL_IMPO=(_F(GROUP_NO='BRADIER',
                                     DX=0.0,DY=0.0,DZ=0.0,),
                                     ),);

COND_LI1=AFFE_CHAR_MECA(MODELE=MODELE1,
                        DDL_IMPO=(_F(GROUP_NO='PSI0',
                                     DX=0.0,DY=0.0,DZ=0.0,
                                     DRX=0.0,DRY=0.0,DRZ=0.0,),
                                  ),
                        LIAISON_SOLIDE=(
                                        _F(GROUP_NO='SRADIER',),
                                        ),
                        );

# ----------------------------------------------------------------------
#---------------------------------------------
#
#  CALCUL DYNAMIQUE
#
#---------------------------------------------
#
#----------------------------------------
# CONSTITUTION ET ASSEMBLAGE DES MATRICES
# DE MASSE ET DE RAIDEUR
#----------------------------------------
#
#
MELR=CALC_MATR_ELEM(OPTION='RIGI_MECA',
                    MODELE=MODELE,
                    CHAM_MATER=CHMAT,
                    CARA_ELEM=ELEM,
                    CHARGE=(COND_LIM),
                    );

MELM=CALC_MATR_ELEM(OPTION='MASS_MECA',
                    MODELE=MODELE,
                    CHAM_MATER=CHMAT,
                    CARA_ELEM=ELEM,
                    CHARGE=(COND_LIM),
                    );


NUM=NUME_DDL(MATR_RIGI=MELR,
             );


MATR=ASSE_MATRICE(MATR_ELEM=MELR,
                  NUME_DDL=NUM,);
   #
   #


MATM=ASSE_MATRICE(MATR_ELEM=MELM,
                  NUME_DDL=NUM,);

   #
   #
   #-----------------------------------------
   #      CALCUL DES MASSES
   #-----------------------------------------
   #
   #


MASSES=POST_ELEM(MODELE=MODELE,
                 CHAM_MATER=CHMAT,
                 CARA_ELEM=ELEM,
                 INFO=1,
                 MASS_INER=_F(TOUT='OUI',),);
   #
   #------------------------------------------------
   #  CALCUL DES MODES DYNAMIQUES SUR BASE ENCASTREE
   #------------------------------------------------
   #

MOD_DYN=CALC_MODES(MATR_RIGI=MATR,
                   OPTION='BANDE',
                   CALC_FREQ=_F(FREQ=(0.1,10.0,),
                                ),
                   MATR_MASS=MATM,
                   )
#
# CALCUL DU MACRO-ELEMENT DYNAMIQUE :
#---------------------------------------------

INTERDYN=DEFI_INTERF_DYNA(  NUME_DDL=NUM,
            INTERFACE=_F( NOM = 'DROITE',
                       TYPE = 'CRAIGB',
                       GROUP_NO = ('BRADIER',))
           );

BAMO=DEFI_BASE_MODALE(   CLASSIQUE=_F( INTERF_DYNA = INTERDYN,
                                      MODE_MECA = MOD_DYN,
                                      NMAX_MODE = 20)
       );

MAEL=MACR_ELEM_DYNA(  BASE_MODALE=BAMO,
                   );

#
# TRAITEMENT DE MISS3D PAR EXEC_LOGICIEL
#---------------------------------------
TABSOL =  DEFI_SOL_MISS(
    TITRE="SOL HOMOGENE",
    MATERIAU=(
        _F(E=28.E+08,  NU=0.4, RHO=2.1e3, AMOR_HYST=0.10),
        _F(E=28.E+08,  NU=0.4, RHO=2.1e3, AMOR_HYST=0.10),
    ),
    COUCHE=(
        _F(EPAIS=25., NUME_MATE=1, RECEPTEUR="OUI", SOURCE="OUI"),
        _F(SUBSTRATUM="OUI", NUME_MATE=2,),
    ),
    INFO=2,
)

CALC_MISS(
    TYPE_RESU='FICHIER',
    TABLE_SOL=TABSOL,
    MACR_ELEM_DYNA=MAEL,
    AMOR_REDUIT=(0.07,),
    GROUP_MA_INTERF='SRADIE2',

    UNITE_IMPR_ASTER=26,
    UNITE_RESU_IMPE=25,
    VERSION='V6.6',
    PARAMETRE=_F(
        FREQ_MIN=2.5,
        FREQ_MAX=3.5,
        FREQ_PAS=0.5,
        Z0= -11.60,
        DREF=30.,
        SURF='OUI',
        ALGO = 'DEPL',
        OFFSET_MAX=60,
        OFFSET_NB=300,
    ),
)


DEFI_FICHIER(ACTION='LIBERER',UNITE=25,);

MODSTA=MODE_STATIQUE(MATR_RIGI=MATR,
                     MATR_MASS=MATM,
                     MODE_STAT=_F(GROUP_NO='BRADIER',
                                  TOUT_CMP='OUI',
                                  ),
                     );

BAMO2=DEFI_BASE_MODALE(RITZ=(_F(MODE_MECA=MOD_DYN,
                                NMAX_MODE=0,),
                             _F(MODE_INTF=MODSTA,),),
                       INTERF_DYNA=INTERDYN,
                       NUME_REF=NUM,);

NDDLGE2 = NUME_DDL_GENE( BASE= BAMO2, STOCKAGE= 'PLEIN',);

MATI = LIRE_IMPE_MISS(UNITE_RESU_IMPE=25, FREQ_EXTR=3.0,
                      BASE=BAMO2, NUME_DDL_GENE=NDDLGE2);

MAEL2=MACR_ELEM_DYNA(  BASE_MODALE=BAMO2,
                       MATR_IMPE = MATI,
                       FREQ_EXTR=3.0,
                       AMOR_SOL=0.05,
                       );

CHPE11=AFFE_CHAR_MECA(MODELE=MODELE1,
                      PESANTEUR= _F(GRAVITE=9.81,
                                    DIRECTION=(0.,0.,-1.,),),);

CHPE12=AFFE_CHAR_MECA(MODELE=MODELE1,
                      PESANTEUR= _F(GRAVITE=1.0,
                                    DIRECTION=(-1.0,0.0,0.0,),),);

ASSEMBLAGE(MODELE=MODELE1,
                CHAM_MATER=CHMAT,
                CARA_ELEM=ELEM1,
                CHARGE=(COND_LI1),
                NUME_DDL=CO('NUME1'),
                MATR_ASSE=(_F(MATRICE=CO('MATR1'),
                              OPTION='RIGI_MECA',),
                           _F(MATRICE=CO('MATM1'),
                              OPTION='MASS_MECA',),
                           _F(MATRICE=CO('MATA1'),
                              OPTION='AMOR_MECA',),),
                VECT_ASSE=(_F(VECTEUR=CO("VECAS1"),
                              OPTION='CHAR_MECA',
                              CHARGE=CHPE11),
                           _F(VECTEUR=CO("VECAS2"),
                              OPTION='CHAR_MECA',
                              CHARGE=CHPE12),),);



# MODE1=CALC_MODES(  MATR_RIGI=MATR1,   MATR_MASS=MATM1,
#                            CALC_FREQ=_F(
#                                         NMAX_FREQ=120,
#                                        ),
#                            VERI_MODE=_F(  STOP_ERREUR='NON')
#                          );
MODE1=CALC_MODES(MATR_RIGI=MATR1,
                 OPTION='BANDE',
                 CALC_FREQ=_F(FREQ=(3.,20.,31.,41.,),
                              ),
                 MATR_MASS=MATM1,
                 )

MODSTA1=MODE_STATIQUE(MATR_RIGI=MATR1,
                      MATR_MASS=MATM1,
                      MODE_STAT=_F(GROUP_NO='PSI0',
                                   # AVEC_CMP=('DX','DY','DZ'),
                                   TOUT_CMP='OUI',
                                   ),
                                  );

INTERDY1=DEFI_INTERF_DYNA(  NUME_DDL=NUME1,
            INTERFACE=_F( NOM = 'DROITE',
                       TYPE = 'CRAIGB',
                       GROUP_NO = ('PSI0',))
           );

BAMO1=DEFI_BASE_MODALE(RITZ=(_F(MODE_MECA=MODE1,
                                NMAX_MODE=120,),
                             _F(MODE_INTF=MODSTA1,
                                NMAX_MODE=1999,),
                             ),
                       INTERF_DYNA=INTERDY1,
                       NUME_REF=NUME1,);


NDDLGE1 = NUME_DDL_GENE( BASE= BAMO1, STOCKAGE= 'PLEIN',);

VECGE1=PROJ_VECT_BASE(  BASE=BAMO1,  NUME_DDL_GENE=NDDLGE1,
                            VECT_ASSE=VECAS1 );

VECGE2=PROJ_VECT_BASE(  BASE=BAMO1,  NUME_DDL_GENE=NDDLGE1,
                            VECT_ASSE=VECAS2 );

MAEL1=MACR_ELEM_DYNA(  BASE_MODALE=BAMO1,
                       MATR_RIGI=MATR1,
                       MATR_MASS=MATM1,
                       MATR_AMOR=MATA1,
                       SANS_GROUP_NO='SRADIER',
                       CAS_CHARGE=(
                                 _F(NOM_CAS='CHP1',
                                    VECT_ASSE_GENE=VECGE1,),
                                 _F(NOM_CAS='CHP2',
                                    VECT_ASSE_GENE=VECGE2,),
                                   ),
                     );

IMPR_CO(CHAINE='MAEL1   .LINO');
IMPR_CO(CHAINE='MAEL2   .LINO');

MAYADYN=DEFI_MAILLAGE(DEFI_SUPER_MAILLE=(
                          _F(MACR_ELEM=MAEL1,
                             SUPER_MAILLE='STAT1',),
                          _F(MACR_ELEM=MAEL2,
                             SUPER_MAILLE='STAT2',),
                                         ),
                      RECO_GLOBAL=_F(TOUT='OUI',),
                      DEFI_NOEUD=_F(TOUT='OUI',
                                     INDEX=(1,0,1,8,),),);

MAILB=ASSE_MAILLAGE(MAILLAGE_1=MAIL,
                    MAILLAGE_2=MAYADYN,
                    OPERATION='SOUS_STR',);


CHMATB=AFFE_MATERIAU(MAILLAGE=MAILB,
                     AFFE=(_F(GROUP_MA='LIGRAD',
                              MATER=MAT_C,),
                           _F(GROUP_MA='PSI0',
                              MATER=BETARM,),
                           ),
                     );

MODELB=AFFE_MODELE(MAILLAGE=MAILB,
                   AFFE_SOUS_STRUC=_F(SUPER_MAILLE=('STAT1','STAT2',),
                                      PHENOMENE='MECANIQUE',),
                   AFFE=(_F(GROUP_MA='LIGRAD',
                           PHENOMENE='MECANIQUE',
                           MODELISATION='DIS_T',),
                         _F(GROUP_MA='PSI0',
                           PHENOMENE='MECANIQUE',
                           MODELISATION='DIS_TR',),
                        ),
                  );
#
# ----------------------------------------------------------------------
# AFFECTATION DES CARACTERISTIQUES ELEMENTAIRES RIGI_MISS_3D
ELEMB=AFFE_CARA_ELEM(MODELE=MODELB,
                    DISCRET=(
                             _F(GROUP_MA='PSI0',
                                CARA='K_TR_D_N',
                                VALE=(0.,0.,0.,0.,0.,0.,),),
                             _F(GROUP_MA='PSI0',
                                CARA='A_TR_D_N',
                                VALE=(0.,0.,0.,0.,0.,0.,),),
                             _F(GROUP_MA='PSI0',
                                CARA='M_TR_D_N',
                                VALE=(0.,0.,0.,0.,0.,0.,0.,0.,0.,0.),),
                             _F(GROUP_MA='LIGRAD',
                                CARA='K_T_D_L',
                                VALE=(1e+15,1e+15,1e+15,),),
                             _F(GROUP_MA='LIGRAD',
                                CARA='A_T_D_L',
                                VALE=(0.,0.,0.,),),
                             _F(GROUP_MA='LIGRAD',
                                REPERE='GLOBAL',
                                CARA='M_T_L',
                                VALE=
                                (0.01,0.0,0.01,0.0,0.0,0.01,0.00,0.0,0.0,0.01,
                                 0.0,0.00,0.0,0.0,0.01,0.0,0.0,0.0,0.0,0.0,0.01,
                                 ),
                               ),
                             ),
                        );

COND_LIB=AFFE_CHAR_MECA(MODELE=MODELB,
                        LIAISON_SOLIDE=(
                                        _F(GROUP_NO='SRADIER',),
                                        ),
                        );

ASSEMBLAGE(MODELE=MODELB,
                CHAM_MATER=CHMATB,
                CARA_ELEM=ELEMB,
                CHARGE=COND_LIB,
                NUME_DDL=CO('NUMEROTB'),
                MATR_ASSE=(_F(MATRICE=CO('MATRRIGB'),
                              OPTION='RIGI_MECA',),
                           _F(MATRICE=CO('MATRMASB'),
                              OPTION='MASS_MECA',),
                           _F(MATRICE=CO('MATRAMOB'),
                              OPTION='AMOR_MECA',),
                           ),
               );

#
# CALCUL DES MODES SUR TAPIS DE RESSORTS:
#---------------------------------------------

MASSTOT=POST_ELEM(MODELE=MODELB,
                  CHAM_MATER=CHMATB,
                  CARA_ELEM=ELEMB,
                  CHARGE=COND_LIB,
                  TITRE='MASSES',
                  MASS_INER=(_F(TOUT='OUI',),
                             _F(GROUP_MA=('LIGRAD'),),
                            ),
                  )

IMPR_TABLE(TABLE=MASSTOT,);


MODEB=CALC_MODES(MATR_RIGI=MATRRIGB,
                 OPTION='BANDE',
                 CALC_FREQ=_F(FREQ=(0.1,20.,30.,60.,),
                              ),
                 MATR_MASS=MATRMASB,
                 )


CHAPP=AFFE_CHAR_MECA(MODELE=MODELB,
                     PESANTEUR=_F(GRAVITE=9.81,
                                  DIRECTION=(0.0,0.0,-1.0,),),);
#



TEMPL2B=DEFI_LIST_REEL(
                      DEBUT=0.01,
                      INTERVALLE=_F(JUSQU_A=5.00,
                                    NOMBRE=499,),
                      );

TEMPL2C=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=_F(JUSQU_A=5.00,
                                    NOMBRE=500,),);


L_INST=DEFI_LIST_REEL(DEBUT=-10.0,
                      INTERVALLE=_F(JUSQU_A=0.0,
                                    NOMBRE=10,),);
#
# EVOLUTIONS
#  LECTURE DE L ACCELEROGRAMME DE SOL ACCE

FC1 = DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(-10., 1.0, 100.0, 1.0, ),);

ACCE1=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=
                    (0.0,0.0000,0.01,0.0169,0.02,-0.0528,0.03,-0.14363,0.04,-0.22013,0.05,-0.27819,0.06,
                           -0.30506,0.07,-0.28967,0.08,-0.27053,0.09,-0.24898,0.1,-0.23472,0.11,-0.22889,0.12,-0.21952,0.13,
                           -0.19547,0.14,-0.14869,0.15,-0.10487,0.16,-0.07417,0.17,-0.06249,0.18,-0.07415,0.19,-0.07001,0.2,
                           -0.04562,0.21,0.00874,0.22,0.07774,0.23,0.13178,0.24,0.16934,0.25,0.14742,0.26,0.11109,0.27,0.07036,
                           0.28,0.04015,0.29,0.03173,0.3,0.02224,0.31,0.01538,0.32,-0.01261,0.33,-0.04791,0.34,-0.09414,0.35,
                           -0.14386,0.36,-0.19484,0.37,-0.24359,0.38,-0.27364,0.39,-0.31038,0.4,-0.3333,0.41,-0.3404,0.42,
                           -0.34413,0.43,-0.33844,0.44,-0.32683,0.45,-0.30766,0.46,-0.28452,0.47,-0.23281,0.48,-0.18779,0.49,
                           -0.16542,0.5,-0.16678,0.51,-0.1771,0.52,-0.19146,0.53,-0.20545,0.54,-0.18988,0.55,-0.15568,0.56,
                           -0.0947,0.57,-0.02365,0.58,0.04729,0.59,0.0983,0.6,0.11529,0.61,0.09544,0.62,0.0345,0.63,-0.04432,
                           0.64,-0.10935,0.65,-0.10353,0.66,-0.04454,0.67,0.06906,0.68,0.17431,0.69,0.23358,0.7,0.25758,0.71,
                           0.25438,0.72,0.23631,0.73,0.19217,0.74,0.13117,0.75,0.05596,0.76,-0.01551,0.77,-0.10553,0.78,
                           -0.1743,0.79,-0.27342,0.8,-0.34167,0.81,-0.40255,0.82,-0.46852,0.83,-0.5388,0.84,-0.61011,0.85,
                           -0.60998,0.86,-0.54679,0.87,-0.36574,0.88,-0.17583,0.89,-0.00938,0.9,0.08483,0.91,0.14888,0.92,
                           0.18499,0.93,0.21046,0.94,0.25163,0.95,0.26867,0.96,0.28253,0.97,0.23813,0.98,0.21309,0.99,0.21051,
                           1.0,0.24065,1.01,0.28854,1.02,0.33035,1.03,0.33162,1.04,0.30234,1.05,0.21732,1.06,0.10509,1.07,
                           0.01888,1.08,-0.07127,1.09,-0.07778,1.1,-0.07656,1.11,-0.0289,1.12,0.03955,1.13,0.16734,1.14,
                           0.33092,1.15,0.52478,1.16,0.72538,1.17,0.8673,1.18,0.89524,1.19,0.85529,1.2,0.72709,1.21,0.47094,
                           1.22,0.15034,1.23,-0.12869,1.24,-0.42932,1.25,-0.63123,1.26,-0.58525,1.27,-0.01759,1.28,0.58906,
                           1.29,0.84239,1.3,0.82748,1.31,0.58466,1.32,0.35377,1.33,0.2994,1.34,0.35738,1.35,0.33624,1.36,
                           0.29299,1.37,0.29445,1.38,0.29895,1.39,0.21595,1.4,0.13375,1.41,0.10984,1.42,0.08029,1.43,0.0234,
                           1.44,-0.03604,1.45,-0.10311,1.46,-0.14765,1.47,-0.14938,1.48,-0.14145,1.49,-0.1637,1.5,-0.22909,
                           1.51,-0.27697,1.52,-0.36715,1.53,-0.46066,1.54,-0.5448,1.55,-0.58779,1.56,-0.56207,1.57,-0.45074,
                           1.58,-0.28381,1.59,-0.10519,1.6,0.07447,1.61,0.15431,1.62,0.11462,1.63,-0.12707,1.64,-0.4388,1.65,
                           -0.69515,1.66,-0.81827,1.67,-0.6895,1.68,-0.49276,1.69,-0.28587,1.7,-0.13224,1.71,0.01434,1.72,
                           0.10735,1.73,0.15958,1.74,0.19442,1.75,0.24293,1.76,0.32433,1.77,0.42733,1.78,0.55718,1.79,0.63512,
                           1.8,0.69211,1.81,0.66063,1.82,0.62503,1.83,0.59007,1.84,0.58267,1.85,0.5771,1.86,0.58978,1.87,
                           0.61416,1.88,0.64514,1.89,0.63453,1.9,0.56584,1.91,0.42662,1.92,0.22262,1.93,-0.00249,1.94,-0.22835,
                           1.95,-0.42435,1.96,-0.5815,1.97,-0.65509,1.98,-0.69168,1.99,-0.69782,2.0,-0.72456,2.01,-0.78244,
                           2.02,-0.83616,2.03,-0.84177,2.04,-0.80809,2.05,-0.78351,2.06,-0.78169,2.07,-0.80253,2.08,-0.85786,
                           2.09,-0.9037,2.1,-0.92977,2.11,-0.89873,2.12,-0.80915,2.13,-0.64127,2.14,-0.43477,2.15,-0.22604,
                           2.16,-0.03963,2.17,0.09583,2.18,0.14271,2.19,0.11289,2.2,0.04008,2.21,-0.0268,2.22,-0.05459,2.23,
                           -0.02338,2.24,0.05474,2.25,0.13539,2.26,0.23961,2.27,0.32451,2.28,0.35997,2.29,0.28869,2.3,0.20268,
                           2.31,0.16777,2.32,0.16879,2.33,0.15273,2.34,0.11256,2.35,0.02944,2.36,-0.05388,2.37,-0.09701,2.38,
                           -0.12437,2.39,-0.182,2.4,-0.26566,2.41,-0.36155,2.42,-0.47775,2.43,-0.59172,2.44,-0.65356,2.45,
                           -0.52446,2.46,-0.34721,2.47,-0.11488,2.48,0.11538,2.49,0.31855,2.5,0.4817,2.51,0.52527,2.52,0.51778,
                           2.53,0.42948,2.54,0.34436,2.55,0.28028,2.56,0.24354,2.57,0.2533,2.58,0.31649,2.59,0.38854,2.6,
                           0.44251,2.61,0.41867,2.62,0.29521,2.63,0.13266,2.64,-0.03359,2.65,-0.0757,2.66,-0.07627,2.67,
                           -0.10069,2.68,-0.11651,2.69,-0.16179,2.7,-0.16721,2.71,-0.1327,2.72,-0.08259,2.73,-0.06328,2.74,
                           -0.05396,2.75,-0.01161,2.76,0.04409,2.77,-0.01124,2.78,-0.15782,2.79,-0.27215,2.8,-0.44073,2.81,
                           -0.56262,2.82,-0.47852,2.83,0.06833,2.84,0.60514,2.85,0.62705,2.86,0.44127,2.87,0.13743,2.88,
                           -0.08899,2.89,-0.22001,2.9,-0.24969,2.91,-0.29322,2.92,-0.34913,2.93,-0.37997,2.94,-0.42481,2.95,
                           -0.54072,2.96,-0.67301,2.97,-0.74164,2.98,-0.72907,2.99,-0.6216,3.0,-0.49178,3.01,-0.37436,3.02,
                           -0.24112,3.03,-0.01019,3.04,0.32868,3.05,0.69375,3.06,0.9824,3.07,0.99892,3.08,1.0,3.09,1.0,3.1,1.0,
                           3.11,0.88961,3.12,0.7765,3.13,0.71436,3.14,0.7077,3.15,0.72904,3.16,0.77,3.17,0.76879,3.18,0.71801,
                           3.19,0.65091,3.2,0.53964,3.21,0.36128,3.22,0.1632,3.23,-0.03858,3.24,-0.24568,3.25,-0.41392,3.26,
                           -0.52322,3.27,-0.46954,3.28,-0.36078,3.29,-0.17294,3.3,-0.04408,3.31,-0.09063,3.32,-0.17959,3.33,
                           -0.2501,3.34,-0.26909,3.35,-0.29314,3.36,-0.30685,3.37,-0.29657,3.38,-0.27918,3.39,-0.27662,3.4,
                           -0.2844,3.41,-0.34935,3.42,-0.49243,3.43,-0.63921,3.44,-0.77905,3.45,-0.70525,3.46,-0.48618,3.47,
                           -0.01764,3.48,0.47138,3.49,0.74964,3.5,0.89508,3.51,0.83312,3.52,0.75338,3.53,0.66328,3.54,0.57185,
                           3.55,0.40491,3.56,0.1893,3.57,-0.04806,3.58,-0.26318,3.59,-0.42946,3.6,-0.54154,3.61,-0.5444,3.62,
                           -0.48771,3.63,-0.299,3.64,-0.12544,3.65,-0.03434,3.66,-0.00191,3.67,-0.08174,3.68,-0.12501,3.69,
                           -0.11813,3.7,-0.05115,3.71,0.02854,3.72,0.07115,3.73,0.08717,3.74,0.07319,3.75,0.04102,3.76,0.0396,
                           3.77,0.04728,3.78,0.04278,3.79,0.04254,3.8,0.01519,3.81,0.00584,3.82,-0.02874,3.83,-0.07551,3.84,
                           -0.13708,3.85,-0.16488,3.86,-0.14189,3.87,-0.06607,3.88,0.04295,3.89,0.16837,3.9,0.24406,3.91,
                           0.21547,3.92,0.16816,3.93,0.09453,3.94,0.0836,3.95,0.13398,3.96,0.20697,3.97,0.21463,3.98,0.17878,
                           3.99,0.11032,4.0,-0.00838,4.01,-0.17971,4.02,-0.36781,4.03,-0.60581,4.04,-0.85649,4.05,-0.99782,
                           4.06,-0.99733,4.07,-0.98784,4.08,-0.77148,4.09,-0.35328,4.1,0.03796,4.11,0.1548,4.12,0.14403,4.13,
                           0.07038,4.14,0.02429,4.15,0.02362,4.16,0.1045,4.17,0.17056,4.18,0.22401,4.19,0.26293,4.2,0.2822,
                           4.21,0.27263,4.22,0.26371,4.23,0.26553,4.24,0.24071,4.25,0.16008,4.26,0.02796,4.27,-0.14276,4.28,
                           -0.32073,4.29,-0.4599,4.3,-0.56463,4.31,-0.64555,4.32,-0.69577,4.33,-0.73134,4.34,-0.77901,4.35,
                           -0.82346,4.36,-0.86846,4.37,-0.84618,4.38,-0.78919,4.39,-0.65643,4.4,-0.50937,4.41,-0.40651,4.42,
                           -0.35802,4.43,-0.40507,4.44,-0.5283,4.45,-0.70748,4.46,-0.85675,4.47,-0.87789,4.48,-0.80336,4.49,
                           -0.65014,4.5,-0.45734,4.51,-0.25615,4.52,-0.08692,4.53,0.05592,4.54,0.14506,4.55,0.20735,4.56,
                           0.25894,4.57,0.30466,4.58,0.35854,4.59,0.40702,4.6,0.46171,4.61,0.51186,4.62,0.57677,4.63,0.66117,
                           4.64,0.75393,4.65,0.80432,4.66,0.84591,4.67,0.82886,4.68,0.81996,4.69,0.81728,4.7,0.82183,4.71,
                           0.77933,4.72,0.69032,4.73,0.54547,4.74,0.34642,4.75,0.11485,4.76,-0.13274,4.77,-0.31896,4.78,
                           -0.42668,4.79,-0.31015,4.8,-0.09616,4.81,0.18673,4.82,0.44375,4.83,0.60139,4.84,0.66939,4.85,0.5968,
                           4.86,0.50824,4.87,0.42573,4.88,0.38693,4.89,0.3555,4.9,0.33602,4.91,0.30789,4.92,0.27712,4.93,
                           0.23604,4.94,0.1902,4.95,0.1367,4.96,0.0699,4.97,0.00468,4.98,-0.05104,4.99,-0.10179,5.0,-0.13678,
                           5.01,-0.14709,5.02,-0.13259,5.03,-0.09953,5.04,-0.07127,5.05,-0.06837,5.06,-0.11696,5.07,-0.19047,
                           5.08,-0.27786,5.09,-0.29193,5.1,-0.21907,5.11,0.03174,5.12,0.32701,5.13,0.56805,5.14,0.69178,5.15,
                           0.61642,5.16,0.44995,5.17,0.21145,5.18,0.00624,5.19,-0.14651,5.2,-0.23959,5.21,-0.29193,5.22,
                           -0.31295,5.23,-0.31172,5.24,-0.29093,5.25,-0.24169,5.26,-0.16576,5.27,-0.09711,5.28,-0.05587,5.29,
                           -0.08063,5.3,-0.18398,5.31,-0.3157,5.32,-0.45141,5.33,-0.4852,5.34,-0.43541,5.35,-0.23933,5.36,
                           -0.06928,5.37,-0.057,5.38,-0.12252,5.39,-0.22499,5.4,-0.26083,5.41,-0.22957,5.42,-0.14042,5.43,
                           -0.09624,5.44,-0.1139,5.45,-0.16636,5.46,-0.26851,5.47,-0.33125,5.48,-0.29144,5.49,-0.02571,5.5,
                           0.3182,5.51,0.62968,5.52,0.80515,5.53,0.72958,5.54,0.56106,5.55,0.43542,5.56,0.38757,5.57,0.39966,
                           5.58,0.45373,5.59,0.50514,5.6,0.52118,5.61,0.46654,5.62,0.40406,5.63,0.33732,5.64,0.2811,5.65,
                           0.19134,5.66,0.0837,5.67,-0.03092,5.68,-0.14815,5.69,-0.21715,5.7,-0.21051,5.71,-0.04155,5.72,
                           0.20004,5.73,0.49577,5.74,0.69472,5.75,0.66143,5.76,0.5248,5.77,0.36333,5.78,0.27195,5.79,0.24161,
                           5.8,0.27935,5.81,0.30565,5.82,0.28132,5.83,0.2332,5.84,0.15012,5.85,0.09664,5.86,0.11581,5.87,
                           0.28941,5.88,0.47452,5.89,0.52842,5.9,0.51559,5.91,0.49137,5.92,0.48242,5.93,0.51113,5.94,0.56654,
                           5.95,0.58721,5.96,0.60075,5.97,0.60256,5.98,0.60153,5.99,0.57558,6.0,0.54654,6.01,0.53438,6.02,
                           0.50884,6.03,0.42672,6.04,0.29678,6.05,0.13085,6.06,-0.08346,6.07,-0.29495,6.08,-0.42009,6.09,
                           -0.33257,6.1,-0.12703,6.11,0.14508,6.12,0.30303,6.13,0.17134,6.14,-0.02439,6.15,-0.08447,6.16,
                           -0.01379,6.17,0.13663,6.18,0.28966,6.19,0.35823,6.2,0.35747,6.21,0.31765,6.22,0.30698,6.23,0.29748,
                           6.24,0.28888,6.25,0.24926,6.26,0.12398,6.27,-0.03185,6.28,-0.14695,6.29,-0.08567,6.3,0.09254,6.31,
                           0.38609,6.32,0.60893,6.33,0.5645,6.34,0.44928,6.35,0.41124,6.36,0.41222,6.37,0.35149,6.38,0.29984,
                           6.39,0.27339,6.4,0.23534,6.41,0.18275,6.42,0.12947,6.43,0.08581,6.44,0.04044,6.45,-0.00778,6.46,
                           -0.06896,6.47,-0.14708,6.48,-0.20696,6.49,-0.24678,6.5,-0.26674,6.51,-0.27413,6.52,-0.30671,6.53,
                           -0.33414,6.54,-0.3614,6.55,-0.24452,6.56,-0.08032,6.57,0.13097,6.58,0.36995,6.59,0.60589,6.6,
                           0.79073,6.61,0.79277,6.62,0.72441,6.63,0.55455,6.64,0.39396,6.65,0.26353,6.66,0.176,6.67,0.09205,
                           6.68,0.03823,6.69,0.03242,6.7,0.04697,6.71,0.02263,6.72,-0.04332,6.73,-0.16396,6.74,-0.35744,6.75,
                           -0.56951,6.76,-0.75676,6.77,-0.83233,6.78,-0.84069,6.79,-0.76551,6.8,-0.6944,6.81,-0.63933,6.82,
                           -0.60526,6.83,-0.56323,6.84,-0.52385,6.85,-0.53297,6.86,-0.54887,6.87,-0.61433,6.88,-0.66511,6.89,
                           -0.69722,6.9,-0.71336,6.91,-0.7245,6.92,-0.73787,6.93,-0.70637,6.94,-0.67662,6.95,-0.63983,6.96,
                           -0.60665,6.97,-0.55632,6.98,-0.49634,6.99,-0.41752,7.0,-0.34125,7.01,-0.27719,7.02,-0.22964,7.03,
                           -0.18338,7.04,-0.12816,7.05,-0.07689,7.06,-0.02309,7.07,0.02922,7.08,0.08499,7.09,0.17795,7.1,
                           0.29736,7.11,0.43003,7.12,0.57414,7.13,0.69408,7.14,0.77604,7.15,0.75802,7.16,0.6886,7.17,0.56236,
                           7.18,0.43516,7.19,0.32643,7.2,0.235,7.21,0.14765,7.22,0.07199,7.23,0.02454,7.24,-0.00032,7.25,
                           0.00512,7.26,0.02463,7.27,0.03505,7.28,0.02719,7.29,-0.01336,7.3,-0.09112,7.31,-0.18803,7.32,
                           -0.28245,7.33,-0.31607,7.34,-0.32958,7.35,-0.29182,7.36,-0.25219,7.37,-0.20459,7.38,-0.14064,7.39,
                           -0.06061,7.4,0.01481,7.41,0.01509,7.42,-0.00587,7.43,-0.07067,7.44,-0.13154,7.45,-0.18727,7.46,
                           -0.23891,7.47,-0.28178,7.48,-0.31113,7.49,-0.26754,7.5,-0.20635,7.51,-0.11104,7.52,-0.02358,7.53,
                           0.05395,7.54,0.12668,7.55,0.19628,7.56,0.2444,7.57,0.21447,7.58,0.15653,7.59,0.06409,7.6,-0.01513,
                           7.61,-0.08964,7.62,-0.16223,7.63,-0.24108,7.64,-0.32822,7.65,-0.38788,7.66,-0.41835,7.67,-0.39611,
                           7.68,-0.34338,7.69,-0.27208,7.7,-0.20074,7.71,-0.14038,7.72,-0.09394,7.73,-0.05903,7.74,-0.03191,
                           7.75,-0.01087,7.76,0.00737,7.77,0.01691,7.78,0.03471,7.79,0.07762,7.8,0.14805,7.81,0.25539,7.82,
                           0.36798,7.83,0.44899,7.84,0.47514,7.85,0.41862,7.86,0.31452,7.87,0.19233,7.88,0.09398,7.89,0.06148,
                           7.9,0.0655,7.91,0.08871,7.92,0.12073,7.93,0.1569,7.94,0.1828,7.95,0.15832,7.96,0.10902,7.97,0.02819,
                           7.98,-0.05618,7.99,-0.13748,8.0,-0.2056,8.01,-0.27397,8.02,-0.35109,8.03,-0.43417,8.04,-0.5278,8.05,
                           -0.5928,8.06,-0.64863,8.07,-0.6611,8.08,-0.66272,8.09,-0.65275,8.1,-0.63112,8.11,-0.58665,8.12,
                           -0.52675,8.13,-0.45581,8.14,-0.37997,8.15,-0.3055,8.16,-0.23853,8.17,-0.19976,8.18,-0.17136,8.19,
                           -0.17023,8.2,-0.15325,8.21,-0.113,8.22,-0.05227,8.23,0.00056,8.24,0.03726,8.25,0.0478,8.26,0.03401,
                           8.27,-0.00195,8.28,-0.0497,8.29,-0.09224,8.3,-0.13862,8.31,-0.16547,8.32,-0.19096,8.33,-0.20941,
                           8.34,-0.21538,8.35,-0.20047,8.36,-0.17082,8.37,-0.14699,8.38,-0.12278,8.39,-0.10452,8.4,-0.08149,
                           8.41,-0.06387,8.42,-0.05506,8.43,-0.07002,8.44,-0.11016,8.45,-0.14981,8.46,-0.17708,8.47,-0.13184,
                           8.48,-0.04661,8.49,0.0814,8.5,0.214,8.51,0.30864,8.52,0.3677,8.53,0.35674,8.54,0.32569,8.55,0.28084,
                           8.56,0.23828,8.57,0.19192,8.58,0.15037,8.59,0.12548,8.6,0.1223,8.61,0.14207,8.62,0.1778,8.63,
                           0.22616,8.64,0.25109,8.65,0.23488,8.66,0.19864,8.67,0.1536,8.68,0.12578,8.69,0.1134,8.7,0.11108,
                           8.71,0.11326,8.72,0.10251,8.73,0.10779,8.74,0.09518,8.75,0.08107,8.76,0.06297,8.77,0.05858,8.78,
                           0.07645,8.79,0.10838,8.8,0.14942,8.81,0.16104,8.82,0.15188,8.83,0.09826,8.84,0.02045,8.85,-0.07691,
                           8.86,-0.1798,8.87,-0.27401,8.88,-0.34543,8.89,-0.35255,8.9,-0.32567,8.91,-0.26429,8.92,-0.19147,
                           8.93,-0.11908,8.94,-0.06386,8.95,-0.06537,8.96,-0.09467,8.97,-0.15254,8.98,-0.2251,8.99,-0.28191,
                           9.0,-0.29663,9.01,-0.21771,9.02,-0.09068,9.03,0.04685,9.04,0.15326,9.05,0.17559,9.06,0.16938,9.07,
                           0.17691,9.08,0.20368,9.09,0.24605,9.1,0.29088,9.11,0.33637,9.12,0.3684,9.13,0.3779,9.14,0.38246,
                           9.15,0.36927,9.16,0.35944,9.17,0.35103,9.18,0.34006,9.19,0.30301,9.2,0.2462,9.21,0.17776,9.22,
                           0.10084,9.23,0.03276,9.24,-0.02283,9.25,-0.03856,9.26,-0.0492,9.27,-0.05008,9.28,-0.04943,9.29,
                           -0.03843,9.3,-0.01337,9.31,0.00965,9.32,0.04064,9.33,0.05552,9.34,0.06514,9.35,0.07512,9.36,0.08623,
                           9.37,0.11422,9.38,0.15265,9.39,0.2092,9.4,0.25873,9.41,0.26797,9.42,0.24736,9.43,0.18678,9.44,
                           0.11608,9.45,0.04979,9.46,-0.0003,9.47,-0.037,9.48,-0.05296,9.49,-0.05177,9.5,-0.0404,9.51,-0.03109,
                           9.52,-0.03863,9.53,-0.067,9.54,-0.12435,9.55,-0.18811,9.56,-0.25689,9.57,-0.29237,9.58,-0.31247,
                           9.59,-0.31338,9.6,-0.30233,9.61,-0.26792,9.62,-0.22255,9.63,-0.1785,9.64,-0.13748,9.65,-0.11338,
                           9.66,-0.10627,9.67,-0.13126,9.68,-0.15347,9.69,-0.17703,9.7,-0.18694,9.71,-0.1825,9.72,-0.17128,
                           9.73,-0.15799,9.74,-0.14429,9.75,-0.11256,9.76,-0.08424,9.77,-0.05595,9.78,-0.0282,9.79,0.00198,9.8,
                           0.02904,9.81,0.0522,9.82,0.06504,9.83,0.06926,9.84,0.07251,9.85,0.07654,9.86,0.086,9.87,0.08287,
                           9.88,0.07645,9.89,0.05206,9.9,0.02988,9.91,0.01048,9.92,-0.00353,9.93,-0.02138,9.94,-0.03965,9.95,
                           -0.06106,9.96,-0.08536,9.97,-0.11346,9.98,-0.1446,9.99,-0.1616,10.0,-0.17295,
                           10.01, 0.0, 10.24, 0.0,
                           ),
                           );

ACCE=CALC_FONCTION(COMB=_F(FONCTION=ACCE1,
                           COEF=3.5,),);
#  LECTURE DES CHARGES NODALES

CHFONO=AFFE_CHAR_MECA(MODELE=MODELB,
                     PESANTEUR=_F(GRAVITE=1.0,
                                  DIRECTION=(-1.0,0.0,0.0,),),);

#
VELPP=CALC_VECT_ELEM(    OPTION='CHAR_MECA',
           CHARGE=CHAPP, CHAM_MATER=CHMATB, CARA_ELEM=ELEMB,
           MODELE=MODELB,
           SOUS_STRUC=_F( CAS_CHARGE = 'CHP1', SUPER_MAILLE = 'STAT1',)
               );

VELFO=CALC_VECT_ELEM(    OPTION='CHAR_MECA',
           CHARGE=CHFONO, CHAM_MATER=CHMATB, CARA_ELEM=ELEMB,
           MODELE=MODELB,
           SOUS_STRUC=_F( CAS_CHARGE = 'CHP2', SUPER_MAILLE = 'STAT1',)
               );


VECASPP=ASSE_VECTEUR(   NUME_DDL=NUMEROTB,  VECT_ELEM=VELPP);
VECASFO=ASSE_VECTEUR(   NUME_DDL=NUMEROTB,  VECT_ELEM=VELFO);

# Calcul de la position statique initiale sous pesanteur
EVOL0=DYNA_VIBRA( TYPE_CALCUL='TRAN',
                  BASE_CALCUL='PHYS',
                  MATR_MASS=MATRMASB, MATR_RIGI=MATRRIGB,
                      SCHEMA_TEMPS=_F(SCHEMA='NEWMARK',
                                      BETA =1.0, GAMMA =1.5,),
                      INCREMENT=_F( LIST_INST = L_INST),
                      ARCHIVAGE=_F( PAS_ARCH=10),
                     EXCIT=_F( VECT_ASSE=VECASPP, COEF_MULT = 1.0,),
                    );

DEP0=CREA_CHAMP( OPERATION='EXTR', TYPE_CHAM='NOEU_DEPL_R',
                 RESULTAT= EVOL0, INST=0.0,
                 NOM_CHAM = 'DEPL');

VIT0=CREA_CHAMP( OPERATION='EXTR', TYPE_CHAM='NOEU_DEPL_R',
                 RESULTAT= EVOL0, INST=0.0,
                 NOM_CHAM = 'VITE');


# Boucle de calculs lineaires iteratifs en recalculant les forces
# non lineaires sur tout l intervalle de calcul

NF = 7

for k in range(1,NF):

  if k==1:
    EVOL=DYNA_VIBRA(TYPE_CALCUL='TRAN',
                    BASE_CALCUL='PHYS',
                    MATR_MASS=MATRMASB, MATR_RIGI=MATRRIGB,
                      MATR_AMOR=MATRAMOB,
                      ETAT_INIT=_F(DEPL=DEP0, VITE=VIT0,),
                      INCREMENT=_F(LIST_INST=TEMPL2C,),
                      ARCHIVAGE=_F(PAS_ARCH=1,),
                      AMOR_MODAL=_F(MODE_MECA = MODEB,
                                    AMOR_REDUIT = 0.05),
                     EXCIT=(
                            _F( VECT_ASSE=VECASPP, COEF_MULT = 1.0,),
                            _F( VECT_ASSE=VECASFO, FONC_MULT = ACCE,),
                            ),
                    );


  else:

    resunl = CALC_FORC_NONL( RESULTAT = EVOL , TOUT_ORDRE = 'OUI'    ,
                  CHAM_MATER=CHMATB, CARA_ELEM=ELEMB, MODELE=MODELB,
                  COMPORTEMENT=(_F(RELATION='ELAS',
                                TOUT='OUI',),
                             _F(RELATION='DIS_CHOC',
                                GROUP_MA='LIGRAD',),
                             ),
                       );

    DETRUIRE(INFO=1,CONCEPT=_F(NOM=EVOL));
    EVOL=DYNA_VIBRA(TYPE_CALCUL='TRAN',
                    BASE_CALCUL='PHYS',
                    MATR_MASS=MATRMASB, MATR_RIGI=MATRRIGB,
                      MATR_AMOR=MATRAMOB,
                      ETAT_INIT=_F(DEPL=DEP0, VITE=VIT0,),
                      INCREMENT=_F(LIST_INST=TEMPL2C,),
                      ARCHIVAGE=_F(PAS_ARCH=1,),
                      AMOR_MODAL=_F(MODE_MECA = MODEB,
                                    AMOR_REDUIT = 0.05),
                     EXCIT=(
                            _F( VECT_ASSE=VECASPP, COEF_MULT = 1.0,),
                            _F( VECT_ASSE=VECASFO, FONC_MULT = ACCE,),
                           ),
                     EXCIT_RESU=(
                            _F( RESULTAT = resunl, COEF_MULT = -1.0,),
                                ),
                        );

    DETRUIRE(INFO=1,CONCEPT=_F(NOM=resunl));


## fin boucle NF


RESUGLO=REST_COND_TRAN(  RESULTAT=EVOL,
                         MACR_ELEM_DYNA=MAEL1,
                         LIST_INST=TEMPL2B,
                         PRECISION=1.E-4,
                         NOM_CHAM='DEPL',
                       );
TEST_RESU(RESU=(_F(INST=0.0,
                   RESULTAT=EVOL,
                   NOM_CHAM='DEPL',
                   NOEUD='N739',
                   NOM_CMP='DZ',
                   VALE_CALC=-5.11475541823E-03,
                   CRITERE=('RELATIF', 'ABSOLU'),
                   ),
                _F(INST=0.0,
                   RESULTAT=EVOL,
                   NOM_CHAM='DEPL',
                   NOEUD='N731',
                   NOM_CMP='DZ',
                   VALE_CALC=-5.1208549250819E-03,
                   CRITERE=('RELATIF', 'ABSOLU'),
                   ),
                _F(INST=4.4500000000000002,
                   RESULTAT=RESUGLO,
                   NOM_CHAM='DEPL',
                   NOEUD='N739',
                   NOM_CMP='DZ',
                   VALE_CALC=9.166646E-03,
                   CRITERE=('ABSOLU', 'ABSOLU'),
                   ),
                _F(INST=4.4500000000000002,
                   RESULTAT=RESUGLO,
                   NOM_CHAM='DEPL',
                   NOEUD='N1',
                   NOM_CMP='DX',
                   VALE_CALC=-0.25212884658433,
                   CRITERE=('RELATIF', 'ABSOLU'),
                ),),);

FIN();
