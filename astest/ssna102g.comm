# TITRE CONTACT MULTICORPS ELASTIQUES
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

# --------------------------------------------------------------------
#       LECTURE DU MAILLAGE ET CREATION DE GROUPES DE NOEUDS
# --------------------------------------------------------------------


MA=LIRE_MAILLAGE(FORMAT='MED',);

MA=MODI_MAILLAGE(reuse =MA,
                 MAILLAGE=MA,
                 ORIE_PEAU_3D=_F(GROUP_MA=('BOTTOM_T','SPH_B_B','SPH_B_T','SPH_T_B','SPH_T_T','TOP_B','ENCAST',),),);

MA=DEFI_GROUP(reuse =MA,
              MAILLAGE=MA,
              CREA_GROUP_NO=_F(GROUP_MA='ENCAST',),);

#
# --------------------------------------------------------------------
#         DEFINITION ET AFFECTATION D'UN MATERIAU ELASTIQUE
# --------------------------------------------------------------------
#

MAT=DEFI_MATERIAU(ELAS=_F(E=200000,
                          NU=0.3,),);

CHMAT=AFFE_MATERIAU(MAILLAGE=MA,
                    AFFE=_F(TOUT='OUI',
                            MATER=MAT,),);

#
# --------------------------------------------------------------------
#                   MODELISATION 3D
# --------------------------------------------------------------------
#

MO=AFFE_MODELE(MAILLAGE=MA,
               AFFE=_F(GROUP_MA=('TOUT',),
                       PHENOMENE='MECANIQUE',
                       MODELISATION='3D',),);

#
# --------------------------------------------------------------------
#                   ENCASTREMENT ET SYMETRIE
# --------------------------------------------------------------------
#


CL=AFFE_CHAR_CINE(MODELE=MO,
                 MECA_IMPO=(_F(GROUP_MA='ENCAST',
                               DX=0,
                               DY=0,
                               DZ=0,
                               ),
                            _F(GROUP_MA='SX',
                               DX=0,),
                            _F(GROUP_MA='SY',
                               DY=0,),),);

#
# --------------------------------------------------------------------
#               DEPLACEMENT IMPOSE
# --------------------------------------------------------------------
#

DEPL=AFFE_CHAR_CINE(MODELE=MO,
                   MECA_IMPO=_F(GROUP_MA='DEPLA',
                                DZ=-2,),);

#
# --------------------------------------------------------------------
#      CONTACT UNILATERAL : FORMULATION CONTINUE
#                           SUPPRESSION DES MOUVEMENTS DE CORPS RIGIDE
# --------------------------------------------------------------------
#

CONT=DEFI_CONTACT(MODELE         = MO,
                  FORMULATION    = 'CONTINUE',
                  ALGO_RESO_CONT = 'POINT_FIXE',
                  ALGO_RESO_GEOM = 'POINT_FIXE',
                  ZONE=(
                  _F(GROUP_MA_MAIT='TOP_B',
                     GROUP_MA_ESCL='SPH_T_T',
                     CONTACT_INIT='INTERPENETRE',
                     ),
                  _F(GROUP_MA_MAIT='SPH_B_T',
                     GROUP_MA_ESCL='SPH_T_B',
                     CONTACT_INIT='INTERPENETRE',
                     ),
                  _F(GROUP_MA_MAIT='BOTTOM_T',
                     GROUP_MA_ESCL='SPH_B_B',
                     CONTACT_INIT='INTERPENETRE',
                     ),),);

#
# --------------------------------------------------------------------
#         DECOUPAGE EN INCREMENTS DE CHARGE (1 EN ELASTICITE)
#         ET RAMPE MULTIPLICATRICE POUR LE DEPLACEMENT IMPOSE
# --------------------------------------------------------------------
#

RAMPE=DEFI_FONCTION(NOM_PARA='INST',VALE=(0,0,
                          1,1,
                          ),);

TPS=DEFI_LIST_REEL(DEBUT=0,
                   INTERVALLE=_F(JUSQU_A=1,
                                 NOMBRE=1,),);

#
# --------------------------------------------------------------------
#                            CALCUL NON LINEAIRE
# --------------------------------------------------------------------
#

RESU=STAT_NON_LINE(MODELE=MO,
                   CHAM_MATER=CHMAT,
                   EXCIT=(_F(CHARGE=CL,),
                          _F(CHARGE=DEPL,
                             FONC_MULT=RAMPE,),),
                   CONTACT=CONT,
                   COMPORTEMENT=_F(RELATION='ELAS',
                                DEFORMATION='PETIT',),
                   INCREMENT=_F(LIST_INST=TPS,),
                   NEWTON=_F(MATRICE='ELASTIQUE',
                             REAC_ITER=1,),
                   SOLVEUR=_F(METHODE='GCPC',
                              RESI_RELA=1.0E-12,
                              PRE_COND='LDLT_SP',
                              ),
                   CONVERGENCE=_F(),);

#
# --------------------------------------------------------------------
#          CALCUL DES FORCES NODALES ET DES REACTIONS NODALES
# --------------------------------------------------------------------
#

RESU=CALC_CHAMP(reuse =RESU,
             RESULTAT=RESU,
             FORCE='REAC_NODA');

# --------------------------------------------------------------------
#                COMPARAISON SOURCE EXTRENE : DEPLACEMENT
# --------------------------------------------------------------------

DEPL_PA4=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                                 INTITULE='Deplacement en PA4',
                                 RESULTAT=RESU,
                                 NOM_CHAM='DEPL',
                                 GROUP_NO='PA4',
                                 RESULTANTE='DZ',),);

IMPR_TABLE(TABLE=DEPL_PA4,);

TEST_RESU(RESU=_F(GROUP_NO='PA4',
                  INST=1.0,
                  REFERENCE='SOURCE_EXTERNE',
                  RESULTAT=RESU,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DZ',
                  VALE_CALC=-0.795088723,
                  VALE_REFE=-0.81,
                  CRITERE='RELATIF',
                  PRECISION=0.04,),
          )

#
# --------------------------------------------------------------------
#                CALCUL DE LA REACTION A L'ENCASTREMENT
# --------------------------------------------------------------------
#                COMPARAISON SOURCE EXTRENE
# --------------------------------------------------------------------

FORC_ENC=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                                 INTITULE='Reaction a l encastrement',
                                 RESULTAT=RESU,
                                 NOM_CHAM='REAC_NODA',
                                 GROUP_NO='ENCAST',
                                 RESULTANTE='DZ',),);

IMPR_TABLE(TABLE=FORC_ENC,);

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=0.050000000000000003,
           VALE_CALC= 2.83290758E+04,
           VALE_REFE=2.706425E4,
           NOM_PARA='DZ',
           TABLE=FORC_ENC,
           FILTRE=_F(NOM_PARA='INST',
                     VALE=1.0,),
           )

# --------------------------------------------------------------------
#                IMPRESSION DES RESULTATS
# --------------------------------------------------------------------


IMPR_RESU(FORMAT='MED',
          RESU=_F(RESULTAT=RESU,),);

FIN();
