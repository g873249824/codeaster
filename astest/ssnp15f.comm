# TITRE ESSAI DE TRACTION-CISAILLEMENT (MISES ECROUISSAGE ISOTROPE)
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

DEBUT(CODE=_F(NOM='SSNP15F',
              NIV_PUB_WEB='INTERNET',),
      DEBUG=_F(SDVERI='NON',),);

#......................................................................
# MODELISATION F : IDEM MODELISATION A AVEC UTILISATION D'UN CRITERE
#                  DE RE-DECOUPAGE DU PAS DE TEMPS PAR EVENT-DRIVEN
#......................................................................

MA=LIRE_MAILLAGE();

MO=AFFE_MODELE(MAILLAGE=MA,
               VERIF='MAILLE',
               AFFE=_F(TOUT='OUI',
                       PHENOMENE='MECANIQUE',
                       MODELISATION='3D',),);

ACIER=DEFI_MATERIAU(ELAS=_F(E=195000.,
                            NU=0.3,),
                    ECRO_LINE=_F(D_SIGM_EPSI=1930.,
                                 SY=181.,),
                    PRAGER=_F(C=0.,),);

CM=AFFE_MATERIAU(MAILLAGE=MA,
                 AFFE=_F(TOUT='OUI',
                         MATER=ACIER,),);

SIGMA_F=DEFI_FONCTION(NOM_PARA='INST',VALE=(0.0,0.0,
                            1.0,151.2,
                            2.0,257.2,
                            3.0,0.0,
                            ),PROL_DROITE='EXCLU',PROL_GAUCHE='EXCLU',);

TAU_F=DEFI_FONCTION(NOM_PARA='INST',VALE=(0.0,0.0,
                          1.0,93.1,
                          2.0,33.1,
                          3.0,0.0,
                          ),PROL_DROITE='EXCLU',PROL_GAUCHE='EXCLU',);

TRACTION=AFFE_CHAR_MECA(MODELE=MO,
                        FORCE_FACE=_F(MAILLE='GAUCHE',
                                      FX=-1.,),);

CISAIL=AFFE_CHAR_MECA(MODELE=MO,
                      FORCE_FACE=(_F(MAILLE='GAUCHE',
                                     FY=-1.,),
                                  _F(MAILLE='DROITE',
                                     FY=1.,),
                                  _F(MAILLE='HAUT',
                                     FX=1.,),
                                  _F(MAILLE='BAS',
                                     FX=-1.,),),);

LIAISON=AFFE_CHAR_MECA(MODELE=MO,
                       DDL_IMPO=(_F(NOEUD='NO4',
                                    DX=0.,
                                    DY=0.,),
                                 _F(NOEUD='NO8',
                                    DX=0.,
                                    DY=0.,
                                    DZ=0.,),
                                 _F(NOEUD='NO2',
                                    DX=0.,),
                                 _F(NOEUD='NO6',
                                    DX=0.,),),);

L_INST=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=(_F(JUSQU_A=0.1,
                                     NOMBRE=1,),
                                  _F(JUSQU_A=0.9,
                                     NOMBRE=1,),
                                  _F(JUSQU_A=1.0,
                                     NOMBRE=1,),
                                  _F(JUSQU_A=2.0,
                                     NOMBRE=1,),
                                  _F(JUSQU_A=3.0,
                                     NOMBRE=1,),),);

# gestion manuelle avec event-driven

DEFLIST=DEFI_LIST_INST(DEFI_LIST=_F(METHODE='MANUEL',
                                    LIST_INST=L_INST,),
                       ECHEC=_F(EVENEMENT='DELTA_GRANDEUR',
                                SUBD_NIVEAU=10,
                                VALE_REF=0.1e-2,
                                NOM_CHAM='VARI_ELGA',
                                NOM_CMP='V1',),);

U=STAT_NON_LINE(MODELE=MO,
                CHAM_MATER=CM,
                EXCIT=(_F(CHARGE=LIAISON,),
                       _F(CHARGE=TRACTION,
                          FONC_MULT=SIGMA_F,),
                       _F(CHARGE=CISAIL,
                          FONC_MULT=TAU_F,),),
                COMP_INCR=_F(RELATION='VMIS_ISOT_LINE',),
                INCREMENT=_F(LIST_INST=DEFLIST,),
                NEWTON=_F(MATRICE='TANGENTE',
                          REAC_ITER=3,),
                RECH_LINEAIRE=_F(RHO_MAX=150),
                )

# gestion manuelle avec critere sur radialite

nbincr=2

L_INST2=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=(_F(JUSQU_A=0.1,
                                     NOMBRE=1,),
                                  _F(JUSQU_A=0.9,
                                     NOMBRE=1,),
                                  _F(JUSQU_A=1.0,
                                     NOMBRE=1,),
                                  _F(JUSQU_A=2.0,
                                     NOMBRE=nbincr,),
                                  _F(JUSQU_A=3.0,
                                     NOMBRE=nbincr,),),);

# gestion manuelle avec event-driven

DEFLIST2=DEFI_LIST_INST(DEFI_LIST=_F(METHODE='MANUEL',
                                    LIST_INST=L_INST2,),
                       ECHEC=_F(SUBD_NIVEAU=10,),
                       );

U2=STAT_NON_LINE(MODELE=MO,
                 CHAM_MATER=CM,
                 EXCIT=(_F(CHARGE=LIAISON,),
                        _F(CHARGE=TRACTION,
                           FONC_MULT=SIGMA_F,),
                        _F(CHARGE=CISAIL,
                           FONC_MULT=TAU_F,),),
                 COMP_INCR=_F(RELATION='VMIS_ISOT_LINE',RESI_RADI_RELA=0.02),
                 INCREMENT=_F(LIST_INST=DEFLIST2,),
                 NEWTON=_F(MATRICE='TANGENTE',
                           REAC_ITER=3,),
                 RECH_LINEAIRE=_F(RHO_MAX=150),
                 )

U3=STAT_NON_LINE(MODELE=MO,
                 CHAM_MATER=CM,
                 EXCIT=(_F(CHARGE=LIAISON,),
                        _F(CHARGE=TRACTION,
                           FONC_MULT=SIGMA_F,),
                        _F(CHARGE=CISAIL,
                           FONC_MULT=TAU_F,),),
                 COMP_INCR=_F(RELATION='VMIS_ECMI_LINE',RESI_RADI_RELA=0.02),
                 INCREMENT=_F(LIST_INST=DEFLIST2,),
                 NEWTON=_F(MATRICE='TANGENTE',
                           REAC_ITER=3,),
                 RECH_LINEAIRE=_F(RHO_MAX=150),
                 )

U=CALC_CHAMP(reuse=U,RESULTAT=U,CONTRAINTE=('SIGM_ELNO'),VARI_INTERNE=('VARI_ELNO'),DEFORMATION=('EPSI_ELNO','EPSP_ELGA'))


U2=CALC_CHAMP(reuse=U2,RESULTAT=U2,CONTRAINTE=('SIGM_ELNO'),VARI_INTERNE=('VARI_ELNO'),DEFORMATION=('EPSI_ELNO','EPSP_ELGA'))


U3=CALC_CHAMP(reuse=U3,RESULTAT=U3,CONTRAINTE=('SIGM_ELNO'),VARI_INTERNE=('VARI_ELNO'),DEFORMATION=('EPSI_ELNO','EPSP_ELGA'))



VARI=CREA_CHAMP(TYPE_CHAM='ELNO_VARI_R',
                OPERATION='EXTR',
                RESULTAT=U,
                NOM_CHAM='VARI_ELNO',
                INST=1.,);

TEST_RESU(CHAM_ELEM=_F(NOEUD='NO2',
                       NOM_CMP='V1',
                       MAILLE='CUBE',
                       CHAM_GD=VARI,
                       VALE_CALC=0.020547300000000001,
                       TOLE_MACHINE=1.E-3,))

TEST_RESU(RESU=(_F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U,
                   NOM_CHAM='SIGM_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='SIXX',
                   VALE_CALC=151.200000000,
                   VALE_REFE=151.19999999999999,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U,
                   NOM_CHAM='SIGM_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='SIXY',
                   VALE_CALC=93.100000000,
                   VALE_REFE=93.099999999999994,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.014829714,
                   VALE_REFE=0.014829699999999999,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.013601401,
                   VALE_REFE=0.0136014,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.014054329,
                   VALE_REFE=0.014054000000000001,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.012980734,
                   VALE_REFE=0.012980999999999999,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U,
                   NOM_CHAM='VARI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='V1',
                   VALE_CALC=0.020547265,
                   VALE_REFE=0.020547300000000001,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U,
                   NOM_CHAM='VARI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='V2',
                   VALE_CALC=1.000000000,
                   VALE_REFE=1.0,
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.035327063,
                   VALE_REFE=0.035264999999999998,
                   PRECISION=6.0000000000000001E-3, TOLE_MACHINE=(6.0000000000000001E-3, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.020367031,
                   VALE_REFE=0.020471,
                   PRECISION=6.0000000000000001E-3, TOLE_MACHINE=(6.0000000000000001E-3, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.034008089,
                   VALE_REFE=0.033945999999999997,
                   PRECISION=6.0000000000000001E-3, TOLE_MACHINE=(6.0000000000000001E-3, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.020146364,
                   VALE_REFE=0.020250000000000001,
                   PRECISION=6.0000000000000001E-3, TOLE_MACHINE=(6.0000000000000001E-3, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U,
                   NOM_CHAM='VARI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='V1',
                   VALE_CALC=0.042329286,
                   VALE_REFE=0.042328999999999999,
                   PRECISION=6.0000000000000001E-3, TOLE_MACHINE=(6.0000000000000001E-3, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                ),
          )

TEST_RESU(RESU=(_F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U2,
                   NOM_CHAM='SIGM_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='SIXX',
                   VALE_CALC=151.200000000,
                   VALE_REFE=151.19999999999999,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U2,
                   NOM_CHAM='SIGM_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='SIXY',
                   VALE_CALC=93.100000000,
                   VALE_REFE=93.099999999999994,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U2,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.014829714,
                   VALE_REFE=0.014829699999999999,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U2,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.013601401,
                   VALE_REFE=0.0136014,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U2,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.014054329,
                   VALE_REFE=0.014054000000000001,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U2,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.012980734,
                   VALE_REFE=0.012980999999999999,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U2,
                   NOM_CHAM='VARI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='V1',
                   VALE_CALC=0.020547265,
                   VALE_REFE=0.020547300000000001,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U2,
                   NOM_CHAM='VARI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='V2',
                   VALE_CALC=1.000000000,
                   VALE_REFE=1.0,
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U2,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.035339378,
                   VALE_REFE=0.035264999999999998,
                   PRECISION=1.E-2, TOLE_MACHINE=(1.E-2, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U2,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.020321852,
                   VALE_REFE=0.020471,
                   PRECISION=1.E-2, TOLE_MACHINE=(1.E-2, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U2,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.034020403,
                   VALE_REFE=0.033945999999999997,
                   PRECISION=1.E-2, TOLE_MACHINE=(1.E-2, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U2,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.020101186,
                   VALE_REFE=0.020250000000000001,
                   PRECISION=1.E-2, TOLE_MACHINE=(1.E-2, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U2,
                   NOM_CHAM='VARI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='V1',
                   VALE_CALC=0.042329286,
                   VALE_REFE=0.042328999999999999,
                   PRECISION=1.E-2, TOLE_MACHINE=(1.E-2, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                ),
          )

TEST_RESU(RESU=(_F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U3,
                   NOM_CHAM='SIGM_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='SIXX',
                   VALE_CALC=151.200000000,
                   VALE_REFE=151.19999999999999,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U3,
                   NOM_CHAM='SIGM_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='SIXY',
                   VALE_CALC=93.100000000,
                   VALE_REFE=93.099999999999994,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U3,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.014829714,
                   VALE_REFE=0.014829699999999999,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U3,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.013601401,
                   VALE_REFE=0.0136014,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U3,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.014054329,
                   VALE_REFE=0.014054000000000001,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U3,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.012980734,
                   VALE_REFE=0.012980999999999999,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U3,
                   NOM_CHAM='VARI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='V1',
                   VALE_CALC=0.020547265,
                   VALE_REFE=0.020547300000000001,
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U3,
                   NOM_CHAM='VARI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='V2',
                   VALE_CALC=1.000000000,
                   VALE_REFE=1.0,
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U3,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.035339378,
                   VALE_REFE=0.035264999999999998,
                   PRECISION=1.E-2, TOLE_MACHINE=(1.E-2, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U3,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.020321852,
                   VALE_REFE=0.020471,
                   PRECISION=1.E-2, TOLE_MACHINE=(1.E-2, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U3,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXX',
                   VALE_CALC=0.034020403,
                   VALE_REFE=0.033945999999999997,
                   PRECISION=1.E-2, TOLE_MACHINE=(1.E-2, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   POINT=1,
                   RESULTAT=U3,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPXY',
                   VALE_CALC=0.020101186,
                   VALE_REFE=0.020250000000000001,
                   PRECISION=1.E-2, TOLE_MACHINE=(1.E-2, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                _F(INST=2.0,
                   REFERENCE='AUTRE_ASTER',
                   RESULTAT=U3,
                   NOM_CHAM='VARI_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='V1',
                   VALE_CALC=0.042329286,
                   VALE_REFE=0.042328999999999999,
                   PRECISION=1.E-2, TOLE_MACHINE=(1.E-2, 9.9999999999999995E-07),
                   MAILLE='CUBE',),
                ),
          )

# TEST DES INDICATEURS DE CHARGE - DECHARGE

U=CALC_CHAMP(reuse=U,RESULTAT=U,CRITERES=('DERA_ELGA','DERA_ELNO'))


U2=CALC_CHAMP(reuse=U2,RESULTAT=U2,CRITERES=('DERA_ELGA','DERA_ELNO'))


U3=CALC_CHAMP(reuse=U3,RESULTAT=U3,CRITERES=('DERA_ELGA','DERA_ELNO'))



TEST_RESU(RESU=(_F(INST=1.0,
                   POINT=1,
                   RESULTAT=U,
                   NOM_CHAM='DERA_ELGA',
                   NOM_CMP='DCHA_V',
                   VALE_CALC=-1.7868100000000001E-4,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='RELATIF',
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   RESULTAT=U,
                   NOM_CHAM='DERA_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='DCHA_V',
                   VALE_CALC=-1.7868100000000001E-4,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='RELATIF',
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   POINT=1,
                   RESULTAT=U,
                   NOM_CHAM='DERA_ELGA',
                   NOM_CMP='RADI_V',
                   VALE_CALC=0.97772000000000003,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='ABSOLU',
                   MAILLE='CUBE',),
                _F(INST=1.0,
                   POINT=1,
                   RESULTAT=U,
                   NOM_CHAM='DERA_ELGA',
                   NOM_CMP='ERR_RADI',
                   VALE_CALC=0.0,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='ABSOLU',
                   MAILLE='CUBE',),
                ),
          )

TEST_RESU(RESU=(_F(INST=1.5,
                   POINT=1,
                   RESULTAT=U2,
                   NOM_CHAM='DERA_ELGA',
                   NOM_CMP='DCHA_V',
                   VALE_CALC=6.1365500000000002E-3,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='RELATIF',
                   MAILLE='CUBE',),
                _F(INST=1.5,
                   RESULTAT=U2,
                   NOM_CHAM='DERA_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='DCHA_V',
                   VALE_CALC=6.1365500000000002E-3,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='RELATIF',
                   MAILLE='CUBE',),
                _F(INST=1.5,
                   POINT=1,
                   RESULTAT=U2,
                   NOM_CHAM='DERA_ELGA',
                   NOM_CMP='RADI_V',
                   VALE_CALC=0.70079999999999998,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='ABSOLU',
                   MAILLE='CUBE',),
                _F(INST=1.5,
                   POINT=1,
                   RESULTAT=U2,
                   NOM_CHAM='DERA_ELGA',
                   NOM_CMP='ERR_RADI',
                   VALE_CALC=9.4975570000000002E-3,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='ABSOLU',
                   MAILLE='CUBE',),
                ),
          )

TEST_RESU(RESU=(_F(INST=1.5,
                   POINT=1,
                   RESULTAT=U3,
                   NOM_CHAM='DERA_ELGA',
                   NOM_CMP='DCHA_V',
                   VALE_CALC=6.1365500000000002E-3,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='RELATIF',
                   MAILLE='CUBE',),
                _F(INST=1.5,
                   RESULTAT=U3,
                   NOM_CHAM='DERA_ELNO',
                   NOEUD='NO2',
                   NOM_CMP='DCHA_V',
                   VALE_CALC=6.1365500000000002E-3,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='RELATIF',
                   MAILLE='CUBE',),
                _F(INST=1.5,
                   POINT=1,
                   RESULTAT=U3,
                   NOM_CHAM='DERA_ELGA',
                   NOM_CMP='RADI_V',
                   VALE_CALC=2.9671000000000002E-11,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='ABSOLU',
                   MAILLE='CUBE',),
                _F(INST=1.5,
                   POINT=1,
                   RESULTAT=U3,
                   NOM_CHAM='DERA_ELGA',
                   NOM_CMP='ERR_RADI',
                   VALE_CALC=9.4975570000000002E-3,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='ABSOLU',
                   MAILLE='CUBE',),
                ),
          )

# l'erreur est || dn || / 2 = sin (alpha / 2;)

RADI1=RECU_FONCTION(RESULTAT=U,
                   NOM_CHAM='DERA_ELNO',
                   NOM_CMP='ERR_RADI',
                   MAILLE='CUBE',
                   NOEUD='NO2',
                   NOM_RESU='X',
                  );

RADI2=RECU_FONCTION(RESULTAT=U2,
                   NOM_CHAM='DERA_ELNO',
                   NOM_CMP='ERR_RADI',
                   MAILLE='CUBE',
                   NOEUD='NO2',
                   NOM_RESU='X',
                  );

RADI3=RECU_FONCTION(RESULTAT=U3,
                   NOM_CHAM='DERA_ELNO',
                   NOM_CMP='ERR_RADI',
                   MAILLE='CUBE',
                   NOEUD='NO2',
                   NOM_RESU='X',
                  );


# pour quantifier THETA (ou RADI) par rapport a l'iso-erreur

IMPR_FONCTION(FORMAT='XMGRACE',
              UNITE=38,
              COURBE=(
              _F(FONCTION=RADI1,LEGENDE='radi=sin(alpha/2) calcul DELTAp',),
              _F(FONCTION=RADI2,LEGENDE='radi=sin(alpha/2) calcul fin ISOT',),
              _F(FONCTION=RADI3,LEGENDE='radi=sin(alpha/2) calcul fin ECMI',),
                        ),
              TITRE='Radi et iso-erreur',
              LEGENDE_X='Inst',
              LEGENDE_Y='crit erreur',);

FIN();
