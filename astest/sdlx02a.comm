# TITRE PROBLEME DE HOVGAARD: CALCUL MODAL ET CALCUL SPECTRAL
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

MAILLAGE=LIRE_MAILLAGE(FORMAT='MED', )

MODELE=AFFE_MODELE(  MAILLAGE=MAILLAGE,AFFE=(
                  _F(  GROUP_MA = 'POU_D_T',  PHENOMENE = 'MECANIQUE',
                         MODELISATION = 'POU_D_T'),
                       _F(  GROUP_MA = 'POU_C_T',  PHENOMENE = 'MECANIQUE',
                         MODELISATION = 'POU_C_T'))                  )

#

MAT=DEFI_MATERIAU( ELAS=_F(  E = 1.658E+11,  RHO = 1.3404106E+04,
                                   NU = 0.3,  ALPHA = 1.288E-05)    )

CHAMPMAT=AFFE_MATERIAU(  MAILLAGE=MAILLAGE,
                            AFFE=_F(  GROUP_MA = 'MAT_1',  MATER = MAT) )

COND_LIM=AFFE_CHAR_MECA(  MODELE=MODELE,
                         DDL_IMPO=_F(  GROUP_NO = 'ENCASTRE',
                                    DX = 0.,  DY = 0.,  DZ = 0.,
                                    DRX = 0.,  DRY = 0.,  DRZ = 0.)   )

#

CARA_ELE=AFFE_CARA_ELEM(  MODELE=MODELE,POUTRE=(
                  _F(  GROUP_MA = 'SEC_1',  SECTION = 'GENERALE',
                           CARA = ( 'A',  'IZ', 'IY', 'AY', 'AZ', 'JX',
                                  'EZ', 'EY', 'RY', 'RZ', 'RT',      ),
                           VALE = ( 3.4390E-03,  1.3770E-05,  1.3770E-05,
                                  2.0,  2.0,  2.7540E-05,  0.0,  0.0,
                                  1.0,  1.0,  1.0,        )),
                         _F(  GROUP_MA = 'SEC_2', SECTION = 'GENERALE',
                           CARA = ( 'A',  'IZ', 'IY', 'AY', 'AZ', 'JX',
                                  'EZ', 'EY', 'RY', 'RZ', 'RT',      ),
                           VALE = ( 3.4390E-03, 5.8870E-06, 5.8870E-06,
                                  2.0,  2.0,  2.7540E-05,  0.0,  0.0,
                                  1.0,  1.0,  1.0,        ))),DEFI_ARC=(
                  _F(  MAILLE = 'E3',  ORIE_ARC = 90., RAYON = 0.922),
                           _F(  MAILLE = 'E4',  ORIE_ARC = 90., RAYON = 0.922),
                           _F(  MAILLE = 'E9',  ORIE_ARC = 0., RAYON = 0.922),
                           _F(  MAILLE = 'E10', ORIE_ARC = 0., RAYON = 0.922)) )

#

RIGI_ELE=CALC_MATR_ELEM(  MODELE=MODELE,   OPTION='RIGI_MECA',
                              CHAM_MATER=CHAMPMAT,   CARA_ELEM=CARA_ELE,
                              CHARGE=( COND_LIM, )                   )

MASS_ELE=CALC_MATR_ELEM(  MODELE=MODELE,   OPTION='MASS_MECA',
                              CHAM_MATER=CHAMPMAT,   CARA_ELEM=CARA_ELE,
                              CHARGE=( COND_LIM, )                   )

MASS_ELD=CALC_MATR_ELEM(  MODELE=MODELE,   OPTION='MASS_MECA_DIAG',
                              CHAM_MATER=CHAMPMAT,   CARA_ELEM=CARA_ELE,
                              CHARGE=( COND_LIM, )                   )

NUMEDDL=NUME_DDL(  MATR_RIGI=RIGI_ELE)

RIGIDITE=ASSE_MATRICE(  MATR_ELEM=RIGI_ELE,   NUME_DDL=NUMEDDL )

MASSE=ASSE_MATRICE(  MATR_ELEM=MASS_ELE,   NUME_DDL=NUMEDDL )

MASSE_DI=ASSE_MATRICE(  MATR_ELEM=MASS_ELD,   NUME_DDL=NUMEDDL )

TABL_MAS=POST_ELEM(  MODELE=MODELE,
                         CHAM_MATER=CHAMPMAT,   CARA_ELEM=CARA_ELE,
                        MASS_INER=_F(  TOUT = 'OUI')                   )

MODE=CALC_MODES(MATR_RIGI=RIGIDITE,
                CALC_FREQ=_F(NMAX_FREQ=9,
                             ),
                MATR_MASS=MASSE,
                SOLVEUR_MODAL=_F(METHODE='TRI_DIAG',
                                 ),
                )


MODE_DIA=CALC_MODES(MATR_RIGI=RIGIDITE,
                    CALC_FREQ=_F(NMAX_FREQ=9,
                                 ),
                    MATR_MASS=MASSE_DI,
                    SOLVEUR_MODAL=_F(METHODE='TRI_DIAG',
                                     ),
                    )


MODE_DIA=NORM_MODE(reuse=MODE_DIA,   MODE=MODE_DIA,   NORME='TRAN_ROTA',)

MODE_DIA=CALC_CHAMP(reuse=MODE_DIA,RESULTAT=MODE_DIA,CONTRAINTE=('SIEF_ELGA','EFGE_ELNO'))


MODE_DIA=CALC_CHAMP(reuse=MODE_DIA,  RESULTAT=MODE_DIA,
                 FORCE='REAC_NODA', )

TEST_RESU(RESU=(_F(PARA='FREQ',
                   NUME_MODE=1,
                   RESULTAT=MODE,
                   VALE_CALC=10.4487958193,
                   VALE_REFE=10.390000000000001,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=6.0000000000000001E-3,),
                _F(PARA='FREQ',
                   NUME_MODE=2,
                   RESULTAT=MODE,
                   VALE_CALC=19.9067162804,
                   VALE_REFE=20.02,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=6.0000000000000001E-3,),
                _F(PARA='FREQ',
                   NUME_MODE=3,
                   RESULTAT=MODE,
                   VALE_CALC=25.3369043157,
                   VALE_REFE=25.449999999999999,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=5.0000000000000001E-3,),
                _F(PARA='FREQ',
                   NUME_MODE=4,
                   RESULTAT=MODE,
                   VALE_CALC=46.8805695909,
                   VALE_REFE=48.32,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=0.029999999999999999,),
                _F(PARA='FREQ',
                   NUME_MODE=5,
                   RESULTAT=MODE,
                   VALE_CALC=51.7708362839,
                   VALE_REFE=52.600000000000001,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=0.016,),
                _F(PARA='FREQ',
                   NUME_MODE=6,
                   RESULTAT=MODE,
                   VALE_CALC=82.4334755801,
                   VALE_REFE=84.810000000000002,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=0.029000000000000001,),
                _F(PARA='FREQ',
                   NUME_MODE=7,
                   RESULTAT=MODE,
                   VALE_CALC=84.1737126926,
                   VALE_REFE=87.159999999999997,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=0.035000000000000003,),
                _F(PARA='FREQ',
                   NUME_MODE=8,
                   RESULTAT=MODE,
                   VALE_CALC=130.137899294,
                   VALE_REFE=129.31,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=7.0000000000000001E-3,),
                _F(PARA='FREQ',
                   NUME_MODE=9,
                   RESULTAT=MODE,
                   VALE_REFE=131.69,
                   VALE_CALC=131.691220344,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=1.E-3,
                   ),
                ),
          )

#

TEST_RESU(RESU=(_F(PARA='FREQ',
                   NUME_MODE=1,
                   RESULTAT=MODE_DIA,
                   VALE_CALC=10.198605717,
                   VALE_REFE=10.18,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=5.0000000000000001E-3,),
                _F(PARA='FREQ',
                   NUME_MODE=2,
                   RESULTAT=MODE_DIA,
                   VALE_CALC=19.5444171076,
                   VALE_REFE=19.539999999999999,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=5.0000000000000001E-3,),
                _F(PARA='FREQ',
                   NUME_MODE=3,
                   RESULTAT=MODE_DIA,
                   VALE_CALC=25.3685550027,
                   VALE_REFE=25.469999999999999,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=5.0000000000000001E-3,),
                _F(PARA='FREQ',
                   NUME_MODE=4,
                   RESULTAT=MODE_DIA,
                   VALE_CALC=47.76404685,
                   VALE_REFE=48.090000000000003,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=8.0000000000000002E-3,),
                _F(PARA='FREQ',
                   NUME_MODE=5,
                   RESULTAT=MODE_DIA,
                   VALE_CALC=52.5090603545,
                   VALE_REFE=52.859999999999999,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=1.E-2,),
                _F(PARA='FREQ',
                   NUME_MODE=6,
                   RESULTAT=MODE_DIA,
                   VALE_CALC=75.1310959094,
                   VALE_REFE=75.939999999999998,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=0.010999999999999999,),
                _F(PARA='FREQ',
                   NUME_MODE=7,
                   RESULTAT=MODE_DIA,
                   VALE_CALC=79.5127085205,
                   VALE_REFE=80.109999999999999,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=1.E-2,),
                _F(PARA='FREQ',
                   NUME_MODE=8,
                   RESULTAT=MODE_DIA,
                   VALE_CALC=120.785751835,
                   VALE_REFE=122.34,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=0.014999999999999999,),
                _F(PARA='FREQ',
                   NUME_MODE=9,
                   RESULTAT=MODE_DIA,
                   VALE_CALC=121.480944836,
                   VALE_REFE=123.15000000000001,
                   REFERENCE='SOURCE_EXTERNE',
                   PRECISION=0.014999999999999999,),
                ),
          )

#

MODE_STA=MODE_STATIQUE(  MATR_RIGI=RIGIDITE,   MATR_MASS=MASSE_DI,
                             PSEUDO_MODE=_F(  AXE = ( 'X',  'Y',  'Z', ))  )

IMPR_RESU(RESU=_F(RESULTAT=MODE_STA,),)
IMPR_RESU(FORMAT='MED',RESU=_F(RESULTAT=MODE_STA,),)


T_RELE = POST_RELEVE_T ( ACTION=_F( INTITULE = 'MO_ST',
                                    NOEUD    = 'N1000',
                                    RESULTAT = MODE_STA,
                                    NOM_CHAM = 'DEPL',
                                    TOUT_CMP = 'OUI',
                                    OPERATION= 'EXTRACTION',),)
IMPR_TABLE ( TABLE = T_RELE,
             NOM_PARA = ('NOEUD','NUME_ORDRE','DX','DY','DZ','NOEUD_CMP',), )

MODE_STA=CALC_CHAMP(reuse=MODE_STA,RESULTAT=MODE_STA,CONTRAINTE=('SIEF_ELGA','EFGE_ELNO'))


MODE_STA=CALC_CHAMP(reuse=MODE_STA,  RESULTAT=MODE_STA,
                    FORCE='REAC_NODA',)

#

ACCE_XY=DEFI_FONCTION(  NOM_PARA='FREQ',    INTERPOL='LOG',
                            VALE=(     1.0,   1.962,   10.0,   19.62,
                                      30.0,  19.62,   100.0,    1.962,
                                   10000.0,   1.962,          )       )

ACCE_Z=DEFI_FONCTION(  NOM_PARA='FREQ',    INTERPOL='LOG',
                            VALE=(     1.0,   0.981,   10.0,    9.81,
                                      30.0,   9.81,   100.0,    0.981,
                                   10000.0,   0.981,          )       )

SPECT_XY=DEFI_NAPPE(  NOM_PARA='AMOR',
                            INTERPOL=( 'LIN', 'LOG', ),
                          PARA=(     0.015,   0.02,    0.025,  ),
                          FONCTION=( ACCE_XY,  ACCE_XY,  ACCE_XY, )  )

SPECT_Z=DEFI_NAPPE(  NOM_PARA='AMOR',
                            INTERPOL=( 'LIN', 'LOG', ),
                          PARA=(     0.015,   0.02,    0.025,  ),
                          FONCTION=( ACCE_Z,   ACCE_Z,   ACCE_Z,  )  )

#

SISM_SPE=COMB_SISM_MODAL(  MODE_MECA=MODE_DIA,
                           AMOR_REDUIT=0.02,
                           MASS_INER=TABL_MAS,
                           CORR_FREQ='NON',
                           MONO_APPUI = 'OUI',
                           EXCIT=_F( TRI_SPEC = 'OUI',
                                     SPEC_OSCI = ( SPECT_XY,  SPECT_XY,
                                                SPECT_XY, ),
                           ECHELLE = ( 1.,  1.,  0.5, )),
                           COMB_MODE=_F(  TYPE = 'SRSS'),
                           COMB_DIRECTION=_F(  TYPE = 'QUAD'),
                           OPTION=( 'DEPL',  'EFGE_ELNO',
                                      'REAC_NODA', )
                            )


TEST_RESU(RESU=(_F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N300',
                   NOM_CMP='DX',
                   VALE_CALC=0.00484493120485,
                   VALE_REFE=4.8469999999999997E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(NUME_ORDRE=4,
                   RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N300',
                   NOM_CMP='DY',
                   VALE_CALC=0.00219136093588,
                   VALE_REFE=2.1919999999999999E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N300',
                   NOM_CMP='DZ',
                   VALE_CALC=2.73415002813E-06,
                   VALE_REFE=2.7350000000000001E-06,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N500',
                   NOM_CMP='DX',
                   VALE_CALC=0.00480625885103,
                   VALE_REFE=4.8079999999999998E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N500',
                   NOM_CMP='DY',
                   VALE_CALC=0.00291308435158,
                   VALE_REFE=2.9139999999999999E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N500',
                   NOM_CMP='DZ',
                   VALE_CALC=0.000650479069775,
                   VALE_REFE=6.5070000000000004E-4,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N700',
                   NOM_CMP='DX',
                   VALE_CALC=0.00358664080956,
                   VALE_REFE=3.588E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N700',
                   NOM_CMP='DY',
                   VALE_CALC=0.00291238915622,
                   VALE_REFE=2.9139999999999999E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N700',
                   NOM_CMP='DZ',
                   VALE_CALC=0.000859595087391,
                   VALE_REFE=8.5990000000000003E-4,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N900',
                   NOM_CMP='DX',
                   VALE_CALC=0.00234150226048,
                   VALE_REFE=2.3419999999999999E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N900',
                   NOM_CMP='DY',
                   VALE_CALC=0.00291140970888,
                   VALE_REFE=2.9129999999999998E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N900',
                   NOM_CMP='DZ',
                   VALE_CALC=0.00102613329335,
                   VALE_REFE=1.0269999999999999E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N1100',
                   NOM_CMP='DX',
                   VALE_CALC=3.0075054665E-06,
                   VALE_REFE=3.0089999999999999E-06,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N1100',
                   NOM_CMP='DY',
                   VALE_CALC=0.000937109699828,
                   VALE_REFE=9.3749999999999997E-4,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='DEPL',
                   NOEUD='N1100',
                   NOM_CMP='DZ',
                   VALE_CALC=0.000336211276055,
                   VALE_REFE=3.3639999999999999E-4,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                ),
          )

TEST_RESU(RESU=(_F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N100',
                   NOM_CMP='DX',
                   VALE_CALC=2130.80751884,
                   VALE_REFE=2132.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N100',
                   NOM_CMP='DY',
                   VALE_CALC=1240.24533539,
                   VALE_REFE=1241.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N100',
                   NOM_CMP='DZ',
                   VALE_CALC=564.333170144,
                   VALE_REFE=564.60000000000002,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N100',
                   NOM_CMP='DRX',
                   VALE_CALC=2351.27100934,
                   VALE_REFE=2352.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N100',
                   NOM_CMP='DRY',
                   VALE_CALC=4744.27589835,
                   VALE_REFE=4746.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N100',
                   NOM_CMP='DRZ',
                   VALE_CALC=936.916711777,
                   VALE_REFE=937.29999999999995,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N1500',
                   NOM_CMP='DX',
                   VALE_CALC=1652.24024863,
                   VALE_REFE=1653.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N1500',
                   NOM_CMP='DY',
                   VALE_CALC=3352.1936536,
                   VALE_REFE=3354.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N1500',
                   NOM_CMP='DZ',
                   VALE_CALC=893.344220216,
                   VALE_REFE=893.70000000000005,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N1500',
                   NOM_CMP='DRX',
                   VALE_CALC=170.744091156,
                   VALE_REFE=170.80000000000001,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N1500',
                   NOM_CMP='DRY',
                   VALE_CALC=1667.71028718,
                   VALE_REFE=1668.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N1500',
                   NOM_CMP='DRZ',
                   VALE_CALC=4900.62386835,
                   VALE_REFE=4903.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                ),
          )

TEST_RESU(RESU=(_F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N300',
                   NOM_CMP='N',
                   VALE_CALC=559.862149669,
                   VALE_REFE=559.89999999999998,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E2',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N300',
                   NOM_CMP='VY',
                   VALE_CALC=430.755591316,
                   VALE_REFE=430.80000000000001,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E2',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N300',
                   NOM_CMP='VZ',
                   VALE_CALC=914.884326807,
                   VALE_REFE=914.89999999999998,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E2',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N300',
                   NOM_CMP='MT',
                   VALE_CALC=932.505660892,
                   VALE_REFE=932.5,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E2',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N300',
                   NOM_CMP='MFY',
                   VALE_CALC=587.348366878,
                   VALE_REFE=587.29999999999995,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E2',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N300',
                   NOM_CMP='MFZ',
                   VALE_CALC=620.365427551,
                   VALE_REFE=620.39999999999998,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E2',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N700',
                   NOM_CMP='N',
                   VALE_CALC=1624.83576367,
                   VALE_REFE=1625.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E7',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N700',
                   NOM_CMP='VY',
                   VALE_CALC=1367.04164689,
                   VALE_REFE=1367.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E7',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N700',
                   NOM_CMP='VZ',
                   VALE_CALC=225.378182108,
                   VALE_REFE=225.40000000000001,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E7',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N700',
                   NOM_CMP='MT',
                   VALE_CALC=649.577881622,
                   VALE_REFE=649.60000000000002,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E7',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N700',
                   NOM_CMP='MFY',
                   VALE_CALC=499.822053588,
                   VALE_REFE=499.80000000000001,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E7',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N700',
                   NOM_CMP='MFZ',
                   VALE_CALC=908.669530189,
                   VALE_REFE=908.70000000000005,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E7',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1100',
                   NOM_CMP='N',
                   VALE_CALC=1651.66313509,
                   VALE_REFE=1652.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E11',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1100',
                   NOM_CMP='VY',
                   VALE_CALC=3176.77570482,
                   VALE_REFE=3177.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E11',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1100',
                   NOM_CMP='VZ',
                   VALE_CALC=795.676841889,
                   VALE_REFE=795.70000000000005,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E11',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1100',
                   NOM_CMP='MT',
                   VALE_CALC=170.64527643,
                   VALE_REFE=170.59999999999999,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E11',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1100',
                   NOM_CMP='MFY',
                   VALE_CALC=924.696527361,
                   VALE_REFE=924.70000000000005,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E11',),
                _F(RESULTAT=SISM_SPE,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1100',
                   NOM_CMP='MFZ',
                   VALE_CALC=2150.28615335,
                   VALE_REFE=2150.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E11',),
                ),
          )

# ----------------------------------------------------------------------
#      COMPARAISON AVEC POUX, POUR VALIDER L'OPTION CORR_FREQ
# ----------------------------------------------------------------------

SISM_SIS=COMB_SISM_MODAL(  MODE_MECA=MODE_DIA,
                           AMOR_REDUIT=0.02,
                           CORR_FREQ='OUI',
                           MASS_INER=TABL_MAS,
                           MONO_APPUI = 'OUI',
                           EXCIT=_F( TRI_SPEC = 'OUI',
                                     SPEC_OSCI = ( SPECT_XY,  SPECT_XY,
                                                SPECT_Z,  ),
                                     ECHELLE = ( 1.,  1.,  1., )),
                           COMB_MODE=_F(  TYPE = 'SRSS'),
                           COMB_DIRECTION=_F(  TYPE = 'QUAD'),
                           OPTION=( 'DEPL',  'EFGE_ELNO',
                                      'REAC_NODA', )
                            )

TEST_RESU(RESU=(_F(RESULTAT=SISM_SIS,
                   NOM_CHAM='DEPL',
                   NOEUD='N300',
                   NOM_CMP='DX',
                   VALE_CALC=0.00484590048189,
                   VALE_REFE=4.8469999999999997E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='DEPL',
                   NOEUD='N300',
                   NOM_CMP='DY',
                   VALE_CALC=0.00219179933959,
                   VALE_REFE=2.1919999999999999E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='DEPL',
                   NOEUD='N700',
                   NOM_CMP='DX',
                   VALE_CALC=0.00358735835299,
                   VALE_REFE=3.588E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='DEPL',
                   NOEUD='N700',
                   NOM_CMP='DY',
                   VALE_CALC=0.00291297180885,
                   VALE_REFE=2.9139999999999999E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='DEPL',
                   NOEUD='N700',
                   NOM_CMP='DRY',
                   VALE_CALC=0.00143585315676,
                   VALE_REFE=1.436E-3,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N100',
                   NOM_CMP='DX',
                   VALE_CALC=2131.23380823,
                   VALE_REFE=2132.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N100',
                   NOM_CMP='DY',
                   VALE_CALC=1240.49345889,
                   VALE_REFE=1241.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N100',
                   NOM_CMP='DZ',
                   VALE_CALC=564.44607065,
                   VALE_REFE=564.60000000000002,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N1500',
                   NOM_CMP='DRX',
                   VALE_CALC=170.778250222,
                   VALE_REFE=170.80000000000001,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N1500',
                   NOM_CMP='DRY',
                   VALE_CALC=1668.04392934,
                   VALE_REFE=1668.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='REAC_NODA',
                   NOEUD='N1500',
                   NOM_CMP='DRZ',
                   VALE_CALC=4901.60428726,
                   VALE_REFE=4903.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N100',
                   NOM_CMP='N',
                   VALE_CALC=564.44607065,
                   VALE_REFE=564.60000000000002,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E1',),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N100',
                   NOM_CMP='VY',
                   VALE_CALC=1240.49345889,
                   VALE_REFE=1241.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E1',),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N100',
                   NOM_CMP='VZ',
                   VALE_CALC=2131.23380823,
                   VALE_REFE=2132.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E1',),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N200',
                   NOM_CMP='MT',
                   VALE_CALC=935.999001461,
                   VALE_REFE=936.20000000000005,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E1',),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N200',
                   NOM_CMP='MFY',
                   VALE_CALC=1857.11352735,
                   VALE_REFE=1857.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E1',),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N200',
                   NOM_CMP='MFZ',
                   VALE_CALC=759.403841989,
                   VALE_REFE=759.60000000000002,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E1',),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1000',
                   NOM_CMP='N',
                   VALE_CALC=2453.84414242,
                   VALE_REFE=2454.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E10',),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1000',
                   NOM_CMP='VY',
                   VALE_CALC=1997.0692308,
                   VALE_REFE=1997.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E10',),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1000',
                   NOM_CMP='VZ',
                   VALE_CALC=504.858472334,
                   VALE_REFE=505.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E10',),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1100',
                   NOM_CMP='MT',
                   VALE_CALC=170.592750314,
                   VALE_REFE=170.59999999999999,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E10',),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1100',
                   NOM_CMP='MFY',
                   VALE_CALC=924.89751137,
                   VALE_REFE=925.10000000000002,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E10',),
                _F(RESULTAT=SISM_SIS,
                   NOM_CHAM='EFGE_ELNO',
                   NOEUD='N1100',
                   NOM_CMP='MFZ',
                   VALE_CALC=2150.71633964,
                   VALE_REFE=2151.0,
                   REFERENCE = 'ANALYTIQUE',
                   PRECISION=1.E-3,
                   NOEUD_CMP=('COMBI', 'QUAD'),
                   MAILLE='E10',),
                ),
          )

#

FIN( )
