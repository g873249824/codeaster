# TITRE FATIGUE-COMPTAGE DE CYCLES RAINFLOW-DOMMAGE-EQUIVALENTS-C_PLAN
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#----------------------------------------------------------------------
# SZLZ105A     ESSAI AVEC CHARGE EN DENT DE SCIE
#          CAS TEST DE METHODE DE COMPTAGE PAR RAINFLOW
#                   ARTICLE DOWNING - SOCIE (1982)
#          CALCUL DU DOMMAGE AVEC WOHLER         + CUMUL LINEAIRE MINER
#                              ET MANSON_COFFIN  + CUMUL LINEAIRE MINER
#----------------------------------------------------------------------
#        UNITES : NEWTON , MILLIMETRE , SECONDE (N,MM,S,->MPA)
#----------------------------------------------------------------------
#                       A                         H = 1 MM (EPAISSEUR)
#               <------------->                   A = 1 MM
#               Y
#
#              BO-------------O>F/2
#               INO4       NO3I        F(T)
#               I   +     +   I
#               I             I        5
#              AI             I        4       .   .
#               I             I        3  .   . . . .
#               I   +     +   I        2   . .   .   . .
#               INO1       NO2I        1    .         . .
#              BO-------------O>F/2    O-----------------.-- T
#               B               X     -1                  .
#                                     -2                   .
#               GEOMETRIE             -3 CHARGEMENT         .
#
#               DEPS(N)                DSIG(N)
#               I                      I
#               I                      I
#             10I.                   10I.
#               I  .                   I  .
#               I    .                 I    .
#               I      .               I      .
#               I        .             I        .
#               O------------- N       O------------ N
#                        1000                   1000
#
#               MANSON_COFFIN          WOHLER
#
#----------------------------------------------------------------------
#
DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'))

CARRE=LIRE_MAILLAGE(    )

CPLAN=AFFE_MODELE(            MAILLAGE=CARRE,
                                    AFFE=_F(   PHENOMENE = 'MECANIQUE',
                                            MODELISATION = 'C_PLAN',
                                            TOUT = 'OUI'))

ACIER=DEFI_MATERIAU(            ELAS=_F(   E = 1.,
                                            NU = .3,
                                            ALPHA = 0.))

MAT=AFFE_MATERIAU(            MAILLAGE=CARRE,
                                    AFFE=_F(  MAILLE = 'MA1',
                                           MATER = ACIER,
                                           ))

LINST=DEFI_LIST_REEL(              DEBUT=1.,
                              INTERVALLE=_F(  JUSQU_A = 8.,  NOMBRE = 7))

TRAC=AFFE_CHAR_MECA(             MODELE=CPLAN,DDL_IMPO=(
                                _F(  NOEUD = 'NO1',  DX = 0., DY = 0.),
                                _F(  NOEUD = 'NO4',  DX = 0.)),FORCE_NODALE=(
                            _F(  NOEUD = 'NO2',  FX = .5),
                            _F(  NOEUD = 'NO3',  FX = .5)))

COEF=DEFI_FONCTION(         NOM_PARA='INST',
                             PROL_DROITE='LINEAIRE',
                            PROL_GAUCHE='LINEAIRE',
                                   VALE=(   0.,  0.,
                                            1.,  3.,
                                            2.,  1.,
                                            3.,  4.,
                                            4.,  2.,
                                            5.,  4.,
                                            6.,  1.,
                                            7.,  2.,
                                            8., -3.,                  ))

DEPL=MECA_STATIQUE(
                    TITRE='TEST TRACTION SIMPLE/COMPTAGE RAINFLOW EN C_PLAN',
                                    MODELE=CPLAN,
                                CHAM_MATER=MAT,
                                   EXCIT=_F(  CHARGE = TRAC,
                                           FONC_MULT = COEF),
                               LIST_INST=LINST                       )

DEPL=CALC_CHAMP(reuse=DEPL,CONTRAINTE=('SIGM_ELNO'),DEFORMATION=('EPSI_ELGA','EPSI_ELNO'),RESULTAT=DEPL)


DEPL=CALC_CHAMP(reuse=DEPL,CRITERES=('SIEQ_ELGA','EPEQ_ELGA','SIEQ_ELNO','EPEQ_ELNO'),RESULTAT=DEPL)


MACR_ECLA_PG(   MODELE_INIT = CPLAN,  RESU_INIT = DEPL,
                NOM_CHAM = ('EPEQ_ELGA',), LIST_INST=LINST  ,
                RESULTAT = CO("U2B"), MAILLAGE = CO("MA2"),
                 )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='INVA_2',
                  VALE_CALC=2.6,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='PRIN_1',
                  VALE_CALC=-0.9,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='PRIN_2',
                  VALE_CALC=-0.9,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='PRIN_3',
                  VALE_CALC=3.0,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=3,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='INVA_2',
                  VALE_CALC=3.46666666,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=3,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='PRIN_1',
                  VALE_CALC=-1.2,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=3,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='PRIN_2',
                  VALE_CALC=-1.2,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=3,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='PRIN_3',
                  VALE_CALC=4.0,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=7,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='INVA_2',
                  VALE_CALC=1.733333,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=7,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='PRIN_1',
                  VALE_CALC=-0.6,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=7,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='PRIN_2',
                  VALE_CALC=-0.6,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=7,
                  RESULTAT=U2B,
                  NOM_CHAM='EPEQ_ELGA',
                  NOEUD='N1',
                  NOM_CMP='PRIN_3',
                  VALE_CALC=2.,),
          )

F_MANSON=DEFI_FONCTION(      NOM_PARA='EPSI',
                              PROL_DROITE='LINEAIRE',
                             PROL_GAUCHE='LINEAIRE',
                                    VALE=(
                                             0.,    1000.,
                                            10.,       0.,
                                         ),
                                   TITRE='FONCTION DE MANSON_COFFIN')

F_WOHLER=DEFI_FONCTION(      NOM_PARA='SIGM',
                              PROL_DROITE='LINEAIRE',
                             PROL_GAUCHE='LINEAIRE',
                                    VALE=(
                                             0.,  1000.,
                                            10.,     0.,
                                         ),
                                   TITRE='FONCTION DE WOHLER')

MATE=DEFI_MATERIAU(
          FATIGUE=_F(   WOHLER = F_WOHLER) )

DMG_WOHL=CALC_FATIGUE( TYPE_CALCUL = 'CUMUL_DOMMAGE',
                       OPTION      = 'DOMA_ELNO_SIGM',
                       HISTOIRE    = _F( EQUI_GD  = 'VMIS_SG',
                                         RESULTAT = DEPL),
                       DOMMAGE     = 'WOHLER',
                       MATER       = MATE,
                       INFO        = 2
                     )

DMG_WOH2=CALC_FATIGUE( TYPE_CALCUL = 'CUMUL_DOMMAGE',
                       OPTION      = 'DOMA_ELGA_SIGM',
                       HISTOIRE    = _F( EQUI_GD  = 'VMIS_SG',
                                         RESULTAT = DEPL),
                       DOMMAGE     = 'WOHLER',
                       MATER       = MATE,
                       INFO        = 2
                     )

MAT1=DEFI_MATERIAU(
          FATIGUE=_F(   MANSON_COFFIN = F_MANSON) )

DMG_MCOF=CALC_FATIGUE( TYPE_CALCUL = 'CUMUL_DOMMAGE',
                       OPTION      = 'DOMA_ELNO_EPSI',
                       HISTOIRE    = _F( EQUI_GD  = 'INVA_2_SG',
                                         RESULTAT = DEPL),
                       DOMMAGE     = 'MANSON_COFFIN',
                       MATER       = MAT1,
                       INFO        = 2
                     )

DMG_MCO2=CALC_FATIGUE( TYPE_CALCUL = 'CUMUL_DOMMAGE',
                       OPTION      = 'DOMA_ELGA_EPSI',
                       HISTOIRE    = _F( EQUI_GD  = 'INVA_2_SG',
                                         RESULTAT = DEPL),
                       DOMMAGE     = 'MANSON_COFFIN',
                       MATER       = MAT1,
                       INFO        = 2
                     )

MAT2=DEFI_MATERIAU(
          FATIGUE=_F(   WOHLER = F_WOHLER,
                     MANSON_COFFIN = F_MANSON) )

F_FONC=DEFI_FONCTION(       NOM_PARA='SIGM',
                              PROL_DROITE='LINEAIRE',
                             PROL_GAUCHE='LINEAIRE',
                                    VALE=(
                                            0.,    0.,
                                         1000.,   10.,
                                          ),
                                   TITRE='FONCTION DE TAHERI' )

F_NAPPE=DEFI_NAPPE(           NOM_PARA='X',
                               PROL_DROITE='LINEAIRE',
                              PROL_GAUCHE='LINEAIRE',
                                     PARA=(  0.5,   1., ),
                            NOM_PARA_FONC='EPSI',DEFI_FONCTION=(
                            _F(  PROL_DROITE = 'LINEAIRE',
                                            PROL_GAUCHE = 'LINEAIRE',
                                            VALE = (  0.,   25.,
                                                            10.,  525., )),
                                          _F(  PROL_DROITE = 'LINEAIRE',
                                            PROL_GAUCHE = 'LINEAIRE',
                                            VALE = ( 0.,    50.,
                                                           10.,   550., ))),
                                   TITRE='NAPPE DE TAHERI' )

DMG_TMA=CALC_FATIGUE( TYPE_CALCUL  = 'CUMUL_DOMMAGE',
                      OPTION       = 'DOMA_ELNO_EPSI',
                      HISTOIRE     = _F( EQUI_GD  = 'INVA_2_SG',
                                         RESULTAT = DEPL),
                      DOMMAGE      = 'TAHERI_MANSON',
                      MATER        = MAT1,
                      TAHERI_NAPPE = F_NAPPE,
                      TAHERI_FONC  = F_FONC,
                      INFO         = 2
                    )

DMG_TMI=CALC_FATIGUE( TYPE_CALCUL  = 'CUMUL_DOMMAGE',
                      OPTION       = 'DOMA_ELNO_EPSI',
                      HISTOIRE     = _F( EQUI_GD  = 'INVA_2_SG',
                                         RESULTAT = DEPL),
                      DOMMAGE      = 'TAHERI_MIXTE',
                      MATER        = MAT2,
                      TAHERI_NAPPE = F_NAPPE,
                      INFO         = 2
                    )

TEST_RESU(CHAM_ELEM=(_F(NOEUD='NO1',
                        NOM_CMP='DOMA',
                        MAILLE='MA1',
                        CHAM_GD=DMG_WOHL,
                        VALE_REFE=4.8133E-3,
                        REFERENCE='ANALYTIQUE',
                        VALE_CALC=4.8133153396311E-3,
                        PRECISION=1.E-3,),
                     _F(NOEUD='NO1',
                        NOM_CMP='DOMA',
                        MAILLE='MA1',
                        CHAM_GD=DMG_MCOF,
                        VALE_REFE=4.6705E-3,
                        REFERENCE='ANALYTIQUE',
                        VALE_CALC=4.6704838877098E-3,
                        PRECISION=1.E-3,),
                     ),)

TEST_RESU(RESU=(_F(NUME_ORDRE=8,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=DEPL,
                   NOM_CHAM='SIEQ_ELNO',
                   NOEUD='NO1',
                   NOM_CMP='VMIS',
                   VALE_CALC=3.0,
                   VALE_REFE=3.0,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=DEPL,
                   NOM_CHAM='SIEQ_ELNO',
                   NOEUD='NO1',
                   NOM_CMP='TRESCA',
                   VALE_CALC=3.0,
                   VALE_REFE=3.0,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=DEPL,
                   NOM_CHAM='SIEQ_ELNO',
                   NOEUD='NO1',
                   NOM_CMP='VMIS_SG',
                   VALE_CALC=-3.0,
                   VALE_REFE=-3.0,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=DEPL,
                   NOM_CHAM='SIEQ_ELGA',
                   NOM_CMP='VMIS',
                   VALE_CALC=3.0,
                   VALE_REFE=3.0,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=DEPL,
                   NOM_CHAM='SIEQ_ELGA',
                   NOM_CMP='TRESCA',
                   VALE_CALC=3.0,
                   VALE_REFE=3.0,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=DEPL,
                   NOM_CHAM='SIEQ_ELGA',
                   NOM_CMP='VMIS_SG',
                   VALE_CALC=-3.0,
                   VALE_REFE=-3.0,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=DEPL,
                   NOM_CHAM='EPEQ_ELNO',
                   NOEUD='NO1',
                   NOM_CMP='INVA_2',
                   VALE_CALC=2.60,
                   VALE_REFE=2.60,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=DEPL,
                   NOM_CHAM='EPEQ_ELNO',
                   NOEUD='NO1',
                   NOM_CMP='INVA_2SG',
                   VALE_CALC=-2.60,
                   VALE_REFE=-2.60,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=DEPL,
                   NOM_CHAM='EPEQ_ELGA',
                   NOM_CMP='INVA_2',
                   VALE_CALC=2.60,
                   VALE_REFE=2.60,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   REFERENCE='ANALYTIQUE',
                   POINT=1,
                   RESULTAT=DEPL,
                   NOM_CHAM='EPEQ_ELGA',
                   NOM_CMP='INVA_2SG',
                   VALE_CALC=-2.60,
                   VALE_REFE=-2.60,
                   MAILLE='MA1',),
                ),
          )

FIN()
#
