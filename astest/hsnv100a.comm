# MODIF  DATE 12/05/2009   AUTEUR PELLET J.PELLET 
# TITRE THERMO-PLASTICITE EN TRACTION SIMPLE
# RESPONSABLE JMBHH01 J.M.PROIX
# hsnv100a.para = tps_job 60 mem_job 64Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

DEBUT(CODE=_F(NOM='HSNV100A', NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'))

#......................................................................
# CAS TEST THERMOPLASTICITE ELEMENTAIRE
#......................................................................
# DEFINITION DES CARACTERISTIQUES DU MATERIAU
#

MAIL=LIRE_MAILLAGE( )

#
# DONNEES DE MODELISATION
#

FCT1=DEFI_FONCTION(   NOM_PARA='EPSI',  PROL_DROITE='LINEAIRE',
                                          PROL_GAUCHE='LINEAIRE',
                       VALE=(
                             0.200E-2,      400.,
                             0.400E-2,      500.,)
                                                    )

#

FCT2=DEFI_FONCTION(   NOM_PARA='EPSI',  PROL_DROITE='LINEAIRE',
                                          PROL_GAUCHE='LINEAIRE',
                       VALE=(
                             0.100E-2,      200.,
                             0.300E-2,      300.,)
                                                    )

#

CTRACB=DEFI_NAPPE(   NOM_PARA='TEMP',  PROL_DROITE='LINEAIRE',
                                         PROL_GAUCHE='LINEAIRE',
                           PARA=(0.,50.,),
                           FONCTION=(FCT1,FCT2,)            )

#
# MATERIAU ISOTROPE
#

MAT=DEFI_MATERIAU(
          THER=_F( RHO_CP = 0.0E-3,LAMBDA = 1.0E-3),
          ELAS=_F( E = 200.E+3, NU = .3,ALPHA = 10.0E-6),
           TRACTION=_F( SIGM = CTRACB)                                 )

#
# MATERIAU ORTHOTROPE EN FAIT ISOTROPE
#

MATO=DEFI_MATERIAU(
          THER=_F( RHO_CP = 0.0E-3,LAMBDA = 1.0E-3),
          ELAS_ORTH=_F(  E_L = 200000., E_T = 200000., E_N = 200000.,
                    NU_LT = 0.3,   NU_LN = 0.3,   NU_TN = 0.3,
                    G_LT = 75000., G_LN = 75000., G_TN = 75000.,
                    ALPHA_L = 10.0E-6, ALPHA_N = 10.0E-6, ALPHA_T = 10.0E-6),
           TRACTION=_F( SIGM = CTRACB)                                 )

#

CM=AFFE_MATERIAU(    MAILLAGE=MAIL,
          AFFE=_F( TOUT = 'OUI',MATER = MAT)
                                                )

#

CMO=AFFE_MATERIAU(    MAILLAGE=MAIL,
          AFFE=_F( TOUT = 'OUI',MATER = MATO)
                                                )

#

T0=CREA_CHAMP( OPERATION='AFFE', TYPE_CHAM='NOEU_TEMP_R', MAILLAGE=MAIL,
          AFFE=_F( TOUT = 'OUI', NOM_CMP = 'TEMP', VALE = 0.0)
                                                )

L_INST=DEFI_LIST_REEL(       DEBUT=0.,INTERVALLE=(
           _F( JUSQU_A = 66.666E0,   NOMBRE = 1),
                      _F( JUSQU_A = 80.000E0,   NOMBRE = 2),
                      _F( JUSQU_A = 90.000E0,   NOMBRE = 2))
         )

#
TIMPVAR=DEFI_FONCTION(    NOM_PARA='INST',  NOM_RESU='TEMP',
           VALE=(  0.E0,  0.E0, 100.E0, 100.E0,)
                                                )

#

MOTHER=AFFE_MODELE(  MAILLAGE=MAIL,
          AFFE=_F( TOUT = 'OUI', MODELISATION = 'AXIS', PHENOMENE = 'THERMIQUE'))

#

MOMECA=AFFE_MODELE(  MAILLAGE=MAIL,
          AFFE=_F( TOUT = 'OUI', MODELISATION = 'AXIS', PHENOMENE = 'MECANIQUE'))

#
CHTHER=AFFE_CHAR_THER_F(    MODELE=MOTHER,TEMP_IMPO=(
            _F( GROUP_NO = 'GRNO1',  TEMP = TIMPVAR),
            _F( GROUP_NO = 'GRNO2',  TEMP = TIMPVAR),
            _F( GROUP_NO = 'GRNO3',  TEMP = TIMPVAR),
            _F( GROUP_NO = 'GRNO4',  TEMP = TIMPVAR))
                          )

#

TEMPE=THER_LINEAIRE(  MODELE=MOTHER,   CHAM_MATER=CM,
          EXCIT=_F( CHARGE = CHTHER),
          ETAT_INIT=_F( CHAM_NO = T0),
          INCREMENT=_F( LIST_INST = L_INST)
                        )

CHMECA=AFFE_CHAR_MECA(
            MODELE=MOMECA,DDL_IMPO=(
           _F( GROUP_NO = 'GRNO1',  DY = 0.),
           _F( GROUP_NO = 'GRNO3',  DY = 0.)),
                                                                )

#
TEMPEO=THER_LINEAIRE(  MODELE=MOTHER,   CHAM_MATER=CMO,
          EXCIT=_F( CHARGE = CHTHER),
          ETAT_INIT=_F( CHAM_NO = T0),
          INCREMENT=_F( LIST_INST = L_INST)
                        )

CHMECAO=AFFE_CHAR_MECA(
            MODELE=MOMECA,DDL_IMPO=(
           _F( GROUP_NO = 'GRNO1',  DY = 0.),
           _F( GROUP_NO = 'GRNO3',  DY = 0.)),
                                                                )
CTM=AFFE_MATERIAU(    MAILLAGE=MAIL,
          AFFE=_F( TOUT = 'OUI',MATER = MAT,),
          AFFE_VARC=_F( TOUT='OUI',
                        EVOL=TEMPE,
                        NOM_VARC='TEMP',
                        NOM_CHAM='TEMP',
                        VALE_REF=0.),)

#
CTMO=AFFE_MATERIAU(    MAILLAGE=MAIL,
          AFFE=_F( TOUT = 'OUI',MATER = MATO,),
          AFFE_VARC=_F( TOUT='OUI',
                        EVOL=TEMPEO,
                        NOM_VARC='TEMP',
                        NOM_CHAM='TEMP',
                        VALE_REF=0.),)


U=STAT_NON_LINE(
                            MODELE=MOMECA,
                        CHAM_MATER=CTM,
                             EXCIT=_F(
                CHARGE = CHMECA),
                         COMP_INCR=_F(
                RELATION = 'VMIS_ISOT_TRAC'),
                         INCREMENT=_F(
                LIST_INST = L_INST),
                       CONVERGENCE=_F(
                RESI_GLOB_RELA = .0001,
                ITER_GLOB_MAXI = 10)
              )

U=CALC_ELEM( reuse=U,
                            OPTION=( 'EPSI_ELNO_DEPL',
                  'SIEF_ELNO_ELGA',  'VARI_ELNO_ELGA',),
                          RESULTAT=U,
              )

#
TEST_RESU(RESU=(
          _F(  RESULTAT = TEMPE,  NOM_CHAM = 'TEMP',  NUME_ORDRE = 5,
            NOEUD = 'N1', NOM_CMP = 'TEMP', VALE = 90.),
          _F(  RESULTAT = U,  NOM_CHAM = 'EPSI_ELNO_DEPL',  NUME_ORDRE = 1,
            MAILLE = 'M1', NOEUD = 'N1', NOM_CMP = 'EPXX', VALE = 8.6666E-4),
          _F(  RESULTAT = U, NOM_CHAM = 'SIEF_ELNO_ELGA', NUME_ORDRE = 1,
            MAILLE = 'M1', NOEUD = 'N1', NOM_CMP = 'SIYY', VALE = -133.333),
          _F(  RESULTAT = U,  NOM_CHAM = 'EPSI_ELNO_DEPL',  NUME_ORDRE = 3,
            MAILLE = 'M1',NOEUD = 'N2', NOM_CMP = 'EPZZ',VALE = 1.1000E-3),
          _F(  RESULTAT = U,  NOM_CHAM = 'VARI_ELNO_ELGA',  NUME_ORDRE = 3,
            MAILLE = 'M1',NOEUD = 'N2',NOM_CMP = 'V1',VALE = 3.0000E-4),
          _F(  RESULTAT = U,  NOM_CHAM = 'SIEF_ELNO_ELGA',  NUME_ORDRE = 3,
            MAILLE = 'M1',NOEUD = 'N2',NOM_CMP = 'SIYY',VALE = -100.),
          _F(  RESULTAT = U,  NOM_CHAM = 'EPSI_ELNO_DEPL',  NUME_ORDRE = 5,
            MAILLE = 'M1',NOEUD = 'N3',NOM_CMP = 'EPZZ',VALE = 1.2750E-3),
          _F(  RESULTAT = U,  NOM_CHAM = 'VARI_ELNO_ELGA',  NUME_ORDRE = 5,
            MAILLE = 'M1',NOEUD = 'N3',NOM_CMP = 'V1',VALE = 5.2500E-4),
          _F(  RESULTAT = U,  NOM_CHAM = 'SIEF_ELNO_ELGA',  NUME_ORDRE = 5,
            MAILLE = 'M1',NOEUD = 'N3',NOM_CMP = 'SIYY',VALE = -75.000))
          )

#

V=STAT_NON_LINE(
                            MODELE=MOMECA,
                        CHAM_MATER=CTMO,
                             EXCIT=_F(
                CHARGE = CHMECAO),
                         COMP_ELAS=_F(
                RELATION = 'ELAS'),
                         INCREMENT=_F(
                LIST_INST = L_INST),
                            NEWTON=_F(
                MATRICE = 'ELASTIQUE'),
                       CONVERGENCE=_F(
                RESI_GLOB_RELA = .0001,
                ITER_GLOB_MAXI = 10)
              )

V=CALC_ELEM( reuse=V,
                            OPTION=( 'EPSI_ELNO_DEPL',
                   'SIEF_ELNO_ELGA',  'VARI_ELNO_ELGA',),
                          RESULTAT=V,
              )

#
TEST_RESU(RESU=(
          _F(  RESULTAT = V,  NOM_CHAM = 'EPSI_ELNO_DEPL',  NUME_ORDRE = 1,
            MAILLE = 'M1', NOEUD = 'N1', NOM_CMP = 'EPXX', VALE = 8.6666E-4),
          _F(  RESULTAT = V,  NOM_CHAM = 'SIEF_ELNO_ELGA',  NUME_ORDRE = 1,
            MAILLE = 'M1', NOEUD = 'N1', NOM_CMP = 'SIYY', VALE = -133.333))
          )

V2=STAT_NON_LINE(
                            MODELE=MOMECA,
                        CHAM_MATER=CTM,
                             EXCIT=_F(
                CHARGE = CHMECAO),
                         COMP_INCR=_F(
                RELATION = 'ELAS'),
                         INCREMENT=_F(
                LIST_INST = L_INST),
                            NEWTON=_F(
                MATRICE = 'ELASTIQUE'),
                       CONVERGENCE=_F(
                RESI_GLOB_RELA = .0001,
                ITER_GLOB_MAXI = 10)
              )

V2=CALC_ELEM( reuse=V2,
                            OPTION=( 'EPSI_ELNO_DEPL',
                  'SIEF_ELNO_ELGA',  'VARI_ELNO_ELGA',),
                          RESULTAT=V2,
              )

TEST_RESU(RESU=(
          _F(  RESULTAT = V2,NOM_CHAM = 'SIEF_ELNO_ELGA',NUME_ORDRE = 1,
            MAILLE = 'M1',NOEUD = 'N1',NOM_CMP = 'SIYY',VALE = -133.333),
          _F(  RESULTAT = V2,NOM_CHAM = 'EPSI_ELNO_DEPL',NUME_ORDRE = 1,
            MAILLE = 'M1',NOEUD = 'N1',NOM_CMP = 'EPXX',VALE = 8.6666E-4))
                           )

#

DEP=CREA_CHAMP( OPERATION='EXTR', TYPE_CHAM='NOEU_DEPL_R',
                    RESULTAT=U, NUME_ORDRE=1, NOM_CHAM='DEPL' )

#

SI1=CREA_CHAMP( OPERATION='AFFE', TYPE_CHAM='CART_SIEF_R',
                    MAILLAGE=MAIL,
                      AFFE=_F(  TOUT = 'OUI',
           NOM_CMP = ('SIXX','SIYY','SIZZ','SIXY','SIYZ','SIXZ',),
           VALE = (  0.,   -133.332,  0.,     0.,     0.,     0.,))
                      )

L_INST1=DEFI_LIST_REEL(
               DEBUT=66.666E0,INTERVALLE=(
           _F( JUSQU_A = 80.000E0,   NOMBRE = 2),
                      _F( JUSQU_A = 90.000E0,   NOMBRE = 2))
         )

W=STAT_NON_LINE(
                            MODELE=MOMECA,
                        CHAM_MATER=CTM,
                             EXCIT=_F(
                CHARGE = CHMECA),
                         COMP_INCR=_F(
                RELATION = 'VMIS_ISOT_TRAC'),
                         INCREMENT=_F(
                LIST_INST = L_INST1),
                         ETAT_INIT=_F(
                SIGM = SI1,
                DEPL = DEP),
                       CONVERGENCE=_F(
                RESI_GLOB_RELA = .0001,
                ITER_GLOB_MAXI = 10)
              )

W=CALC_ELEM( reuse=W,
                            OPTION=( 'EPSI_ELNO_DEPL',
                  'SIEF_ELNO_ELGA',  'VARI_ELNO_ELGA',),
                          RESULTAT=W,

              )

#
TEST_RESU(RESU=(
          _F(  RESULTAT = W,  NOM_CHAM = 'EPSI_ELNO_DEPL',  NUME_ORDRE = 2,
            MAILLE = 'M1',NOEUD = 'N2',NOM_CMP = 'EPZZ',VALE = 1.1000E-3),
          _F(  RESULTAT = W,  NOM_CHAM = 'VARI_ELNO_ELGA',  NUME_ORDRE = 2,
            MAILLE = 'M1',NOEUD = 'N2',NOM_CMP = 'V1',VALE = 3.0000E-4),
          _F(  RESULTAT = W,  NOM_CHAM = 'SIEF_ELNO_ELGA',  NUME_ORDRE = 2,
            MAILLE = 'M1',NOEUD = 'N2',NOM_CMP = 'SIYY',VALE = -100.),
          _F(  RESULTAT = W,  NOM_CHAM = 'EPSI_ELNO_DEPL',  NUME_ORDRE = 4,
            MAILLE = 'M1',NOEUD = 'N3',NOM_CMP = 'EPZZ',VALE = 1.2750E-3),
          _F(  RESULTAT = W,  NOM_CHAM = 'VARI_ELNO_ELGA',  NUME_ORDRE = 4,
            MAILLE = 'M1',NOEUD = 'N3',NOM_CMP = 'V1',VALE = 5.2500E-4),
          _F(  RESULTAT = W,  NOM_CHAM = 'SIEF_ELNO_ELGA',  NUME_ORDRE = 4,
            MAILLE = 'M1',NOEUD = 'N3',NOM_CMP = 'SIYY',VALE = -75.000))
          )

#  ATESTS DES ENERGIES
U=CALC_ELEM( reuse=U, OPTION=( 'ETOT_ELGA','ENEL_ELGA'),
                          RESULTAT=U,
                          )

TEST_RESU(RESU=(
          _F(  RESULTAT = U,  NOM_CHAM = 'ENEL_ELGA',  NUME_ORDRE = 1,REFERENCE='ANALYTIQUE',
            MAILLE = 'M1', POINT=1, NOM_CMP = 'TOTALE', VALE = 4.4444E-02),),)

T_POT=POST_ELEM(
                    RESULTAT=U,
                      CHARGE=CHMECA,
                    ENER_POT=_F( TOUT = 'OUI',)  )

T_TOT=POST_ELEM(
                    RESULTAT=U,
                      CHARGE=CHMECA,
                    ENER_TOTALE=_F( TOUT = 'OUI',)  )

IMPR_TABLE(TABLE=T_POT)

IMPR_TABLE(TABLE=T_TOT)

TEST_TABLE ( TABLE=T_POT,
             FILTRE=_F(NOM_PARA='NUME_ORDRE',
                       VALE_I=1),
             NOM_PARA='TOTALE',
             REFERENCE='ANALYTIQUE',
             VALE= 0.266664  )
# 4.4444E-2 * 3/2 * 4 = 0.266664
TEST_TABLE ( TABLE=T_TOT,
             FILTRE=_F(NOM_PARA='NUME_ORDRE',
                       VALE_I=1),
             NOM_PARA='TOTALE',
             REFERENCE='ANALYTIQUE',
             VALE= 0.266664 )

FIN()
#
