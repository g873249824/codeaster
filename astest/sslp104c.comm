# MODIF  DATE 13/05/2008   AUTEUR MEUNIER S.MEUNIER 
# TITRE POUTRE CONSOLE 3D/PLAQUE
# VALIDATION DE LA METHODE ARLEQUIN
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2007  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# ARLEQUIN : RACCORD 3D/PLAQUE INCOMPATIBLE.
#            MAILLAGES DE DENSITES DIFFERENTES
#
# VERSION 3D/PLAQUE DE SSLP104A

DEBUT(CODE=_F(NOM='SSLP104C',
              NIV_PUB_WEB='INTERNET',),
      DEBUG=_F(SDVERI='OUI',),);

#############################
# 1. Definition de constantes
#############################

force = 1000000.0;

epais = 1.0;

young = 200000000000.0;

hauteur = 2.0;

long = 10.0;

inertie = hauteur*epais*epais*epais/12;

########################
# 2. Lecture du maillage
########################

PRE_GMSH();

MAIL=LIRE_MAILLAGE();

MAIL=DEFI_GROUP(reuse =MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=(_F(GROUP_MA='GM53',),
                               _F(GROUP_MA='GM54',),),);

MOD=AFFE_MODELE(MAILLAGE=MAIL,
                AFFE=(_F(GROUP_MA=('GM1000','GM101','GM50',),
                         PHENOMENE='MECANIQUE',
                         MODELISATION='3D',),
                      _F(GROUP_MA=('GM100','GM53','GM51',),
                         PHENOMENE='MECANIQUE',
                         MODELISATION='DKT',),),);

MATER=DEFI_MATERIAU(ELAS=_F(E=young,
                            NU=0.3,),);

CHMATER=AFFE_MATERIAU(MAILLAGE=MAIL,
                      AFFE=_F(TOUT='OUI',
                              MATER=MATER,),);

CARA=AFFE_CARA_ELEM(MODELE=MOD,
                    COQUE=_F(GROUP_MA='GM100',
                             EPAIS=epais,),);

EFFORT=AFFE_CHAR_MECA(MODELE=MOD,
                      FORCE_ARETE=_F(GROUP_MA='GM51',
                                     FZ=-force,),);

ENCAST=AFFE_CHAR_MECA(MODELE=MOD,
                      DDL_IMPO=_F(GROUP_MA='GM101',
                                  LIAISON='ENCASTRE',),);

################################################
# 3. Creation des relations de couplage Arlequin
#    entre les groupes de mailles
#    GM1000 (maillage fin) et
#    GM100  (maillage grossier)
#    Collage sur le modele grossier
################################################

ARLQ=AFFE_CHAR_MECA(MODELE=MOD,
                    ARLEQUIN=_F(GROUP_MA_1='GM1000',
                                GROUP_MA_2='GM100',
                                CARA_ELEM=CARA,
                                COLLAGE='GROUP_MA_2',
                                POIDS_FIN=0.9999,),);

RESU=MECA_STATIQUE(MODELE=MOD,
                   CHAM_MATER=CHMATER,
                   CARA_ELEM=CARA,
                   EXCIT=(_F(CHARGE=ARLQ,),
                          _F(CHARGE=EFFORT,),
                          _F(CHARGE=ENCAST,),),);

#############################
# 4.Post-traitement du calcul
#############################

RESU=CALC_ELEM(reuse =RESU,
               RESULTAT=RESU,
               OPTION=('SIGM_ELNO_DEPL','EQUI_ELNO_SIGM',),);

RESU=CALC_NO(reuse =RESU,
             RESULTAT=RESU,
             OPTION=('EQUI_NOEU_SIGM','SIGM_NOEU_DEPL',),);

###########################################
# 5. Fleche maximale au point
#    de coordonnees (X,0,0.5)
#    Noeud 243
#    Solution theorique
#    Reference : Guide de validation
#    des progiciels de calcul de structures
#    p.52
###########################################

X = 9.42857;
fxtheo = -1*(force*hauteur/2./young/inertie*(long*X*X-X*X*X/3))

DPL_2D=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                               INTITULE='DEPL_2D',
                               RESULTAT=RESU,
                               NOM_CHAM='DEPL',
                               GROUP_NO='GM53',
                               NOM_CMP='DZ',),);

IMPR_TABLE(TABLE=DPL_2D,);

TEST_TABLE(TABLE=DPL_2D,
           FILTRE=_F(NOM_PARA='COOR_X',
                     VALE=X,),
           NOM_PARA='DZ',
           VALE=fxtheo,
           CRITERE='RELATIF',
           PRECISION=0.02,
           REFERENCE='ANALYTIQUE',);

TEST_TABLE(TABLE=DPL_2D,
           FILTRE=_F(NOM_PARA='COOR_X',
                     VALE=X,),
           NOM_PARA='DZ',
           VALE=-1.7942266587517E-02,
           CRITERE='RELATIF',
           PRECISION=2e-06,
           REFERENCE='NON_REGRESSION',
           VERSION='9.0.4',);

###########################################
# 6. Contrainte de traction SIXX au point
#    de coordonnees (X,0,Z)
#    Noeud 211
#    Solution theorique
#    Reference : Guide de validation
#    des progiciels de calcul de structures
#    p.52
###########################################

X = 3.0;
Z = 0.888889;

sixxth = force*hauteur*(long-X)*(Z-epais/2.)/inertie

SIXX_Z=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                               INTITULE='SIXX',
                               RESULTAT=RESU,
                               NOM_CHAM='SIGM_NOEU_DEPL',
                               GROUP_NO='GM54',
                               NOM_CMP='SIXX',),);

IMPR_TABLE(TABLE=SIXX_Z,);

TEST_TABLE(TABLE=SIXX_Z,
           FILTRE=_F(NOM_PARA='COOR_Z',
                     VALE=Z,),
           NOM_PARA='SIXX',
           VALE=sixxth,
           CRITERE='RELATIF',
           PRECISION=0.14,
           REFERENCE='ANALYTIQUE',);

TEST_TABLE(TABLE=SIXX_Z,
           FILTRE=_F(NOM_PARA='COOR_Z',
                     VALE=Z,),
           NOM_PARA='SIXX',
           VALE=3.7065127737457E+07,
           CRITERE='RELATIF',
           PRECISION=0.0005,
           REFERENCE='NON_REGRESSION',
           VERSION='9.0.4',);

FIN();
