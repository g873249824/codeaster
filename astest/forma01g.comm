
# MODIF  DATE 24/06/2002   AUTEUR CIBHHGB G.BERTRAND 
# RESPONSABLE PABHHHH N.TARDIEU


DEBUT(CODE=_F(NOM='FORMA01G',NIV_PUB_WEB='INTERNET'),);
# TITRE TRAVAUX PRATIQUES FORMATION DE BASE 
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
# (AT YOUR OPTION) ANY LATER VERSION.                                 
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
# ======================================================================
#        TUYAUTERIE COMPORTANT UN COUDE
#     MODELISATION PAR DES ELEMENTS MASSIFS
#         AVEC STRATIFICATION THERMIQUE
#               MAILLE AVEC GMSH
#     -------------------------------------
#

# TUYAU    <=> GM10000
# EFOND    <=> GM10005
# ENCAST   <=> GM10001
# SYMETRIE <=> GM10002
# SURFINT  <=> GM10004
# SURFEXT  <=> GM10003

PRE_GMSH();

MAIL=LIRE_MAILLAGE();


MAIL=DEFI_GROUP(reuse =MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=(_F(GROUP_MA='GM10005',),
                               _F(GROUP_MA='GM10001',),
                               _F(GROUP_MA='GM10002',),
                               _F(GROUP_MA='GM10004',),
                               _F(GROUP_MA='GM10003',),),);
# DEFINITION DES ELEMENTS FINIS UTILISES POUR LE CALCUL THERMIQUE
#


MODETH=AFFE_MODELE(MAILLAGE=MAIL,
                   AFFE=_F(TOUT='OUI',
                           PHENOMENE='THERMIQUE',
                           MODELISATION='3D',),);
# DEFINITION DES ELEMENTS FINIS UTILISES POUR LE CALCUL MECANIQUE
#


MODMECA=AFFE_MODELE(MAILLAGE=MAIL,
                    AFFE=_F(TOUT='OUI',
                            PHENOMENE='MECANIQUE',
                            MODELISATION='3D',),);
# DEFINITION DU MATERIAU UTILISE POUR LE CALCUL THERMOMECANIQUE
#


ACIER_TH = DEFI_MATERIAU ( ELAS =_F( E = 204000.E+6,
                                  NU = 0.3,
                                 ALPHA = 10.92E-6 ),
                        THER =_F(RHO_CP = 3.71E+6,
                                 LAMBDA = 54.6 )
                       );

CHM=AFFE_MATERIAU(MAILLAGE=MAIL,
                  AFFE=_F(TOUT='OUI',
                          MATER=ACIER_TH,
                          TEMP_REF=20.0,),);
# DEFINITION DES CONDITIONS AUX LIMITES THERMIQUES
#    TEMPERATURE IMPOSEE SUR LA FACE INTERNE DU TUBE 
#     ET ECHANGE NUL SUR LA FACE EXTERNE DU TUBE
#     CALCUL DU TRANSITOIRE THERMIQUE
#
#

F_TEMP=DEFI_FONCTION(NOM_PARA='INST',
                     VALE=(0.0,20.0,10.0,70.0),
                     PROL_DROITE='CONSTANT',
                     PROL_GAUCHE='CONSTANT',);

H=DEFI_CONSTANTE(VALE=0.0,);

T_EXT=DEFI_CONSTANTE(VALE=20.0,);

CHTH=AFFE_CHAR_THER_F(MODELE=MODETH,
                      TEMP_IMPO=_F(GROUP_NO=('GM10004'),
                                   TEMP=F_TEMP,),
                      ECHANGE=_F(GROUP_MA=('GM10003'),
                                 COEF_H=H,
                                 TEMP_EXT=T_EXT,),);

INST=DEFI_LIST_REEL(VALE=(5.0,10.0),);

TEMPE=THER_LINEAIRE(MODELE=MODETH,
                    CHAM_MATER=CHM,
                    EXCIT=_F(CHARGE=CHTH,),
                    INCREMENT=_F(LIST_INST=INST,),
                    TEMP_INIT=_F(VALE=20.0,),);
# DEFINITION DES CONDITIONS AUX LIMITES  CALCUL THERMO-MECANIQUE
#    ENCASTREMENT SUR LA SECTION ENCAST ET EFOND
#    SYMETRIE PAR RAPPORT AU PLAN XOY
#    CHARGEMENT THERMIQUE
#
#


CHARGT=AFFE_CHAR_MECA(MODELE=MODMECA,
                      TEMP_CALCULEE=TEMPE,
                      DDL_IMPO=(_F(GROUP_NO=('GM10001','GM10005'),
                                   DX=0.0,
                                   DY=0.0,
                                   DZ=0.0,),
                                _F(GROUP_NO='GM10002',
                                   DZ=0.0,),),);
# CALCUL THERMO-MECANIQUE ET EXTRACTION DE RESULTATS
#    
#


RESUT=MECA_STATIQUE(MODELE=MODMECA,
                    CHAM_MATER=CHM,
                    EXCIT=_F(CHARGE=CHARGT,),
                    LIST_INST=INST,
                    OPTION=('SIGM_ELNO_DEPL',),);

RESUT=CALC_ELEM(reuse =RESUT,
                MODELE=MODMECA,
                CHAM_MATER=CHM,
                OPTION='EQUI_ELNO_SIGM',
                RESULTAT=RESUT,);


# ON TESTE LA NON-REGRESSION
TEST_RESU(RESU=(_F(RESULTAT=TEMPE,
                   INST=10.0,
                   NOM_CHAM='TEMP',
                   TYPE_TEST='MAX',
                   VALE=7.0E+1,
                   REFERENCE='NON_REGRESSION',
                   VERSION='6.01.16',),
                _F(RESULTAT=RESUT,
                   INST=10.0,
                   NOM_CHAM='EQUI_ELNO_SIGM',
                   TYPE_TEST='MAX',
                   VALE=2.3603066735243E+08,
                   REFERENCE='NON_REGRESSION',
                   VERSION='6.01.16',),),);

# ON TESTE PAR RAPPORT A UNE SOLUTION ASTER QUADRATIQUE 
# ALORS QUE LA, ON EST LINEAIRE
TEST_RESU(RESU=(_F(RESULTAT=TEMPE,
                   INST=10.0,
                   NOM_CHAM='TEMP',
                   TYPE_TEST='MAX',
                   VALE=7.0E+1,
                   REFERENCE='AUTRE_ASTER',),
                _F(RESULTAT=RESUT,
                   NUME_ORDRE=2,   # A REMPLACER A TERME PAR INST=10.0
                   NOM_CHAM='EQUI_ELNO_SIGM',
                   TYPE_TEST='MAX',
                   VALE=1.2383423653872E8,
                   PRECISION=9.1E-1,
                   REFERENCE='AUTRE_ASTER',),),);


# ORIENTATION DES NORMALES AUX COQUES 
# RENTRANTES DANS LE TUYAU
MAIL=MODI_MAILLAGE(reuse =MAIL,
                   MAILLAGE=MAIL,
                   ORIE_PEAU_3D=(_F(GROUP_MA='GM10004',),
                                 _F(GROUP_MA='GM10005',),),
                   MODELE=MODMECA,);
FYTOT = 100000.0;

EPTUB = 0.02;

REXT = 0.2;


RINT=DEFI_VALEUR(R8=EVAL("""REXT-EPTUB"""),);

SINT=DEFI_VALEUR(R8=EVAL("""PI*(RINT*RINT)"""),);

SEXT=DEFI_VALEUR(R8=EVAL("""PI*(REXT*REXT)"""),);

SFON=DEFI_VALEUR(R8=EVAL("""SEXT-SINT"""),);

FYREP=DEFI_VALEUR(R8=EVAL("""FYTOT/SFON"""),);

CHARG1=AFFE_CHAR_MECA(MODELE=MODMECA,
                      DDL_IMPO=(_F(GROUP_MA='GM10001',
                                   DX=0.0,
                                   DY=0.0,
                                   DZ=0.0,),
                                _F(GROUP_MA='GM10002',
                                   DZ=0.0,),),
                      FORCE_FACE=_F(GROUP_MA='GM10005',
                                    FY=FYREP,),);

ACIER=DEFI_MATERIAU(ELAS=_F(E=2.04000000000E11,
                            NU=0.29999999999999999,),);

CHMAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                    AFFE=_F(TOUT='OUI',
                            MATER=ACIER,),);

RESU1=MECA_STATIQUE(MODELE=MODMECA,
                    CHAM_MATER=CHMAT,
                    EXCIT=_F(CHARGE=CHARG1,),
                    OPTION='SIGM_ELNO_DEPL',);
PRES = 15000000.0;

CHARG2=AFFE_CHAR_MECA(MODELE=MODMECA,
                      DDL_IMPO=(_F(GROUP_MA='GM10001',
                                   DX=0.0,
                                   DY=0.0,
                                   DZ=0.0,),
                                _F(GROUP_MA='GM10002',
                                   DZ=0.0,),),
                      PRES_REP=_F(GROUP_MA='GM10004',
                                  PRES=PRES,),);

RESU2=MECA_STATIQUE(MODELE=MODMECA,
                    CHAM_MATER=CHMAT,
                    EXCIT=_F(CHARGE=CHARG2,),
                    OPTION='SIGM_ELNO_DEPL',);

TABDEP1=POST_RELEVE_T(ACTION=_F(INTITULE='DEPB1',
                                GROUP_NO='GM10005',
                                RESULTAT=RESU1,
                                NOM_CHAM='DEPL',
                                TOUT_CMP='OUI',
                                OPERATION='MOYENNE',),);

TABDEP2=POST_RELEVE_T(ACTION=_F(INTITULE='DEPB2',
                                GROUP_NO='GM10005',
                                RESULTAT=RESU2,
                                NOM_CHAM='DEPL',
                                TOUT_CMP='OUI',
                                OPERATION='MOYENNE',),);

IMPR_TABLE(TABLE=TABDEP1,);

IMPR_TABLE(TABLE=TABDEP2,);

# ON TESTE LA NON-REGRESSION
TEST_TABLE(TABLE=TABDEP1,
           FILTRE=_F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),
           NOM_PARA='DX',
           VALE=-2.6549141957878E-02,
           PRECISION=1.E-4,
           VERSION='6.01.16',
           REFERENCE='NON_REGRESSION',);

TEST_TABLE(TABLE=TABDEP1,
           FILTRE=_F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),
           NOM_PARA='DY',
           VALE=7.3125995314675E-02,
           PRECISION=1.E-4,
           VERSION='6.01.16',
           REFERENCE='NON_REGRESSION',);

TEST_TABLE(TABLE=TABDEP2,
           FILTRE=_F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),
           NOM_PARA='DX',
           VALE=-2.6230986120822E-01,
           PRECISION=1.E-4,
           VERSION='6.01.16',
           REFERENCE='NON_REGRESSION',);

TEST_TABLE(TABLE=TABDEP2,
           FILTRE=_F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),
           NOM_PARA='DY',
           VALE=3.9673323795615E-01,
           PRECISION=1.E-4,
           VERSION='6.01.16',
           REFERENCE='NON_REGRESSION',);


# ON TESTE UNE SOLUTION ASTER QUADRATIQUE 
# ALORS QUE LA, ON EST LINEAIRE
TEST_TABLE(TABLE=TABDEP1,
           FILTRE=_F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),
           NOM_PARA='DX',
           VALE=-0.0290667935107,
           PRECISION=8.7E-2,
           REFERENCE='AUTRE_ASTER',);

TEST_TABLE(TABLE=TABDEP1,
           FILTRE=_F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),
           NOM_PARA='DY',
           VALE=0.106543262917,
           PRECISION=32.E-2,
           REFERENCE='AUTRE_ASTER',);

TEST_TABLE(TABLE=TABDEP2,
           FILTRE=_F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),
           NOM_PARA='DX',
           VALE=-0.276345088914,
           PRECISION=5.1E-2,
           REFERENCE='AUTRE_ASTER',);

TEST_TABLE(TABLE=TABDEP2,
           FILTRE=_F(NOM_PARA='QUANTITE',
                     VALE_K='MOMENT_0',),
           NOM_PARA='DY',
           VALE=0.447257076911,
           PRECISION=11.3E-2,
           REFERENCE='AUTRE_ASTER',);

                    

IMPR_RESU(MODELE=MODMECA,
          RESU=( 
                 _F(
###                    RESULTAT=RESUT,NOM_CHAM='SIGM_ELNO_DEPL',
                   RESULTAT=RESUT,NOM_CHAM='SIEF_ELGA_DEPL',
                   NOM_CMP='SIXX',
                   INST=10.,
                   ),
                   ),);

                

IMPR_RESU(MODELE=MODMECA,
          RESU=( 
                 _F(FORMAT='GMSH',FICHIER='IDEAS',
###                    RESULTAT=RESUT,NOM_CHAM='SIGM_ELNO_DEPL',
                   RESULTAT=RESUT,NOM_CHAM='SIEF_ELGA_DEPL',
                   INST=10.,
                   NOM_CMP='SIXX',
                   ),
                   ),);

IMPR_RESU(MODELE=MODMECA,
          RESU=( 
                 _F(FORMAT='GMSH',FICHIER='IDEAS',
                   MAILLAGE=MAIL),
                   ),);

FIN()

