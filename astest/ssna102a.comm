# MODIF  DATE 09/05/2005   AUTEUR REZETTE C.REZETTE 
#
# TITRE CONTACT MULTICORPS ELASTIQUES
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
# (AT YOUR OPTION) ANY LATER VERSION.                                 
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
# ======================================================================
#
# REFERENCE : CALCULS AVEC ABAQUS, SYSTUS, SAMCEF 
#
#########################################


DEBUT(  CODE=_F( NOM = 'SSNA102A',NIV_PUB_WEB='INTERNET'))

# --------------------------------------------------------------------
#       LECTURE DU MAILLAGE ET CREATION DE GROUPES DE NOEUDS
# --------------------------------------------------------------------


PRE_GIBI()

MAIL=LIRE_MAILLAGE( )

#

MAIL=DEFI_GROUP( reuse=MAIL,  MAILLAGE=MAIL,CREA_GROUP_NO=(
# GROUPES DE NOEUDS POUR LES DEGRES DE LIBERTE IMPOSES
                        _F(  GROUP_MA = 'LCD1'),
                        _F(  GROUP_MA = 'LBC4'),
# GROUPES DE NOEUDS POUR LES CONDITIONS DE CONTACT
                        _F(  GROUP_MA = 'LAB1'),
                        _F(  GROUP_MA = 'CEP2'),
                        _F(  GROUP_MA = 'CME2'),
                        _F(  GROUP_MA = 'CEP3'),
                        _F(  GROUP_MA = 'CME3'),
                        _F(  GROUP_MA = 'LCD4'),
                        _F(  GROUP_MA = 'LCD4I'),
# LCD4P EST LCD4 SAUF NOEUD PC4 ENCASTRE (POUR LE POST-TRAITEMENT)
                        _F(  NOM = 'LCD4P',
                                        DIFFE = ('LCD4I', 'PC4',)))
                     )

#
# --------------------------------------------------------------------
#                   MODELISATION 2D AXISYMETRIQUE
# --------------------------------------------------------------------
#

MOD=AFFE_MODELE( 
                       MAILLAGE=MAIL,
                       AFFE=_F(  TOUT = 'OUI',
                              PHENOMENE = 'MECANIQUE',
                              MODELISATION = 'AXIS')
                    )

#
# --------------------------------------------------------------------
#         DEFINITION ET AFFECTATION D'UN MATERIAU ELASTIQUE
# --------------------------------------------------------------------
#

ELAS=DEFI_MATERIAU( 
                          ELAS=_F(  E = 200000.,
                                 NU = 0.3)
                       )

#

CHMAT=AFFE_MATERIAU( 
                           MAILLAGE=MAIL,
                           AFFE=_F(  TOUT = 'OUI',
                                  MATER = ELAS)
                        )

#
# --------------------------------------------------------------------
#                   ENCASTREMENT DE LA LIGNE LBC4
# --------------------------------------------------------------------
#

BLOQ=AFFE_CHAR_MECA( 
                           MODELE=MOD,
                              DDL_IMPO=_F(  GROUP_NO = 'LBC4',
                                         DX = 0.0,  DY = 0.0)
                        )

#
# --------------------------------------------------------------------
#               DEPLACEMENT IMPOSE SUR LA LIGNE LCD1
# --------------------------------------------------------------------
#

DEPL=AFFE_CHAR_MECA( 
                           MODELE=MOD,
                              DDL_IMPO=_F(  GROUP_NO = 'LCD1',
                                                  DY = -2.0)
                       )

#
# --------------------------------------------------------------------
#     SUPPRESSION DES MOUVEMENTS DE CORPS RIGIDE DES DEUX SPHERES
# --------------------------------------------------------------------
#

LIAI=AFFE_CHAR_MECA( 
                           MODELE=MOD,LIAISON_DDL=(
                           _F(  GROUP_NO = ('PA1',  'PP2', ),
                                         DDL = ('DY', 'DY',),
                                         COEF_MULT = (1., -1.,),
                                         COEF_IMPO = 0.),
                           _F(  GROUP_NO = ('PM3',  'PD4', ),
                                         DDL = ('DY', 'DY',),
                                         COEF_MULT = (1., -1.,),
                                         COEF_IMPO = 0.))
                       )

#
# --------------------------------------------------------------------
#      CONTACT UNILATERAL : FORMULATION MAITRE-ESCLAVE (3 ZONES)
# --------------------------------------------------------------------
#

CONTSY=AFFE_CHAR_MECA( 
                           MODELE=MOD,CONTACT=(
                               _F(  GROUP_MA_MAIT = 'LAB1',
                                         GROUP_MA_ESCL = 'CEP2',
STOP_SINGULIER='NON',

                                         SANS_GROUP_NO = ('PA1', 'PP2',),
                                         REAC_GEOM = 'CONTROLE',
                                         NB_REAC_GEOM=2,
                                         APPARIEMENT = 'MAIT_ESCL_SYME',
                                         RECHERCHE = 'NOEUD_BOUCLE'),
                               _F(  GROUP_MA_MAIT = 'CME2',
                                         GROUP_MA_ESCL = 'CEP3',
STOP_SINGULIER='NON',
                                         REAC_GEOM = 'CONTROLE',
                                         NB_REAC_GEOM=2,
                                         APPARIEMENT = 'MAIT_ESCL_SYME',
                                         RECHERCHE = 'NOEUD_BOUCLE'),
                               _F(  GROUP_MA_MAIT = 'CME3',
STOP_SINGULIER='NON',
                                         GROUP_MA_ESCL = 'LCD4',
                                         REAC_GEOM = 'CONTROLE',
                                         NB_REAC_GEOM=2,
                                         SANS_GROUP_NO = ('PM3', 'PD4',),
                                         APPARIEMENT = 'MAIT_ESCL_SYME',
                                         RECHERCHE = 'NOEUD_BOUCLE')),
                           INFO=2
                       )
CONT=AFFE_CHAR_MECA( 
                           MODELE=MOD,CONTACT=(
                               _F(  GROUP_MA_MAIT = 'LAB1',
                                         GROUP_MA_ESCL = 'CEP2',
                                         SANS_GROUP_NO = ('PA1', 'PP2',),
                                         REAC_GEOM = 'AUTOMATIQUE',
                                         APPARIEMENT = 'MAIT_ESCL',
                                         RECHERCHE = 'NOEUD_BOUCLE'),
                               _F(  GROUP_MA_MAIT = 'CME2',
                                         GROUP_MA_ESCL = 'CEP3',
                                         REAC_GEOM = 'AUTOMATIQUE',
                                         APPARIEMENT = 'MAIT_ESCL',
                                         RECHERCHE = 'NOEUD_BOUCLE'),
                               _F(  GROUP_MA_MAIT = 'CME3',
                                         GROUP_MA_ESCL = 'LCD4',
                                         REAC_GEOM = 'AUTOMATIQUE',
                                         SANS_GROUP_NO = ('PM3', 'PD4',),
                                         APPARIEMENT = 'MAIT_ESCL',
                                         RECHERCHE = 'NOEUD_BOUCLE')),
                           INFO=1
                       )

#
# --------------------------------------------------------------------
#         DECOUPAGE EN INCREMENTS DE CHARGE (1 EN ELASTICITE)
#         ET RAMPE MULTIPLICATRICE POUR LE DEPLACEMENT IMPOSE
# --------------------------------------------------------------------
#

FONC=DEFI_FONCTION( 
                           NOM_PARA='INST',
                           VALE=( 0.,   0.0,
                                  1.,   1.0, )
                        )

#

LINST=DEFI_LIST_REEL( 
                            DEBUT=0.0,
                            INTERVALLE=_F(  JUSQU_A = 1.,  NOMBRE = 1)
                         )

#
# --------------------------------------------------------------------
#                            CALCUL NON LINEAIRE
# --------------------------------------------------------------------
#

RESU=STAT_NON_LINE( 
                          MODELE=MOD,
                          CHAM_MATER=CHMAT,EXCIT=(
                          _F(  CHARGE = BLOQ),
                                _F(  CHARGE = DEPL,   FONC_MULT = FONC),
                                _F(  CHARGE = LIAI),
                                _F(  CHARGE = CONT)),
                          COMP_ELAS=_F(  RELATION = 'ELAS'),
                          NEWTON=_F(  MATRICE = 'ELASTIQUE'),
                          INCREMENT=_F(  LIST_INST = LINST),
                          CONVERGENCE=_F( 
                                        RESI_GLOB_MAXI = 1.E-6,
                                        ITER_GLOB_MAXI = 50,
                                        ARRET = 'OUI'),
                          INFO=1
                       )

#
# --------------------------------------------------------------------
#                    CALCUL DES CONTRAINTES AUX NOEUDS
# --------------------------------------------------------------------
#  

RESU=CALC_ELEM( reuse=RESU,  RESULTAT=RESU,
                       OPTION='SIEF_ELNO_ELGA',
                  )

RESU=CALC_NO( reuse=RESU,  RESULTAT=RESU,  
                     OPTION='SIEF_NOEU_ELGA'
                  )

#
# --------------------------------------------------------------------
#          CALCUL DES FORCES NODALES ET DES REACTIONS NODALES
# --------------------------------------------------------------------
#


RESU=CALC_NO( reuse=RESU,  RESULTAT=RESU,  EXCIT=(
                     _F(  CHARGE = BLOQ),
                           _F(  CHARGE = DEPL,
                             FONC_MULT = FONC),
                           _F(  CHARGE = LIAI),
                           _F(  CHARGE = CONT)),
                     OPTION='REAC_NODA'
                  )

#
# --------------------------------------------------------------------
#             IMPRESSIONS AU FORMAT CASTEM ET ENSIGHT
#       IMPRESSION AU FORMAT LISTING DU DEPLACEMENT DU POINT PA4
# --------------------------------------------------------------------
#                COMPARAISON SOURCE EXTRENE
# --------------------------------------------------------------------

TEST_RESU(
            RESU=_F( 
                  RESULTAT = RESU,
                  NUME_ORDRE = 1,
                  REFERENCE = 'SOURCE_EXTERNE',
                  NOM_CHAM = 'DEPL',
                  GROUP_NO = 'PA4',
                  NOM_CMP = 'DY',
                  VALE = -0.81,
                  PRECISION = 4.0E-2,
                  CRITERE = 'RELATIF')
           )

# --------------------------------------------------------------------
#                NON REGRESSION
# --------------------------------------------------------------------

TEST_RESU(
            RESU=_F( 
                  RESULTAT = RESU,
                  NUME_ORDRE = 1,
                  REFERENCE = 'NON_REGRESSION',
                  VERSION   = '6.2.8',
                  NOM_CHAM = 'DEPL',
                  GROUP_NO = 'PA4',
                  NOM_CMP = 'DY',
                  VALE = -8.4052577528286E-01,
                  PRECISION = 1.0E-10,
                  CRITERE = 'RELATIF')
           )

#
# --------------------------------------------------------------------
#                CALCUL DE LA REACTION A L'ENCASTREMENT
# --------------------------------------------------------------------
#                COMPARAISON SOURCE EXTRENE
# --------------------------------------------------------------------


REACENC=POST_RELEVE_T( 
                 ACTION=_F(  RESULTAT = RESU,
                          INST = 1.,
                          INTITULE = 'ENCASTREMENT',
                          NOM_CHAM = 'REAC_NODA',
                          REPERE = 'GLOBAL',
                          OPERATION = 'EXTRACTION',
                          GROUP_NO = 'LBC4',
                          RESULTANTE = ('DX', 'DY',))
              )

#

TEST_TABLE(    TABLE=REACENC,
               NOM_PARA='DY',
               REFERENCE='SOURCE_EXTERNE',
               VALE=17229.58,          
               PRECISION=1.5E-2,
               CRITERE='RELATIF' )

# --------------------------------------------------------------------
#                NON REGRESSION
# --------------------------------------------------------------------

TEST_TABLE(     TABLE=REACENC,
                NOM_PARA='DY',
                REFERENCE='NON_REGRESSION',
                VERSION = '6.2.8',
                VALE=1.7475291318274E+04,          
                PRECISION=1.E-10,
                CRITERE='RELATIF' )

RESU2=STAT_NON_LINE( 
                          MODELE=MOD,
                          CHAM_MATER=CHMAT,EXCIT=(
                          _F(  CHARGE = BLOQ),
                                _F(  CHARGE = DEPL,   FONC_MULT = FONC),
                                _F(  CHARGE = LIAI),
                                _F(  CHARGE = CONTSY)),
                          COMP_ELAS=_F(  RELATION = 'ELAS'),
                          NEWTON=_F(  MATRICE = 'ELASTIQUE'),
                          INCREMENT=_F(  LIST_INST = LINST),
                          CONVERGENCE=_F( 
                                        RESI_GLOB_MAXI = 1.E-6,
                                        ITER_GLOB_MAXI = 50,
                                        ARRET = 'OUI'),
                          INFO=1
                       )

#
# --------------------------------------------------------------------
#                    CALCUL DES CONTRAINTES AUX NOEUDS
# --------------------------------------------------------------------
#  

RESU2=CALC_ELEM( reuse=RESU2,  RESULTAT=RESU2,
                       OPTION='SIEF_ELNO_ELGA',
                  )

RESU2=CALC_NO( reuse=RESU2,  RESULTAT=RESU2,  
                     OPTION='SIEF_NOEU_ELGA'
                  )

#
# --------------------------------------------------------------------
#          CALCUL DES FORCES NODALES ET DES REACTIONS NODALES
# --------------------------------------------------------------------
#


RESU2=CALC_NO( reuse=RESU2,  RESULTAT=RESU2,  EXCIT=(
                     _F(  CHARGE = BLOQ),
                           _F(  CHARGE = DEPL,
                             FONC_MULT = FONC),
                           _F(  CHARGE = LIAI),
                           _F(  CHARGE = CONTSY)),
                     OPTION='REAC_NODA'
                  )

#
# --------------------------------------------------------------------
#             IMPRESSIONS AU FORMAT CASTEM ET ENSIGHT
#       IMPRESSION AU FORMAT LISTING DU DEPLACEMENT DU POINT PA4
# --------------------------------------------------------------------
#                COMPARAISON SOURCE EXTRENE
# --------------------------------------------------------------------

TEST_RESU(
            RESU=_F( 
                  RESULTAT = RESU2,
                  NUME_ORDRE = 1,
                  REFERENCE = 'SOURCE_EXTERNE',
                  NOM_CHAM = 'DEPL',
                  GROUP_NO = 'PA4',
                  NOM_CMP = 'DY',
                  VALE = -0.81,
                  PRECISION = 4.0E-2,
                  CRITERE = 'RELATIF')
           )

# --------------------------------------------------------------------
#                NON REGRESSION
# --------------------------------------------------------------------

TEST_RESU(
            RESU=_F( 
                  RESULTAT = RESU2,
                  NUME_ORDRE = 1,
                  REFERENCE = 'NON_REGRESSION',
                  VERSION   = '7.3.23',
                  NOM_CHAM = 'DEPL',
                  GROUP_NO = 'PA4',
                  NOM_CMP = 'DY',
                  VALE = -8.4121016905018E-01,
                  PRECISION = 1.0E-10,
                  CRITERE = 'RELATIF')
           )

#
# --------------------------------------------------------------------
#                CALCUL DE LA REACTION A L'ENCASTREMENT
# --------------------------------------------------------------------
#                COMPARAISON SOURCE EXTRENE
# --------------------------------------------------------------------


REACEN2=POST_RELEVE_T( 
                 ACTION=_F(  RESULTAT = RESU2,
                          INST = 1.,
                          INTITULE = 'ENCASTREMENT',
                          NOM_CHAM = 'REAC_NODA',
                          REPERE = 'GLOBAL',
                          OPERATION = 'EXTRACTION',
                          GROUP_NO = 'LBC4',
                          RESULTANTE = ('DX', 'DY',))
              )

#

TEST_TABLE(    TABLE=REACEN2,
               NOM_PARA='DY',
               REFERENCE='SOURCE_EXTERNE',
               VALE=17229.58,          
               PRECISION=1.6E-2,
               CRITERE='RELATIF' )

# --------------------------------------------------------------------
#                NON REGRESSION
# --------------------------------------------------------------------

TEST_TABLE(     TABLE=REACEN2,
                NOM_PARA='DY',
                REFERENCE='NON_REGRESSION',
                VERSION = '7.3.23',
                VALE=1.7492307043099E+04,          
                PRECISION=1.E-10,
                CRITERE='RELATIF' )


DEFI_FICHIER(ACTION='ASSOCIER',
UNITE=37,)

IMPR_RESU(RESU=_F(
                  RESULTAT=RESU,
                  NOM_CHAM='DEPL',
                  ),
          UNITE=37,
          FORMAT='GMSH',
          VERSION=1.2,
          
          
);




FIN()
#
