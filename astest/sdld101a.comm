# TITRE OSCILLATEUR SIMPLE SOUMIS A UNE EXCITATION ALEATOIRE
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#*********************************************************************#
DEBUT( CODE=_F( NOM = 'SDLD101A',NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

#*********************************************************************#
# *****LECTURE DU MAILLAGE********************************************#
#*********************************************************************#
MA1=LIRE_MAILLAGE( )

#*********************************************************************#
# *****AFFECTATION D ELEMENTS SUR LES MAILLES*************************#
#*********************************************************************#
MO1=AFFE_MODELE(  MAILLAGE=MA1,AFFE=(
       _F(                TOUT = 'OUI',
                            PHENOMENE = 'MECANIQUE',
                            MODELISATION = 'DIS_T'),
       _F(                NOEUD = ('P1', 'P2'),
                            PHENOMENE = 'MECANIQUE',
                            MODELISATION = 'DIS_T')))

#*********************************************************************#
# *****CARACTERISTIQUES DES ELEMENTS DE POUTRE ET DE MASSE************#
#*********************************************************************#
CARELEM1=AFFE_CARA_ELEM(   MODELE=MO1,DISCRET=(
     _F(  NOEUD = ('P1', 'P2'),
               CARA = 'M_T_D_N',
               VALE = (100.)),
     _F(  NOEUD = ('P1', 'P2'),
               CARA = 'K_T_D_N',
               VALE = (0.,0.,0.)),
     _F(  MAILLE = ('M1'),
               CARA = 'K_T_D_L',
               VALE = (1000000., 0., 0.)))
                         )

#*********************************************************************#
# *****CONDITIONS AUX LIMITES*****************************************#
#*********************************************************************#
CHARGE1=AFFE_CHAR_MECA(
             MODELE=MO1,DDL_IMPO=(
            _F( TOUT = 'OUI',
                     DZ = 0.0,
                     DY = 0.0),
            _F( NOEUD = ('P1'),
                     DX = 0.0))
                                 )

#*********************************************************************#
# *****MATRICES ELEMENTAIRES ET ASSEMBLAGE****************************#
#*********************************************************************#
MELR1=CALC_MATR_ELEM(  MODELE=MO1,
                        CHARGE=CHARGE1,
                       OPTION='RIGI_MECA',
                        CARA_ELEM=CARELEM1  )

MELM1=CALC_MATR_ELEM(  MODELE=MO1,
                        CHARGE=CHARGE1,
                       OPTION='MASS_MECA',
                        CARA_ELEM=CARELEM1  )

#
NUM1=NUME_DDL(  MATR_RIGI=MELR1 )

MATASSR1=ASSE_MATRICE(MATR_ELEM=MELR1,NUME_DDL=NUM1)

MATASSM1=ASSE_MATRICE(MATR_ELEM=MELM1,NUME_DDL=NUM1)

#*********************************************************************#
# *****CALCUL DE MODES PROPRES ET IMPRESSION FORMAT IDEAS*************#
#*********************************************************************#

FREQ1=MODE_ITER_INV(   MATR_RIGI=MATASSR1,      MATR_MASS=MATASSM1,
           CALC_FREQ=_F(  OPTION = 'AJUSTE',
                       FREQ = (0.1, 3000.0),
                       NMAX_FREQ = 1),
            CALC_MODE=_F( NMAX_ITER = 30)
                       )

#*********************************************************************#
# *****CALCUL DE MODES STATIQUES; IMPRESSION FORMAT IDEAS*************#
#*********************************************************************#
MODESTA1=MODE_STATIQUE( MATR_RIGI=MATASSR1,SOLVEUR=_F(METHODE='MUMPS'),
                        MATR_MASS=MATASSM1,
                        MODE_STAT=_F(  NOEUD = 'P1',
                                    AVEC_CMP = 'DX')
                      )

#*********************************************************************#
# *****LECTURE DE L INTERSPECTRE EXCITATION***************************#
#*********************************************************************#
INTEREXC=DEFI_INTE_SPEC(    DIMENSION=1,
                            CONSTANT=_F(  NUME_ORDRE_I = 1,
                                       NUME_ORDRE_J = 1,
                                       FREQ_MIN = 0.,
                                       FREQ_MAX = 100.,
                                       PAS = 1.,
                                       PROL_GAUCHE = 'CONSTANT',
                                       PROL_DROITE = 'CONSTANT',
                                       INTERPOL = 'LIN',
                                       VALE_C = ('RI',1.,0.))
                         )

#
#*********************************************************************#
# *****CALCUL D INTERSPECTRE REPONSE: ACCE --> ACCE *****************#
# *****                               MVT ABSOLU    *****************#
#*********************************************************************#

DYNALEA1=DYNA_ALEA_MODAL(
          BASE_MODALE=_F(
             MODE_MECA = FREQ1,
             NUME_ORDRE = 1,
             AMOR_REDUIT = 0.05),
         MODE_STAT=MODESTA1,
           EXCIT=_F(
             DERIVATION = 2,
             INTE_SPEC = INTEREXC,
             NUME_ORDRE_I = 1,
             NUME_ORDRE_J = 1,
             NOEUD = 'P1',
             NOM_CMP = 'DX'),
              REPONSE=_F(
             DERIVATION = 2)
                      )

INTERRE1=REST_SPEC_PHYS(         MODE_MECA=FREQ1,
                                    NUME_ORDRE=1,
                                INTE_SPEC_GENE=DYNALEA1,
                                     MODE_STAT=MODESTA1,
                                 EXCIT=_F(   NOEUD = 'P1',
                                          NOM_CMP = 'DX'),
                                     MOUVEMENT='ABSOLU',
                                         NOEUD='P2',
                                      NOM_CHAM='ACCE',
                                       NOM_CMP='DX',
                                        OPTION='TOUT_TOUT'  )

DYNALEA2=DYNA_ALEA_MODAL(
          BASE_MODALE=_F(
             MODE_MECA = FREQ1,
             NUME_ORDRE = 1,
             AMOR_REDUIT = 0.05),
         MODE_STAT=MODESTA1,
           EXCIT=_F(
             DERIVATION = 2,
             INTE_SPEC = INTEREXC,
             NUME_ORDRE_I = 1,
             NUME_ORDRE_J = 1,
             NOEUD = 'P1',
             NOM_CMP = 'DX'),
              REPONSE=_F(
             DERIVATION = 2,
             FREQ_MIN = 0.,
             FREQ_MAX = 30.,
             PAS = 5.)
                      )

INTER1=REST_SPEC_PHYS(         MODE_MECA=FREQ1,
                                  NUME_ORDRE=1,
                              INTE_SPEC_GENE=DYNALEA2,
                                   MODE_STAT=MODESTA1,
                               EXCIT=_F(   NOEUD = 'P1',
                                        NOM_CMP = 'DX'),
                                   MOUVEMENT='ABSOLU',
                                    NOM_CHAM='ACCE',
                                       NOEUD=( 'P1',   'P2'),
                                     NOM_CMP=('DX', 'DX'),
                                      OPTION='TOUT_TOUT'   )

INTER2=REST_SPEC_PHYS(         MODE_MECA=FREQ1,
                                  NUME_ORDRE=1,
                              INTE_SPEC_GENE=DYNALEA2,
                                   MODE_STAT=MODESTA1,
                               EXCIT=_F(   NOEUD = 'P1',
                                        NOM_CMP = 'DX'),
                                   MOUVEMENT='RELATIF',
                                    NOM_CHAM='ACCE',
                                       NOEUD=( 'P1',   'P2'),
                                     NOM_CMP=('DX', 'DX'),
                                      OPTION='TOUT_TOUT'   )

INTER3=REST_SPEC_PHYS(         MODE_MECA=FREQ1,
                                  NUME_ORDRE=1,
                              INTE_SPEC_GENE=DYNALEA2,
                                   MODE_STAT=MODESTA1,
                               EXCIT=_F(   NOEUD = 'P1',
                                        NOM_CMP = 'DX'),
                                   MOUVEMENT='DIFFERENTIEL',
                                    NOM_CHAM='ACCE',
                                       NOEUD=( 'P1',   'P2'),
                                     NOM_CMP=('DX', 'DX'),
                                      OPTION='TOUT_TOUT'   )

REP1=RECU_FONCTION(    INTE_SPEC=INTER1,
                            NOEUD_I = 'P2',
                            NOM_CMP_I = 'DX',
                      )

REP2=RECU_FONCTION(    INTE_SPEC=INTER2,
                            NOEUD_I = 'P2',
                            NOM_CMP_I = 'DX',
                      )

REP3=RECU_FONCTION(    INTE_SPEC=INTER3,
                            NOEUD_I = 'P2',
                            NOM_CMP_I = 'DX',
                      )

TEST_FONCTION(VALEUR=_F(VALE_CALC=1.230718,
                        VALE_REFE=1.2306999999999999,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=5.0,
                        FONCTION=REP1,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=2.711657,
                        VALE_REFE=2.7115999999999998,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=10.0,
                        FONCTION=REP1,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=47.21578,
                        VALE_REFE=47.215400000000002,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=15.0,
                        FONCTION=REP1,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=2.892421,
                        VALE_REFE=2.8923999999999999,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=20.0,
                        FONCTION=REP1,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=0.47047853,
                        VALE_REFE=0.47047,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=25.0,
                        FONCTION=REP1,),
              )

#*********************************************************************#
TEST_FONCTION(VALEUR=_F(VALE_CALC=0.01197649,
                        VALE_REFE=0.011976000000000001,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=5.0,
                        FONCTION=REP2,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=0.42096223,
                        VALE_REFE=0.42096,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=10.0,
                        FONCTION=REP2,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=36.92589,
                        VALE_REFE=36.922499999999999,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=15.0,
                        FONCTION=REP2,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=7.100623,
                        VALE_REFE=7.1006,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=20.0,
                        FONCTION=REP2,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=2.795333,
                        VALE_REFE=2.7953000000000001,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=25.0,
                        FONCTION=REP2,),
              )

#*********************************************************************#
TEST_FONCTION(VALEUR=_F(VALE_CALC=1.000,
                        VALE_REFE=1.0,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=5.0,
                        FONCTION=REP3,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=1.000,
                        VALE_REFE=1.0,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=10.0,
                        FONCTION=REP3,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=1.000,
                        VALE_REFE=1.0,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=15.0,
                        FONCTION=REP3,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=1.000,
                        VALE_REFE=1.0,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=20.0,
                        FONCTION=REP3,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=1.000,
                        VALE_REFE=1.0,
                        REFERENCE = 'ANALYTIQUE',
                        PRECISION=1.E-3,
                        VALE_PARA=25.0,
                        FONCTION=REP3,),
              )

#
#*****************************************************#
#*****************************************************#
#*****************************************************#
#*****************************************************#
#    POST-TRAITEMENT                                  #
#  REPARTITION DE PIC SELON LOI NORMALE GAUSS*********#
#  REPARTITION DE PIC SELON RAYLEIGH*      ***********#
#  PROBABILITE DE DEPASSEMENT DE SEUIL      **********#
#  PROBA CUMULEE SELON VANMARCKE             *********#
#*****************************************************#
STADEF=POST_DYNA_ALEA(  INTE_SPEC=INTERRE1,
                        NOEUD_I='P2',
                        NOM_CMP_I='DX',
                        NOEUD_J='P2',
                        NOM_CMP_J='DX',
                        MOMENT=( 6,  7,  10),
                        INFO=2
                      )

TEST_TABLE(
           VALE_CALC=505.87578073776,
           VALE_REFE=505.70832000000001,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='LAMBDA_00',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=49053.607563044,
           VALE_REFE=4.9047800000000003E4,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='LAMBDA_01',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=5.0245598913453E+06,
           VALE_REFE=5.025066E6,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='LAMBDA_02',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=5.5278352232258E+08,
           VALE_REFE=5.52943000E8,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='LAMBDA_03',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=7.203315273698E+10,
           VALE_REFE=7.2046000000E10,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='LAMBDA_04',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=22.491682479036,
           VALE_REFE=22.487959499999999,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='ECART',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=38.112490168437,
           VALE_REFE=38.117660000000001,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='NB_EXTREMA_P_S',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=31.723215183086,
           VALE_REFE=31.730060000000002,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='NB_PASS_ZERO_P_S',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=15.861607591543,
           VALE_REFE=15.865031,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='FREQ_APPAR',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=0.83235745139943,
           VALE_REFE=0.83242413999999998,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='FACT_IRRE',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=4.1865119983101E+15,
           VALE_REFE=4.186992000000000E15,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='LAMBDA_06',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=1.7825975757353E+18,
           VALE_REFE=1.7826555E+18,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='LAMBDA_07',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=2.4687334061992E+26,
           VALE_REFE=2.4687339999999999E+26,
           REFERENCE = 'ANALYTIQUE',
           PRECISION=1.E-3,
           NOM_PARA='LAMBDA_10',
           TABLE=STADEF,
           FILTRE=(_F(NOM_PARA='NOEUD_I',
                      VALE_K='P2',),
                   _F(NOM_PARA='NOEUD_J',
                      VALE_K='P2',),
                   ),
           )

# PAS DE TEST SUR LES FONCTIONS QUI SONT EXPLICITEMENT CALCULEES A
# PARTIR DES VALEURS (MOMENT SPECTRAUX) CALCULEES ET VERIFIEES
FIN( )
#
