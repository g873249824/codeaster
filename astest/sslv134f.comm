# TITRE CALCUL 3D DE G LOCAL FISSURE CIRCULAIRE EN MILIEU INFINI
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# QUART DE FISSURE. CALCUL DE G BILINEAIRE ET DE G_MAX LOCAL

DEBUT(CODE=_F(
              NIV_PUB_WEB='INTERNET',),DEBUG=_F(SDVERI='OUI'));

MA=LIRE_MAILLAGE(FORMAT='MED',);

MA=DEFI_GROUP(reuse =MA,
              MAILLAGE=MA,
              CREA_GROUP_NO=(_F(GROUP_MA='SSUP_S',),
                             _F(GROUP_MA='SAV_S',),
                             _F(GROUP_MA='SLAT_S',),
                             _F(GROUP_MA='LFF',),),);

# Barsoum
MA=MODI_MAILLAGE(reuse=MA,
                MAILLAGE=MA,
                MODI_MAILLE=_F(OPTION='NOEUD_QUART',
                               GROUP_MA_FOND='LFF'))

MO=AFFE_MODELE(MAILLAGE=MA,
               AFFE=_F(TOUT='OUI',
                       PHENOMENE='MECANIQUE',
                       MODELISATION='3D',),);

MAT=DEFI_MATERIAU(ELAS=_F(E=200000000000.0,
                          NU=0.3,),);

CHMAT=AFFE_MATERIAU(MAILLAGE=MA,
                    AFFE=_F(TOUT='OUI',
                            MATER=MAT,),);

F1=DEFI_FONCTION(NOM_PARA='INST',
                 VALE=
                 (0.0,0.0,1.0,1.0,2.0,0.0,3.0,1.0,4.0,1.0,),
                 PROL_DROITE='CONSTANT',
                 PROL_GAUCHE='LINEAIRE',);

F2=DEFI_FONCTION(NOM_PARA='INST',
                 VALE=
                 (0.0,0.0,1.0,0.0,2.0,1.0,3.0,1.0,4.0,-1.0,),
                 PROL_DROITE='CONSTANT',
                 PROL_GAUCHE='LINEAIRE',);

LIST=DEFI_LIST_REEL(DEBUT=0.0,
                    INTERVALLE=_F(JUSQU_A=4.0,
                                  NOMBRE=4,),
                    INFO=1,);
#-----------------------------------------------------------------------

CHCL=AFFE_CHAR_MECA(MODELE=MO,
                    DDL_IMPO=(_F(GROUP_NO='SSUP_S',
                                 DZ=0.0,),
                              _F(GROUP_NO='SLAT_S',
                                 DX=0.0,),
                              _F(GROUP_NO='SAV_S',
                                 DY=0.0,),),);

CH1=AFFE_CHAR_MECA(MODELE=MO,
                   PRES_REP=_F(GROUP_MA='SINF',
                               PRES=-1000000.0,),);

CH2=AFFE_CHAR_MECA(MODELE=MO,
                   FORCE_FACE=(_F(GROUP_MA='SLAT',
                                  FZ=1000000.0,),
                               _F(GROUP_MA='SINF',
                                  FX=1000000.0,),),);
#-----------------------------------------------------------------------

RESU=STAT_NON_LINE(MODELE=MO,
                   CHAM_MATER=CHMAT,
                   EXCIT=(_F(CHARGE=CHCL,),
                          _F(CHARGE=CH1,
                             FONC_MULT=F1,),
                          _F(CHARGE=CH2,
                             FONC_MULT=F2,),),
                   COMPORTEMENT=_F(RELATION='ELAS',),
                   INCREMENT=_F(LIST_INST=LIST,),
                   CONVERGENCE=_F(RESI_GLOB_RELA=1e-06,),
                   INFO=1,);

RESU=CALC_CHAMP(reuse=RESU,RESULTAT=RESU,CONTRAINTE=('SIGM_ELNO'),VARI_INTERNE=('VARI_ELNO'))


FOND=DEFI_FOND_FISS(MAILLAGE=MA,
                    SYME='OUI',
                    FOND_FISS=_F(GROUP_MA='LFF',
                                 DTAN_ORIG=(1.0,0.0,0.0,),),
                   );

GL1=CALC_G(THETA=_F(FOND_FISS=FOND,
                    R_INF=0.1,
                    R_SUP=1.0,),
           RESULTAT=RESU,
           NUME_ORDRE=(1,2,3,4),
           LISSAGE=_F(LISSAGE_THETA='LAGRANGE',
                      LISSAGE_G='LAGRANGE',),
           TITRE='G_LOCAL AVEC R_INF =  1.00000E-01 ET R_SUP =  1.00000E+00',);

GL2=CALC_G(THETA=_F(FOND_FISS=FOND,
                    R_INF=0.5,
                    R_SUP=1.5,),
           RESULTAT=RESU,
           NUME_ORDRE=(1,2,3,4),
           TITRE='G_LOCAL AVEC R_INF =  0.50000E-01 ET R_SUP =  1.50000E+00',);

GLBIL1=CALC_G(THETA=_F(FOND_FISS=FOND,
                       R_INF=0.1,
                       R_SUP=1.0,),
              RESULTAT=RESU,
           NUME_ORDRE=(1,2,3,4),
              LISSAGE=_F(LISSAGE_THETA='LAGRANGE',
                         LISSAGE_G='LAGRANGE',),
              OPTION='G_BILI',
              TITRE='G_LOCAL AVEC R_INF =  1.00000E-01 ET R_SUP =  1.00000E+00',);

GLBIL2=CALC_G(THETA=_F(FOND_FISS=FOND,
                       R_INF=0.5,
                       R_SUP=1.5,),
              RESULTAT=RESU,
           NUME_ORDRE=(1,2,3,4),
              OPTION='G_BILI',
              TITRE='G_LOCAL AVEC R_INF =  5.00000E-01 ET R_SUP =  1.50000E+00',);

GLMAX1=CALC_G(THETA=_F(FOND_FISS=FOND,
                       R_INF=0.1,
                       R_SUP=1.0,),
              RESULTAT=RESU,
           NUME_ORDRE=(1,2,3,4),
              LISSAGE=_F(LISSAGE_THETA='LAGRANGE',
                         LISSAGE_G='LAGRANGE',),
              OPTION='G_MAX',
              BORNES=(
              _F(NUME_ORDRE=1,
                 VALE_MIN=0.0,
                 VALE_MAX=1.0,),
              _F(NUME_ORDRE=2,
                 VALE_MIN=-1.0,
                 VALE_MAX=1.0,),
              _F(NUME_ORDRE=3,
                 VALE_MIN=0.0,
                 VALE_MAX=1.0,),
              _F(NUME_ORDRE=4,
                 VALE_MIN=-1.0,
                 VALE_MAX=1.0,),),
              TITRE='GMAX_LOCAL AVEC R_INF =  1.00000E-01 ET R_SUP =  1.00000E+00',);

GLMAX2=CALC_G(THETA=_F(FOND_FISS=FOND,
                       R_INF=0.5,
                       R_SUP=1.5,),
              RESULTAT=RESU,
           NUME_ORDRE=(1,2,3,4),
              OPTION='G_MAX',
              BORNES=(
              _F(NUME_ORDRE=1,
                 VALE_MIN=0.0,
                 VALE_MAX=1.0,),
              _F(NUME_ORDRE=2,
                 VALE_MIN=-1.0,
                 VALE_MAX=1.0,),
              _F(NUME_ORDRE=3,
                 VALE_MIN=0.0,
                 VALE_MAX=1.0,),
              _F(NUME_ORDRE=4,
                 VALE_MIN=-1.0,
                 VALE_MAX=1.0,),),
              TITRE='GMAX_LOCAL AVEC R_INF =  5.00000E-01 ET R_SUP =  1.50000E+00',);

KLMAX1=CALC_G(
           TITRE='K_MAX AVEC R_INF =  0.1 ET R_SUP =  0.5',
           RESULTAT=RESU,
           OPTION='CALC_K_MAX',
           LISSAGE=_F( LISSAGE_THETA = 'LAGRANGE_REGU',
                       LISSAGE_G = 'LAGRANGE_REGU',),
           THETA=_F( FOND_FISS=FOND,
                     R_INF=0.1,
                     R_SUP=0.5,),
           SIGNES = _F( CHARGE_S = (1,3),
                        CHARGE_NS = (2,4),),
                    );


IMPR_TABLE(TABLE=GL1,);

IMPR_TABLE(TABLE=GL2,);

IMPR_TABLE(TABLE=GLBIL1,);

IMPR_TABLE(TABLE=GLBIL2,);

IMPR_TABLE(TABLE=GLMAX1,);

IMPR_TABLE(TABLE=GLMAX2,);

IMPR_TABLE(TABLE=KLMAX1,);

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           PRECISION=8.0000000000000002E-3,
           VALE_CALC=11.632023253937,
           VALE_REFE=11.58,
           NOM_PARA='G',
           TABLE=GL1,
           FILTRE=(_F(NOM_PARA='NUME_ORDRE',
                      VALE_I=1,),
                   _F(NOM_PARA='NOEUD',
                      VALE_K='N2667',),
                   ),
           )

TEST_TABLE(REFERENCE='AUTRE_ASTER',
           PRECISION=8.0000000000000002E-3,
           VALE_CALC=11.632023253937,
           VALE_REFE=11.58,
           NOM_PARA='G_BILI_LOCAL',
           TABLE=GLBIL1,
           FILTRE=(_F(NOM_PARA='NUME_CMP_I',
                      VALE_I=1,),
                   _F(NOM_PARA='NUME_CMP_J',
                      VALE_I=1,),
                   _F(NOM_PARA='NOEUD',
                      VALE_K='N2667',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=30.248664966762,
           NOM_PARA='G',
           TABLE=GLMAX1,
           FILTRE=(_F(NOM_PARA='Q_1',
                      VALE=1.0,),
                   _F(NOM_PARA='Q_2',
                      VALE=-1.0,),
                   _F(NOM_PARA='Q_3',
                      VALE=1.0,),
                   _F(NOM_PARA='Q_4',
                      VALE=-1.0,),
                   _F(NOM_PARA='NOEUD',
                      VALE_K='N2667',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=4.3796523031498,
           NOM_PARA='G',
           TABLE=GL2,
           FILTRE=(_F(NOM_PARA='NUME_ORDRE',
                      VALE_I=2,),
                   _F(NOM_PARA='NOEUD',
                      VALE_K='N2667',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=4.3796523031498,
           NOM_PARA='G_BILI_LOCAL',
           TABLE=GLBIL2,
           FILTRE=(_F(NOM_PARA='NUME_CMP_I',
                      VALE_I=2,),
                   _F(NOM_PARA='NUME_CMP_J',
                      VALE_I=2,),
                   _F(NOM_PARA='NOEUD',
                      VALE_K='N2667',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=30.430745453611,
           NOM_PARA='G',
           TABLE=GLMAX2,
           FILTRE=(_F(NOM_PARA='Q_1',
                      VALE=1.0,),
                   _F(NOM_PARA='Q_2',
                      VALE=-1.0,),
                   _F(NOM_PARA='Q_3',
                      VALE=1.0,),
                   _F(NOM_PARA='Q_4',
                      VALE=-1.0,),
                   _F(NOM_PARA='NOEUD',
                      VALE_K='N2773',),
                   ),
           )

TEST_TABLE(
           VALE_CALC=153.50676690494,
           NOM_PARA='G',
           TABLE=KLMAX1,
           FILTRE=(_F(NOM_PARA='Q_1',
                      VALE_I=1,),
                   _F(NOM_PARA='Q_2',
                      VALE_I=1,),
                   _F(NOM_PARA='Q_3',
                      VALE_I=1,),
                   _F(NOM_PARA='Q_4',
                      VALE_I=1,),
                   _F(NOM_PARA='NUM_PT',
                      VALE_I=5,),
                   ),
           )

FIN();
#
