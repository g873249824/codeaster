# MODIF  DATE 13/09/2005   AUTEUR LEBOUVIE F.LEBOUVIER 
# TITRE  VALIDATION DU COUPLAGE SATURNE-ASTER par FICHIER MED
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2005  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
# 

DEBUT(CODE=_F(NOM='ZZZZ176B',
              NIV_PUB_WEB='INTRANET',VISU_EFICAS='NON'),)

maflu=LIRE_MAILLAGE(UNITE=21,
                    FORMAT='MED',);

moflu=AFFE_MODELE(MAILLAGE=maflu,
                  AFFE=_F(TOUT='OUI',
                          PHENOMENE='MECANIQUE',
                          MODELISATION='DKT',),);

pressflu=LIRE_RESU(TYPE_RESU='EVOL_CHAR',
                   FORMAT='MED',
                   MODELE=moflu,
                   UNITE=21,
                   FORMAT_MED=_F(
                   NOM_CHAM='PRES',
                   NOM_CHAM_MED='Pression_interpolee',
                   NOM_CMP='PRES',
                   NOM_CMP_MED='x',),
                   TOUT_ORDRE='OUI',);

#---------------------------------------------------------------------
# TEST DU CHAMP DE TYPE EVOL_CHAR APRES UN IMPR_RESU

DEFI_FICHIER( UNITE=36, 
              FICHIER='./REPE_OUT/pressflu.pos')

IMPR_RESU(MODELE=moflu,
          FORMAT='GMSH',UNITE=36,
          RESU=_F(MAILLAGE=maflu,
                  RESULTAT=pressflu,),
          INFO=2,);

DEFI_FICHIER(ACTION='LIBERER',UNITE=36)

TEST_FICHIER(FICHIER='./REPE_OUT/pressflu.pos',
             NB_CHIFFRE=6,
             EPSILON=1.E-14,
             VALE_K='804883c25478f5cbbcb7b6ce37794564',
             REFERENCE='NON_REGRESSION',
             VERSION='8.1.13',
             INFO=1)
#---------------------------------------------------------------------
#
maflu=DEFI_GROUP(reuse =maflu,
                MAILLAGE=maflu,
                CREA_GROUP_MA=(_F(NOM='XP',
                                  MAILLE=('M2','MA'),),
                               _F(NOM='XM',
                                  MAILLE=('M8','MF'),),
                               _F(NOM='YP',
                                  MAILLE=('M3','M6'),),
                               _F(NOM='YM',
                                  MAILLE=('MC','MG'),),
                               _F(NOM='ZP',
                                  MAILLE=('M1','M9','M5','MD'),),
                               _F(NOM='ZM',
                                  MAILLE=('M4','M7','MB','ME'),),
                                ),);

maflu=MODI_MAILLAGE(reuse =maflu,
                   MAILLAGE=maflu,
                   ORIE_NORM_COQUE=(
                                    _F(GROUP_MA='XP',
                                       VECT_NORM=(1.0,0.0,0.0,),
                                       NOEUD='N1',),
                                    _F(GROUP_MA='XM',
                                       VECT_NORM=(-1.0,0.0,0.0,),
                                       NOEUD='N5',),
                                    _F(GROUP_MA='YP',
                                       VECT_NORM=(0.0,1.0,0.0,),
                                       NOEUD='N1',),
                                    _F(GROUP_MA='YM',
                                       VECT_NORM=(0.0,-1.0,0.0,),
                                       NOEUD='N8',),
                                    _F(GROUP_MA='ZP',
                                       VECT_NORM=(0.0,0.0,1.0,),
                                       NOEUD='N1',),
                                    _F(GROUP_MA='ZM',
                                       VECT_NORM=(0.0,0.0,-1.0,),
                                       NOEUD='NA',),
                                  ),
                   MODELE=moflu,);

ACIER=DEFI_MATERIAU(ELAS=_F(E=204000000000.0,
                            NU=0.3,),);

CHMAT=AFFE_MATERIAU(MAILLAGE=maflu,
                    AFFE=_F(TOUT='OUI',
                            MATER=ACIER,),);

CARA_COQ=AFFE_CARA_ELEM(MODELE=moflu,
                        COQUE=(_F(MAILLE=('M1','M3','M4',
                                          'M5','M6','M7','M9',
                                          'MB','MC','MD',
                                          'ME','MG',),
                                          EPAIS=0.005,),
                               _F(MAILLE=('M2','MA','M8','MF'),
                                 EPAIS=0.005, ANGL_REP=(90.,0.,),),

                                 ),);

BLOQUAGE=AFFE_CHAR_MECA(MODELE=moflu,
                        DDL_IMPO=(_F(NOEUD='N1',
                                     DX=0.0,
                                     DY=0.0,
                                     DZ=0.0,),
                                  _F(NOEUD='N8',
                                     DZ=0.0,),
                                  _F(NOEUD='N5',
                                     DY=0.0,
                                     DZ=0.0,),
                                  _F(NOEUD='NA',
                                     DY=0.0,),
                               ),);
PRESSION=AFFE_CHAR_MECA(MODELE=moflu,
                      EVOL_CHAR=pressflu,);

FONCT=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(0.0,0.0,1.0,2.E4),
                    PROL_DROITE='EXCLU',
                    PROL_GAUCHE='EXCLU',);

RESU=MECA_STATIQUE(      
                    CARA_ELEM=CARA_COQ,
                    MODELE=moflu,
                    CHAM_MATER=CHMAT,INST=1.,
                    EXCIT=(
                           _F( CHARGE    = PRESSION,
                               FONC_MULT = FONCT),
                           _F( CHARGE    = BLOQUAGE),),);

RESU=CALC_ELEM(reuse =RESU,
                OPTION=('SIGM_ELNO_DEPL','EQUI_ELNO_SIGM',),
                RESULTAT=RESU,
                NIVE_COUCHE='SUP',);

IMPR_RESU(RESU=_F(RESULTAT=RESU,),);

#
# - TEST DES DEPLACEMENTS
#

TEST_RESU(RESU=(
                _F(RESULTAT=RESU,
                   NUME_ORDRE=1,
                   NOM_CMP='DX',
                   NOM_CHAM='DEPL',
                   NOEUD ='N3',
                   VALE=5.01073E-05,
                   REFERENCE='NON_REGRESSION',VERSION='8.1.12'),
                _F(RESULTAT=RESU,
                   NUME_ORDRE=1,
                   NOM_CMP='DY',
                   NOM_CHAM='DEPL',
                   NOEUD ='N3',
                   VALE=-1.88838E-05,
                   REFERENCE='NON_REGRESSION',VERSION='8.1.12'),
                _F(RESULTAT=RESU,
                   NUME_ORDRE=1,
                   NOM_CMP='DZ',
                   NOM_CHAM='DEPL',
                   NOEUD ='N3',
                   VALE=-5.85183E-02,
                   REFERENCE='NON_REGRESSION',VERSION='8.1.12'),
                )
          );
      
TEST_RESU(RESU=(
                _F(RESULTAT=RESU,
                   NUME_ORDRE=1,
                   NOM_CMP='DX',
                   NOM_CHAM='DEPL',
                   NOEUD ='NC',
                   VALE=6.73646E-05,
                   REFERENCE='NON_REGRESSION',VERSION='8.1.12'),
                _F(RESULTAT=RESU,
                   NUME_ORDRE=1,
                   NOM_CMP='DY',
                   NOM_CHAM='DEPL',
                   NOEUD ='NC',
                   VALE=1.26216E-06,
                   REFERENCE='NON_REGRESSION',VERSION='8.1.12'),
                _F(RESULTAT=RESU,
                   NUME_ORDRE=1,
                   NOM_CMP='DZ',
                   NOM_CHAM='DEPL',
                   NOEUD ='NC',
                   VALE=5.84992E-02,
                   REFERENCE='NON_REGRESSION',VERSION='8.1.12'),
                )
          );

IMPR_RESU(FORMAT='CASTEM',UNITE=37,
         
RESU=_F(MAILLAGE=maflu,RESULTAT=RESU,NUME_ORDRE=1,
                      NOM_CHAM='DEPL',),);

FIN();
