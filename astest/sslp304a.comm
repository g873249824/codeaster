# MODIF  DATE 29/05/2002   AUTEUR DURAND C.DURAND 
# RESPONSABLE JMBHH01 J.M.PROIX
# TITRE PLAQUE ORTHOTROPE EN TRACTION UNIAXIALE HORS AXES D'ORTHOTROPIE
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
# (AT YOUR OPTION) ANY LATER VERSION.                                 
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
# ======================================================================
DEBUT( CODE=_F(  NOM = 'SSLP304A',NIV_PUB_WEB='INTERNET') )

MAIL=LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='NON'),   )

#
# DEFINITION DES GROUPES DE NOEUDS
MAIL=DEFI_GROUP( reuse=MAIL,   MAILLAGE=MAIL,CREA_GROUP_NO=(
                       _F(  GROUP_MA = 'BORD_CH1'),
                       _F(  GROUP_MA = 'BORD_CH2'),
                       _F(  NOM = 'RESULT',
                                       NOEUD = ('N171', 'N336', 'N345',)))
                   )

#
# DEFINITION DU MODELE
MODELE=AFFE_MODELE(    MAILLAGE=MAIL,
                         AFFE=_F(  TOUT = 'OUI',
                       PHENOMENE = 'MECANIQUE',
                       MODELISATION = 'C_PLAN')  )

#
# DEFINITION DU MATERIAU (REPERE D'ORTHOTROPIE = REPERE GLOBAL)
ACIER=DEFI_MATERIAU(    ELAS_ORTH=_F(  E_L = 4.E10,
                                       E_T = 1.E10,
                                       G_LT = 0.45E10,
                                       G_TN = 0.35E10,
                                       G_LN = 0.45E10,
                                       NU_LT = 0.3)
                      )

#
# ATTRIBUTION DU MATERIAU
CHMAT=AFFE_MATERIAU(    MAILLAGE=MAIL,
                          AFFE=_F(  TOUT = 'OUI',
                                 MATER = ACIER)  )

COS30 = DEFI_VALEUR(  R8=EVAL("""COS(30*PI/180)""") ) 

COS30E4 = DEFI_VALEUR(  R8=EVAL("""1.E4*COS(30*PI/180)""") ) 

MCOS30E4 = DEFI_VALEUR(  R8=EVAL("""-1.E4*COS(30*PI/180)""") ) 
#
# DEFINITION DES CONDITIONS AUX LIMITES ET CHARGEMENTS
# DANS LE REPERE GLOBAL , ON A : 0.5*SQRT(3)*U - 0.5*V = 0.
CHARGT=AFFE_CHAR_MECA(    MODELE=MODELE,
                           DDL_IMPO=_F(  GROUP_NO = 'A',  DX = 0.,   DY = 0.),
                           LIAISON_DDL=_F(  GROUP_NO = ( 'B',  'B', ),
                                         DDL = ( 'DX', 'DY', ),
                                         COEF_MULT = ( COS30,  -0.5, ),
                                         COEF_IMPO = 0.),
                                         FORCE_CONTOUR=(
                           _F(  GROUP_MA = 'BORD_CH2',
                                           FX = COS30E4,
                                           FY = -0.5E4),
                           _F(  GROUP_MA = 'BORD_CH1',
                                           FX = MCOS30E4,
                                           FY = 0.5E4))
                        )

#
# RESOLUTION
DEF=MECA_STATIQUE(        MODELE=MODELE,
                        CHAM_MATER=CHMAT,
                             EXCIT=_F(  CHARGE = CHARGT)  )

#
# RECUPERATION DU CHAMP DE DEPLACEMENTS
U=CREA_CHAMP(  OPERATION='EXTR', TYPE_CHAM='NOEU_DEPL_R',
               NOM_CHAM='DEPL', RESULTAT=DEF,
                 NUME_ORDRE=1
                  )

#
# CALCUL DES CONTRAINTES
SIG=CALC_CHAM_ELEM(        MODELE=MODELE,
                         CHAM_MATER=CHMAT,
                             OPTION='SIGM_ELNO_DEPL',
                               DEPL=U
                     )


DEF2=MODI_REPERE(RESULTAT=DEF,
                 MODI_CHAM=_F(NOM_CHAM='DEPL',
                              NOM_CMP=('DX','DY'),
                              TYPE_CHAM='VECT_2D',),
                 DEFI_REPERE=_F(REPERE='UTILISATEUR',
                                ANGL_NAUT=(-30.0),),);
                                
                                
U2=CREA_CHAMP(TYPE_CHAM='NOEU_DEPL_R',
             OPERATION='EXTR',
             RESULTAT=DEF2,
             NOM_CHAM='DEPL',
             NUME_ORDRE=1,);

TEST_RESU(CHAM_NO=(_F(CHAM_GD=U2,
                      NOEUD='N171',
                      NOM_CMP='DX',
                      VALE=0.0,
                      CRITERE='ABSOLU',
                      REFERENCE='ANALYTIQUE',PRECISION=1.E-2,),
                   _F(CHAM_GD=U2,
                      NOEUD='N171',
                      NOM_CMP='DY',
                      VALE=-2.292E-7,
                      REFERENCE='ANALYTIQUE',PRECISION=1.E-3,),
                   _F(CHAM_GD=U2,
                      NOEUD='N336',
                      NOM_CMP='DX',
                      VALE=5.917E-7,
                      REFERENCE='ANALYTIQUE',PRECISION=1.E-3,),
                   _F(CHAM_GD=U2,
                      NOEUD='N336',
                      NOM_CMP='DY',
                      VALE=-5.028E-7,
                      REFERENCE='ANALYTIQUE',PRECISION=1.E-3,),
                   _F(CHAM_GD=U2,
                      NOEUD='N345',
                      NOM_CMP='DX',
                      VALE=5.917E-7,
                      REFERENCE='ANALYTIQUE',PRECISION=1.E-3,),
                   _F(CHAM_GD=U2,
                      NOEUD='N345',
                      NOM_CMP='DY',
                      VALE=-7.319E-7,
                      REFERENCE='ANALYTIQUE',PRECISION=1.E-3,),),);
#
# TEST_RESU DE LA CONTRAINTE
#
TEST_RESU(CHAM_ELEM=(
# SIG B
              _F(  CHAM_GD = SIG,
                          MAILLE = 'M46',
                          NOEUD = 'N171',
                          NOM_CMP = 'SIXX',
                          VALE = 7.5E3,
                          REFERENCE='ANALYTIQUE',PRECISION = 0.003),
              _F(  CHAM_GD = SIG,
                          MAILLE = 'M46',
                          NOEUD = 'N171',
                          NOM_CMP = 'SIYY',
                          VALE = 2.5E3,
                          REFERENCE='ANALYTIQUE',PRECISION = 0.005),
              _F(  CHAM_GD = SIG,
                          MAILLE = 'M46',
                          NOEUD = 'N171',
                          NOM_CMP = 'SIXY',
                          VALE = -4.33E3,
                          REFERENCE='ANALYTIQUE',PRECISION = 0.005),
# SIG C
              _F(  CHAM_GD = SIG,
                          MAILLE = 'M59',
                          NOEUD = 'N336',
                          NOM_CMP = 'SIXX',
                          VALE = 7.5E3,
                          REFERENCE='ANALYTIQUE',PRECISION = 0.005),
              _F(  CHAM_GD = SIG,
                          MAILLE = 'M59',
                          NOEUD = 'N336',
                          NOM_CMP = 'SIYY',
                          VALE = 2.5E3,
                          REFERENCE='ANALYTIQUE',PRECISION = 0.005),
              _F(  CHAM_GD = SIG,
                          MAILLE = 'M59',
                          NOEUD = 'N336',
                          NOM_CMP = 'SIXY',
                          VALE = -4.33E3,
                          REFERENCE='ANALYTIQUE',PRECISION = 0.005),
# SIG D
              _F(  CHAM_GD = SIG,
                          MAILLE = 'M150',
                          NOEUD = 'N345',
                          NOM_CMP = 'SIXX',
                          VALE = 7.5E3,
                          REFERENCE='ANALYTIQUE',PRECISION = 0.005),
              _F(  CHAM_GD = SIG,
                          MAILLE = 'M150',
                          NOEUD = 'N345',
                          NOM_CMP = 'SIYY',
                          VALE = 2.5E3,
                          REFERENCE='ANALYTIQUE',PRECISION = 0.005),
              _F(  CHAM_GD = SIG,
                          MAILLE = 'M150',
                          NOEUD = 'N345',
                          NOM_CMP = 'SIXY',
                          VALE = -4.33E3,
                          REFERENCE='ANALYTIQUE',PRECISION = 0.005))
          )

IMPR_RESU(RESU=(_F(FORMAT='CASTEM',
                   MAILLAGE=MAIL,
                   RESULTAT=DEF,),
                _F(RESULTAT=DEF,
                   VALE_MAX='OUI',
                   VALE_MIN='OUI',),),);

FIN()
#
