# MODIF  DATE 16/10/2007   AUTEUR SALMONA L.SALMONA 
# TITRE  : ENDOMMAGEMENT D UNE PLAQUE PLANE SOUS SOLLICITATIONS VARIEES
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2007  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================

#  DETAILS : MODELISATION : DKTG (GLRC_DM) 
#            MAILLAGE     : TRIA3
#            CHARGEMENT   : CYCLIQUE CISAILLEMENT/FLEXION

DEBUT(CODE=_F(NOM='SSNS106E',NIV_PUB_WEB='INTERNET',),);

PRE_GIBI();

EP = 0.1
DCIS= 5.0E-4
DR0 = 2.0E-2
t1 = 1.0
t2 = 2.8*t1
t3 = 3.0*t1
dt = 0.05
fx = 5E5

MAIL=LIRE_MAILLAGE();

MAIL=DEFI_GROUP(reuse =MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=(_F(GROUP_MA='A1A2',),
                               _F(GROUP_MA='A4A3' ,),
                               _F(GROUP_MA='A2A4' ,),
                               _F(GROUP_MA='A3A1' ,),
                             ),);

MAIL=MODI_MAILLAGE(reuse=MAIL,
                   MAILLAGE=MAIL,
                   ORIE_NORM_COQUE=_F(GROUP_MA='DALLE',
                                      VECT_NORM=(0.,0.,1.),
                                      GROUP_NO='A1',),
                   );

MA5=CREA_MAILLAGE(MAILLAGE=MAIL,
                  CREA_GROUP_MA=_F(NOM = 'ACIER2L',  
                                   PREF_MAILLE = 'A2L',  
                                   GROUP_MA = 'DALLE',),
                 )


MA4=CREA_MAILLAGE(MAILLAGE=MA5,
                  CREA_GROUP_MA=_F(NOM = 'ACIER1T',  
                                   PREF_MAILLE = 'A1T',  
                                   GROUP_MA = 'DALLE',),
                 )


DETRUIRE(CONCEPT = _F(NOM = MA5))

MA3=CREA_MAILLAGE(MAILLAGE=MA4,
                  CREA_GROUP_MA=_F(NOM = 'ACIER2T',  
                                   PREF_MAILLE = 'A2T',  
                                   GROUP_MA = 'DALLE',),
                 )

DETRUIRE(CONCEPT = _F(NOM = MA4))


MA2=CREA_MAILLAGE(MAILLAGE=MA3,
                  CREA_GROUP_MA=_F(NOM = 'ACIER1L',  
                                   PREF_MAILLE = 'A1L',  
                                   GROUP_MA = 'DALLE',),
                 )

DETRUIRE(CONCEPT = _F(NOM = MA3))

MA1=CREA_MAILLAGE(MAILLAGE=MA2,
                  CREA_GROUP_MA=_F(NOM = 'ACIER1',  
                                   PREF_MAILLE = 'A1',  
                                   GROUP_MA = 'DALLE',),
                 )

DETRUIRE(CONCEPT = _F(NOM =MA2))

MA0=CREA_MAILLAGE(MAILLAGE=MA1,
                  CREA_GROUP_MA=_F(NOM = 'DALLE_G',  
                                   PREF_MAILLE = 'G',  
                                   GROUP_MA = 'DALLE',),
                 )

DETRUIRE(CONCEPT = _F(NOM = MA1))


MA=CREA_MAILLAGE(MAILLAGE=MA0,
                  CREA_GROUP_MA=_F(NOM = 'ACIER2',  
                                   PREF_MAILLE = 'A2',  
                                   GROUP_MA = 'DALLE',),
                 )

DETRUIRE(CONCEPT = _F(NOM = MA0))

MO=AFFE_MODELE(INFO=1,
                 MAILLAGE=MA,
                 AFFE=(
                       _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='DALLE',
                          MODELISATION='DKT'),
                        _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='ACIER1L',
                          MODELISATION='GRILLE_EXCENTRE',
                          ),
                       _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='ACIER1T',
                          MODELISATION='GRILLE_EXCENTRE',
                          ),
                       _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='ACIER2L',
                          MODELISATION='GRILLE_EXCENTRE',
                          ),
                       _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='ACIER2T',
                          MODELISATION='GRILLE_EXCENTRE',
                          ),
                 )
                 );
                 
MO_G=AFFE_MODELE(INFO=1,
               MAILLAGE=MA,
              AFFE = _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='DALLE_G',
                          MODELISATION='DKTG'),
              )            

E = 3.2308E10
BETON_E=DEFI_MATERIAU( 
                      ELAS=(_F(
                               E=E,
                               NU=0.2,
                               RHO=2500)),
                       BETON_ECRO_LINE=_F( 
                       SYT = 3.4E6,
                       D_SIGM_EPSI = -0.20*E)
               )

ACIER = DEFI_MATERIAU(INFO=1,
                       ELAS=(_F(AMOR_ALPHA=3.7771128018011707E-05,
                                E=2.E11,
                                NU=0.2,
                                RHO=7800.0,
                                AMOR_BETA=2.6476993459625175)),
                       ECRO_LINE=(_F(SY=5.70000000E8,
                                     D_SIGM_EPSI=3.E8)
                                     ),
                       );
EGM =5.45E10*0.78
EGF = 7.32E10
NUF = 0.12

MAT_G = DEFI_MATERIAU(
                      ELAS  =_F(
                                 E = EGM,
                                 NU=  0.16, 
                              ),
                     GLRC_DM =_F( 
                                        GAMMA_T = 0.225,
                                        GAMMA_F = 0.6,
                                        SYT     = 4.7E5,
#                                        SYF     = 1.6E4,
                                        SYF     = 3.0E4,
                                        EF      = EGF,
                                        NUF     = NUF,
                                       ), 
                                          )

MATER=AFFE_MATERIAU( MAILLAGE=MA,
                    
                     AFFE=(
                          _F(GROUP_MA='DALLE_G',
                               MATER=MAT_G),
                          _F(GROUP_MA='DALLE',
                               MATER=BETON_E),
                          _F(GROUP_MA = 'ACIER1',
                               MATER=ACIER),                               
                          _F(GROUP_MA = 'ACIER2',
                               MATER=ACIER),                               
                          _F(GROUP_MA = 'ACIER1L',
                               MATER=ACIER),                               
                          _F(GROUP_MA = 'ACIER1T',
                               MATER=ACIER),                               
                          _F(GROUP_MA = 'ACIER2L',
                               MATER=ACIER),                               
                          _F(GROUP_MA = 'ACIER2T',
                               MATER=ACIER),                               
                      )
                    )  

CAEL=AFFE_CARA_ELEM(INFO=1,
                      COQUE=(
                             _F(EPAIS=EP,
                                GROUP_MA='DALLE',
                                COQUE_NCOU=1,
                                INER_ROTA = 'OUI',
                                ANGL_REP=(0.0,0.0,),
                                MODI_METRIQUE='NON')),
                      MODELE=MO,
                       GRILLE=(
                              _F(
                                 GROUP_MA='ACIER1L',
                                 SECTION=5.0E-3,
                                 EXCENTREMENT = -EP*0.4,
                                 ANGL_REP=(0,0,),
                                 GRILLE_NCOU=1,
                                 COEF_RIGI_DRZ=1.E-10),                              
                              _F(
                                 GROUP_MA='ACIER1T',
                                 SECTION=5.0E-3,
                                 EXCENTREMENT = -EP*0.4,
                                 ANGL_REP=(90,0,),
                                 GRILLE_NCOU=1,
                                 COEF_RIGI_DRZ=1.E-10),                              
                              _F(GROUP_MA='ACIER2L',
                                 SECTION=5.0E-3, 
                                 EXCENTREMENT = EP*0.4,
                                 ANGL_REP=(0,0,),
                                 GRILLE_NCOU=1,
                                 COEF_RIGI_DRZ=1.E-10),                              
                              _F(GROUP_MA='ACIER2T',
                                 SECTION=5.0E-3,
                                 EXCENTREMENT = EP*0.4,
                                 ANGL_REP=(90,0,),
                                 GRILLE_NCOU=1,
                                 COEF_RIGI_DRZ=1.E-10),                              
                       ),
                    )  

CAEL_G=AFFE_CARA_ELEM(MODELE=MO_G,
                        COQUE=_F(GROUP_MA='DALLE_G',
                                 EPAIS=EP,
                                 INER_ROTA = 'OUI',
                                 ANGL_REP=(0.0,0.0),
                                ),
                        )        

COND_0 = AFFE_CHAR_MECA(MODELE=MO,
                        DDL_IMPO=(_F(GROUP_NO='A1',
                                     DX=0.0,
                                     DY=0.0,
                                     DZ=0.0,
                                     DRX=0.0,
                                     DRY=0.0,
                                     DRZ=0.0,
                                     ),
                                 _F(GROUP_MA='A3A1',
                                     DX=0.0,
                                     DY=0.0,
                                     DRY=0.0,
                                      ),
                                  ),
                       )           

COND_1 = AFFE_CHAR_MECA(MODELE=MO,
                       DDL_IMPO=(
                                 _F(GROUP_MA='A2A4',
                                       DY=DCIS,
                                       DRY=DR0,
                                      ),
                                 ),
                       );

chf1 = DEFI_FONCTION(NOM_PARA='INST',
                     VALE=(0.0, 0.0,
                           t1 ,     1.,
                           t2 ,    -1.,
                           t3 ,     0.,
                           ),
                     PROL_DROITE='CONSTANT',
                     PROL_GAUCHE='CONSTANT',
                    );

inst1=DEFI_LIST_REEL(DEBUT=0.0,INTERVALLE=(
                          _F(JUSQU_A = t3,PAS = dt),
                      ),);
                     
RESU_G = STAT_NON_LINE(                      
#                      CONVERGENCE=_F(
# #                                     RESI_GLOB_MAXI=1E-5,
#                                      ITER_GLOB_MAXI=5,
#                                      ),
                     NEWTON=_F(
                              REAC_ITER=1, # FULL_MECA
                              PAS_MINI_ELAS=0.0,
                              MATRICE='TANGENTE',
#                              PREDICTION='ELASTIQUE',
                              REAC_INCR=1),
                              
                               
                      MODELE=MO_G,
                      CHAM_MATER= MATER,
                      CARA_ELEM = CAEL_G,
                      COMP_INCR=_F(
                                   RELATION ='GLRC_DM',
                                  ),
                      INCREMENT=_F( LIST_INST = inst1,
                                    PRECISION =1.E-1,
                                    SUBD_METHODE='UNIFORME',
                                    SUBD_PAS=4,
                                    SUBD_PAS_MINI=1.E-4
                                  ),
                      EXCIT=(   
                             _F( CHARGE = COND_0, 
                                    FONC_MULT = chf1 ),
                             _F( CHARGE = COND_1, 
                                    FONC_MULT = chf1 ),
                            ),
                     );

RESU_G=CALC_NO(reuse = RESU_G,
               OPTION='FORC_NODA',
               PRECISION=1.E-3,
               RESULTAT=RESU_G,
               MODELE=MO_G,
               CHAM_MATER=MATER,
               );
#debut post_traitement                                
RESU_G=CALC_ELEM(reuse = RESU_G,
                   INFO=1,
                   CRITERE='RELATIF',
                   RESULTAT=RESU_G,
                   OPTION='VARI_ELNO_ELGA',
                   TYPE_OPTION='TOUTES',
                   PRECISION=1.E-3,
                   MODELE=MO_G,
                   CHAM_MATER=MATER,
                   );

TEST_RESU(RESU=(
                _F(RESULTAT=RESU_G,
                  NOEUD='N2', 
                  INST=1.0,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DX',
                  VALE =2.9413472384809E-04,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                _F(RESULTAT=RESU_G,
                  NOEUD='N2', 
                  INST=1.0,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DZ',
                  VALE =-1.0022138200549E-02,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                _F(RESULTAT=RESU_G,
                  NOEUD='N2', 
                  INST=1.0,
                  NOM_CHAM='FORC_NODA',
                  NOM_CMP='DY',
                  VALE =3.5142504627660E+03,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                _F(RESULTAT=RESU_G,
                  MAILLE='GM182',
                  NOEUD='N1', 
                  INST=1.0,
                  NOM_CHAM='VARI_ELNO_ELGA',
                  NOM_CMP='V1',
                  VALE =4.6144550142418E+00,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                _F(RESULTAT=RESU_G,
                  MAILLE='GM182',
                  NOEUD='N1', 
                  INST=1.0,
                  NOM_CHAM='VARI_ELNO_ELGA',
                  NOM_CMP='V2',
                  VALE =9.4378519041505E+00,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                _F(RESULTAT=RESU_G,
                  NOEUD='N4', 
                  INST=2.8,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DX',
                  VALE =3.2396104172391E-04,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                _F(RESULTAT=RESU_G,
                  NOEUD='N4', 
                  INST=2.8,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DZ',
                  VALE =8.7926926146338E-03,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                _F(RESULTAT=RESU_G,
                  NOEUD='N4', 
                  INST=2.8,
                  NOM_CHAM='FORC_NODA',
                  NOM_CMP='DY',
                  VALE =-4.8336638067395E+03,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                _F(RESULTAT=RESU_G,
                  MAILLE='GM182',
                  NOEUD='N1', 
                  INST=2.8,
                  NOM_CHAM='VARI_ELNO_ELGA',
                  NOM_CMP='V1',
                  VALE =7.4233661123903E+00,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                _F(RESULTAT=RESU_G,
                  MAILLE='GM182',
                  NOEUD='N1', 
                  INST=2.8,
                  NOM_CHAM='VARI_ELNO_ELGA',
                  NOM_CMP='V2',
                  VALE =9.4378519041505E+00,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                _F(RESULTAT=RESU_G,
                  MAILLE='GM182',
                  NOEUD='N1', 
                  INST=3.0,
                  NOM_CHAM='VARI_ELNO_ELGA',
                  NOM_CMP='V1',
                  VALE =7.4233661123903E+00,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                _F(RESULTAT=RESU_G,
                  MAILLE='GM182',
                  NOEUD='N1', 
                  INST=3.0,
                  NOM_CHAM='VARI_ELNO_ELGA',
                  NOM_CMP='V2',
                  VALE =9.4378519041505E+00,
                  PRECISION = 1.0E-6,
                  REFERENCE='NON_REGRESSION',
                  ),
                )
          )      
FIN();
