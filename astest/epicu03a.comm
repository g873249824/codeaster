########################################################################
#
#                         OUTIL METIER SECURE
#
########################################################################
#
# TYPE D'ANALYSE : TRANS1D-RUPT1D
#
# IDENTIFIANT    : FCA1.1.4
#
# FONCTION       : FICHIER DE COMMANDES POUR EXECUTION CODE_ASTER
#                  RESOLUTION THERMIQUE NON LINEAIRE AVEC CONDITIONS
#                  AUX LIMITES ECHANGE
#                  RESOLUTION MECANIQUE LINEAIRE (ELASTICITE)
#
# SYNTAXE        : CODE_ASTER VERSIONS NEW6 ET STA6 POSTERIEURE A STA6.0
#
# PARAMETRAGE    : OUI
#
########################################################################
# ======================================================================
# COPYRIGHT (C) 1991 - 2017  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
#
#
# ======================================================================

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'))

#=====  1 - LECTURE DU MAILLAGE  =======================================

PRE_GIBI ()

MAIL = LIRE_MAILLAGE (FORMAT="ASTER")

# AJOUT DES GROUPES DE NOEUDS SUR LES BORDS INFERIEUR ET SUPERIEUR

MAIL = DEFI_GROUP ( reuse = MAIL,
                    MAILLAGE      = MAIL,
                    CREA_GROUP_NO =(
                                  _F ( NOM      = 'NOEINF',
                                       GROUP_MA = 'SEGINF' ),
                                  _F ( NOM      = 'NOESUP',
                                       GROUP_MA = 'SEGSUP' ))
                  )

#===== 2 - MODELISATION ET RESOLUTION THERMIQUE NON LINEAIRE  ==========

# 2.1 DEFINITION DU MODELE THERMIQUE

MO_THER = AFFE_MODELE (
        MAILLAGE = MAIL,
        AFFE     =_F ( GROUP_MA     = ( 'R', 'M', 'SEGINF', 'SEGEXT',
                                        'SEGSUP', 'SEGINT' ),
                       PHENOMENE    = 'THERMIQUE',
                       MODELISATION = 'AXIS' )
                      )

MAIL = MODI_MAILLAGE ( reuse        = MAIL ,
                       MAILLAGE     = MAIL ,
                       ORIE_PEAU_2D = (
                                        _F ( GROUP_MA = 'SEGINF'  ) ,
                                        _F ( GROUP_MA = 'SEGEXT'  ) ,
                                        _F ( GROUP_MA = 'SEGSUP'  ) ,
                                        _F ( GROUP_MA = 'SEGINT'  ) 
                                      )
                     )

# 2.2 DEFINITION DES PROPRIETES THERMIQUES DES MATERIAUX

# 2.2.1 MATERIAU DU DEFAUT

LAMB_MET = DEFI_FONCTION ( NOM_PARA    = 'TEMP',
# DEB PARAM
                           VALE        = ( 
                     0.0, 0.0377, 
                     20.0, 0.0377, 
                     50.0, 0.0386, 
                     100.0, 0.0399, 
                     150.0, 0.0405, 
                     200.0, 0.0405, 
                     250.0, 0.0402, 
                     300.0, 0.0395, 
                     350.0, 0.0387, ),
# FIN PARAM
                           PROL_DROITE = 'LINEAIRE',
                           PROL_GAUCHE = 'LINEAIRE' )

BETA_MET = DEFI_FONCTION ( NOM_PARA    = 'TEMP',
# DEB PARAM
                           VALE        = ( 
                     0.0, 0.0, 
                     50.0, 0.10619, 
                     100.0, 0.29033, 
                     150.0, 0.48291, 
                     200.0, 0.68328, 
                     250.0, 0.89216, 
                     300.0, 1.10944, 
                     350.0, 1.33506, ),
## FIN PARAM
                           PROL_DROITE = 'LINEAIRE',
                           PROL_GAUCHE = 'LINEAIRE' )

# CONVERSIONS D'UNITES
#
#                   -1  -1       -1  -1
# LAMBDA      : W.mm  .K   -> W.m  .K
#
#                   -3           -3
# H VOLUMIQUE : J.mm       -> J.m

LMBD_MET = CALC_FONCTION (
             COMB        =_F ( FONCTION = LAMB_MET,
                               COEF     = 1.0E+3 ),
             PROL_DROITE = 'LINEAIRE',
             PROL_GAUCHE = 'LINEAIRE' )

ENTH_MET = CALC_FONCTION (
             COMB        =_F ( FONCTION = BETA_MET,
                               COEF     = 1.0E+9 ),
             PROL_DROITE = 'LINEAIRE',
             PROL_GAUCHE = 'LINEAIRE' )

MATH_MET = DEFI_MATERIAU ( THER_NL = _F ( LAMBDA = LMBD_MET,
                                          BETA   = ENTH_MET ) )

# 2.2.2 REVETEMENT

LAMB_REV = DEFI_FONCTION ( NOM_PARA    = 'TEMP',
# DEB PARAM
                           VALE        = ( 
                     0.0, 0.0147, 
                     20.0, 0.0147, 
                     50.0, 0.0152, 
                     100.0, 0.0158, 
                     150.0, 0.0167, 
                     200.0, 0.0172, 
                     250.0, 0.018, 
                     300.0, 0.0186, 
                     350.0, 0.0193, ),
## FIN PARAM
                           PROL_DROITE = 'LINEAIRE',
                           PROL_GAUCHE = 'LINEAIRE' )

BETA_REV = DEFI_FONCTION ( NOM_PARA    = 'TEMP',
# DEB PARAM
                           VALE        = ( 
                     0.0, 0.0, 
                     50.0, 0.11021, 
                     100.0, 0.30133, 
                     150.0, 0.50143, 
                     200.0, 0.70813, 
                     250.0, 0.91888, 
                     300.0, 1.13291, 
                     350.0, 1.34898, ),
# FIN PARAM
                           PROL_DROITE = 'LINEAIRE',
                           PROL_GAUCHE = 'LINEAIRE' )

# CONVERSIONS D'UNITES
#
#                   -1  -1       -1  -1
# LAMBDA      : W.mm  .K   -> W.m  .K
#
#                   -3           -3
# H VOLUMIQUE : J.mm       -> J.m

LMBD_REV = CALC_FONCTION (
             COMB        =_F ( FONCTION = LAMB_REV,
                               COEF     = 1.0E+3 ),
             PROL_DROITE = 'LINEAIRE',
             PROL_GAUCHE = 'LINEAIRE' )

ENTH_REV = CALC_FONCTION (
             COMB        =_F ( FONCTION = BETA_REV,
                               COEF     = 1.0E+9 ),
             PROL_DROITE = 'LINEAIRE',
             PROL_GAUCHE = 'LINEAIRE' )

MATH_REV = DEFI_MATERIAU ( THER_NL = _F ( LAMBDA = LMBD_REV,
                                          BETA   = ENTH_REV ) )

# 2.3 AFFECTATION DES MATERIAUX

CHMAT_TH = AFFE_MATERIAU ( MAILLAGE = MAIL,
                           AFFE     =(
                                    _F ( GROUP_MA = 'M',
                                         MATER    = MATH_MET ),
                                    _F ( GROUP_MA = 'R',
                                         MATER    = MATH_REV ))
                         )

# 2.4 DEFINITION DU CHARGEMENT THERMIQUE : ECHANGE EN PEAU INTERNE

# 2.4.1-a COEFFICIENTS DU POLYNOME POUR LA VARIATION AZIMUTALE

a0 = 2.01373000
a1 = -1.45143000E-2
a2 = 1.3210000E-3
a3 = -8.0777300E-5
a4 = 1.60275000E-6 
a5 = -1.2661800E-8
a6 = 3.5171600E-11


# 2.4.1-b VALEURS UTILISEES POUR LES PARAMETRES DU TRANSITOIRE ANALYTIQUE

thetais = 10.
theta1 = 270.
tinit = thetais + theta1
theta2 = 20.
trg = 200.
trgcuve = 700.
tsecond = 1000.
fsecond = 0.05
hcuve = 5.


# 2.4.2 DEFINITION DE LA FONCTION DONNANT LA TEMPERATURE EN PAROI INTERNE EN FONCTION DE L'INSTANT AU POINT CONSIDERE

# DEFINITION DU POINT D'ETUDE
angle = 0.0%120.
altitude = -8.100


polynom = a0+a1*(angle)+a2*(angle)**2.+a3*(angle)**3.+a4*(angle)**4.+a5*(angle)**5.+a6*(angle)**6

# TEMPERATURE EN PAROI INTERNE DE LA CUVE EN FONCTION DE L'INSTANT

T_INT = FORMULE(NOM_PARA=('INST'),VALE='thetais+theta1*exp(-INST/((polynom)*(trg*(1-(altitude+8.100)/hcuve)+trgcuve*(altitude+8.100)/hcuve)))+theta2*sin(fsecond*INST)*exp(-INST/tsecond)')


# 2.5 AFFECTATION DU CHARGEMENT THERMIQUE

T_EXT = DEFI_CONSTANTE ( VALE = 20.0 )
H_EXT = DEFI_CONSTANTE ( VALE = 0.0 )  

CHAR_TH = AFFE_CHAR_THER_F ( MODELE  = MO_THER,
#
# Temperature en paroi interne
                             TEMP_IMPO = _F( GROUP_MA = 'SEGINT',
                                             TEMP     = T_INT    ) ,
# Echange nul avec l'exterieur : isolation thermique
#                             ECHANGE = (
#                                       _F( GROUP_MA = 'SEGEXT',
#                                           COEF_H   = H_EXT,
#                                           TEMP_EXT = T_EXT    )
#                                        )
                           )

# 2.6 RESOLUTION THERMIQUE NON LINEAIRE

# 2.6.1 DEFINITION DES INSTANTS DE RESOLUTION

LINST_TH = DEFI_LIST_REEL (DEBUT = 0.,
                           INTERVALLE=_F(JUSQU_A=3400.0, PAS=10.0),
                          )

# 2.6.2 RESOLUTION

TEMP = THER_NON_LINE (
         MODELE      = MO_THER,
         CHAM_MATER  = CHMAT_TH,
         EXCIT       = _F ( CHARGE         = CHAR_TH ),
# DEB PARAM
         ETAT_INIT   = _F ( VALE           = tinit ),
# FIN PARAM
         INCREMENT   = _F ( LIST_INST      = LINST_TH ),
         CONVERGENCE = _F ( ITER_GLOB_MAXI = 100,
                            RESI_GLOB_RELA = 1.0E-5 )
                     )

#===== 3 - MODELISATION ET RESOLUTION MECANIQUE  =======================
#=====     MODELE ELASTIQUE LINEAIRE             =======================

# 3.1 DEFINITION DU MODELE MECANIQUE

MO_MECA = AFFE_MODELE (
        MAILLAGE = MAIL,
        AFFE     =_F ( GROUP_MA     = ( 'R', 'M', 'SEGINF', 'SEGEXT',
                                        'SEGSUP', 'SEGINT' ),
                       PHENOMENE    = 'MECANIQUE',
                       MODELISATION = 'AXIS' )
                      )

MAIL = MODI_MAILLAGE ( reuse        = MAIL ,
                       MAILLAGE     = MAIL ,
                       ORIE_PEAU_2D = (
                                        _F ( GROUP_MA = 'SEGINF'  ) ,
                                        _F ( GROUP_MA = 'SEGEXT'  ) ,
                                        _F ( GROUP_MA = 'SEGSUP'  ) ,
                                        _F ( GROUP_MA = 'SEGINT'  ) 
                                      )
                     )

# 3.2 DEFINITION DES PROPRIETES MECANIQUES DES MATERIAUX

# 3.2.1 MATERIAU DU DEFAUT

E_MET = DEFI_FONCTION ( NOM_PARA    = 'TEMP',
# DEB PARAM
                        VALE        = ( 
                     0.0, 205000.0, 
                     20.0, 204000.0, 
                     50.0, 203000.0, 
                     100.0, 200000.0, 
                     150.0, 197000.0, 
                     200.0, 193000.0, 
                     250.0, 189000.0, 
                     300.0, 185000.0, 
                     350.0, 180000.0, ),
# FIN PARAM
                        PROL_DROITE = 'LINEAIRE',
                        PROL_GAUCHE = 'LINEAIRE' )

# CONVERSION D'UNITE POUR LE MODULE D'YOUNG : MPa -> Pa
YOUNGMET = CALC_FONCTION (
             COMB        =_F ( FONCTION = E_MET,
                               COEF     = 1.0E+6 ),
             PROL_DROITE = 'LINEAIRE',
             PROL_GAUCHE = 'LINEAIRE' )

# DEB PARAM
NUMET = DEFI_CONSTANTE ( VALE = 0.3 )
# FIN PARAM

ALPHAME0 = DEFI_FONCTION  ( NOM_PARA    = 'TEMP',
# DEB PARAM
                            VALE        = ( 
                     0.0, 1.122e-05, 
                     20.0, 1.122e-05, 
                     50.0, 1.145e-05, 
                     100.0, 1.179e-05, 
                     150.0, 1.214e-05, 
                     200.0, 1.247e-05, 
                     250.0, 1.278e-05, 
                     300.0, 1.308e-05, 
                     350.0, 1.34e-05, ),
# FIN PARAM
                            PROL_DROITE = 'LINEAIRE',
                            PROL_GAUCHE = 'LINEAIRE' )

# APPLICATION DU COEFFICIENT MULTIPLICATEUR 
ALPHAMET = CALC_FONCTION (
             COMB        =_F ( FONCTION = ALPHAME0,
                               COEF     = 1.6 ),
             PROL_DROITE = 'LINEAIRE',
             PROL_GAUCHE = 'LINEAIRE' )

MAME_MET = DEFI_MATERIAU ( ELAS_FO =_F (
                      E              = YOUNGMET,
                      NU             = NUMET,
                      ALPHA          = ALPHAMET,
# DEB PARAM
                      TEMP_DEF_ALPHA = 20.0
# FIN PARAM
                         )           )
# 3.2.2 REVETEMENT

E_REV = DEFI_FONCTION ( NOM_PARA    = 'TEMP',
# DEB PARAM
                        VALE        = ( 
                     0.0, 198500.0, 
                     20.0, 197000.0, 
                     50.0, 195000.0, 
                     100.0, 191500.0, 
                     150.0, 187500.0, 
                     200.0, 184000.0, 
                     250.0, 180000.0, 
                     300.0, 176500.0, 
                     350.0, 172000.0, ),
# FIN PARAM
                        PROL_DROITE = 'LINEAIRE',
                        PROL_GAUCHE = 'LINEAIRE' )

# CONVERSION D'UNITE POUR LE MODULE D'YOUNG : MPa -> Pa
YOUNGREV = CALC_FONCTION (
             COMB        =_F ( FONCTION = E_REV,
                               COEF     = 1.0E+6 ),
             PROL_DROITE = 'LINEAIRE',
             PROL_GAUCHE = 'LINEAIRE' )

# DEB PARAM
NUREV = DEFI_CONSTANTE ( VALE = 0.3 )
# FIN PARAM

ALPHARE0 = DEFI_FONCTION  ( NOM_PARA    = 'TEMP',
# DEB PARAM
                            VALE        = ( 
                     0.0, 1.64e-05, 
                     20.0, 1.64e-05, 
                     50.0, 1.654e-05, 
                     100.0, 1.68e-05, 
                     150.0, 1.704e-05, 
                     200.0, 1.72e-05, 
                     250.0, 1.75e-05, 
                     300.0, 1.77e-05, 
                     350.0, 1.79e-05, ),
# FIN PARAM
                            PROL_DROITE = 'LINEAIRE',
                            PROL_GAUCHE = 'LINEAIRE' )

# APPLICATION DU COEFFICIENT MULTIPLICATEUR 
ALPHAREV = CALC_FONCTION (
             COMB        =_F ( FONCTION = ALPHARE0,
                               COEF     = 1.6 ),
             PROL_DROITE = 'LINEAIRE',
             PROL_GAUCHE = 'LINEAIRE' )

MAME_REV = DEFI_MATERIAU ( ELAS_FO =_F (
                      E              = YOUNGREV,
                      NU             = NUREV,
                      ALPHA          = ALPHAREV,
# DEB PARAM
                      TEMP_DEF_ALPHA = 20.0
# FIN PARAM
                         )           )

# 3.3 AFFECTATION DES MATERIAUX

CHMAT_ME = AFFE_MATERIAU ( MAILLAGE = MAIL,
                           AFFE     =(
                                    _F ( GROUP_MA = 'M',
                                         MATER    = MAME_MET,),
                                    _F ( GROUP_MA = 'R',
                                         MATER    = MAME_REV,)),
                           AFFE_VARC=(_F(GROUP_MA = 'M',
                                         NOM_VARC = 'TEMP',
                                         EVOL = TEMP,
                                         NOM_CHAM='TEMP',
# DEB PARAM
                                         VALE_REF = 280.0 ),
# FIN PARAM
                                        _F(GROUP_MA = 'R',
                                         NOM_VARC = 'TEMP',
                                         EVOL = TEMP,
                                         NOM_CHAM='TEMP',
# DEB PARAM
                                         VALE_REF = 280.0 ),)
# FIN PARAM
                         )

# 3.4 DEFINITION DES CHARGEMENTS MECANIQUES

# 3.4.1 PRESSION FLUIDE EN PEAU INTERNE

PRESS0 = DEFI_FONCTION ( NOM_PARA    = 'INST',
# DEB PARAM
                        VALE        = ( 
                              0.0,15.61311,
                             10.01055,14.67456,
                             20.01332,13.72181,
                             30.00928,13.51951,
                             40.03054,11.86051,
                             50.03405,11.02303,
                             60.03804,10.49397,
                             70.01553,9.893082,
                             80.0628,9.205244,
                             90.04962,8.609702,
                             100.005,8.215752,
                             110.0141,7.94385,
                             120.0293,7.747075,
                             130.0506,7.606335,
                             140.0189,7.514703,
                             150.1131,7.45763,
                             160.0571,7.42599,
                             170.0005,7.41524,
                             180.0598,7.416013,
                             190.084,7.410862,
                             200.0076,7.399506,
                             210.0938,7.388468,
                             220.0173,7.383606,
                             230.0238,7.383993,
                             240.0866,7.382219,
                             250.0914,7.375163,
                             260.0598,7.367017,
                             270.1074,7.361174,
                             280.0342,7.370409,
                             290.0512,7.373274,
                             300.0137,7.376286,
                             310.0034,7.37196,
                             320.0718,7.369534,
                             330.0688,7.374268,
                             340.095,7.383369,
                             350.0111,7.387495,
                             360.0521,7.386518,
                             370.0279,7.381575,
                             380.0709,7.378593,
                             390.068,7.368069,
                             400.0461,7.350939,
                             410.056,7.327966,
                             420.0361,7.305421,
                             430.0341,7.283534,
                             440.0925,7.257982,
                             450.01,7.238559,
                             460.038,7.203239,
                             470.0275,7.166712,
                             480.1245,7.132769,
                             490.0343,7.093647,
                             500.0543,7.054423,
                             510.079,7.01506,
                             520.0497,6.980986,
                             530.0504,6.946021,
                             540.0393,6.912601,
                             550.0798,6.878379,
                             560.062,6.836366,
                             570.0269,6.775694,
                             580.0431,6.71555,
                             590.1052,6.65193,
                             600.0189,6.586234,
                             610.0588,6.498553,
                             620.013,6.393281,
                             630.0855,6.253011,
                             640.0508,6.095603,
                             650.0024,5.991284,
                             660.0779,5.90752,
                             670.027,5.835104,
                             680.0045,5.764201,
                             690.0249,5.697591,
                             700.0419,5.639604,
                             710.0787,5.581365,
                             720.05,5.521296,
                             730.0349,5.465582,
                             740.0209,5.40832,
                             750.0154,5.35091,
                             760.0145,5.294853,
                             770.0132,5.238836,
                             780.0283,5.156344,
                             790.0261,5.052401,
                             800.0446,5.007156,
                             810.0048,4.980953,
                             820.0015,4.952337,
                             830.037,4.871476,
                             840.0154,4.778218,
                             850.0044,4.690403,
                             860.0258,4.593082,
                             870.0046,4.487826,
                             880.0024,4.414248,
                             890.0023,4.376189,
                             900.0081,4.33181,
                             910.0023,4.287891,
                             920.0088,4.257056,
                             930.0304,4.241769,
                             940.0042,4.215888,
                             950.0187,4.192864,
                             960.0328,4.172719,
                             970.0098,4.15187,
                             980.0298,4.131503,
                             990.0202,4.110942,
                             1000.034,4.091608,
                             1010.03,4.065384,
                             1020.009,4.035781,
                             1030.008,3.995226,
                             1040.013,3.940906,
                             1050.023,3.858313,
                             1060.029,3.763639,
                             1070.005,3.692352,
                             1080.014,3.620266,
                             1090.031,3.576548,
                             1100.023,3.524256,
                             1110.013,3.496345,
                             1120.006,3.488374,
                             1130.009,3.473165,
                             1140.028,3.45569,
                             1150.012,3.432624,
                             1160.031,3.412896,
                             1170.031,3.395809,
                             1180.011,3.376975,
                             1190.009,3.355922,
                             1200.025,3.336303,
                             1210.022,3.311745,
                             1220.036,3.284893,
                             1230.006,3.251578,
                             1240.024,3.205593,
                             1250.016,3.14264,
                             1260.018,3.07036,
                             1270.01,3.015802,
                             1280.009,2.964272,
                             1290.007,2.926383,
                             1300.006,2.893088,
                             1310.027,2.865084,
                             1320.025,2.862901,
                             1330.0,2.854943,
                             1340.013,2.844457,
                             1350.019,2.830012,
                             1360.016,2.814639,
                             1370.02,2.801011,
                             1380.016,2.784672,
                             1390.022,2.762223,
                             1400.036,2.731808,
                             1410.017,2.696163,
                             1420.015,2.650838,
                             1430.014,2.613065,
                             1440.03,2.58427,
                             1450.008,2.563116,
                             1460.023,2.542495,
                             1470.016,2.524872,
                             1480.024,2.513665,
                             1490.037,2.510271,
                             1500.015,2.503007,
                             1510.006,2.490418,
                             1520.017,2.478706,
                             1530.016,2.465465,
                             1540.037,2.451453,
                             1550.032,2.438297,
                             1560.003,2.430503,
                             1570.021,2.425244,
                             1580.028,2.419756,
                             1590.026,2.416803,
                             1600.017,2.414912,
                             1610.012,2.414341,
                             1620.004,2.411661,
                             1630.007,2.406371,
                             1640.019,2.397112,
                             1650.017,2.383715,
                             1660.005,2.367948,
                             1670.036,2.35021,
                             1680.024,2.330354,
                             1690.017,2.31156,
                             1700.023,2.29423,
                             1710.031,2.277185,
                             1720.018,2.261646,
                             1730.019,2.24658,
                             1740.002,2.231683,
                             1750.002,2.217773,
                             1760.008,2.203638,
                             1770.02,2.189758,
                             1780.019,2.175655,
                             1790.023,2.161247,
                             1800.001,2.147149,
                             1810.033,2.132368,
                             1820.01,2.117762,
                             1830.022,2.103007,
                             1840.006,2.089037,
                             1850.003,2.074688,
                             1860.017,2.060522,
                             1870.004,2.046608,
                             1880.003,2.032841,
                             1890.009,2.018897,
                             1900.031,2.005336,
                             1910.012,1.992042,
                             1920.013,1.97862,
                             1930.017,1.965584,
                             1940.009,1.95154,
                             1950.03,1.938966,
                             1960.024,1.925872,
                             1970.002,1.912845,
                             1980.037,1.899892,
                             1990.017,1.887228,
                             2000.036,1.874622,
                             2010.026,1.861979,
                             2020.035,1.849859,
                             2030.034,1.838017,
                             2040.008,1.826158,
                             2050.02,1.81404,
                             2060.01,1.802497,
                             2070.004,1.790132,
                             2080.003,1.77982,
                             2090.025,1.766781,
                             2100.031,1.75505,
                             2110.021,1.744113,
                             2120.003,1.732366,
                             2130.031,1.721043,
                             2140.021,1.710462,
                             2150.021,1.698671,
                             2160.018,1.687532,
                             2170.026,1.676883,
                             2180.009,1.665545,
                             2190.029,1.65482,
                             2200.022,1.643045,
                             2210.019,1.633059,
                             2220.027,1.621242,
                             2230.003,1.610485,
                             2240.022,1.599522,
                             2250.008,1.588133,
                             2260.008,1.57706,
                             2270.017,1.566687,
                             2280.003,1.556374,
                             2290.024,1.544408,
                             2300.015,1.534013,
                             2310.018,1.522778,
                             2320.026,1.511755,
                             2330.0,1.500371,
                             2340.02,1.490489,
                             2350.014,1.478629,
                             2360.014,1.468569,
                             2370.029,1.457565,
                             2380.008,1.446233,
                             2390.027,1.435802,
                             2400.021,1.424192,
                             2410.014,1.414207,
                             2420.033,1.403092,
                             2430.009,1.392432,
                             2440.031,1.382904,
                             2450.02,1.371518,
                             2460.019,1.360792,
                             2470.016,1.350711,
                             2480.028,1.340721,
                             2490.01,1.330466,
                             2500.026,1.320082,
                             2510.022,1.311228,
                             2520.032,1.300007,
                             2530.039,1.289979,
                             2540.016,1.280216,
                             2550.036,1.270001,
                             2560.026,1.260314,
                             2570.03,1.250914,
                             2580.0,1.241599,
                             2590.013,1.232158,
                             2600.035,1.222351,
                             2610.016,1.213275,
                             2620.018,1.203655,
                             2630.019,1.193735,
                             2640.024,1.184641,
                             2650.032,1.175646,
                             2660.012,1.166427,
                             2670.006,1.157626,
                             2680.0,1.148511,
                             2690.016,1.138857,
                             2700.017,1.129717,
                             2710.017,1.121542,
                             2720.027,1.111791,
                             2730.016,1.103191,
                             2740.029,1.094499,
                             2750.027,1.084514,
                             2760.015,1.077148,
                             2770.018,1.067231,
                             2780.005,1.057965,
                             2790.029,1.04998,
                             2800.002,1.040037,
                             2810.04,1.031487,
                             2820.039,1.023076,
                             2830.009,1.013856,
                             2840.028,1.005229,
                             2850.019,0.9965533,
                             2860.007,0.9874608,
                             2870.027,0.9786884,
                             2880.03,0.9696602,
                             2890.006,0.9607148,
                             2900.002,0.9519052,
                             2910.0,0.9426952,
                             2920.001,0.9344626,
                             2930.007,0.9244963,
                             2940.009,0.9170634,
                             2950.006,0.9068379,
                             2960.003,0.898097,
                             2970.004,0.8896993,
                             2980.015,0.8806662,
                             2990.038,0.8728344,
                             3000.03,0.8634333,
                             3010.024,0.8559651,
                             3020.018,0.8467914,
                             3030.019,0.8375706,
                             3040.02,0.8288937,
                             3050.015,0.8203739,
                             3060.02,0.8121778,
                             3070.003,0.8041948,
                             3080.037,0.7963126,
                             3090.015,0.787503,
                             3100.004,0.7780247,
                             3110.038,0.7675827,
                             3120.024,0.757998,
                             3130.027,0.7486116,
                             3140.002,0.7376098,
                             3150.034,0.7249817,
                             3160.031,0.7141517,
                             3170.036,0.7039508,
                             3180.015,0.691968,
                             3190.006,0.6792405,
                             3200.017,0.6680589,
                             3210.031,0.658172,
                             3220.025,0.6485209,
                             3230.02,0.6405747,
                             3240.003,0.6330568,
                             3250.026,0.625726,
                             3260.009,0.6181359,
                             3270.034,0.6113568,
                             3280.006,0.6046484,
                             3290.022,0.5983156,
                             3300.038,0.590022,
                             3310.011,0.583567,
                             3320.039,0.5764346,
                             3330.004,0.5688137,
                             3340.015,0.5626034,
                             3350.03,0.555966,
                             3360.017,0.5475281,
                             3370.017,0.541403,
                             3380.016,0.5353296,
                             3390.021,0.5280001,
                             3400.013,0.5219343,),
                       PROL_DROITE = 'CONSTANT',
                       PROL_GAUCHE = 'CONSTANT'
# FIN PARAM
                      );
# APPLICATION DU COEFFICIENT MULTIPLICATEUR 
PRESS = CALC_FONCTION (
          COMB        =_F ( FONCTION = PRESS0,
                            COEF     = 1.6 ),
          INTERPOL    = 'LIN',
# DEB PARAM
          PROL_DROITE = 'EXCLU',
          PROL_GAUCHE = 'CONSTANT'
# FIN PARAM
                      )
# CONVERSION D'UNITE POUR LA PRESSION FLUIDE : MPa -> Pa
P_INT = CALC_FONCTION (
          COMB        =_F ( FONCTION = PRESS,
                            COEF     = 1.0E+6 ),
          INTERPOL    = 'LIN',
# DEB PARAM
          PROL_DROITE = 'EXCLU',
          PROL_GAUCHE = 'CONSTANT'
# FIN PARAM
                      )

# 3.4.2 EFFET DE FOND

# DEB PARAM
RIMM = 2197.0
EREV = 7.5 
EMDB = 220.0 
# FIN PARAM

# CONVERSION D'UNITE POUR LES PARAMETRES GEOMETRIQUES : mm -> m
RINT  = RIMM / 1.0E+3
EPREV = EREV / 1.0E+3
EPMDB = EMDB / 1.0E+3

REXT = RINT + EPREV + EPMDB

COEFFOND = ( -1.0E+0*RINT*RINT ) / ( REXT*REXT-RINT*RINT )

P_EF = CALC_FONCTION (
         COMB        =_F ( FONCTION = P_INT,
                           COEF     = COEFFOND ),
         INTERPOL    = 'LIN',
# DEB PARAM
         PROL_DROITE = 'EXCLU',
         PROL_GAUCHE = 'CONSTANT'
# FIN PARAM
                     )

# 3.4.3 DEFINITION D'UNE FONCTION CONSTANTE NULLE AU COURS DU TEMPS
#       POUR L'APPLICATION DES CONDITIONS AUX LIMITES (BLOCAGES)

ZERO = DEFI_FONCTION ( NOM_PARA    = 'INST',
                       VALE        = (  0.,  0.,
                                       10.,  0. ),
                       PROL_DROITE = 'CONSTANT',
                       PROL_GAUCHE = 'CONSTANT' )

# 3.5 AFFECTATION DES CHARGEMENTS THERMO-MECANIQUES

# 3.5.2 PRESSION INTERNE, EFFET DE FOND, BLOCAGES ET CONDITIONS
#       DE SYMETRIE

CHME2 = AFFE_CHAR_MECA_F ( MODELE        = MO_MECA,
                           PRES_REP      =(
                                         _F ( GROUP_MA = 'SEGINT',
                                              PRES     = P_INT ),
                                         _F ( GROUP_MA = 'SEGSUP',
                                              PRES     = P_EF  )),
                           DDL_IMPO     =_F ( GROUP_NO = 'NOEINF',
                                              DY       = ZERO  ),
                           LIAISON_UNIF =_F ( GROUP_NO = 'NOESUP',
                                              DDL      = 'DY'  )
                         )

# 3.6 RESOLUTION ELASTIQUE LINEAIRE

# 3.6.1 DEFINITION DES INSTANTS DE RESOLUTION

LINST_ME = DEFI_LIST_REEL (DEBUT = 0., INTERVALLE=_F(JUSQU_A=3400.0, PAS=10.0),);


# 3.6.2 RESOLUTION EN ELASTICITE LINEAIRE

SIG = MECA_STATIQUE(    MODELE = MO_MECA,
                        CHAM_MATER = CHMAT_ME,
                        EXCIT      =( _F ( CHARGE = CHME2 ) ),
                        SOLVEUR    = ( _F(METHODE='MUMPS',
                                          MATR_DISTRIBUEE='NON',
                                          RESI_RELA=-1.0,
                                          PCENT_PIVOT=100,),), 
                        LIST_INST=LINST_ME);

SIG = CALC_CHAMP (reuse      = SIG,
         CONTRAINTE=('SIGM_ELNO'),
         RESULTAT   = SIG,                  
                 )
#===== 4 - POST-TRAITEMENT : CALCUL DES FACTEURS D'INTENSITE  ==========
#=====     DE CONTRAINTES PAR LA METHODE K-BETA               ==========

# 4.1 RELEVE PREALABLE DES CONTRAINTES ET TEMPERATURE SUR LE SEGMENT
#     D'APPUI DU DEFAUT  

#     REMARQUES :
#     LES CARACTERISTIQUES GEOMETRIQUES DE LA FISSURE SONT SAISIES DANS
#     L'IHM. L'ORIENTATION DE LA FISSURE EST 'CIRC' OU 'LONGI'.

# DEB PARAM
PDEF = 5.0
LDEF = 25.0
RVIR = 2197.0
EPRE = 7.5
# FIN PARAM

#DECALAGE DU DEFAUT
DEF_DEC = -2.0E-4


# CONVERSION D'UNITE POUR LES PARAMETRES GEOMETRIQUES : mm -> m
PROFDEF = PDEF / 1.0E+3 - DEF_DEC
LONGDEF = LDEF / 1.0E+3
DEBFIS  = RVIR / 1.0E+3 + EPRE / 1.0E+3 + DEF_DEC
EXTRABS = DEBFIS + PDEF / 1.0E+3 - DEF_DEC

print 'PROFDEF = ',PROFDEF
print 'LONGDEF = ',LONGDEF
print 'DEBFIS  = ',DEBFIS
print 'EXTRABS = ',EXTRABS

# 4.21DEFINITION D'UN NOUVEAU MATERIAU AVEC ECROUISSAGE ISOTROPE NON
#     LINEAIRE POUR LE REVETEMENT
#     (UTILISATION DE LA LIMITE ELASTIQUE PAR LA METHODE K-BETA)

# DEB PARAM NIV 1

CTREV_01 = DEFI_FONCTION ( NOM_PARA = 'EPSI',
                            VALE = ( 
                     0.00187817259, 370.0, 
                     1.00187817259, 370.0,),
                            PROL_DROITE = 'LINEAIRE',
                            PROL_GAUCHE = 'LINEAIRE')

# CONVERSION D'UNITE SUR LA COURBE DE TRACTION : CONTRAINTE MPa -> Pa
TRREV_01 = CALC_FONCTION ( 
                  COMB     =_F (FONCTION= CTREV_01,
                                COEF     = 1.0E+6 ),
                            PROL_DROITE = 'LINEAIRE',
                            PROL_GAUCHE = 'LINEAIRE')

# DEB PARAM NIV 2
CTREV_02 = DEFI_FONCTION ( NOM_PARA = 'EPSI',
                            VALE = ( 
                     0.001723237598, 330.0, 
                     1.001723237598, 330.0,),
                            PROL_DROITE = 'LINEAIRE',
                            PROL_GAUCHE = 'LINEAIRE')

# CONVERSION D'UNITE SUR LA COURBE DE TRACTION : CONTRAINTE MPa -> Pa
TRREV_02 = CALC_FONCTION ( 
                  COMB     =_F (FONCTION= CTREV_02,
                                COEF     = 1.0E+6 ),
                            PROL_DROITE = 'LINEAIRE',
                            PROL_GAUCHE = 'LINEAIRE')

# DEB PARAM NIV 3
CTREV_03 = DEFI_FONCTION ( NOM_PARA = 'EPSI',
                            VALE = ( 
                     0.00152974504, 270.0, 
                     1.00152974504, 270.0,),
                            PROL_DROITE = 'LINEAIRE',
                            PROL_GAUCHE = 'LINEAIRE')

# CONVERSION D'UNITE SUR LA COURBE DE TRACTION : CONTRAINTE MPa -> Pa
TRREV_03 = CALC_FONCTION ( 
                  COMB     =_F (FONCTION= CTREV_03,
                                COEF     = 1.0E+6 ),
                            PROL_DROITE = 'LINEAIRE',
                            PROL_GAUCHE = 'LINEAIRE')

SIGM_REV = DEFI_NAPPE ( NOM_PARA    = 'TEMP',
# DEB PARAM
                        PARA        = (  20.0,
                    100.0, 
                    300.0, ),
# FIN PARAM
                        FONCTION    = (
# DEB PARAM
                           TRREV_01,
                           TRREV_02,
                           TRREV_03,
# ATTENTION PAS DE ',' APRES LA DERNIERE FONCTION DE LA LISTE
# FIN PARAM
                                      ),
                        PROL_DROITE = 'LINEAIRE',
                        PROL_GAUCHE = 'LINEAIRE' )

MAME_RE2 = DEFI_MATERIAU (ELAS_FO  =_F ( E              = YOUNGREV,
                                         NU             = NUREV,
                                         ALPHA          = ALPHAREV,
                          TEMP_DEF_ALPHA = 20.0),
                          TRACTION =_F ( SIGM = SIGM_REV ))

#****************************************************************************

# 4.2. PRISE EN COMPTE DES CONTRAINTES RESIDUELLES

L_SG_L=DEFI_FONCTION(NOM_PARA='X',
#      DEB PARAM 
                               VALE        = ( 
                     0.0, 0.0, 
                     2197.0, 0.0, 
                     2204.5, 0.0, 
#                     2197.0, 200.0, 
#                     2204.5, 200.0, 
                     2204.51, 0.0, 
                     2424.5, 0.0, ),
#      FIN PARAM 
                               PROL_DROITE = 'LINEAIRE',
                               PROL_GAUCHE = 'LINEAIRE' )
# CONVERSION D'UNITE SUR LA COURBE DE TRACTION : CONTRAINTE MPa -> Pa
L_SG_R_L = CALC_FONCTION (
             COMB        =_F ( FONCTION = L_SG_L,
                               COEF     = 1.0E+6 ),
             PROL_DROITE = 'LINEAIRE',
             PROL_GAUCHE = 'LINEAIRE' )
# FIN PARAM NIV 1


L_SG_C=DEFI_FONCTION(NOM_PARA='X',
#      DEB PARAM 
                               VALE        = ( 
                     0.0, 0.0, 
                     2197.0, 0.0, 
                     2204.5, 0.0, 
#                     2197.0, 156.0, 
#                     2204.5, 156.0, 
                     2204.51, 0.0, 
                     2424.5, 0.0, ),
#      FIN PARAM 
                               PROL_DROITE = 'LINEAIRE',
                               PROL_GAUCHE = 'LINEAIRE' )
# CONVERSION D'UNITE SUR LA COURBE DE TRACTION : CONTRAINTE MPa -> Pa
L_SG_R_C = CALC_FONCTION (
             COMB        =_F ( FONCTION = L_SG_C,
                               COEF     = 1.0E+6 ),
             PROL_DROITE = 'LINEAIRE',
             PROL_GAUCHE = 'LINEAIRE' )
# FIN PARAM NIV 1


# REVETEMENT

debut = (RVIR+EPRE)/1.0E+3
fin   = debut+PDEF/1.e3

# METAL DE BASE

S1M_G=MACR_LIGN_COUPE(RESULTAT=SIG,
#                   LIST_INST=LINST_me,
                   VIS_A_VIS=_F(GROUP_MA_1 = 'M'),
                   NOM_CHAM='SIGM_ELNO',
                   LIGN_COUPE=_F(TYPE='SEGMENT',
                                 NB_POINTS=5,
                                 COOR_ORIG=(debut,0.0,),
                                 COOR_EXTR=(fin,0.0,),
                                 ),);
#
TEMP_G=MACR_LIGN_COUPE(RESULTAT=TEMP,
                   NOM_CHAM='TEMP',
                   LIST_INST = LINST_TH,
                   LIGN_COUPE=_F(TYPE='SEGMENT',
                                 NB_POINTS=5,
                                 COOR_ORIG=(debut,0.0,),
                                 COOR_EXTR=(fin,0.0,),),);

FCT_L = FORMULE(VALE='SIYY+L_SG_R_L(COOR_X*1000)',NOM_PARA=('COOR_X','SIYY',),);

FCT_C = FORMULE(VALE='SIZZ+L_SG_R_C(COOR_X*1000)',NOM_PARA=('COOR_X','SIZZ',),);
#                 

S1_G=CALC_TABLE(TABLE=S1M_G,
               ACTION=(_F(OPERATION='OPER',
                         FORMULE=FCT_L,
                         NOM_PARA='SIYYP',),
                      _F(OPERATION='SUPPRIME',
                          NOM_PARA='SIYY',),
                      _F(OPERATION='OPER',
                         FORMULE=FCT_C,
                         NOM_PARA='SIZZP',),
                      _F(OPERATION='SUPPRIME',
                          NOM_PARA='SIZZ',),
                      _F(OPERATION='EXTR',
                          NOM_PARA=('INTITULE','NOM_CHAM','INST','ABSC_CURV',
                                    'COOR_X','COOR_Y','COOR_Z','SIXX','SIYYP','SIZZP','SIXY'),),
                      _F(OPERATION='RENOMME',
                          NOM_PARA=('SIYYP','SIYY'),),
                      _F(OPERATION='RENOMME',
                          NOM_PARA=('SIZZP','SIZZ'),),));

#*********************************************************************************************



# IMPR_TABLE(TABLE=S1_G)


profondeur         = 0.005e0
longueur_defaut    = 0.025e0
ep_mdb=220.e-3

# 4.3 CALCUL DES FACTEURS D'INTENSITE DE CONTRAINTES 

# 4.3.1 DEFAUT LONGITUDINAL

TB_LONGI = POST_K_BETA ( MAILLAGE  = MAIL,
                         MATER_REV = MAME_RE2,
                         MATER_MDB = MAME_MET,
                         EPAIS_REV = EPREV,
                         EPAIS_MDB = ep_mdb,
                        FISSURE   =_F (   FORM_FISS   = 'SEMI_ELLIPSE',
                                          PROFONDEUR  =  profondeur,
                                          LONGUEUR    =  longueur_defaut,
                                          ORIENTATION = 'LONGI' ),
                         K1D       =(_F (
                                          TABL_MECA_MDB = S1_G,
                                          TABL_THER     = TEMP_G,
                                          INTITULE      = 'NOEINF',),),
                         TITRE     = 'FIC PAR METHODE K-BETA'
                       )


IMPR_TABLE(TABLE=TB_LONGI)
 
# Instant = 0s

TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  280,
       VALE_REFE =  280,
       NOM_PARA  = 'TEMPPF_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  2.0974258133286E+07,
       VALE_REFE =  2.0974258133286E+07,
       NOM_PARA  = 'K1_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  2.5985423729961E+07,
       VALE_REFE =  2.5985423729961E+07,
       NOM_PARA  = 'KCP_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  0.75E-2,
       VALE_CALC =  2.1212138570423E+07,
       VALE_REFE =  2.112E+07,
       NOM_PARA  = 'K1_MDB',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  0.5E-2,
       VALE_CALC =  3.0530095134293E+07,
       VALE_REFE =  3.044E+07,
       NOM_PARA  = 'KCP_MDB',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  7.5572400533636E+06,
       VALE_REFE =  7.5572400533636E+06,
       NOM_PARA  = 'K1C_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  9.3628143492732E+06,
       VALE_REFE =  9.3628143492732E+06,
       NOM_PARA  = 'KCPC_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )

# Instant = 640.s

TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  106.71166525149,
       VALE_REFE =  106.71166525149,
       NOM_PARA  = 'TEMPPF_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  6.587463095756E+07,
       VALE_REFE =  6.587463095756E+07,
       NOM_PARA  = 'K1_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  8.3750025886379E+07,
       VALE_REFE =  8.3750025886379E+07,
       NOM_PARA  = 'KCP_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  0.75E-2,
       VALE_CALC =  6.4239617148243E+07,
       VALE_REFE =  6.396E+07,
       NOM_PARA  = 'K1_MDB',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  1.5E-2,
       VALE_CALC =  9.6108713859147E+07,
       VALE_REFE =  9.519E+07,
       NOM_PARA  = 'KCP_MDB',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  2.3986634710876E+07,
       VALE_REFE =  2.3986634710876E+07,
       NOM_PARA  = 'K1C_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  3.0509594876999E+07,
       VALE_REFE =  3.0509594876999E+07,
       NOM_PARA  = 'KCPC_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )

# Instant = 3400.s

TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  23.039315174059,
       VALE_REFE =  23.039315174059,
       NOM_PARA  = 'TEMPPF_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  2.360209653767E+07,
       VALE_REFE =  2.360209653767E+07,
       NOM_PARA  = 'K1_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  4.1659716851549E+07,
       VALE_REFE =  4.1659716851549E+07,
       NOM_PARA  = 'KCP_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  0.75E-2,
       VALE_CALC =  2.3121293098448E+07,
       VALE_REFE =  2.301E+07,
       NOM_PARA  = 'K1_MDB',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  0.75E-2,
       VALE_CALC =  5.5392309786484E+07,
       VALE_REFE =  5.512E+07,
       NOM_PARA  = 'KCP_MDB',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  8.5637713849839E+06,
       VALE_REFE =  8.5637713849839E+06,
       NOM_PARA  = 'K1C_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  1.5143641900781E+07,
       VALE_REFE =  1.5143641900781E+07,
       NOM_PARA  = 'KCPC_REV',
       TABLE     =  TB_LONGI,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )

# 4.3.1 DEFAUT CIRCONFERENTIEL

TB_CIRC = POST_K_BETA ( MAILLAGE  = MAIL,
                         MATER_REV = MAME_RE2,
                         MATER_MDB = MAME_MET,
                         EPAIS_REV = EPREV,
                         EPAIS_MDB = ep_mdb,
                        FISSURE   =_F (   FORM_FISS   = 'SEMI_ELLIPSE',
                                          PROFONDEUR  =  profondeur,
                                          LONGUEUR    =  longueur_defaut,
                                          ORIENTATION = 'CIRC' ),
                         K1D       =(_F (
                                          TABL_MECA_MDB = S1_G,
                                          TABL_THER     = TEMP_G,
                                          INTITULE      = 'NOEINF',),),
                         TITRE     = 'FIC PAR METHODE K-BETA'
                       )

IMPR_TABLE(TABLE=TB_CIRC)

# Instant = 0s

TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  280,
       VALE_REFE =  280,
       NOM_PARA  = 'TEMPPF_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  9.4978855553688E+06,
       VALE_REFE =  9.4978855553688E+06,
       NOM_PARA  = 'K1_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  1.0888095323965E+07,
       VALE_REFE =  1.0888095323965E+07,
       NOM_PARA  = 'KCP_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  0.75E-2,
       VALE_CALC =  9.6173527611692E+06,
       VALE_REFE =  9.57E+06,
       NOM_PARA  = 'K1_MDB',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  0.5E-2,
       VALE_CALC =  1.102504899826E+07,
       VALE_REFE =  1.1E+07,
       NOM_PARA  = 'KCP_MDB',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  3.4208430636403E+06,
       VALE_REFE =  3.4208430636403E+06,
       NOM_PARA  = 'K1C_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  3.9215533971333E+06,
       VALE_REFE =  3.9215533971333E+06,
       NOM_PARA  = 'KCPC_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=0.),
     )

# Instant = 640.s

TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  106.71166525149,
       VALE_REFE =  106.71166525149,
       NOM_PARA  = 'TEMPPF_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  6.1604794623564E+07,
       VALE_REFE =  6.1604794623564E+07,
       NOM_PARA  = 'K1_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  9.2977411534289E+07,
       VALE_REFE =  9.2977411534289E+07,
       NOM_PARA  = 'KCP_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  0.75E-2,
       VALE_CALC =  5.9996707284157E+07,
       VALE_REFE =  5.974E+07,
       NOM_PARA  = 'K1_MDB',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  1.2E-2,
       VALE_CALC =  9.0401631601529E+07,
       VALE_REFE =  8.961E+07,
       NOM_PARA  = 'KCP_MDB',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  2.2440709673036E+07,
       VALE_REFE =  2.2440709673036E+07,
       NOM_PARA  = 'K1C_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  3.3895617604313E+07,
       VALE_REFE =  3.3895617604313E+07,
       NOM_PARA  = 'KCPC_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=640.),
     )

# Instant = 3400.s

TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  23.039315174059,
       VALE_REFE =  23.039315174059,
       NOM_PARA  = 'TEMPPF_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  2.3476783901483E+07,
       VALE_REFE =  2.3476783901483E+07,
       NOM_PARA  = 'K1_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  5.5665267256335E+07,
       VALE_REFE =  5.5665267256335E+07,
       NOM_PARA  = 'KCP_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  0.75E-2,
       VALE_CALC =  2.3020619993402E+07,
       VALE_REFE =  2.291E+07,
       NOM_PARA  = 'K1_MDB',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'AUTRE_ASTER',
       PRECISION =  0.75E-2,
       VALE_CALC =  5.4318046963526E+07,
       VALE_REFE =  5.405E+07,
       NOM_PARA  = 'KCP_MDB',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  8.5157391556399E+06,
       VALE_REFE =  8.5157391556399E+06,
       NOM_PARA  = 'K1C_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )
TEST_TABLE(REFERENCE = 'NON_DEFINI',
       PRECISION =  0.1E-2,
       VALE_CALC =  2.0241550084852E+07,
       VALE_REFE =  2.0241550084852E+07,
       NOM_PARA  = 'KCPC_REV',
       TABLE     =  TB_CIRC,
       FILTRE    = _F(NOM_PARA='INST',VALE=3400.),
     )

FIN ()
