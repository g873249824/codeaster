# MODIF  DATE 28/11/2005   AUTEUR LEBOUVIE F.LEBOUVIER 
# TITRE TOLE ONDULEE EN TRACTION (MISES ECR. ISOT. 2D)
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
# (AT YOUR OPTION) ANY LATER VERSION.                                 
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
# ======================================================================

DEBUT(CODE=_F( NOM = 'SSNV115A',NIV_PUB_WEB='INTERNET') )

PRE_GIBI()

M=LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='OUI'), )

M=DEFI_GROUP(reuse=M,  MAILLAGE=M,
        CREA_GROUP_NO=_F( TOUT_GROUP_MA = 'OUI'))

MO=AFFE_MODELE(    MAILLAGE=M,
   AFFE=_F( TOUT = 'OUI',PHENOMENE = 'MECANIQUE',MODELISATION = 'D_PLAN'))

ACIER=DEFI_MATERIAU(       ELAS=_F( E = 2000., NU = 0.3),
           ECRO_LINE=_F( D_SIGM_EPSI = 200., SY = 100.) )

CM=AFFE_MATERIAU(   MAILLAGE=M,  AFFE=_F( TOUT = 'OUI',MATER = ACIER))

CH_LIM=AFFE_CHAR_MECA(   MODELE=MO,DDL_IMPO=(
           _F( GROUP_NO = 'BOUT1',  DX = 0.),
           _F( GROUP_NO = 'PO',     DY = 0.))
           )

CH_FO=AFFE_CHAR_MECA(    MODELE=MO,
           FORCE_CONTOUR=_F( GROUP_MA = 'BOUT2',   FX = 100.)
           )

RAMPE=DEFI_FONCTION(   NOM_PARA='INST',
           PROL_GAUCHE='LINEAIRE',  PROL_DROITE='LINEAIRE',
           VALE=(0.0,0.0,1.0,1.0,))

L_INST=DEFI_LIST_REEL(  DEBUT=0.0,
              INTERVALLE=_F( JUSQU_A = 1.0,      NOMBRE = 10)
           )

# STAT_NON_LINE 'VMIS'

#---------------------


U2=STAT_NON_LINE( 
                            MODELE=MO,
                        CHAM_MATER=CM,EXCIT=(
                             _F( 
                CHARGE = CH_FO,
                FONC_MULT = RAMPE), _F( 
                CHARGE = CH_LIM)),
                         COMP_INCR=_F( 
                RELATION = 'VMIS_ISOT_LINE',
                ITER_INTE_MAXI = 30,
                RESI_INTE_RELA = 1.E-8),
                         INCREMENT=_F( 
                LIST_INST = L_INST,
                NUME_INST_FIN = 5),
                            NEWTON=_F( 
                MATRICE = 'TANGENTE',
                REAC_ITER = 2),
                       CONVERGENCE=_F( 
                RESI_GLOB_RELA = 1.E-6,)
              )

U2=CALC_ELEM( reuse=U2,
                            OPTION=(
                  'SIEF_ELNO_ELGA',  'VARI_ELNO_ELGA',),
                          RESULTAT=U2,
              )

#==============================================================
# POUR TESTER L'IMPRESSION DU RESULTAT AUX POINTS DE GAUSS:
# ----------------------------------------------------------


#MA2=CREA_MAILLAGE(  MAILLAGE=M,
#        ECLA_PG=_F( MODELE = MO,  SHRINK = 0.90)
#                       )
#
#

#U2B=CREA_RESU( OPERATION='ECLA_PG', TYPE_RESU='EVOL_NOLI',
#            ECLA_PG=_F(  MODELE_INIT = MO,
#                      RESU_INIT = U2,
#                      MAILLAGE = MA2,
#                      NOM_CHAM = ('SIEF_ELGA','VARI_ELGA',))
#                 )

MACR_ECLA_PG(RESULTAT = CO('U2B'),
             MAILLAGE = CO('MA2'),
             RESU_INIT = U2,
             MODELE_INIT = MO,
             NOM_CHAM = ('SIEF_ELGA','VARI_ELGA'),);

#

TEST_RESU(RESU=(  
       _F(  RESULTAT = U2B,    NUME_ORDRE = 1,
         NOM_CHAM = 'SIEF_ELGA', TYPE_TEST = 'SOMM_ABS',
         VALE = 4.8662129934030E+04),
       _F(  RESULTAT = U2B,    NUME_ORDRE = 5,
         NOM_CHAM = 'SIEF_ELGA', TYPE_TEST = 'SOMM_ABS',
         VALE = 2.6564696943360E+05),
       _F(  RESULTAT = U2B,    NUME_ORDRE = 5,
         NOM_CHAM = 'VARI_ELGA', TYPE_TEST = 'SOMM_ABS',
         VALE = 5.7249254143005E+02))
         )


#==============================================================
# IMPRESSION DU RESULTAT SUR UN BOUT DU MAILLAGE 
# ----------------------------------------------------------

MA3=CREA_MAILLAGE( MAILLAGE=M,
                   ECLA_PG=_F( MODELE = MO,
                               SHRINK = 0.90,
                               GROUP_MA='EXTR1',
                               TAILLE_MIN = 0.1,
                              )
                  )

#

U3B=CREA_RESU( OPERATION='ECLA_PG', TYPE_RESU='EVOL_NOLI',
            ECLA_PG=_F( MODELE_INIT = MO,
                        RESU_INIT = U2,
                        MAILLAGE = MA3,
                        GROUP_MA='EXTR1',
                        NOM_CHAM = ('SIEF_ELGA','VARI_ELGA',))
                 )
#

TEST_RESU(RESU=(  
       _F(  RESULTAT = U3B,    NUME_ORDRE = 1,
         NOM_CHAM = 'SIEF_ELGA', TYPE_TEST = 'SOMM_ABS',
         VALE = 4.6550E+02),
       _F(  RESULTAT = U3B,    NUME_ORDRE = 5,
         NOM_CHAM = 'SIEF_ELGA', TYPE_TEST = 'SOMM_ABS',
         VALE = 2.3275E+03),
       _F(  RESULTAT = U3B,    NUME_ORDRE = 5,
         NOM_CHAM = 'VARI_ELGA', TYPE_TEST = 'SOMM_ABS',
         VALE = 0.0000E+00, PRECISION = 0., CRITERE = 'ABSOLU'))
         )



#==============================================================

U2=STAT_NON_LINE( reuse=U2,
                            MODELE=MO,
                        CHAM_MATER=CM,EXCIT=(
                             _F( 
                CHARGE = CH_FO,
                FONC_MULT = RAMPE), _F( 
                CHARGE = CH_LIM)),
                         COMP_INCR=_F( 
                RELATION = 'VMIS_ISOT_LINE',
                ITER_INTE_MAXI = 30,
                RESI_INTE_RELA = 1.E-8),
                         ETAT_INIT=_F( 
                EVOL_NOLI = U2,
                NUME_ORDRE = 5),
                         INCREMENT=_F( 
                LIST_INST = L_INST,
                NUME_INST_FIN = 10),
                            NEWTON=_F( 
                MATRICE = 'TANGENTE',
                REAC_ITER = 2),
                       CONVERGENCE=_F( 
                RESI_GLOB_RELA = 1.E-6)
              )

U2=CALC_ELEM( reuse=U2,
                            OPTION=(
                  'SIEF_ELNO_ELGA',  'VARI_ELNO_ELGA',),
                          RESULTAT=U2,
                        NUME_ORDRE=( 6, 7, 8, 9, 10, ),
              )

TEST_RESU(RESU=(

    _F(  RESULTAT = U2,  NUME_ORDRE = 10,  NOM_CHAM = 'SIEF_ELNO_ELGA',
    MAILLE = 'M1', NOEUD = 'N249',    NOM_CMP = 'SIXX',   VALE = 98.453),
    _F(  RESULTAT = U2,  NUME_ORDRE = 10,  NOM_CHAM = 'VARI_ELNO_ELGA',
    MAILLE = 'M13', NOEUD = 'N226',    NOM_CMP = 'V1',    VALE = 0.17870))
    )

# =======================================================
#  SIMULATION DE L'ANCIENNE FONCTIONNALITE HIST_NON_LINE
# =======================================================

V=STAT_NON_LINE( 
                            MODELE=MO,
                        CHAM_MATER=CM,
                         COMP_INCR=_F( 
                RELATION = 'VMIS_ISOT_LINE'),
                         INCREMENT=_F( 
                LIST_INST = L_INST),
                            NEWTON=_F( 
                PREDICTION = 'DEPL_CALCULE',
                EVOL_NOLI = U2),
# CHARGE BIDON (ATTENTION: PAS DE CHARGE DE TYPE DIRICHLET)
                             EXCIT=_F( 
                CHARGE = CH_LIM),
                       CONVERGENCE=_F( 
                ITER_GLOB_MAXI = 0,
# CONVERGENCE BIDON
                RESI_GLOB_MAXI = 1.)
              )

V=CALC_ELEM( reuse=V,
                            OPTION=(
                  'SIEF_ELNO_ELGA',  'VARI_ELNO_ELGA',),
                          RESULTAT=V,
              )

TEST_RESU(RESU=(

    _F(  RESULTAT = V,  NUME_ORDRE = 10,  NOM_CHAM = 'DEPL',
    PRECISION = 1.E-2, GROUP_NO = 'X',    NOM_CMP = 'DX',   VALE = 0.02743),
    _F(  RESULTAT = V,  NUME_ORDRE = 10,  NOM_CHAM = 'DEPL',
    PRECISION = 1.E-2, GROUP_NO = 'X',    NOM_CMP = 'DY',   VALE = -0.2804),

    _F(  RESULTAT = V,  NUME_ORDRE = 10,  NOM_CHAM = 'SIEF_ELNO_ELGA',
    MAILLE = 'M1', NOEUD = 'N249',    NOM_CMP = 'SIXX',   VALE = 98.453),
    _F(  RESULTAT = V,  NUME_ORDRE = 10,  NOM_CHAM = 'VARI_ELNO_ELGA',
    MAILLE = 'M13', NOEUD = 'N226',    NOM_CMP = 'V1',    VALE = 0.17870))
    )


FIN()
#
