# MODIF  DATE 10/10/2012   AUTEUR COURTOIS M.COURTOIS 
# TITRE TEST DE LA LOI DE HUJEUX SUR UN POINT MATERIEL
# comp012a.para = tps_job 60 mem_job 256Mo liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================

DEBUT(CODE=_F(NOM='COMP012A',NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

K = 516.2E6
G = 238.2E6
YOUNG   = 9.*K*G /(3.*K+G)
POISSON = (3.*K-2.*G) /(6.*K+2.*G)

MATE1=DEFI_MATERIAU(ELAS=_F(E=YOUNG, NU=POISSON, RHO=2500., ALPHA=0.),
                    HUJEUX=_F(N        = 0.4,
                              BETA     = 24.,
                              D        = 2.5,
                              B        = 0.2,
                              PHI      = 33.,
                              ANGDIL   = 33.,
                              PCO      = -1.E6,
                              PREF     = -1.E6,
                              AMON     = 0.008,
                              ACYC     = 0.0001,
                              CMON     = 0.2,
                              CCYC     = 0.1,
                              RD_ELA   = 0.005,
                              RI_ELA   = 0.001,
                              RHYS     = 0.05,
                              RMOB     = 0.9,
                              XM       = 1.,
                              RD_CYC   = 0.005,
                              RI_CYC   = 0.001,
                              DILA     = 1.0,),)


# declaration des tables (TABLE_RESU) qui sortiront de la macro
TABTD    = CO('TTD')
TABTND   = CO('TTND')
TABCISA1 = CO('TCISA1')
TABCISA2 = CO('TCISA2')
TABTNDC1 = CO('TTNDC1')
TABTNDC2 = CO('TTNDC2')

# creation de courbes de reference (TABLE_REF) bidon pour couverture de code
tabbid1 = CREA_TABLE(LISTE=(_F(PARA='TYPE'    , LISTE_K=['P-Q',]),
                            _F(PARA='LEGENDE' , LISTE_K=['ma_legende',]),
                            _F(PARA='ABSCISSE', LISTE_R=[0.,1.]),
                            _F(PARA='ORDONNEE', LISTE_R=[0.,1.]),),);
tabbid2 = CREA_TABLE(LISTE=(_F(PARA='TYPE'    , LISTE_K=['EPSXY-G',]),
                            _F(PARA='LEGENDE' , LISTE_K=['ma_legende',]),
                            _F(PARA='ABSCISSE', LISTE_R=[0.,1.]),
                            _F(PARA='ORDONNEE', LISTE_R=[0.,1.]),),);

CALC_ESSAI_GEOMECA(INFO=1,
                   MATER=MATE1,
                   COMP_INCR=_F(RELATION='HUJEUX',
                                ITER_INTE_MAXI=20,
                                RESI_INTE_RELA=1.E-8,),
                   CONVERGENCE=_F(RESI_GLOB_RELA = 1.E-6,
                                  ITER_GLOB_MAXI = 20,
                                  ARRET = 'OUI',),

                   ESSAI_TD = _F(PRES_CONF   = -5.E+4,
                                 EPSI_IMPOSE = -0.2, 
                                 TABLE_REF   = tabbid1,
                                 TABLE_RESU  = TABTD),

                   ESSAI_TND = _F(PRES_CONF   = -5.E+4,
                                  EPSI_IMPOSE = -0.02, 
                                  TABLE_REF   = tabbid1,
                                  TABLE_RESU  = TABTND),

                   ESSAI_TND_C = _F(PRES_CONF   = -3.E4,
                                    SIGM_IMPOSE = 1.5E+4,
                                    NB_CYCLE    =  3,
                                    UN_SUR_K    =  1.E-12,
                                    TABLE_REF   = tabbid1,
                                    TABLE_RESU  = (TABTNDC1,TABTNDC2),),

                   ESSAI_CISA_C = _F(PRES_CONF   = -5.E+4,
                                     EPSI_IMPOSE =  1.95E-4 , 
                                     NB_CYCLE    = 1, 
                                     TABLE_REF   = tabbid2,
                                     TABLE_RESU  = (TABCISA1,TABCISA2),),

                   )

#IMPR_TABLE(TABLE=TABTD)
#IMPR_TABLE(TABLE=TABTND)
#IMPR_TABLE(TABLE=TABTNDC1)
#IMPR_TABLE(TABLE=TABTNDC2)
#IMPR_TABLE(TABLE=TABCISA1)
#IMPR_TABLE(TABLE=TABCISA2)

# trace de sigma : p = trace(sig)/3.
FORMU1   = FORMULE(NOM_PARA='P',  VALE='3.*P'  )
FORMU2   = FORMULE(NOM_PARA='P_1',VALE='3.*P_1')
TABTND2  = CALC_TABLE(TABLE=TABTND,
                      ACTION= _F(OPERATION='OPER',NOM_PARA='TRSIG',FORMULE=FORMU1),)
TABTNDC3 = CALC_TABLE(TABLE=TABTNDC1,
                      ACTION= _F(OPERATION='OPER',NOM_PARA='TRSIG',FORMULE=FORMU2),)

# pour l'essai 'TD' -> valeurs de reference de ssnv197a ('TRACE' pour sigma et epsilon)

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=0.02,
           VALE_CALC= 1.15501005E+05,
           VALE_REFE=117640,
           NOM_PARA='Q',
           TABLE=TTD,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-1.E-2,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=0.02,
           VALE_CALC= 1.55438019E+05,
           VALE_REFE=157072,
           NOM_PARA='Q',
           TABLE=TTD,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-0.02,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC= 1.99926190E+05,
           VALE_REFE=200850,
           NOM_PARA='Q',
           TABLE=TTD,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-0.050000000000000003,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC= 2.06796447E+05,
           VALE_REFE=207649,
           NOM_PARA='Q',
           TABLE=TTD,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-0.10000000000000001,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC= 1.84850730E+05,
           VALE_REFE=185854,
           NOM_PARA='Q',
           TABLE=TTD,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-0.20000000000000001,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=0.02,
           VALE_CALC=-3.77680761E-03,
           VALE_REFE=-3.82E-3,
           NOM_PARA='EPS_VOL',
           TABLE=TTD,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-1.E-2,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=0.02,
           VALE_CALC=-4.33722691E-03,
           VALE_REFE=-4.3400000000000001E-3,
           NOM_PARA='EPS_VOL',
           TABLE=TTD,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-0.02,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=0.029999999999999999,
           VALE_CALC=0.010902447,
           VALE_REFE=0.010699999999999999,
           NOM_PARA='EPS_VOL',
           TABLE=TTD,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-0.10000000000000001,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=0.050000000000000003,
           VALE_CALC=0.032359926,
           VALE_REFE=0.031910000000000001,
           NOM_PARA='EPS_VOL',
           TABLE=TTD,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-0.20000000000000001,),
           )

# pour l'essai 'TND' -> valeurs de reference de wtnv133a ('VMIS','TRACE')

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=0.029999999999999999,
           VALE_CALC= 3.13628698E+04,
           VALE_REFE=31547,
           NOM_PARA='Q',
           TABLE=TTND,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-1.E-3,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=0.02,
           VALE_CALC= 3.99961774E+04,
           VALE_REFE=40129,
           NOM_PARA='Q',
           TABLE=TTND,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-2.E-3,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC= 5.18427757E+04,
           VALE_REFE=51937,
           NOM_PARA='Q',
           TABLE=TTND,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-5.0000000000000001E-3,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC= 6.81808426E+04,
           VALE_REFE=68286,
           NOM_PARA='Q',
           TABLE=TTND,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-1.E-2,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC= 1.03069548E+05,
           VALE_REFE=103161,
           NOM_PARA='Q',
           TABLE=TTND,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-0.02,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC=-1.38900528E+05,
           VALE_REFE=-138887,
           NOM_PARA='TRSIG',
           TABLE=TABTND2,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-1.E-3,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC=-1.33795174E+05,
           VALE_REFE=-133789,
           NOM_PARA='TRSIG',
           TABLE=TABTND2,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-2.E-3,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC=-1.24909260E+05,
           VALE_REFE=-124952,
           NOM_PARA='TRSIG',
           TABLE=TABTND2,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-5.0000000000000001E-3,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC=-1.36653886E+05,
           VALE_REFE=-136801,
           NOM_PARA='TRSIG',
           TABLE=TABTND2,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-1.E-2,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC=-1.85830172E+05,
           VALE_REFE=-185971,
           NOM_PARA='TRSIG',
           TABLE=TABTND2,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='EPS_AXI',
                     VALE=-0.02,),
           )

# pour l'essai 'TND_C' -> valeurs de reference de wtnv134b ('TRACE')


TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC=-8.02382230E+04,
           VALE_REFE=-8.0193699999999997E4,
           NOM_PARA='TRSIG',
           TABLE=TABTNDC3,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='INST_1',
                     VALE=10.0,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC=-7.40838365E+04,
           VALE_REFE=-7.4078100000000006E4,
           NOM_PARA='TRSIG',
           TABLE=TABTNDC3,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='INST_1',
                     VALE=30.0,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=1.E-2,
           VALE_CALC=-6.61271785E+04,
           VALE_REFE=-6.6250100000000006E4,
           NOM_PARA='TRSIG',
           TABLE=TABTNDC3,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='INST_1',
                     VALE=50.0,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=0.02,
           VALE_CALC=-5.29275537E+04,
           VALE_REFE=-52999,
           NOM_PARA='TRSIG',
           TABLE=TABTNDC3,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='INST_1',
                     VALE=70.0,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='SOURCE_EXTERNE',
           PRECISION=0.02,
           VALE_CALC=-4.56022980E+04,
           VALE_REFE=-4.5671900000000001E4,
           NOM_PARA='TRSIG',
           TABLE=TABTNDC3,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='INST_1',
                     VALE=90.0,),
           )

# pour l'essai 'CISA_C' -> non regression

TEST_TABLE(CRITERE='RELATIF',
           VALE_CALC=-9992.0499999999993,
           TOLE_MACHINE=1.E-3,
           NOM_PARA='SIG_XY_1',
           TABLE=TCISA1,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='INST_1',
                     VALE=10.0,),
           )

TEST_TABLE(CRITERE='RELATIF',
           VALE_CALC=1.00784E4,
           TOLE_MACHINE=1.E-3,
           NOM_PARA='SIG_XY_1',
           TABLE=TCISA1,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='INST_1',
                     VALE=30.0,),
           )

TEST_TABLE(CRITERE='RELATIF',
           REFERENCE='NON_DEFINI',
           PRECISION=1.E-2,
           VALE_CALC=-9.95413672E+03,
           VALE_REFE=-9954.1399999999994,
           NOM_PARA='SIG_XY_1',
           TABLE=TCISA1,
           FILTRE=_F(CRITERE='ABSOLU',
                     PRECISION=9.0000000000000006E-05,
                     NOM_PARA='INST_1',
                     VALE=50.0,),
           )

FIN()
