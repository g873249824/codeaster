# MODIF  DATE 22/03/2010   AUTEUR BERARD A.BERARD 
# TITRE  VALIDATION DE PROJ_CHAMP EN 2D  (DIVERSES METHODES)
# zzzz261a.para = tps_job 60 mem_job 64Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2010  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
#----------------------------------------------------------------------------------

# RESPONSABLE PELLET J.PELLET
DEBUT(  CODE=_F(NOM='ZZZZ261A',NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

#-------------------------------------------------------------------------------------
# description du test :
#----------------------
#  On lit 2 maillages (MA1 et MA2) correspondants au carre [0,1]X[0,1].
#  Leurs discretisations sont differentes.
#
#  On cree sur MA1 un evol_ther "analytique" grace a une formule de temps et de l'espace.
#
#  On projette ensuite cet evol_ther sur MA2 avec les 3 methodes de projection :
#    -'ELEM'
#    -'NUAGE_DEG_0'
#    -'NUAGE_DEG_1'
#
#  On verifie que la temperature projetee au point (0.5, 0.5) est correcte.
#-------------------------------------------------------------------------------------

PRE_GIBI(UNITE_GIBI=19,UNITE_MAILLAGE=20)
MA1=LIRE_MAILLAGE(UNITE=20 )

PRE_GIBI(UNITE_GIBI=18,UNITE_MAILLAGE=21)
MA2=LIRE_MAILLAGE(UNITE=21 )


# Creation de l'evol_ther "analytique" (TEMP1):
#------------------------------------------------
LINST=DEFI_LIST_REEL( DEBUT=0.,INTERVALLE=  _F( JUSQU_A = 10.,   NOMBRE = 3))

TFONC = FORMULE(NOM_PARA=('X','Y','INST'),VALE=' INST*(1. + 2.*(X-0.5)**2 +3.*(Y-0.25)**2)')

CHFONC=CREA_CHAMP( OPERATION='AFFE', TYPE_CHAM='NOEU_TEMP_F', MAILLAGE=MA1,
              AFFE=_F(  TOUT = 'OUI', NOM_CMP = ('TEMP', ), VALE_F = (TFONC,)))

TEMP1=CREA_RESU(    OPERATION='AFFE', TYPE_RESU='EVOL_THER',  NOM_CHAM='TEMP',
                           AFFE=_F(  LIST_INST = LINST, CHAM_GD = CHFONC))

CHAREF=CREA_CHAMP(MAILLAGE=MA2, OPERATION='AFFE', TYPE_CHAM='NOEU_TEMP_R', INFO=1,
                    AFFE= _F(TOUT='OUI', NOM_CMP='TEMP', VALE=0.0))


# Validation de METHODE='ELEM' :
#--------------------------------
TEMP2=PROJ_CHAMP(RESULTAT=TEMP1,METHODE='ELEM',  MAILLAGE_1=MA1, MAILLAGE_2=MA2, NOM_CHAM='TEMP')
TEST_RESU( RESU=_F(RESULTAT = TEMP2,  NUME_ORDRE = 4, NOM_CHAM = 'TEMP', REFERENCE='ANALYTIQUE',
                   GROUP_NO='O1',NOM_CMP = 'TEMP', VALE = 11.87500 , PRECISION=1.5E-2 ))


# Validation de METHODE='NUAGE_DEG_0' :
#---------------------------------------
TEMP3=PROJ_CHAMP(RESULTAT=TEMP1,METHODE='NUAGE_DEG_0',  MAILLAGE_1=MA1, MAILLAGE_2=MA2, NOM_CHAM='TEMP',  CHAM_NO_REFE=CHAREF)
TEST_RESU( RESU=_F(RESULTAT = TEMP3,  NUME_ORDRE = 4, NOM_CHAM = 'TEMP', REFERENCE='ANALYTIQUE',
                   GROUP_NO='O1',NOM_CMP = 'TEMP', VALE = 11.87500 , PRECISION=1.5E-2 ))

# Validation de METHODE='NUAGE_DEG_1' :
#---------------------------------------
TEMP4=PROJ_CHAMP(RESULTAT=TEMP1,METHODE='NUAGE_DEG_1',  MAILLAGE_1=MA1, MAILLAGE_2=MA2, NOM_CHAM='TEMP',  CHAM_NO_REFE=CHAREF)
TEST_RESU( RESU=_F(RESULTAT = TEMP4,  NUME_ORDRE = 4, NOM_CHAM = 'TEMP', REFERENCE='ANALYTIQUE',
                   GROUP_NO='O1',NOM_CMP = 'TEMP', VALE = 11.87500 , PRECISION=1.5E-2 ))


#-------------------------------------------------------------------------------------------------------------------------------
# Validation de differents mots cles :
#-------------------------------------

# VIS_A_VIS/ TOUT_1/2 :
#----------------------
TEMP5=PROJ_CHAMP(RESULTAT=TEMP1,METHODE='ELEM',  MAILLAGE_1=MA1,MAILLAGE_2=MA2, NOM_CHAM='TEMP',
                 VIS_A_VIS=_F(TOUT_1='OUI',TOUT_2='OUI', CAS_FIGURE='2D'))
TEST_RESU( RESU=_F(RESULTAT = TEMP5,  NUME_ORDRE = 4, NOM_CHAM = 'TEMP', REFERENCE='ANALYTIQUE',
                   GROUP_NO='O1',NOM_CMP = 'TEMP', VALE = 11.87500 , PRECISION=1.5E-2 ))

TEMP6=PROJ_CHAMP(RESULTAT=TEMP1,METHODE='NUAGE_DEG_0',  MAILLAGE_1=MA1,MAILLAGE_2=MA2, NOM_CHAM='TEMP', CHAM_NO_REFE=CHAREF,
                 VIS_A_VIS=_F(TOUT_1='OUI',TOUT_2='OUI', CAS_FIGURE='2D'))
TEST_RESU( RESU=_F(RESULTAT = TEMP6,  NUME_ORDRE = 4, NOM_CHAM = 'TEMP', REFERENCE='ANALYTIQUE',
                   GROUP_NO='O1',NOM_CMP = 'TEMP', VALE = 11.87500 , PRECISION=1.5E-2 ))


# VIS_A_VIS/ GROUP_MA_1/2 :
#--------------------------
TEMP7=PROJ_CHAMP(RESULTAT=TEMP1,METHODE='ELEM',  MAILLAGE_1=MA1,MAILLAGE_2=MA2, NOM_CHAM='TEMP',
                 VIS_A_VIS=_F(GROUP_MA_1='ABCD',GROUP_MA_2='EFGH', CAS_FIGURE='2D'))
TEST_RESU( RESU=_F(RESULTAT = TEMP7,  NUME_ORDRE = 4, NOM_CHAM = 'TEMP', REFERENCE='ANALYTIQUE',
                   GROUP_NO='O1',NOM_CMP = 'TEMP', VALE = 11.87500 , PRECISION=1.5E-2 ))

TEMP8=PROJ_CHAMP(RESULTAT=TEMP1,METHODE='NUAGE_DEG_0',  MAILLAGE_1=MA1,MAILLAGE_2=MA2, NOM_CHAM='TEMP', CHAM_NO_REFE=CHAREF,
                 VIS_A_VIS=_F(GROUP_MA_1='ABCD',GROUP_MA_2='EFGH', CAS_FIGURE='2D'))
TEST_RESU( RESU=_F(RESULTAT = TEMP8,  NUME_ORDRE = 4, NOM_CHAM = 'TEMP', REFERENCE='ANALYTIQUE',
                   GROUP_NO='O1',NOM_CMP = 'TEMP', VALE = 11.87500 , PRECISION=1.5E-2 ))



# CHAM_NO isole + METHODE= 'ELEM' / 'NUAGE_DEG_0/1':
#-----------------------------------------------------
CHT1=CREA_CHAMP(OPERATION='EXTR', TYPE_CHAM='NOEU_TEMP_R', RESULTAT=TEMP1, NOM_CHAM = 'TEMP', NUME_ORDRE=4,)

CHT2=PROJ_CHAMP(CHAM_NO=CHT1,METHODE='ELEM',  MAILLAGE_1=MA1, MAILLAGE_2=MA2)
TEST_RESU(CHAM_NO=_F( CHAM_GD = CHT2, REFERENCE='ANALYTIQUE',
                   GROUP_NO='O1',NOM_CMP = 'TEMP', VALE = 11.87500 , PRECISION=1.5E-2 ))

CHT3=PROJ_CHAMP(CHAM_NO=CHT1,METHODE='NUAGE_DEG_0',  MAILLAGE_1=MA1, MAILLAGE_2=MA2, CHAM_NO_REFE=CHAREF)
TEST_RESU(CHAM_NO=_F( CHAM_GD = CHT3, REFERENCE='ANALYTIQUE',
                   GROUP_NO='O1',NOM_CMP = 'TEMP', VALE = 11.87500 , PRECISION=1.5E-2 ))

CHT4=PROJ_CHAMP(CHAM_NO=CHT1,METHODE='NUAGE_DEG_1',  MAILLAGE_1=MA1, MAILLAGE_2=MA2, CHAM_NO_REFE=CHAREF)
TEST_RESU(CHAM_NO=_F( CHAM_GD = CHT4, REFERENCE='ANALYTIQUE',
                   GROUP_NO='O1',NOM_CMP = 'TEMP', VALE = 11.87500 , PRECISION=1.5E-2 ))

FIN();
