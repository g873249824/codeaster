# TITRE CHAINAGE 3D CODE_SATURNE CODE_ASTER
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================


DEBUT(CODE=_F(NOM='ZZZZ215C', NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'),
      IGNORE_ALARM=('CALCULEL2_63','CALCULEL2_64','CALCULEL_26'))

# <CALCULEL2_63> : DANS UN MODELE, IL EXISTE DES ELEMENTS DE TYPE "BORD" QUI N'ONT PAS DE VOISIN AVEC RIGIDITE
# <CALCULEL2_64> : DANS UN MODELE, IL N'Y A AUCUN ELEMENT AVEC AVEC RIGIDITE
# <CALCULEL_26>  : LE MAILLAGE EST GROSSIER POUR QUE LE TEST SOIT PEU COUTEUX
#  LE MODELE PROVOQUANT CES ALARMES EST UN MODELE FLUIDE

# ==============================================================
# LECTURE DU RESULTAT DE PRESSION DE CODE_SATURNE
# ==============================================================

MAFLUIDE=LIRE_MAILLAGE(UNITE=22, FORMAT='MED',);

MOFLUIDE=AFFE_MODELE(MAILLAGE=MAFLUIDE,
                  AFFE=_F(TOUT='OUI',
                          PHENOMENE='MECANIQUE',
                          MODELISATION='3D',),);

RES_PRES=LIRE_RESU(TYPE_RESU='EVOL_CHAR',
                   FORMAT='MED',
                   MODELE=MOFLUIDE,
                   UNITE=22,
                   TOUT_ORDRE='OUI',
                   FORMAT_MED=_F(NOM_CHAM='PRES',
                                 NOM_CHAM_MED='Pression_interpolee',
                                 NOM_CMP='PRES',
                                 NOM_CMP_MED='x',),
                   );


# ==============================================================
# EXPLOITATION DE CET EVOL_CHAR DANS UN CALCUL MECANIQUE
#   - on projete la pression fluide sur le maillage mecanique
#   - on cree un evol_char utilise pour la resolution
# ==============================================================

MASOLIDE=LIRE_MAILLAGE(UNITE=23, FORMAT='MED',);

MOSOLIDE=AFFE_MODELE(MAILLAGE=MASOLIDE,
                  AFFE=_F(TOUT='OUI',
                          PHENOMENE='MECANIQUE',
                          MODELISATION='3D',),);

ACIER=DEFI_MATERIAU(ELAS=_F(E=1., NU=0.3,),);

MATER=AFFE_MATERIAU(MAILLAGE=MASOLIDE, AFFE=_F(TOUT='OUI',  MATER=ACIER,),);

RES_PROJ=PROJ_CHAMP(METHODE='COLLOCATION',  RESULTAT=RES_PRES, PROL_ZERO='OUI', INFO=2,
                    MODELE_1=MOFLUIDE,  MODELE_2=MOSOLIDE, TOUT_ORDRE='OUI',
                    VIS_A_VIS=_F(TOUT_1='OUI',  GROUP_MA_2=('Face1','Face3','Face5','Face6',),),
                    );

#IMPR_RESU(FORMAT='MED', UNITE=93, RESU=_F(RESULTAT=RES_PROJ,INST=1., GROUP_MA=('Face2','Face4','Face1','Face3','Face5','Face6',),),);


CHA_PROJ=AFFE_CHAR_MECA(MODELE=MOSOLIDE,
                        EVOL_CHAR=RES_PROJ,);

CHA_IMPO=AFFE_CHAR_MECA(MODELE=MOSOLIDE,
                      FACE_IMPO=_F(GROUP_MA='Face1',
                                   DX=0.0,
                                   DY=0.0,
                                   DZ=0.0,),);

L_INST=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=_F(JUSQU_A=1.0,
                                    NOMBRE=3,),);

RESU=STAT_NON_LINE(MODELE=MOSOLIDE,
                   CHAM_MATER=MATER,
                   EXCIT=(_F(CHARGE=CHA_IMPO,),
                          _F(CHARGE=CHA_PROJ,),),
                   COMP_INCR=_F(RELATION='ELAS',),
                   INCREMENT=_F(LIST_INST=L_INST,),
                   );
#IMPR_RESU(FORMAT='MED', UNITE=80, RESU=_F(RESULTAT=RESU,NOM_CHAM='DEPL',INST=1.,),);


# DU FAIT DES DIFFERENCES QUI APPARAISSENT LORS DE LA PROJECTION
# DU CHAMP DE PRESSION SUR DIFFERENTES ARCHITECTURES (UN NOEUD
# SUR L'ARETE DU CUBE PEUT ETRE PROJETE SUR UNE FACE OU UNE AUTRE)
# ON MET COMME VALEUR DE REFERENCE LA VALEUR OBTENUE SUR MACHINES
# 64 BITS

TEST_RESU(RESU=(_F(INST=1.0,
                   REFERENCE='NON_DEFINI',
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N134',
                   NOM_CMP='DX',
                   VALE_CALC= 1.92440035E+04,
                   VALE_REFE=1.9244003483487999E4,
                   PRECISION=0.029999999999999999,),
                _F(INST=1.0,
                   REFERENCE='NON_DEFINI',
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N134',
                   NOM_CMP='DY',
                   VALE_CALC=-1.29952149E+04,
                   VALE_REFE=-1.2995214902305001E4,
                   PRECISION=0.029999999999999999,),
                _F(INST=1.0,
                   REFERENCE='NON_DEFINI',
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N134',
                   NOM_CMP='DZ',
                   VALE_CALC= 3.91105232E+03,
                   VALE_REFE=3911.0523216041001,
                   PRECISION=0.029999999999999999,),
                ),
          )

FIN();
