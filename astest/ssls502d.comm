# person_in_charge: patrick.massin at edf.fr
# TITRE  : CYLINDRE ORTHOTROPE LONG SOUMIS A UNE LIGNE DE CHARGE
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#---------------------------------------------------------------------
#  - CALCUL QUASI-STATIQUE D'UN CYLINDRE LONG REPOSANT A SES
#    EXTREMITES SUR DES DIAPHRAGMES RIGIDES
#  - MODELISATION AVEC DES ELEMENTS 'DKT'(QUAD4) '
#---------------------------------------------------------------------

DEBUT(CODE=_F(NOM='SSLS502D',
NIV_PUB_WEB='INTERNET',),DEBUG=_F(SDVERI='OUI'))

MAIL=LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='OUI',),FORMAT='MED',);

MO=AFFE_MODELE(MAILLAGE=MAIL,
               AFFE=_F(TOUT='OUI',
                       PHENOMENE='MECANIQUE',
                       MODELISATION='DKT',),);

MAIL=DEFI_GROUP(reuse =MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=_F(GROUP_MA='CD',
                                 OPTION='NOEUD_ORDO',
                                 NOM='CD',
                                 GROUP_NO_ORIG='C',
                                 GROUP_NO_EXTR='D',),);

CAR_ELE=AFFE_CARA_ELEM(MODELE=MO,
                       COQUE=_F(GROUP_MA='TOUT_ELT',
                                EPAIS=0.0061,
                                ANGL_REP=(0.0,0.0,),),);

MAT=DEFI_MATERIAU(ELAS_COQUE=_F(MEMB_L=18692840.0,
                                MEMB_LT=6739280.0,
                                MEMB_T=113441700.0,
                                MEMB_G_LT=7625000.0,
                                FLEX_L=57.96338137,
                                FLEX_LT=20.89738407,
                                FLEX_T=351.7638047,
                                FLEX_G_LT=23.64385417,
                                CISA_L=10000000000.0,
                                CISA_T=10000000000.0,),);

CHAM_MAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                       AFFE=_F(TOUT='OUI',
                               MATER=MAT,),);

CHA=AFFE_CHAR_MECA(MODELE=MO,
                   DDL_IMPO=(_F(GROUP_MA='BA',
                                DX=0.0,
                                DZ=0.0,
                                DRY=0.0,),
                             _F(GROUP_MA=('AD','BC',),
                                DX=0.0,
                                DRY=0.0,
                                DRZ=0.0,),
                             _F(GROUP_MA='CD',
                                DY=0.0,
                                DRX=0.0,
                                DRZ=0.0,),),
                   FORCE_ARETE=_F(GROUP_MA='BC',
                                  FZ=-448.276,),);

RESU=MECA_STATIQUE(MODELE=MO,
                   CHAM_MATER=CHAM_MAT,
                   CARA_ELEM=CAR_ELE,
                   EXCIT=_F(CHARGE=CHA,),);

RESU=CALC_CHAMP(reuse=RESU,RESULTAT=RESU,CONTRAINTE=('SIGM_ELNO'))


RESU2=POST_CHAMP(RESULTAT=RESU,
                 EXTR_COQUE=_F(NOM_CHAM='SIGM_ELNO',
                               NUME_COUCHE=1,
                               NIVE_COUCHE='SUP',),);
DEP_DZ=POST_RELEVE_T(ACTION=_F(INTITULE='TAB_DZ ',
                               GROUP_NO='CD',
                               RESULTAT=RESU,
                               NOM_CHAM='DEPL',
                               NOM_CMP='DZ',
                               OPERATION='EXTRACTION',),);

DEP_NORM=POST_RELEVE_T(ACTION=_F(INTITULE='TAB_NORM',
                                 GROUP_NO='CD',
                                 RESULTAT=RESU,
                                 NOM_CHAM='DEPL',
                                 NOM_CMP=('DX','DY','DZ',),
                                 REPERE='CYLINDRIQUE',
                                 ORIGINE=(0.0,0.0,0.0,),
                                 AXE_Z=(0.0,1.0,0.0,),
                                 OPERATION='EXTRACTION',),);

SIGMA=POST_RELEVE_T(ACTION=_F(INTITULE='TAB_SIGM ',
                              GROUP_NO='CD',
                              RESULTAT=RESU2,
                              NOM_CHAM='SIGM_ELNO',
                              TOUT_CMP='OUI',
                              OPERATION='EXTRACTION',),);

DEPZ=RECU_FONCTION(TABLE=DEP_DZ,
                   PARA_X='ABSC_CURV',
                   PARA_Y='DZ',);

DEPNOR=RECU_FONCTION(TABLE=DEP_NORM,
                     PARA_X='ABSC_CURV',
                     PARA_Y='DX',);

SIGX=RECU_FONCTION(TABLE=SIGMA,
                   PARA_X='ABSC_CURV',
                   PARA_Y='SIXX',);

SIGY=RECU_FONCTION(TABLE=SIGMA,
                   PARA_X='ABSC_CURV',
                   PARA_Y='SIYY',);

IMPR_FONCTION(
            FORMAT='AGRAF',
            TITRE='dep_norm fonction de abscisse curviligne',
            COURBE=(_F(FONCTION=DEPZ,),
                    _F(FONCTION=DEPNOR,),),);

IMPR_FONCTION(UNITE=27, UNITE_DIGR=28,
            FORMAT='AGRAF',
            TITRE='sigma XX fonction de abscisse curviligne',
            COURBE=_F(FONCTION=SIGX,),);

IMPR_FONCTION(UNITE=29, UNITE_DIGR=30,
            FORMAT='AGRAF',
            TITRE='sigma YY fonction de abscisse curviligne',
            COURBE=_F(FONCTION=SIGY,),);


IMPR_TABLE(TABLE=SIGMA,
           NOM_PARA=('NOEUD','SIXX','SIYY',),);
#
#---------------------------------------------------------------------
#          TEST REFERENCE EXPERIMENTALE
#---------------------------------------------------------------------

TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   GROUP_NO='F',
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DX',
                   VALE_CALC=1.32983654E-03,
                   VALE_REFE=1.35E-3,
                   PRECISION=0.05,),
                _F(NUME_ORDRE=1,
                   GROUP_NO='C',
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DZ',
                   VALE_CALC=-2.36977986E-03,
                   VALE_REFE=-2.46E-3,
                   PRECISION=0.05,),
                _F(NUME_ORDRE=1,
                   GROUP_NO='D',
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DZ',
                   VALE_CALC= 5.28532977E-04,
                   VALE_REFE=3.5E-4,
                   PRECISION=0.52,),
                ),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='F',
                  REFERENCE='SOURCE_EXTERNE',
                  RESULTAT=RESU2,
                  NOM_CHAM='SIGM_ELNO',
                  NOM_CMP='SIXX',
                  VALE_CALC= 1.79115065E+06,
                  VALE_REFE=1.900000E6,
                  PRECISION=0.15,
                  MAILLE='M184',),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='F',
                  REFERENCE='SOURCE_EXTERNE',
                  RESULTAT=RESU2,
                  NOM_CHAM='SIGM_ELNO',
                  NOM_CMP='SIYY',
                  VALE_CALC= 1.84436484E+06,
                  VALE_REFE=1.550000E6,
                  PRECISION=0.2,
                  MAILLE='M184',),
          )

#
#---------------------------------------------------------------------
#          TEST REFERENCE BATOZ
#---------------------------------------------------------------------

TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   GROUP_NO='F',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DX',
                   VALE_CALC= 1.32983654E-03,
                   VALE_REFE=1.325E-3,
                   PRECISION=0.1,),
                _F(NUME_ORDRE=1,
                   GROUP_NO='C',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DZ',
                   VALE_CALC=-2.36977986E-03,
                   VALE_REFE=-2.45E-3,
                   PRECISION=0.05,),
                _F(NUME_ORDRE=1,
                   GROUP_NO='D',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DZ',
                   VALE_CALC= 5.28532977E-04,
                   VALE_REFE=5.1E-4,
                   PRECISION=0.5,),
                ),
          )

#
#---------------------------------------------------------------------
#              TEST SIGMA
#---------------------------------------------------------------------

TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   GROUP_NO='F',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=RESU2,
                   NOM_CHAM='SIGM_ELNO',
                   NOM_CMP='SIXX',
                   VALE_CALC= 1.79115065E+06,
                   VALE_REFE=1.68E6,
                   PRECISION=0.1,
                   MAILLE='M184',),
                _F(NUME_ORDRE=1,
                   GROUP_NO='F',
                   REFERENCE='ANALYTIQUE',
                   RESULTAT=RESU2,
                   NOM_CHAM='SIGM_ELNO',
                   NOM_CMP='SIYY',
                   VALE_CALC=1.84436484E+06,
                   VALE_REFE=1.80E6,
                   PRECISION=0.1,
                   MAILLE='M184',),
                ),
          )

#------------------------------------------------------------------------------------------
# validation de POST_CHAMP / EXTR_COQUE :
#----------------------------------------
RESU=CALC_CHAMP(reuse =RESU, RESULTAT=RESU,  CONTRAINTE='SIGM_ELGA')

RESU3=POST_CHAMP(RESULTAT=RESU,
               EXTR_COQUE =_F(NOM_CHAM='SIGM_ELGA', NUME_COUCHE=1, NIVE_COUCHE='SUP',),);
TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  POINT=2,
                  SOUS_POINT=3,
                  RESULTAT=RESU,
                  NOM_CHAM='SIGM_ELGA',
                  NOM_CMP='SIXX',
                  VALE_CALC=1.8199294623515999E6,
                  MAILLE='M184',),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  REFERENCE='AUTRE_ASTER',
                  POINT=2,
                  RESULTAT=RESU3,
                  NOM_CHAM='SIGM_ELGA',
                  NOM_CMP='SIXX',
                  VALE_CALC=1.8199294624E+06,
                  VALE_REFE=1.8199294623515999E6,
                  PRECISION=1.E-10,
                  MAILLE='M184',),
          )

#-----------------------------------------------------------------------------------------
FIN();
