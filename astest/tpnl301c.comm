# TITRE THERMO-HYDRATATION D'UN CYLINDRE DE BETON AXIS AXIS_DIAG QUA4 TRIA3
# ======================================================================
# COPYRIGHT (C) 1991 - 2015  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# CAS TEST TPNL301C
# person_in_charge: jessica.haelewyn at edf.fr

DEBUT(CODE=_F(
              NIV_PUB_WEB='INTERNET',),
      DEBUG=_F(SDVERI='OUI',),);

MAILTH=LIRE_MAILLAGE(FORMAT='MED',);

MODELETH=AFFE_MODELE(MAILLAGE=MAILTH,
                     AFFE=_F(TOUT='OUI',
                             PHENOMENE='THERMIQUE',
                             MODELISATION='AXIS',),);

MODDIAG=AFFE_MODELE(MAILLAGE=MAILTH,
                    AFFE=_F(TOUT='OUI',
                            PHENOMENE='THERMIQUE',
                            MODELISATION='AXIS_DIAG',),);

#------------------------------------------------------------------
# Definition des constantes materiaux
#------------------------------------------------------------------
# Le beton
# CONDUCTION EN KJ/H/M/K

COND=DEFI_FONCTION(NOM_PARA='TEMP',VALE=(0.,6.,
                         300.,6.,
                         ),PROL_DROITE='LINEAIRE',PROL_GAUCHE='LINEAIRE',);


# DEFINITION DE L'AFFINITE FONCTION DU DEGRE D'HYDRATATION
Ar = 4700;

TZ0 = 273.15;


AA = FORMULE(VALE='exp(-Ar/(TZ0+TEMP))*(1586000*HYDR*HYDR*HYDR*HYDR*HYDR-5224000*HYDR*HYDR*HYDR*HYDR+6432000*HYDR*HYDR*HYDR-3530500*HYDR*HYDR+730000*HYDR+6510)',
             NOM_PARA=('HYDR','TEMP',),);

LL=DEFI_LIST_REEL(DEBUT=0.0,
                  INTERVALLE=_F(JUSQU_A=1.0,
                                PAS=0.002,),);

LT=DEFI_LIST_REEL(DEBUT=0.0,
                  INTERVALLE=_F(JUSQU_A=100.0,
                                PAS=0.1,),);

AFF=CALC_FONC_INTERP(FONCTION=AA,
                     LIST_PARA=LL,
                     NOM_RESU='AFF',
                     NOM_PARA='HYDR',
                     PROL_DROITE='CONSTANT',
                     PROL_GAUCHE='EXCLU',
                     NOM_PARA_FONC='TEMP',
                     LIST_PARA_FONC=LT,
                     PROL_DROITE_FONC='LINEAIRE',
                     PROL_GAUCHE_FONC='LINEAIRE',);

# ENTHALPIE EN KJ/H/M

ENTH=DEFI_FONCTION(NOM_PARA='TEMP',VALE=(0.,0.,
                         10.0,24000.0,
                         ),PROL_DROITE='LINEAIRE',PROL_GAUCHE='LINEAIRE',);

BETON=DEFI_MATERIAU(THER_HYDR=_F(LAMBDA=COND,
                                 BETA=ENTH,
                                 AFFINITE=AFF,
                                 CHALHYDR=1.4904e5,),);
BETON_NL=DEFI_MATERIAU(THER_NL=_F(LAMBDA=COND,
                                 BETA=ENTH,
                                 ),);

# -------------------------------------------------
#   Definition des temps caracteristiques
# ------------------------------------------------
#temps 1 jour
tps_1j = 24.0;


#temps 5 jours
tps_5j = (5.0 * tps_1j);


#temps 1 an
tps_1an = (365.25 * tps_1j);

tps_10an = (10 * tps_1an);


#temps 1 mois
tps_1m = (tps_1an / 12.0);


#temps 10 mois
tps_10m = (10.0 * tps_1m);

t50h = 50;

t730h = 730;


# -------------------------------------------------
#   Definition des listes d'instants
# ------------------------------------------------

LINIT=DEFI_LIST_REEL(DEBUT=-10.0,
                     INTERVALLE=_F(JUSQU_A=0.0,
                                   NOMBRE=2,),);

LINST=DEFI_LIST_REEL(DEBUT=-1.0,
                     INTERVALLE=(_F(JUSQU_A=0.0,
                                    NOMBRE=1,),
                                 _F(JUSQU_A=300,
                                    PAS=2,),
                                 _F(JUSQU_A=t730h,
                                    PAS=10,),),);

# ---------------------------------------------------------------------------------
#   Calcul Hydrique
# ---------------------------------------------------------------------------------
#Champ de temperature

CHMATTH=AFFE_MATERIAU(MAILLAGE=MAILTH,
                      AFFE=_F(TOUT='OUI',
                              MATER=BETON,),);
CHMAT_NL=AFFE_MATERIAU(MAILLAGE=MAILTH,
                      AFFE=_F(TOUT='OUI',
                              MATER=BETON_NL,),);

TEMP_INT=DEFI_FONCTION(NOM_PARA='INST',VALE=(-1000.0,40.0,
                             tps_10an,40.0,
                             ),PROL_DROITE='CONSTANT',PROL_GAUCHE='CONSTANT',);

TEMP_EXT=DEFI_FONCTION(NOM_PARA='INST',VALE=(-1000.0,15.0,
                             tps_10an,15.0,
                             ),PROL_DROITE='CONSTANT',PROL_GAUCHE='CONSTANT',);

CL_THER=AFFE_CHAR_THER_F(MODELE=MODELETH,
                         TEMP_IMPO=(_F(GROUP_NO='SEXTERI',
                                       TEMP=TEMP_EXT,),
                                    _F(GROUP_NO='SINTERI',
                                       TEMP=TEMP_INT,),),);

CHARDIAG=AFFE_CHAR_THER_F(MODELE=MODDIAG,
                          TEMP_IMPO=(_F(GROUP_NO='SEXTERI',
                                        TEMP=TEMP_EXT,),
                                     _F(GROUP_NO='SINTERI',
                                        TEMP=TEMP_INT,),),);
Ti = 40.0;

Te = 15.0;

Re = 21.0;

Ri = 20.0;



line=DEFI_MATERIAU(THER=_F(LAMBDA=6.0,
                           RHO_CP=2400.0,),);

matline=AFFE_MATERIAU(MAILLAGE=MAILTH,
                      AFFE=_F(TOUT='OUI',
                              MATER=line,),);

THINI=THER_NON_LINE(MODELE=MODELETH,
                    CHAM_MATER=CHMAT_NL,
                    EXCIT=_F(CHARGE=CL_THER,),
                    INCREMENT=_F(LIST_INST=LINIT,),
                    ETAT_INIT=_F(STATIONNAIRE='OUI',),);

TINIDIAG=THER_NON_LINE(MODELE=MODDIAG,
                       CHAM_MATER=CHMAT_NL,
                       EXCIT=_F(CHARGE=CHARDIAG,),
                       INCREMENT=_F(LIST_INST=LINIT,),
                       ETAT_INIT=_F(STATIONNAIRE='OUI',),);

RESUTHER=THER_NON_LINE(MODELE=MODELETH,
                       CHAM_MATER=CHMATTH,
                       COMPORTEMENT=_F(RELATION='THER_HYDR',),
                       EXCIT=_F(CHARGE=CL_THER,),
                       INCREMENT=_F(LIST_INST=LINST,),
                       ETAT_INIT=_F(EVOL_THER=THINI,),);

RESUDIAG=THER_NON_LINE(MODELE=MODDIAG,
                       CHAM_MATER=CHMATTH,
                       COMPORTEMENT=_F(RELATION='THER_HYDR',),
                       EXCIT=_F(CHARGE=CHARDIAG,),
                       INCREMENT=_F(LIST_INST=LINST,),
                       ETAT_INIT=_F(EVOL_THER=THINI,),);

TT=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                           INTITULE='TT',
                           RESULTAT=RESUTHER,
                           NOM_CHAM='TEMP',
                           GROUP_NO='X205',
                           TOUT_CMP='OUI',),);

TTDIAG=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                               INTITULE='TTDIAG',
                               RESULTAT=RESUDIAG,
                               NOM_CHAM='TEMP',
                               GROUP_NO='X205',
                               TOUT_CMP='OUI',),);

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.02,
           VALE_CALC=48.362209713,
           VALE_REFE=48.8675,
           NOM_PARA='TEMP',
           TYPE_TEST='MAX',
           TABLE=TT,)

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.025000000000000001,
           VALE_CALC=47.902082180,
           VALE_REFE=48.8675,
           NOM_PARA='TEMP',
           TYPE_TEST='MAX',
           TABLE=TTDIAG,)

#Tests de non-regression (version 10.1)

TEST_TABLE(
           VALE_CALC=48.362209713499539,
           NOM_PARA='TEMP',
           TYPE_TEST='MAX',
           TABLE=TT,
           )

TEST_TABLE(
           VALE_CALC=47.902082179632913,
           NOM_PARA='TEMP',
           TYPE_TEST='MAX',
           TABLE=TTDIAG,
           )

TM1=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
               OPERATION='EXTR',
               RESULTAT=THINI,
               NOM_CHAM='TEMP',
               INST=0.0,);

TM1D=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
                OPERATION='EXTR',
                RESULTAT=TINIDIAG,
                NOM_CHAM='TEMP',
                INST=0.0,);

T5j=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
               OPERATION='EXTR',
               RESULTAT=RESUTHER,
               NOM_CHAM='TEMP',
               INST=t50h,);

T5JD=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
                OPERATION='EXTR',
                RESULTAT=RESUDIAG,
                NOM_CHAM='TEMP',
                INST=t50h,);

T1m=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
               OPERATION='EXTR',
               RESULTAT=RESUTHER,
               NOM_CHAM='TEMP',
               INST=t730h,);

T1MD=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
                OPERATION='EXTR',
                RESULTAT=RESUDIAG,
                NOM_CHAM='TEMP',
                INST=t730h,);

TEST_RESU(CHAM_NO=(_F(REFERENCE='ANALYTIQUE',
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      PRECISION=1.E-2,
                      CHAM_GD=TM1,
                      VALE_CALC=27.347548953,
                      VALE_REFE=27.3475,),
                   _F(REFERENCE='ANALYTIQUE',
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      PRECISION=1.E-2,
                      CHAM_GD=TM1D,
                      VALE_CALC=27.347548953,
                      VALE_REFE=27.3475,),
                   _F(REFERENCE='ANALYTIQUE',
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      PRECISION=1.E-2,
                      CHAM_GD=T5j,
                      VALE_CALC=48.362209713,
                      VALE_REFE=48.709099999999999,),
                   _F(REFERENCE='ANALYTIQUE',
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      PRECISION=0.02,
                      CHAM_GD=T5JD,
                      VALE_CALC=47.822310644,
                      VALE_REFE=48.709099999999999,),
                   _F(REFERENCE='ANALYTIQUE',
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      PRECISION=1.E-2,
                      CHAM_GD=T1m,
                      VALE_CALC=27.652608579,
                      VALE_REFE=27.711600000000001,),
                   _F(REFERENCE='ANALYTIQUE',
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      PRECISION=1.E-2,
                      CHAM_GD=T1MD,
                      VALE_CALC=27.652446423,
                      VALE_REFE=27.711600000000001,),
                   ),
          )

#Tests non-regression (version 10.1)

TEST_RESU(CHAM_NO=(_F(
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      CHAM_GD=TM1,
                      VALE_CALC=27.347548952638579,),
                   _F(
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      CHAM_GD=TM1D,
                      VALE_CALC=27.347548952638569,),
                   _F(
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      CHAM_GD=T5j,
                      VALE_CALC=48.362209713499539,),
                   _F(
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      CHAM_GD=T5JD,
                      VALE_CALC=47.822310644478399,),
                   _F(
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      CHAM_GD=T1m,
                      VALE_CALC=27.652608579475011,),
                   _F(
                      NOM_CMP='TEMP',
                      GROUP_NO='X205',
                      CHAM_GD=T1MD,
                      VALE_CALC=27.652446423184578,),
                   ),
          )

RESUTHER=CALC_CHAMP(reuse =RESUTHER,
                    RESULTAT=RESUTHER,
                    THERMIQUE='HYDR_NOEU',);

RESUDIAG=CALC_CHAMP(reuse =RESUDIAG,
                    RESULTAT=RESUDIAG,
                    THERMIQUE='HYDR_NOEU',);

H49h=CREA_CHAMP(TYPE_CHAM='NOEU_HYDR_R',
                OPERATION='EXTR',
                RESULTAT=RESUTHER,
                NOM_CHAM='HYDR_NOEU',
                INST=t50h,);

H49D=CREA_CHAMP(TYPE_CHAM='NOEU_HYDR_R',
                OPERATION='EXTR',
                RESULTAT=RESUDIAG,
                NOM_CHAM='HYDR_NOEU',
                INST=t50h,);

H730h=CREA_CHAMP(TYPE_CHAM='NOEU_HYDR_R',
                 OPERATION='EXTR',
                 RESULTAT=RESUTHER,
                 NOM_CHAM='HYDR_NOEU',
                 INST=t730h,);

H730D=CREA_CHAMP(TYPE_CHAM='NOEU_HYDR_R',
                 OPERATION='EXTR',
                 RESULTAT=RESUDIAG,
                 NOM_CHAM='HYDR_NOEU',
                 INST=t730h,);

TEST_RESU(CHAM_NO=(_F(REFERENCE='ANALYTIQUE',
                      NOM_CMP='HYDR',
                      GROUP_NO='X205',
                      PRECISION=0.029999999999999999,
                      CHAM_GD=H49h,
                      VALE_CALC=0.491674478,
                      VALE_REFE=0.4778,),
                   _F(REFERENCE='ANALYTIQUE',
                      NOM_CMP='HYDR',
                      GROUP_NO='X205',
                      PRECISION=0.02,
                      CHAM_GD=H49D,
                      VALE_CALC=0.485218678,
                      VALE_REFE=0.4778,),
                   _F(REFERENCE='ANALYTIQUE',
                      NOM_CMP='HYDR',
                      GROUP_NO='X205',
                      PRECISION=1.E-2,
                      CHAM_GD=H730D,
                      VALE_CALC=0.957998485,
                      VALE_REFE=0.95579999999999998,),
                   _F(REFERENCE='ANALYTIQUE',
                      NOM_CMP='HYDR',
                      GROUP_NO='X205',
                      PRECISION=1.E-2,
                      CHAM_GD=H730h,
                      VALE_CALC=0.957014160,
                      VALE_REFE=0.95579999999999998,),
                   ),
          )

#Tests non-regression (version 10.1)

TEST_RESU(CHAM_NO=(_F(
                      NOM_CMP='HYDR',
                      GROUP_NO='X205',
                      CHAM_GD=H49h,
                      VALE_CALC=0.49167447825994842,),
                   _F(
                      NOM_CMP='HYDR',
                      GROUP_NO='X205',
                      CHAM_GD=H49D,
                      VALE_CALC=0.48521867759309878,),
                   _F(
                      NOM_CMP='HYDR',
                      GROUP_NO='X205',
                      CHAM_GD=H730D,
                      VALE_CALC=0.95799848507143337,),
                   _F(
                      NOM_CMP='HYDR',
                      GROUP_NO='X205',
                      CHAM_GD=H730h,
                      VALE_CALC=0.95701415957441183,),
                   ),
          )

FIN();
