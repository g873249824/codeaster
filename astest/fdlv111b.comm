# MODIF  DATE 04/04/2007   AUTEUR ABBAS M.ABBAS 
# TITRE ABSORPTION D'UNE ONDE DE PRESSION DANS UNE COLONNE FLUIDE
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
# (AT YOUR OPTION) ANY LATER VERSION.                                 
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
# ======================================================================
# CAS_TEST__: FDLV111B
#
# PROPAGATION D'UNE ONDE DE COMPRESSION DANS UNE COLONNE FLUIDE
# INFINIE - ABSORPTION DE L'ONDE A LA FRONTIERE DU MAILLAGE 
# ELEMENTS FINIS
# CAS 2D
#=======================================================================

DEBUT(CODE=_F( NOM = 'FDLV111B',NIV_PUB_WEB='INTERNET'))

MAIL=LIRE_MAILLAGE( )

MAIL=DEFI_GROUP( reuse=MAIL,   MAILLAGE=MAIL,
                       CREA_GROUP_NO=_F(  GROUP_MA = 'IFLUSOL')
                     )

MAIL=DEFI_GROUP( reuse=MAIL,   MAILLAGE=MAIL,
                       CREA_GROUP_NO=_F(  GROUP_MA = 'IPRES')
                     )

MAIL=DEFI_GROUP( reuse=MAIL,   MAILLAGE=MAIL,
                       CREA_GROUP_NO=_F(  GROUP_MA = 'STRU')
                     )

EAU=DEFI_MATERIAU( FLUIDE=_F( RHO = 1000.,  CELE_R = 1500.))

MAT1=DEFI_MATERIAU( ELAS=_F(  E = 3.6E+10, RHO = 2400.,  NU = 0.2)
                    )

MODELE=AFFE_MODELE(    MAILLAGE=MAIL,AFFE=(
                         _F(  GROUP_MA = 'FLUIDE',
                                PHENOMENE = 'MECANIQUE',
                                MODELISATION = '2D_FLUIDE'),
                         _F(  GROUP_MA = 'IFLUSOL',
                                PHENOMENE = 'MECANIQUE',
                                MODELISATION = '2D_FLUI_STRU'),
                         _F(  GROUP_MA = 'FOND',
                                PHENOMENE = 'MECANIQUE',
                                MODELISATION = '2D_FLUI_ABSO'),
                         _F(  GROUP_MA = 'IPRES',
                                PHENOMENE = 'MECANIQUE',
                                MODELISATION = '2D_FLUI_STRU'),
                           _F( GROUP_MA = 'STRU',
                                 PHENOMENE = 'MECANIQUE',
                                 MODELISATION = 'D_PLAN'))
                        )

CHAMPMAT=AFFE_MATERIAU(    MAILLAGE=MAIL,AFFE=(
                   _F(  GROUP_MA = ( 'FLUIDE', 'IFLUSOL',
                                       'FOND', 'IPRES', ),
                          MATER = EAU),
                   _F(  GROUP_MA = 'STRU',
                          MATER = MAT1))
                           )

COND_LIM=AFFE_CHAR_MECA(    MODELE=MODELE,DDL_IMPO=(
                   _F(  GROUP_NO = 'IFLUSOL',
                               DX = 0., DY = 0.),
                   _F(  GROUP_NO = 'IPRES',
                              DX = -1.E-3))
                             )

RIGI_ELE=CALC_MATR_ELEM(    MODELE=MODELE,
                              OPTION='RIGI_MECA',
                              CHAM_MATER=CHAMPMAT,
                              CHARGE=COND_LIM
                            )

MASS_ELE=CALC_MATR_ELEM(    MODELE=MODELE,
                              OPTION='MASS_MECA',
                              CHAM_MATER=CHAMPMAT,
                              CHARGE=COND_LIM
                            )

VECTELEM=CALC_VECT_ELEM(    OPTION='CHAR_MECA',
                              CHAM_MATER=CHAMPMAT,
                              CHARGE=COND_LIM
                            )

NUME_DDL=NUME_DDL(    MATR_RIGI=RIGI_ELE )
#METHODE : 'LDLT');

RIGIDITE=ASSE_MATRICE(    MATR_ELEM=RIGI_ELE,
                            NUME_DDL=NUME_DDL
                          )

MASSE=ASSE_MATRICE(    MATR_ELEM=MASS_ELE,
                         NUME_DDL=NUME_DDL
                       )

VECTASS=ASSE_VECTEUR(    VECT_ELEM=VECTELEM,
                           NUME_DDL=NUME_DDL
                         )

# --- LECTURE DE LA FONCTION D'EXCITATION ---
INCLUDE(   UNITE=11,   INFO=1 )

TEMPLI=DEFI_LIST_REEL(DEBUT=0., INTERVALLE=_F( JUSQU_A = 4., NOMBRE = 4000))

INTLI=DEFI_LIST_ENTI( DEBUT=1, INTERVALLE=_F( JUSQU_A = 4001, PAS = 1))

DYN=DYNA_LINE_TRAN(    MATR_MASS=MASSE,   MATR_RIGI=RIGIDITE,
                          EXCIT=_F(  VECT_ASSE = VECTASS,
                                  FONC_MULT = FONC),
                     #    ETAT_INIT=_F(  INST_INIT = 0.),
                         INCREMENT=_F( LIST_INST = TEMPLI),
                        ARCHIVAGE=_F(  LIST_ARCH = INTLI),
                          NEWMARK=_F() 
                        )

PN10=RECU_FONCTION(    LIST_INST=TEMPLI,   PRECISION=1.E-4,
                        RESULTAT=DYN,   NOEUD='N10',
                        NOM_CHAM='DEPL',
                        NOM_CMP='PRES'
                      )

PN7=RECU_FONCTION(    LIST_INST=TEMPLI,   PRECISION=1.E-4,
                        RESULTAT=DYN,   NOEUD='N7',
                        NOM_CHAM='DEPL',
                        NOM_CMP='PRES'
                      )

TEST_FONCTION(VALEUR=(   _F( 
                   FONCTION = PN10,
                   VALE_PARA = 3.86000E-01,
                   VALE_REFE = 4.88962E+03,
                   CRITERE = 'RELATIF',
                   PRECISION = 1.E-3,
                   REFERENCE = 'NON_REGRESSION'),
                  _F( 
                   FONCTION = PN10,
                   VALE_PARA = 6.37000E-01,
                   VALE_REFE = -4.93961E+03,
                   CRITERE = 'RELATIF',
                   PRECISION = 1.E-3,
                   REFERENCE = 'NON_REGRESSION'),
                  _F( 
                   FONCTION = PN10,
                   VALE_PARA = 1.15600E+00,
                   VALE_REFE = 0.E0,
                   CRITERE = 'ABSOLU',
                   PRECISION = 1.E0,
                   REFERENCE = 'ANALYTIQUE'))
                )

TEST_FONCTION(   VALEUR=_F( 
                   FONCTION = PN7,
                   VALE_PARA = 3.86000E-01,
                   VALE_REFE = 4.89074E+03,
                   CRITERE = 'RELATIF',
                   PRECISION = 1.E-3)
                )

TEMLI=DEFI_LIST_REEL(DEBUT=0., INTERVALLE=_F( JUSQU_A = 1.1, NOMBRE = 1100))

TEMLI2=DEFI_LIST_REEL(DEBUT=0.001, 
        INTERVALLE=_F( JUSQU_A = 1.1, NOMBRE = 1099))

INLI=DEFI_LIST_ENTI( DEBUT=1, INTERVALLE=_F( JUSQU_A = 1101, PAS = 1))

DYNA=DYNA_NON_LINE(     MODELE=MODELE,   CHAM_MATER=CHAMPMAT,
                          EXCIT=_F(  CHARGE = COND_LIM,
                                  FONC_MULT = FONC),
                       #  ETAT_INIT=_F(  INST_INIT = 0.),
                          COMP_INCR=_F( RELATION = 'ELAS',
                                  TOUT = 'OUI'),
                         SOLVEUR=_F( STOP_SINGULIER = 'NON',
                                  METHODE = 'LDLT'),
                         NEWTON=_F(  MATRICE = 'ELASTIQUE', 
                                 REAC_INCR = 0,
                                 REAC_ITER = 0),
                         CONVERGENCE=_F(  RESI_GLOB_RELA = 1.E-6,
                             ITER_GLOB_MAXI = 20),
                         INCREMENT=_F( LIST_INST = TEMLI),
###CDURAND###            ARCHIVAGE=_F( LIST_ARCH = INLI),
                         SCHEMA_TEMPS=_F(SCHEMA='NEWMARK',
                                FORMULATION='DEPLACEMENT',),
                        )

PNA10=RECU_FONCTION(    LIST_INST=TEMLI2,   PRECISION=1.E-4,
                        RESULTAT=DYNA,   NOEUD='N10',
                        NOM_CHAM='DEPL',
                        NOM_CMP='PRES'
                      )

PNA7=RECU_FONCTION(    LIST_INST=TEMLI2,   PRECISION=1.E-4,
                        RESULTAT=DYNA,   NOEUD='N7',
                        NOM_CHAM='DEPL',
                        NOM_CMP='PRES'
                      )

TEST_FONCTION(VALEUR=(   _F( 
                   FONCTION = PNA10,
                   VALE_PARA = 3.84000E-01,
                   VALE_REFE = 4.87451E+03,
                   CRITERE = 'RELATIF',
                   PRECISION = 3.E-3,
                   REFERENCE = 'NON_REGRESSION'),
                  _F( 
                   FONCTION = PNA10,
                   VALE_PARA = 6.44000E-01,
                   VALE_REFE = -4.88583E+03,
                   CRITERE = 'RELATIF',
                   PRECISION = 8.E-3,
                   REFERENCE = 'NON_REGRESSION'),
                  _F( 
                   FONCTION = PNA10,
                   VALE_PARA = 1.10000E+00,
                   VALE_REFE = 0.E0,
                   CRITERE = 'ABSOLU',
                   PRECISION = 5.E1,
                   REFERENCE = 'ANALYTIQUE'))
                )

TEST_FONCTION(   VALEUR=_F( 
                   FONCTION = PN7,
                   VALE_PARA = 3.84000E-01,
                   VALE_REFE = 4.88877E+03,
                   CRITERE = 'RELATIF',
                   PRECISION = 1.E-3,
                   REFERENCE = 'NON_REGRESSION')
                )

FIN()
#
