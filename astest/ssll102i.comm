# MODIF  DATE 15/10/2012   AUTEUR COURTOIS M.COURTOIS 
# TITRE POUTRE DROITE APPUYEE EN SES DEUX EXTREMITES SOUMISE A UN
# ssll102i.para = tps_job 60 mem_job 512Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# CHARGEMENT REPARTI LINEAIRE.REFERENCE ANALYTIQUE
# CALCUL DE LA FLECHE, DE L'EFFORT TRANCHANT, DU MOMENT DE FLEXION ET
# DE LA CONTRAINTE MAXIMALE ASSOCIEE.
# MODELISATION TUYAU
#======================================================================
#
DEBUT(CODE=_F(NOM='SSLL102I',NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

#

M1=LIRE_MAILLAGE()


MA=CREA_MAILLAGE(     MAILLAGE=M1,
       MODI_MAILLE=_F(  OPTION = 'SEG3_4', TOUT = 'OUI')
)
MA=DEFI_GROUP( reuse=MA,   MAILLAGE=MA,
  CREA_GROUP_MA=_F(  NOM = 'TOUT', TOUT = 'OUI'))

MO=AFFE_MODELE(        MAILLAGE=MA,
  AFFE=_F( TOUT = 'OUI', PHENOMENE = 'MECANIQUE', MODELISATION = 'TUYAU_3M')
                        )
#
MATR=DEFI_MATERIAU(    ELAS=_F( E = 2.E11,
                               NU = 0.3)
                     )

#
CHMAT=AFFE_MATERIAU(    MAILLAGE=MA,
                              AFFE=_F( TOUT = 'OUI',
                                    MATER = MATR)
                        )

#
CAREL=AFFE_CARA_ELEM(    MODELE=MO,INFO=2,
ORIENTATION=_F( GROUP_NO = 'P1', CARA = 'GENE_TUYAU', VALE = (0., 0., -1.,), ),
                           POUTRE=_F(
       GROUP_MA = 'TOUT',

                                    SECTION = 'CERCLE',
                                    CARA = ('R',  'EP',),
                                    VALE = ( 0.100,0.01,
                                              ))
                       )

#
F1=DEFI_FONCTION(    NOM_PARA='X',
                           VALE=(0.,  0.,
                                 6.,  6000.,
                                ),
                       INTERPOL='LIN'
                   )

#
CHARG1=AFFE_CHAR_MECA(      MODELE=MO,DDL_IMPO=(
                            _F( GROUP_NO = 'P1',
                                      DX = 0.,
                                      DY = 0.,
                                      DZ = 0.,
                                      DRX = 0.,
                                      DRY = 0.),
                            _F( GROUP_NO = 'P11',
                                      DY = 0.))
                        )

#
CHARG2=AFFE_CHAR_MECA_F(          MODELE=MO,
                              FORCE_POUTRE=_F(
       GROUP_MA = 'TOUT',

                                            FY = F1)
                          )

LINST=DEFI_LIST_REEL(DEBUT=0.0, INTERVALLE=_F(JUSQU_A=1.,  NOMBRE=1,));
MEST1=STAT_NON_LINE(MODELE=MO,
                 CHAM_MATER=CHMAT,
                 CARA_ELEM=CAREL,
                 EXCIT=(_F(CHARGE=CHARG1,),
                        _F(CHARGE=CHARG2,),),
                 COMP_INCR=_F(RELATION='ELAS',),
                 INCREMENT=_F(LIST_INST=LINST,),
                 NEWTON=_F(MATRICE='ELASTIQUE',),)

#
#
MEST1=CALC_CHAMP(reuse=MEST1,RESULTAT=MEST1,CONTRAINTE=('EFGE_ELNO'))

MEST1=CALC_CHAMP( reuse=MEST1,
                         RESULTAT=MEST1,
                           FORCE=('FORC_NODA','REAC_NODA'),CONTRAINTE='EFGE_NOEU'
                   )
#
TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P7',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DY',
                  VALE_CALC= 9.44033108E-03,
                  VALE_REFE=9.3887999999999992E-3,
                  CRITERE='RELATIF',
                  PRECISION=6.0000000000000001E-3,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P1',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1,
                  NOM_CHAM='EFGE_NOEU',
                  NOM_CMP='VY',
                  VALE_CALC= 6.00764159E+03,
                  VALE_REFE=6000.0,
                  CRITERE='RELATIF',
                  PRECISION=2.E-3,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P1',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1,
                  NOM_CHAM='REAC_NODA',
                  NOM_CMP='DY',
                  VALE_CALC=-5.99999999E+03,
                  VALE_REFE=-6000.0,
                  CRITERE='RELATIF',),
          )

#
TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P11',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1,
                  NOM_CHAM='EFGE_NOEU',
                  NOM_CMP='VY',
                  VALE_CALC=-1.19949387E+04,
                  VALE_REFE=-1.2000E4,
                  CRITERE='RELATIF',),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P11',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1,
                  NOM_CHAM='REAC_NODA',
                  NOM_CMP='DY',
                  VALE_CALC=-1.20000000E+04,
                  VALE_REFE=-1.2000E4,
                  CRITERE='RELATIF',),
          )

#
TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P8',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1,
                  NOM_CHAM='EFGE_NOEU',
                  NOM_CMP='MFZ',
                  VALE_CALC=-1.38800780E+04,
                  VALE_REFE=-1.385641E4,
                  CRITERE='RELATIF',
                  PRECISION=2.E-3,),
          )

#
MEST1B=MECA_STATIQUE(        MODELE=MO,
                          CHAM_MATER=CHMAT,
                           CARA_ELEM=CAREL,EXCIT=(
                               _F( CHARGE = CHARG1),
                                     _F( CHARGE = CHARG2))
                      )

MEST1B=CALC_CHAMP(reuse=MEST1B,RESULTAT=MEST1B,CONTRAINTE=('EFGE_ELNO'))

MEST1B=CALC_CHAMP( reuse=MEST1B,
                         RESULTAT=MEST1B,
                           FORCE=('FORC_NODA','REAC_NODA'),CONTRAINTE='EFGE_NOEU'
                   )
TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P7',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1B,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DY',
                  VALE_CALC= 9.44033108E-03,
                  VALE_REFE=9.3887999999999992E-3,
                  CRITERE='RELATIF',
                  PRECISION=6.0000000000000001E-3,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P1',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1B,
                  NOM_CHAM='EFGE_NOEU',
                  NOM_CMP='VY',
                  VALE_CALC= 6.00764159E+03,
                  VALE_REFE=6000.0,
                  CRITERE='RELATIF',
                  PRECISION=2.E-3,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P1',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1B,
                  NOM_CHAM='REAC_NODA',
                  NOM_CMP='DY',
                  VALE_CALC=-5.99999999E+03,
                  VALE_REFE=-6000.0,
                  CRITERE='RELATIF',),
          )

#
TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P11',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1B,
                  NOM_CHAM='EFGE_NOEU',
                  NOM_CMP='VY',
                  VALE_CALC=-1.19949387E+04,
                  VALE_REFE=-1.2000E4,
                  CRITERE='RELATIF',),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P11',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1B,
                  NOM_CHAM='REAC_NODA',
                  NOM_CMP='DY',
                  VALE_CALC=-1.20000000E+04,
                  VALE_REFE=-1.2000E4,
                  CRITERE='RELATIF',),
          )

#
TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P8',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=MEST1B,
                  NOM_CHAM='EFGE_NOEU',
                  NOM_CMP='MFZ',
                  VALE_CALC=-1.38800780E+04,
                  VALE_REFE=-1.385641E4,
                  CRITERE='RELATIF',
                  PRECISION=2.E-3,),
          )

# test de ANGLE

IY=2.70098E-05

MZMAX=-13856.41

R=0.1

EP=0.01

SIMAX=MZMAX*(R-EP/2.)/IY

MEST1B=CALC_CHAMP(reuse=MEST1B,RESULTAT=MEST1B,CONTRAINTE=('SIGM_ELNO'))


SITU90=POST_CHAMP(RESULTAT=MEST1B,

                  EXTR_TUYAU=_F(NOM_CHAM='SIGM_ELNO',
                                NUME_COUCHE=1,
                                NIVE_COUCHE='SUP',
                                ANGLE=90,),);
# la maille la plus proche de L/SQRT(3)
TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P8',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=SITU90,
                  NOM_CHAM='SIGM_ELNO',
                  NOM_CMP='SIXX',
                  VALE_CALC=-4.90169180E+07,
                  VALE_REFE=-4.8736345696747109E7,
                  CRITERE='RELATIF',
                  PRECISION=1.E-2,
                  MAILLE='M12',),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P8',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=SITU90,
                  NOM_CHAM='SIGM_ELNO',
                  NOM_CMP='SIXX',
                  VALE_CALC=-4.90623803E+07,
                  VALE_REFE=-4.8736345696747109E7,
                  CRITERE='RELATIF',
                  PRECISION=1.E-2,
                  MAILLE='M11',),
          )

SITU89=POST_CHAMP(RESULTAT=MEST1B,

                  EXTR_TUYAU=_F(NOM_CHAM='SIGM_ELNO',
                                NUME_COUCHE=1,
                                NIVE_COUCHE='SUP',
                                ANGLE=89,),);
# la maille la plus proche de L/SQRT(3)
TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P8',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=SITU89,
                  NOM_CHAM='SIGM_ELNO',
                  NOM_CMP='SIXX',
                  VALE_CALC=-4.89331983E+07,
                  VALE_REFE=-4.8736345696747109E7,
                  CRITERE='RELATIF',
                  PRECISION=1.E-2,
                  MAILLE='M12',),
          )

SITU91=POST_CHAMP(RESULTAT=MEST1B,

                  EXTR_TUYAU=_F(NOM_CHAM='SIGM_ELNO',
                                NUME_COUCHE=1,
                                NIVE_COUCHE='SUP',
                                ANGLE=91,),);
# la maille la plus proche de L/SQRT(3)
TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P8',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=SITU91,
                  NOM_CHAM='SIGM_ELNO',
                  NOM_CMP='SIXX',
                  VALE_CALC=-4.89331983E+07,
                  VALE_REFE=-4.8736345696747109E7,
                  CRITERE='RELATIF',
                  PRECISION=1.E-2,
                  MAILLE='M12',),
          )

SITU0=POST_CHAMP(RESULTAT=MEST1B,

                 EXTR_TUYAU=_F(NOM_CHAM='SIGM_ELNO',
                               NUME_COUCHE=1,
                               NIVE_COUCHE='SUP',
                               ANGLE=360,),);
# la maille la plus proche de L/SQRT(3)
TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='P8',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=SITU0,
                  NOM_CHAM='SIGM_ELNO',
                  NOM_CMP='SIXX',
                  VALE_CALC=0.0,
                  VALE_REFE=0.0,
                  CRITERE='ABSOLU',
                  TOLE_MACHINE=2.E-5,
                  PRECISION=1.E-2,
                  MAILLE='M12',),
          )

FIN( )
#
#
