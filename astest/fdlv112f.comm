# TITRE REPONSE SISMIQUE D UN BARRAGE AVEC LAPLACE TEMPS
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET',),DEBUG=_F(SDVERI='OUI') 
     );
#
'''
mail0 = LIRE_MAILLAGE(FORMAT='MED', VERI_MAIL=_F(VERIF='OUI'));
#
# Modification du maillage pour creer des mailles a un noeud pour
# placer les impedances sous la fondation du barrages.
#
mail=CREA_MAILLAGE(MAILLAGE=mail0,
                      CREA_POI1 =(
                                  _F(NOM_GROUP_MA = 'PBASE',
                                    NOEUD = 'N316'),
                                  _F(NOM_GROUP_MA = 'PFONDAT',
                                    GROUP_MA = 'SURFBAS2'),
                                 ),
                     );
#
# Modification du maillage pour creer des mailles a un noeud pour
# placer les impedances sous la fondation du barrages.
#


mail=DEFI_GROUP(reuse =mail,
                MAILLAGE=mail,
                CREA_GROUP_NO=_F(NOM='ISOLSTR',
                                 GROUP_MA=('SURFBAS2'),
                                ),
               );
               
mail=DEFI_GROUP(reuse =mail,
                MAILLAGE=mail,
                CREA_GROUP_NO=_F(NOM='IFLUSTR',
                                 GROUP_MA=('IFLUSTR2'),
                                ),
               );
               
mail=DEFI_GROUP(reuse =mail,
                    MAILLAGE=mail,
                    CREA_GROUP_NO=(
                        _F(NOM= 'NISFS', UNION=('ISOLSTR','IFLUSTR'),),
                                  ),
                    );        


#
# Orientation des elements d interface.
#
mail=MODI_MAILLAGE( reuse=mail,
                    MAILLAGE=mail,
                    ORIE_NORM_COQUE=(_F( VECT_NORM = (0., 0., 1.,),
                                         NOEUD = 'N963',
                                         GROUP_MA = 'IFLUSOL2'),
                                     _F( VECT_NORM = (1., 0., 0.,),
                                         NOEUD = 'N221',
                                         GROUP_MA = 'IFLUSTR2'),
                                     _F( VECT_NORM = (0., 0., -1.,),
                                         NOEUD = 'N316',
                                         GROUP_MA = 'SURFBAS2'),
                                     _F( VECT_NORM = (0., 0., 1.,),
                                         NOEUD = 'N1043',
                                         GROUP_MA = 'SLIBREM2'),
                                    ),
                   );
                   

'''

mail0 = LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='OUI'));

mail=CREA_MAILLAGE(MAILLAGE=mail0,
                      CREA_POI1 =(
                                  _F(NOM_GROUP_MA = 'MFICTIF',
                                    GROUP_NO = 'FICTIF'),
                                 ),
                     );


modele=AFFE_MODELE( MAILLAGE= mail,
                      AFFE=( _F(GROUP_MA=( 'STRVOU2' ),
                                PHENOMENE= 'MECANIQUE',
                                MODELISATION= '3D'),
                             _F(GROUP_MA = 'MFICTIF',
                                PHENOMENE = 'MECANIQUE',
                                MODELISATION = 'DIS_TR'),
                             _F(GROUP_MA = 'PFONDAT',
                                PHENOMENE = 'MECANIQUE',
                                MODELISATION = 'DIS_T'),
                           ),
                      );
                      
modele2=AFFE_MODELE( MAILLAGE= mail,
                      AFFE=( _F(GROUP_MA=( 'STRVOU2' ),
                                PHENOMENE= 'MECANIQUE',
                                MODELISATION= '3D'),
                             _F(GROUP_MA = 'MFICTIF',
                                PHENOMENE = 'MECANIQUE',
                                MODELISATION = 'DIS_TR'),
                             _F(GROUP_MA = 'PBASE',
                                PHENOMENE = 'MECANIQUE',
                                MODELISATION = 'DIS_TR'),
                           ),
                      );

#
mat1= DEFI_MATERIAU( ELAS=_F( E= 3.6E+10,
                              RHO= 2400.,
                              NU= 0.2,
#                             AMOR_HYST = 0.1,
                            ),
                       ) ;
#
champmat = AFFE_MATERIAU( MAILLAGE= mail,
                            AFFE=_F( GROUP_MA= ('STRVOU2'),
                                   MATER= mat1 )
                           );
                           
Npf = 205*2

kxp=3.55E13/Npf
kyp=3.33E13/Npf
kzp=3.41E14/Npf

cara_ele=AFFE_CARA_ELEM(MODELE=modele,
                        DISCRET=(
                             _F(GROUP_MA=('MFICTIF'), 
                                CARA='M_TR_D_N',
                                VALE=(1.E-10,1.E-10,1.E-10,1.E-10,0.,0.,
                                      0.,0.,0.,0.,),
                                ),
                             _F(GROUP_MA=('MFICTIF'), 
                                CARA='K_TR_D_N',
                                VALE=(1.E-3,1.E-3,1.E-3,
                                      1.E-3,1.E-3,1.E-3,),
                                ),
                             _F(GROUP_MA=('PFONDAT'), 
                                CARA='K_T_D_N',
                                VALE=(kxp, kyp,kzp,),
                                ),
                                 ),
                        );
                        
cara_el2=AFFE_CARA_ELEM(MODELE=modele2,
                        DISCRET=(
                             _F(GROUP_MA=('MFICTIF'), 
                                CARA='M_TR_D_N',
                                VALE=(1.E-10,1.E-10,1.E-10,1.E-10,0.,0.,
                                      0.,0.,0.,0.,),
                                ),
                             _F(GROUP_MA=('MFICTIF'), 
                                CARA='K_TR_D_N',
                                VALE=(1.E-3,1.E-3,1.E-3,
                                      1.E-3,1.E-3,1.E-3,),
                                ),
                             _F(GROUP_MA=('PBASE'), 
                                CARA='K_TR_D_N',
                                VALE=(0, 0, 0, 0, 0, 0,),
                                ),
                                 ),
                        );

#
#========================================
# ETAPE 1: Calul des impedances de sols
# --------
#========================================
#
#
# La structure est encastree a l interface
#-----------------------------------------

cond_lim = AFFE_CHAR_MECA( MODELE= modele2,
                           DDL_IMPO=_F(
                                          #GROUP_NO=('ISOLSTR',),
                                          NOEUD = 'N316',
                                          DX= 0.,
                                          DY= 0.,
                                          DZ= 0.,
                                          DRX= 0.,
                                          DRY= 0.,
                                          DRZ= 0.,
                                      ),
                           LIAISON_SOLIDE=_F(GROUP_NO=('ISOLSTR',),)
                          );
                          
ASSEMBLAGE(MODELE=modele2,
                CHAM_MATER=champmat,
                CARA_ELEM=cara_el2,
                CHARGE=cond_lim,
                NUME_DDL=CO('NUMEROTA'),
                MATR_ASSE=(_F(MATRICE=CO('MATRIGI2'),
                              OPTION='RIGI_MECA',),
                           ),
                 );
                 
MODSTA=MODE_STATIQUE(  MATR_RIGI=MATRIGI2,
                     MODE_STAT=_F(
                     NOEUD = 'N316', 
                     AVEC_CMP = ('DX','DY','DZ','DRX','DRY','DRZ',),
                                 ));

#
#
# Calcul des matrices et vecteurs elementaires
#----------------------------------------------
rigi_ele = CALC_MATR_ELEM( MODELE= modele ,
                           OPTION= 'RIGI_MECA',
                           CHAM_MATER= champmat,
                           #CHARGE= cond_lim,
                           CARA_ELEM=cara_ele,
                         );
#
mass_ele = CALC_MATR_ELEM( MODELE= modele ,
                           OPTION= 'MASS_MECA',
                           CHAM_MATER= champmat,
                           #CHARGE= cond_lim,
                           CARA_ELEM=cara_ele,
                         );
#
nume_ddl = NUME_DDL( MATR_RIGI= rigi_ele );
#
# Assemblage des matrices et vecteurs
#-------------------------------------
#
MATRIGI= ASSE_MATRICE( MATR_ELEM= rigi_ele, NUME_DDL= nume_ddl );
MATMASS= ASSE_MATRICE( MATR_ELEM= mass_ele, NUME_DDL= nume_ddl );
#
# Calcul de la masse du barrage voute
#-------------------------------------
#
mass_bar=POST_ELEM( MODELE= modele ,
                    INFO= 1,
                    CHAM_MATER= champmat,
                    CARA_ELEM=cara_ele,
                    MASS_INER=_F(TOUT='OUI'),
                   );
                   
IMPR_TABLE(TABLE=mass_bar);

#
# calcul des modes
#------------------
#
#
#
mode_rig=CALC_MODES(MATR_RIGI=MATRIGI,
                    VERI_MODE=_F(STOP_ERREUR='NON',
                                 ),
                    OPTION='BANDE',
                    CALC_FREQ=_F(FREQ=(0.1,20.,40.,50.,),
                                       #60.,70.,80.,90.,100.),
                                 ),
                    FILTRE_MODE=_F(SEUIL=0.0000003,
                                   ),
                    MATR_MASS=MATMASS,
                    NORM_MODE=_F(INFO=1,
                              NORME='TRAN_ROTA',),
                    )


C_LIM0=AFFE_CHAR_MECA(MODELE=modele,
                       DDL_IMPO=_F(GROUP_NO='NISFS',
                                   DX=0.0,
                                   DY=0.0,
                                   DZ=0.0,
                                        ),

                           INFO = 1,                            
                                   );
                                   
NUME0=NUME_DDL(MODELE=modele,
               CHARGE=C_LIM0,);

INTERDY2=DEFI_INTERF_DYNA(NUME_DDL=NUME0,
                          INTERFACE=_F(NOM='DROITE',
                                       TYPE='CRAIGB',
                                       GROUP_NO='NISFS'),);
                                       

BAMO0=DEFI_BASE_MODALE(RITZ=(_F(MODE_MECA=mode_rig,
                                NMAX_MODE=0,),
                             _F(MODE_INTF=mode_rig,#MODE_INTF=MODSTA,
                                NMAX_MODE=54,),
                             ),
                       INTERF_DYNA=INTERDY2,
                       NUME_REF=nume_ddl,);
                       
                       
BAMO=DEFI_BASE_MODALE(RITZ=(_F(BASE_MODALE=BAMO0,),
                            _F(MODE_INTF=MODSTA, NMAX_MODE=6,),
                             ),
                       INTERF_DYNA=INTERDY2,
                       NUME_REF=nume_ddl,);
                       
                       
NDDLGEN = NUME_DDL_GENE( BASE= BAMO, STOCKAGE= 'PLEIN',);
#


TABSOL = DEFI_SOL_MISS(
   TITRE="SOL HOMOGENE",
   MATERIAU=(
      _F(E=3.0e11,   NU=0.16, RHO=2000., AMOR_HYST=0.10),
      _F(E=3.0e11,   NU=0.16, RHO=2000., AMOR_HYST=0.10),
   ),
   COUCHE=(
      _F(EPAIS=2.5, NUME_MATE=1, RECEPTEUR="OUI"),
      _F(EPAIS=2.5, NUME_MATE=1, RECEPTEUR="OUI", SOURCE="OUI"),
      _F(EPAIS=4.0, NUME_MATE=1, RECEPTEUR="OUI"),
      _F(EPAIS=4.0, NUME_MATE=1, RECEPTEUR="OUI", SOURCE="OUI"),
      _F(EPAIS=4.0, NUME_MATE=1, RECEPTEUR="OUI"),
      _F(EPAIS=4.0, NUME_MATE=1, RECEPTEUR="OUI", SOURCE="OUI"),
      _F(EPAIS=5.0, NUME_MATE=1, RECEPTEUR="OUI"),
      _F(EPAIS=5.0, NUME_MATE=1, RECEPTEUR="OUI", SOURCE="OUI"),
      _F(EPAIS=5.0, NUME_MATE=1, RECEPTEUR="OUI"),
      _F(EPAIS=5.0, NUME_MATE=1, RECEPTEUR="OUI", SOURCE="OUI"),
      _F(EPAIS=5.5, NUME_MATE=1, RECEPTEUR="OUI"),
      _F(EPAIS=5.5, NUME_MATE=1, RECEPTEUR="OUI", SOURCE="OUI"),
      _F(EPAIS=6.0, NUME_MATE=1, RECEPTEUR="OUI"),
      _F(EPAIS=6.0, NUME_MATE=1, RECEPTEUR="OUI", SOURCE="OUI"),
      _F(EPAIS=6.5, NUME_MATE=1, RECEPTEUR="OUI"),
      _F(EPAIS=6.5, NUME_MATE=1, RECEPTEUR="OUI", SOURCE="OUI"),
      _F(EPAIS=10., NUME_MATE=1, RECEPTEUR="OUI", SOURCE="OUI"),
      _F(SUBSTRATUM="OUI", NUME_MATE=2,),
   ),
   INFO=2,
);


INCLUDE(UNITE=31,);

N=80 
dt=0.05
TFIN=4                          

linst = DEFI_LIST_REEL ( DEBUT = 0.,
                          INTERVALLE = (
                                      _F( 
                                         JUSQU_A = (N-1)*dt,
                                         PAS=1*dt,
                                         ),
                                       ),
                           );
                           
accex= CALC_FONCTION( COMB=_F( FONCTION = acc_x, COEF = 1.),
                        INTERPOL='LIN',
                        PROL_DROITE='LINEAIRE',
                        PROL_GAUCHE='LINEAIRE',
                      LIST_PARA=linst); 
                      

ACCEX= CALC_FONCTION( COMB=_F( FONCTION = acc_x, COEF = 1.),
                        INTERPOL='LIN',
                        PROL_DROITE='LINEAIRE',
                        PROL_GAUCHE='LINEAIRE',
                      LIST_PARA=linst);
                      
'''

vitex=CALC_FONCTION(INTEGRE=_F(FONCTION=ACCEX,));

deplx0=CALC_FONCTION(INTEGRE=_F(FONCTION=vitex,));

deplxF=FORMULE(NOM_PARA='INST',
            VALE='deplx0(INST)-(INST*deplx0(TFIN-dt)/(TFIN-dt))')
            
deplx=CALC_FONC_INTERP(FONCTION=deplxF, NOM_PARA = 'INST',
                        PROL_DROITE='CONSTANT',
                        PROL_GAUCHE='CONSTANT',
                        LIST_PARA=linst);
                        
'''
                        
MAEL0=MACR_ELEM_DYNA(BASE_MODALE=BAMO,
                      MATR_RIGI=MATRIGI,
                      MATR_MASS=MATMASS,
                      SANS_GROUP_NO='NISFS',
                      );
                      
IMPR_CO(CHAINE='MAEL0   .LINO');                      

'''                     
CALC_MISS(TYPE_RESU='FICHIER',
          PROJET='FDLV112E',
          #REPERTOIRE='/home/H28418/FDLV112E',
          VERSION='V6.6',
          TABLE_SOL=TABSOL,
          MATER_FLUIDE=_F(RHO=1000.,
                          CELE=1500.,
                          AMOR_BETA=0.),
          MACR_ELEM_DYNA=MAEL0,
          GROUP_MA_INTERF='SURFBAS2',
          GROUP_MA_FLU_STR='IFLUSTR2',
          GROUP_MA_FLU_SOL='IFLUSOL2',
          GROUP_MA_SOL_SOL='SLIBREM2',
          UNITE_IMPR_ASTER=26,
          UNITE_RESU_IMPE=25,
          UNITE_RESU_FORC=28,
          PARAMETRE=_F(FREQ_MIN=0.25,
                       FREQ_MAX=10.,
                       FREQ_PAS=0.25,
                       Z0=5.0,
                       SURF='NON',
                       ISSF='OUI',
                       ALGO='REGU',
                       OFFSET_MAX=1000,
                       OFFSET_NB=5000,),);
                       
'''
                      
CALC_MISS(TYPE_RESU='FICHIER_TEMPS',
          PROJET='FDLV112E2',
          VERSION='V6.6',
          TABLE_SOL=TABSOL,
          MATER_FLUIDE=_F(RHO=1000.,
                          CELE=1500.,
                          AMOR_BETA=0.),
          MACR_ELEM_DYNA=MAEL0,
          GROUP_MA_INTERF='SURFBAS2',
          GROUP_MA_FLU_STR='IFLUSTR2',
          GROUP_MA_FLU_SOL='IFLUSOL2',
          GROUP_MA_SOL_SOL='SLIBREM2',
          UNITE_IMPR_ASTER=26,
          INST_FIN = 2.0,
          PRECISION = 1E-10,
          PAS_INST = 0.05,
          UNITE_RESU_RIGI=35,
          #UNITE_RESU_FORC=28,
          PARAMETRE=_F(FREQ_IMAG=0.1,
                       Z0=5.0,
                       SURF='NON',
                       ISSF='OUI',
                       ALGO='REGU',
                       OFFSET_MAX=1000,
                       OFFSET_NB=5000,),);                       


MATK = LIRE_IMPE_MISS(UNITE_RESU_IMPE=35, INST_EXTR=0.0,
                      SYME='OUI',
                      BASE=BAMO, NUME_DDL_GENE=NDDLGEN);
                      
                      
# Termes Z0

MAEL=MACR_ELEM_DYNA(  BASE_MODALE=BAMO,
                       MATR_IMPE_RIGI = MATK,
                       SANS_GROUP_NO='NISFS',
                       );
                       
IMPR_CO(CHAINE='MAEL    .LINO');

                                              
MAYADYN=DEFI_MAILLAGE(DEFI_SUPER_MAILLE=(
                          _F(MACR_ELEM=MAEL,
                             SUPER_MAILLE='STAT1',),
                                         ),
                      RECO_GLOBAL=_F(TOUT='OUI',),
                      DEFI_NOEUD=_F(TOUT='OUI',
                                     INDEX=(1,0,1,8,),),);
                                     
MAILB=ASSE_MAILLAGE(MAILLAGE_1=mail,
                    MAILLAGE_2=MAYADYN,
                    OPERATION='SOUS_STR',);
                                        
                    
MODELB=AFFE_MODELE(MAILLAGE=MAILB,
                     AFFE_SOUS_STRUC=_F(SUPER_MAILLE=('STAT1',),
                                        PHENOMENE='MECANIQUE',),
                     AFFE=( _F(GROUP_MA=( 'STRVOU2' ),
                                PHENOMENE= 'MECANIQUE',
                                MODELISATION= '3D'),
                             _F(GROUP_MA = 'MFICTIF',
                                PHENOMENE = 'MECANIQUE',
                                MODELISATION = 'DIS_TR'),
                           ),
                     );
                     
ELEMB=AFFE_CARA_ELEM(MODELE=MODELB,                                           
                        DISCRET=(                                                                            _F(GROUP_MA=('MFICTIF'), 
                                CARA='M_TR_D_N',
                                VALE=(1.E-10,1.E-10,1.E-10,1.E-10,0.,0.,
                                      0.,0.,0.,0.,),
                                ),
                             _F(GROUP_MA=('MFICTIF'), 
                                CARA='K_TR_D_N',
                                VALE=(1.E-3,1.E-3,1.E-3,
                                      1.E-3,1.E-3,1.E-3,),
                                ),
                                 ),
                     );
                     
COND_LIB=AFFE_CHAR_MECA(MODELE=MODELB,
                        #INFO=2,
                        LIAISON_INTERF=(_F(MACR_ELEM_DYNA=MAEL,),),
                        #LIAISON_SOLIDE=(_F(GROUP_NO='NISFS'),),
                        #LIAISON_SOLIDE=(_F(GROUP_NO='ISOLSTR'),),
                        );
                        
CHMATB=AFFE_MATERIAU(MAILLAGE=MAILB,
                            AFFE=_F( GROUP_MA= ('STRVOU2'),
                                   MATER= mat1 )
                     );
                     
dt = 0.05

N=27

L_INST=DEFI_LIST_REEL(DEBUT=0.,
                     INTERVALLE=_F(
                                   JUSQU_A=(N-1)*dt,
                                   PAS=dt,),
                     );
                     
CHSOL=AFFE_CHAR_MECA(MODELE=MODELB,
                 FORCE_SOL=_F(SUPER_MAILLE='STAT1',
                             #GROUP_NO_INTERF='PBASE',
                             UNITE_RESU_RIGI=35,
                             ),
                      );                      

                        
PESAX=AFFE_CHAR_MECA(MODELE=MODELB,
                    PESANTEUR=_F(GRAVITE=1.0,
                                 DIRECTION=(-1.0,0.0,0.0,),),);
                        
DYNA=DYNA_NON_LINE(MODELE=MODELB,
                 CHAM_MATER=CHMATB,
                 CARA_ELEM=ELEMB,
                 EXCIT=(
                        #_F(CHARGE=FSEISX0,),
                        _F(CHARGE=PESAX,FONC_MULT=ACCEX,),
                        _F(CHARGE=CHSOL),
                        _F(CHARGE=COND_LIB),
                        ),
                 COMPORTEMENT=(_F(RELATION='ELAS',
                                    TOUT='OUI',),
                                ),
                 NEWTON=_F(#PREDICTION='ELASTIQUE',
                           MATRICE='ELASTIQUE',
                           #MATRICE='TANGENTE',
                           REAC_INCR=0,REAC_ITER=0,
                           ),
                 SCHEMA_TEMPS = _F(SCHEMA='HHT', 
                                   #ALPHA=-0.0,
                                   #ALPHA=-0.1,
                                   ALPHA=-0.02,
                                   MODI_EQUI='OUI',
                                   FORMULATION='DEPLACEMENT',),
                 CONVERGENCE=_F(RESI_GLOB_RELA = 1.E-8,
                                ITER_GLOB_MAXI = 20,
                                ARRET='OUI',),
                 INCREMENT=_F(LIST_INST=L_INST,),
                 #ARCHIVAGE=_F(PAS_ARCH=1,),             
                          );
                          
ax253i = RECU_FONCTION ( RESULTAT = DYNA, NOM_CHAM = 'ACCE',
                        INTERPOL='LIN',
                        PROL_DROITE='LINEAIRE',
                        PROL_GAUCHE='LINEAIRE',
                        NOEUD = 'N253', NOM_CMP = 'DX', );
                        
ax316i = RECU_FONCTION ( RESULTAT = DYNA, NOM_CHAM = 'ACCE',
                        INTERPOL='LIN',
                        PROL_DROITE='LINEAIRE',
                        PROL_GAUCHE='LINEAIRE',
                        NOEUD = 'N316', NOM_CMP = 'DX', );
                        
ax11i = RECU_FONCTION ( RESULTAT = DYNA, NOM_CHAM = 'ACCE',
                        INTERPOL='LIN',
                        PROL_DROITE='LINEAIRE',
                        PROL_GAUCHE='LINEAIRE',
                        NOEUD = 'N11', NOM_CMP = 'DX', );
                        
ax253ia=CALC_FONCTION(LIST_PARA=L_INST,
                    COMB=(_F(FONCTION=ax253i,
                             COEF=1.,),
                          _F(FONCTION=ACCEX,
                             COEF=1.,),
                          ),
                       );
                       
ax316ia=CALC_FONCTION(LIST_PARA=L_INST,
                    COMB=(_F(FONCTION=ax316i,
                             COEF=1.,),
                          _F(FONCTION=ACCEX,
                             COEF=1.,),
                          ),
                       );        
                       
ax11ia=CALC_FONCTION(LIST_PARA=L_INST,
                    COMB=(_F(FONCTION=ax11i,
                             COEF=1.,),
                          _F(FONCTION=ACCEX,
                             COEF=1.,),
                          ),
                       );                        
                        
freqspec = DEFI_LIST_REEL ( DEBUT = 0.1,
                          INTERVALLE = (
                                      _F(
                                         JUSQU_A = 15.,
                                         NOMBRE = 149,
                                       ),
                                      _F(
                                         JUSQU_A = 35.,
                                         NOMBRE = 80,
                                       ),
                                      _F(
                                         JUSQU_A = 100.,
                                         NOMBRE = 65,
                                       ),
                                       ),
                           );


sro_axi=CALC_FONCTION(SPEC_OSCI=_F(FONCTION=ax253ia, AMOR_REDUIT=0.05,
                                  NORME=1.,
                                  LIST_FREQ = freqspec,
                                 ),);
                                 
sro11xi=CALC_FONCTION(SPEC_OSCI=_F(FONCTION=ax11ia, AMOR_REDUIT=0.05,
                                  NORME=1.,
                                  LIST_FREQ = freqspec,
                                 ),);
                                 
sro316xi=CALC_FONCTION(SPEC_OSCI=_F(FONCTION=ax316ia, AMOR_REDUIT=0.05,
                                  NORME=1.,
                                  LIST_FREQ = freqspec,
                                 ),);
                                 
                                 
SACCEX=CALC_FONCTION(SPEC_OSCI=_F(FONCTION=ACCEX, AMOR_REDUIT=0.05,
                                  NORME=1.,
                                  LIST_FREQ = freqspec,
                                 ),);
                                 
SACCEX0=CALC_FONCTION(SPEC_OSCI=_F(FONCTION=acc_x, AMOR_REDUIT=0.05,
                                  NORME=1.,
                                  LIST_FREQ = freqspec,
                                 ),);
                                 

TEST_FONCTION(VALEUR=(
                      _F(VALE_CALC=-6.0407335E-01,
                         #VALE_REFE=4.885,
                         #PRECISION=0.13,
                         #REFERENCE = 'AUTRE_ASTER',
                         VALE_PARA=1.25,
                         FONCTION=ax253ia,
                         ),
##                       _F(VALE_CALC=4.884638426062,
##                          VALE_REFE=4.885,
##                          PRECISION=0.13,
##                          REFERENCE = 'AUTRE_ASTER',
##                          VALE_PARA=1.00,
##                          FONCTION=ax253i,
##                          ),
##                       _F(VALE_CALC=17.39874712248,
##                          VALE_REFE=17.40,
##                          PRECISION=0.015,
##                          REFERENCE = 'AUTRE_ASTER',
##                          VALE_PARA=(10.7, 0.05),
##                          NOM_PARA=('FREQ', 'AMOR'),
##                          FONCTION=sro_axi,
##                          ),
                      ),
              );


FIN( );
