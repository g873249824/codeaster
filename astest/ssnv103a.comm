# TITRE  ESSAI DE TRACTION-CISAILLEMENT 3D (ROUSSELIER_FO)
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#-----------------------------------------------------------------------
# TEST VPCS PLAQUE CARREE EN TRACTION CISAILLEMENT CALCUL 3D
# MODELE ELASTOPLASTIQUE ENDOMMAGEMENT DUCTILE DE ROUSSELIER
# MAILLAGE : ELEMENT 3D CUBE A 8 NOEUDS
# UNITES   : NEWTON , MILLIMETRE , SECONDE (N,MM,S)
#-----------------------------------------------------------------------
#
DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'))

CUBE=LIRE_MAILLAGE(    )

TROISD=AFFE_MODELE(            MAILLAGE=CUBE,
                                    AFFE=_F(   PHENOMENE = 'MECANIQUE',
                                            MODELISATION = '3D',
                                            TOUT = 'OUI'))

ECRISO =DEFI_FONCTION(          NOM_PARA='EPSI',
                                PROL_DROITE='LINEAIRE',
                               PROL_GAUCHE='LINEAIRE',
                                     VALE=(
 0.002519,   520.000,
 0.003076,   521.293,
 0.003632,   522.584,
 0.004188,   523.873,
 0.004744,   525.161,
 0.005301,   526.447,
 0.005857,   527.731,
 0.006413,   529.013,
 0.006969,   530.294,
 0.007525,   531.574,
 0.008082,   532.851,
 0.008638,   534.127,
 0.009194,   535.401,
 0.009750,   536.673,
 0.010306,   537.944,
 0.010862,   539.213,
 0.011419,   540.481,
 0.011975,   541.746,
 0.012531,   543.010,
 0.013087,   544.273,
 0.013643,   545.533,
 0.014199,   546.793,
 0.014755,   548.050,
 0.015311,   549.306,
 0.015867,   550.560,
 0.016424,   551.812,
 0.016980,   553.063,
 0.017536,   554.312,
 0.018092,   555.560,
 0.018648,   556.805,
 0.019204,   558.050,
 0.019760,   559.292,
 0.020316,   560.533,
 0.020872,   561.772,
 0.021428,   563.010,
 0.021984,   564.246,
 0.022540,   565.480,
 0.023096,   566.713,
 0.023652,   567.944,
 0.024208,   569.174,
 0.024764,   570.402,
 0.025320,   571.628,
 0.025875,   572.853,
 0.026431,   574.076,
 0.026987,   575.297,
 0.027543,   576.517,
 0.028099,   577.735,
 0.028655,   578.952,
 0.029211,   580.167,
 0.029767,   581.380,
 0.030323,   582.592,
 0.030878,   583.802,
 0.031434,   585.011,
 0.031990,   586.218,
 0.032546,   587.423,
 0.033102,   588.627,
 0.033658,   589.829,
 0.034214,   591.030,
 0.034769,   592.229,
 0.035325,   593.426,
 0.035881,   594.622,
 0.036437,   595.816,
 0.036992,   597.009,
 0.037548,   598.200,
 0.038104,   599.390,
 0.038660,   600.578,
 0.039216,   601.764,
 0.039771,   602.949,
 0.040327,   604.132,
 0.040883,   605.314,
 0.041438,   606.494,
 0.041994,   607.673,
 0.042550,   608.850,
 0.043106,   610.026,
 0.043661,   611.200,
 0.044217,   612.372,
 0.044773,   613.543,
 0.045328,   614.712,
 0.045884,   615.880,
 0.046440,   617.046,
 0.046995,   618.211,
 0.047551,   619.374,
 0.048106,   620.536,
 0.048662,   621.696,
 0.049218,   622.855,
 0.049773,   624.012,
 0.050329,   625.167,
 0.050885,   626.321,
 0.051440,   627.474,
 0.051996,   628.625,
 0.052551,   629.774,
 0.053107,   630.922,
 0.053662,   632.069,
 0.054218,   633.214,
 0.054773,   634.357,
 0.055329,   635.499,
 0.055884,   636.639,
 0.056440,   637.778,
 0.056996,   638.916,
 0.057551,   640.051,
 0.058107,   641.186,
 0.058662,   642.319,
 0.059217,   643.450,
 0.059773,   644.580,
 0.060328,   645.708,
 0.060884,   646.835,
 0.061439,   647.961,
 0.061995,   649.085,
 0.062550,   650.207,
 0.063106,   651.328,
 0.063661,   652.448,
 0.064217,   653.566,
 0.064772,   654.682,
 0.065327,   655.797,
 0.065883,   656.911,
 0.066438,   658.023,
 0.066993,   659.134,
 0.067549,   660.243,
 0.068104,   661.351,
 0.068660,   662.457,
 0.069215,   663.562,
 0.069770,   664.665,
 0.070326,   665.767,
 0.070881,   666.868,
 0.071436,   667.967,
 0.071992,   669.064,
 0.072547,   670.160,
 0.073102,   671.255,
 0.073658,   672.348,
 0.074213,   673.440,
 0.074768,   674.530,
 0.075323,   675.619,
 0.075879,   676.707,
 0.076434,   677.793,
 0.076989,   678.877,
 0.077544,   679.960,
 0.078100,   681.042,
 0.078655,   682.122,
 0.079210,   683.201,
 0.079765,   684.279,
 0.080321,   685.355,
 0.080876,   686.430,
 0.081431,   687.503,
 0.081986,   688.575,
 0.082541,   689.645,
 0.083096,   690.714,
 0.083652,   691.781,
 0.084207,   692.848,
 0.084762,   693.912,
 0.085317,   694.976,
 0.085872,   696.038,
 0.086427,   697.098,
 0.086983,   698.157,
 0.087538,   699.215,
 0.088093,   700.271,
 0.088648,   701.326,
 0.089203,   702.380,
 0.089758,   703.432,
 0.090313,   704.483,
 0.090868,   705.532,
 0.091423,   706.580,
 0.091978,   707.627,
 0.092533,   708.672,
 0.093089,   709.716,
 0.093644,   710.758,
 0.094199,   711.799,
 0.094754,   712.839,
 0.095309,   713.878,
 0.095864,   714.915,
 0.096419,   715.950,
 0.096974,   716.984,
 0.097529,   718.017,
 0.098084,   719.049,
 0.098639,   720.079,
 0.099194,   721.108,
 0.099749,   722.135,
 0.100304,   723.161,
 0.100859,   724.186,
 0.101414,   725.210,
 0.101969,   726.232,
 0.102524,   727.252,
 0.103078,   728.272,
 0.103633,   729.290,
 0.104188,   730.306,
 0.104743,   731.322,
 0.105298,   732.336,
 0.105853,   733.348,
 0.106408,   734.360,
 0.106963,   735.370,
 0.107518,   736.378,
 0.108073,   737.386,
 0.108627,   738.392,
 0.109182,   739.396,
 0.109737,   740.400,
 0.110292,   741.402,
 0.110847,   742.402,
 0.111402,   743.402,
 0.111957,   744.400,
 0.112511,   745.396,
 0.113066,   746.392,
 0.113621,   747.386,
 0.114176,   748.379,
 0.114731,   749.370,
 0.115285,   750.360,
 0.115840,   751.349,
 0.116395,   752.337,
 0.116950,   753.323,
 0.117505,   754.308,
 0.118059,   755.292,
 0.118614,   756.274,
 0.119169,   757.255,
 0.119724,   758.235,
 0.120278,   759.213,
 0.120833,   760.191,
 0.121388,   761.167,
 0.121943,   762.141,
 0.122497,   763.114,
 0.123052,   764.087,
 0.123607,   765.057,
 0.124161,   766.027,
 0.124716,   766.995,
 0.125271,   767.962,
 0.125825,   768.928,
 0.126380,   769.892,
 0.126935,   770.855,
 0.127489,   771.817,
 0.128044,   772.777,
 0.128599,   773.737,
 0.129153,   774.695,
 0.129708,   775.652,
 0.130263,   776.607,
 0.130817,   777.561,
 0.131372,   778.514,
 0.131926,   779.466,
 0.132481,   780.417,
 0.133036,   781.366,
 0.133590,   782.314,
 0.134145,   783.260,
 0.134699,   784.206,
 0.135254,   785.150,
 0.135809,   786.093,
 0.136363,   787.035,
 0.136918,   787.975,
 0.137472,   788.915,
 0.138027,   789.853,
 0.138581,   790.789,
 0.139136,   791.725,
 0.139690,   792.659,
 0.140245,   793.592,
 0.140799,   794.524,
 0.141354,   795.455,
 0.141908,   796.384,
 0.142463,   797.312,
 0.143017,   798.239,
 0.143572,   799.165,
 0.144126,   800.089,
 0.144681,   801.013,
 0.145235,   801.935,
 0.145790,   802.856,
 0.146344,   803.775,
 0.146899,   804.694,
 0.147453,   805.611,
 0.148008,   806.527,
 0.148562,   807.442,
 0.149116,   808.355,
 0.149671,   809.268,
 0.150225,   810.179,
 0.150780,   811.089,
 0.151334,   811.997,
 0.151888,   812.905,
 0.152443,   813.811,
 0.152997,   814.717,
 0.153552,   815.621,
 0.154106,   816.523,
 0.154660,   817.425,
 0.155215,   818.325,
 0.155769,   819.225,
 0.156323,   820.123,
 0.156878,   821.019,
 0.157432,   821.915,
 0.157986,   822.810,
 0.158541,   823.703,
 0.159095,   824.595,
 0.159649,   825.486,
 0.160204,   826.376,  ))

D_T=DEFI_FONCTION(        NOM_PARA='TEMP',
                            PROL_DROITE='CONSTANT',
                           PROL_GAUCHE='CONSTANT',
                          VALE=( 0.,     2.,
                                 1000.,  2.,        ))

S1_T=DEFI_FONCTION(        NOM_PARA='TEMP',
                            PROL_DROITE='CONSTANT',
                           PROL_GAUCHE='CONSTANT',
                          VALE=( 0.,     490.,
                                 1000.,  490.,       ))

F0_T=DEFI_FONCTION(        NOM_PARA='TEMP',
                            PROL_DROITE='CONSTANT',
                           PROL_GAUCHE='CONSTANT',
                          VALE=( 0.,     5.E-4,
                                 1000.,  5.E-4,       ))

ACIER=DEFI_MATERIAU(               ELAS=_F(   E = 206400.,
                                               NU = .3,
                                               ALPHA = 0.),
                                   TRACTION=_F(   SIGM = ECRISO),
                              ROUSSELIER_FO=_F(   D = D_T,
                                               SIGM_1 = S1_T,
                                               PORO_INIT = F0_T))

CHT0=CREA_CHAMP(OPERATION='AFFE', TYPE_CHAM='CART_TEMP_R', MAILLAGE=CUBE,
           AFFE=_F(  TOUT='OUI',   NOM_CMP = 'TEMP',   VALE = 0.E0,  ) )
MAT=AFFE_MATERIAU(  MAILLAGE=CUBE,
                    AFFE=_F(  MAILLE = 'MA1', MATER = ACIER),
                    AFFE_VARC= _F( TOUT = 'OUI', NOM_VARC = 'TEMP', CHAM_GD=CHT0, VALE_REF=20.),
                                           )

LINST=DEFI_LIST_REEL(              DEBUT=.4,
                              INTERVALLE=_F(  JUSQU_A = 1.,  NOMBRE = 8))

TR_CS=AFFE_CHAR_MECA(
            MODELE=TROISD,DDL_IMPO=(
           _F( NOEUD = 'NO4', DX = 0.,DY = 0.),
                    _F( NOEUD = 'NO8', DX = 0.,DY = 0.,DZ = 0.),
                    _F( NOEUD = 'NO2', DX = 0.),
                    _F( NOEUD = 'NO6', DX = 0.)),FORCE_NODALE=(
           _F( NOEUD = ('NO3', 'NO7',),  FX = -50.,  FY = -25.),
                        _F( NOEUD = ('NO4', 'NO8',),  FX = -25.,  FY = 25.),
                        _F( NOEUD = ('NO2', 'NO6',),  FX = 25.,  FY = 25.),
                        _F( NOEUD = ('NO1', 'NO5',),           FY = -25.)) )

COEF=DEFI_FONCTION(      NOM_PARA='INST',
                            PROL_DROITE='LINEAIRE',
                           PROL_GAUCHE='LINEAIRE',
                          VALE=( 0.0,  0.0,
                                 1.0,  4.09707,                  ))

SOLNL=STAT_NON_LINE(
               TITRE='TEST TRACTION_CISAILLEMENT ROUSSELIER',
                            MODELE=TROISD,
                        CHAM_MATER=MAT,
                             EXCIT=_F(
                CHARGE = TR_CS,
                FONC_MULT = COEF),
                         COMPORTEMENT=_F(
                RELATION = 'ROUSS_PR',
                RESI_INTE_RELA = 1.E-6,
                ITER_INTE_MAXI = 10,),
                         INCREMENT=_F(
                LIST_INST = LINST),
                            NEWTON=_F(
                MATRICE = 'TANGENTE',
                REAC_ITER = 1),
                       CONVERGENCE=_F(
                ITER_GLOB_MAXI = 10,
                RESI_GLOB_RELA = 1.E-6)
              )

SOLNL=CALC_CHAMP(reuse=SOLNL,CONTRAINTE=('SIGM_ELNO'),VARI_INTERNE=('VARI_ELNO'),RESULTAT=SOLNL)


#

TEST_RESU(RESU=(_F(NUME_ORDRE=8,
                   PARA='INST',
                   RESULTAT=SOLNL,
                   VALE_CALC=1.0,),
                _F(NUME_ORDRE=8,
                   PARA='ITER_GLOB',
                   VALE_CALC_I=4,
                   RESULTAT=SOLNL,
                   CRITERE='ABSOLU',
                   ),
                ),
          )

SOLNL=CALC_CHAMP(reuse=SOLNL,RESULTAT=SOLNL,DEFORMATION=('EPSI_ELNO'))


TEST_RESU(RESU=(_F(NUME_ORDRE=8,
                   RESULTAT=SOLNL,
                   NOM_CHAM='SIGM_ELNO',
                   NOEUD='NO1',
                   NOM_CMP='SIXX',
                   REFERENCE='ANALYTIQUE',
                   VALE_REFE=409.707,
                   VALE_CALC=409.70759451539,
                   PRECISION=5.0E-4,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   RESULTAT=SOLNL,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO1',
                   NOM_CMP='EPXX',
                   REFERENCE='ANALYTIQUE',
                   VALE_CALC=0.078386709783684,
                   VALE_REFE=0.07830,
                   PRECISION=2.E-3,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   RESULTAT=SOLNL,
                   NOM_CHAM='EPSI_ELNO',
                   NOEUD='NO1',
                   NOM_CMP='EPXY',
                   REFERENCE='ANALYTIQUE',
                   VALE_CALC=0.11705818574568,
                   VALE_REFE=0.11700,
                   PRECISION=2.E-3,
                   MAILLE='MA1',),
                _F(NUME_ORDRE=8,
                   RESULTAT=SOLNL,
                   NOM_CHAM='VARI_ELNO',
                   NOEUD='NO1',
                   NOM_CMP='V1',
                   REFERENCE='ANALYTIQUE',
                   VALE_REFE=0.15260,
                   VALE_CALC=0.15263655315546,
                   PRECISION=1.E-3,
                   MAILLE='MA1',),
                ),
          )

FIN()
#
