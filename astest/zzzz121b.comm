# MODIF  DATE 13/12/2011   AUTEUR PELLET J.PELLET 
# TITRE COUPLAGE ASTER_HOMARD - CAS TRIDIMENSIONNEL
# zzzz121b.para = tps_job 60 mem_job 32Mo ncpus 1 liste_test R
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# RESPONSABLE GNICOLAS G.NICOLAS
# Attention :ceci est un test de non regression et non pas d'evaluation
# de l'adaptation de maillage.
# . Cas d'un cube decoupe en 6 tetraedres, en degre 2
#
#             7                   8
#             --------------------
#            /                   /.
#           /                   / .
#          /                   /  .
#         /                   /   .
#       3 -------------------- 4  .
#         .                  .    .
#         .                  .    .
#         .    5             .    . 6
#         .                  .   /
#         .                  .  /
#         .                  . /
#         .                  ./
#         --------------------
#         1                  2
# NOMBRE DE NOEUDS  : 27
#
# NOMBRE DE MAILLES : 20
#                   POI1    :  2
#                   SEG3    :  1
#                   TRIA6   : 12
#                   TETRA10 :  6
#
# NOMBRE DE GROUPES DE NOEUDS : 5
#                   ORIGINE : 1    NO1(0.,0.,0.)
#                   I       : 1    NO2(1.,0.,0.)
#                   J       : 1    NO5(0.,1.,0.)
#                   K       : 1    NO3(0.,0.,1.)
#                   OPPOSE  : 1    NO8(1.,1.,1.)
#
# NOMBRE DE GROUPES DE MAILLES : 7
#                   MOITIE1   :  3  cote ORIGINE par rapport au plan (2,4,5,7)
#                   MOITIE2   :  3  cote OPPOSE par rapport au plan (2,4,5,7)
#                   Y_0       :  2  triangles du plan y=0 (1,2,4,3)
#                   Z_1       :  2  triangles du plan z=1 (3,4,7,8)
#                   BORD_EXT  :  8  Les 8 autres triangles de bord
#                   O_I       :  1  segment de la ligne y=z=0 (NO1->NO2)
#                   MP_K      :  1  maille-point basee sur K (NO3)
#                   MP_O      :  1  maille-point basee sur ORIGINE (NO1)
# . Information
# . 5 adaptations avec des variantes

DEBUT(CODE=_F(NOM='ZZZZ121B',
              NIV_PUB_WEB='INTERNET',),
      DEBUG=_F(SDVERI='NON',),);
#
# 1. DEFINITION DES MATERIAUX

MATER1=DEFI_MATERIAU(ELAS=_F(E=180000.,
                             NU=0.30,
                             RHO=7700.,
                             ALPHA=15.E-6,),);
#

MATER2=DEFI_MATERIAU(ELAS=_F(E=220000.,
                             NU=0.33,
                             RHO=8300.,
                             ALPHA=16.E-6,),);
#
# 2. LECTURE DU MAILLAGE ET TEST DE LA MACRO SUR L'INFORMATION

MZERO=LIRE_MAILLAGE();
#

# Attention : le test d'interpenetration peut etre long (voir la documentation).
MACR_INFO_MAIL(MAILLAGE=MZERO,
               NOMBRE='OUI',
               QUALITE='OUI',
               CONNEXITE='OUI',
               TAILLE='OUI',
               INTERPENETRATION='OUI',
               PROP_CALCUL='OUI',);
#
# 3. CALCUL SUR LE MAILLAGE ZERO
# 3.1. MODELE MECANIQUE

MODEZERO=AFFE_MODELE(MAILLAGE=MZERO,
                     AFFE=_F(TOUT='OUI',
                             PHENOMENE='MECANIQUE',
                             MODELISATION='3D',),);

MZERO=MODI_MAILLAGE(reuse =MZERO,
                    MAILLAGE=MZERO,
                    ORIE_PEAU_3D=_F(GROUP_MA=('BORD_EXT','Z_1','Y_0',),),);
#
# 3.2. MISE EN PLACE DES MATERIAUX

MATEZERO=AFFE_MATERIAU(MAILLAGE=MZERO,
                       AFFE=(_F(GROUP_MA='MOITIE1',
                                MATER=MATER1,),
                             _F(GROUP_MA='MOITIE2',
                                MATER=MATER2,),),);
#
# 3.4. CHARGEMENTS
FORCE_Z=78480.;
PRES_0 = 0.0;
PRES_0 = 1.E-14;
CHARZERO=AFFE_CHAR_MECA(MODELE=MODEZERO,
                        PESANTEUR=_F(GRAVITE=9.81,
                                     DIRECTION=(0.,0.,-1.,),),
                        DDL_IMPO=(_F(GROUP_NO='J',
                                    DZ=0.,),
                                  _F(GROUP_MA='O_I',
                                     DX=0.,
                                     DY=0.,
                                     DZ=0.,),),
                        FORCE_FACE=_F(GROUP_MA='Z_1',
                                      FZ=FORCE_Z,),
                        PRES_REP=(_F(GROUP_MA='Y_0',
                                     PRES=PRES_0,),
                                  _F(GROUP_MA='BORD_EXT',
                                     PRES=PRES_0,),),);
#
# 3.5. RESOLUTION

RESUZERO=MECA_STATIQUE(MODELE=MODEZERO,
                       CHAM_MATER=MATEZERO,
                       EXCIT=_F(CHARGE=CHARZERO,),);
#
# 4. ADAPTATION DU MAILLAGE DE ZERO VERS UN
#    . TOUTES LES MAILLES CONTENANT A LA FOIS LES 2 NOEUDS SOUS LES
#      MAILLES-POINTS DES 2 GROUPES.

MACR_ADAP_MAIL(MAILLAGE_N=MZERO,
               MAILLAGE_NP1=CO('MUN'),
               ADAPTATION='RAFFINEMENT_UNIFORME',
               GROUP_MA = ('MP_K', 'MP_O',),
               NOMBRE='OUI',
               QUALITE='OUI',);
#
# 5. CALCUL SUR LE MAILLAGE UN
# 5.1. MODELE MECANIQUE

MODEUN=AFFE_MODELE(MAILLAGE=MUN,
                   AFFE=_F(TOUT='OUI',
                           PHENOMENE='MECANIQUE',
                           MODELISATION='3D',),);
#
# 5.2. MISE EN PLACE DES MATERIAUX

MATEUN=AFFE_MATERIAU(MAILLAGE=MUN,
                     AFFE=(_F(GROUP_MA='MOITIE1',
                              MATER=MATER1,),
                           _F(GROUP_MA='MOITIE2',
                              MATER=MATER2,),),);
#
# 5.4. CHARGEMENTS

CHARUN=AFFE_CHAR_MECA(MODELE=MODEUN,
                      PESANTEUR=_F(GRAVITE=9.81,
                                   DIRECTION=(0.,0.,-1.,),),
                      DDL_IMPO=(_F(GROUP_NO='J',
                                  DZ=0.,),
                                _F(GROUP_MA='O_I',
                                   DX=0.,
                                   DY=0.,
                                   DZ=0.,),),
                      FORCE_FACE=_F(GROUP_MA='Z_1',
                                    FZ=FORCE_Z,),
                      PRES_REP=(_F(GROUP_MA='Y_0',
                                   PRES=PRES_0,),
                                _F(GROUP_MA='BORD_EXT',
                                   PRES=PRES_0,),),);
#
# 5.5. RESOLUTION

RESUUN=MECA_STATIQUE(MODELE=MODEUN,
                     CHAM_MATER=MATEUN,
                     EXCIT=_F(CHARGE=CHARUN,),);
#
# 5.6. CALCUL DE L'INDICATEUR D'ERREUR

RESUUN=CALC_ELEM(reuse =RESUUN,
                 RESULTAT=RESUUN,
                 OPTION=('SIGM_ELNO',),);

RESUUN=CALC_ERREUR(reuse =RESUUN,
                   RESULTAT=RESUUN,
                   OPTION=('ERME_ELEM',),);
#
# 6. TEST DE NON REGRESSION

TEST_RESU(RESU=(_F(RESULTAT=RESUUN,
                   NUME_ORDRE=1,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DX',
                   GROUP_NO='OPPOSE',
                   VALE=0.00368805181,
                   CRITERE='RELATIF',
                   PRECISION=1E-06,
                   REFERENCE='NON_REGRESSION',
                   VERSION='8.02.05',),
                _F(RESULTAT=RESUUN,
                   NUME_ORDRE=1,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DY',
                   GROUP_NO='OPPOSE',
                   VALE=0.0616572976,
                   CRITERE='RELATIF',
                   PRECISION=1E-06,
                   REFERENCE='NON_REGRESSION',
                   VERSION='8.02.05',),
                _F(RESULTAT=RESUUN,
                   NUME_ORDRE=1,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DZ',
                   GROUP_NO='OPPOSE',
                   VALE=0.0404077437,
                   CRITERE='RELATIF',
                   PRECISION=1E-06,
                   REFERENCE='NON_REGRESSION',
                   VERSION='8.02.05',),),);
#
# 7. ADAPTATION DU MAILLAGE DE UN VERS DEUX
#    . RAFFINEMENT ET DERAFFINEMENT
#    . SELECTION DE L'INDICATEUR PAR UN CHAMP DE GRANDEUR
#    . MISE A JOUR D'UN CHAMP DE GRANDEUR

INDICUN=CREA_CHAMP(TYPE_CHAM='ELEM_ERRE_R',
                   OPERATION='EXTR',
                   RESULTAT=RESUUN,
                   NOM_CHAM='ERME_ELEM',
                   NUME_ORDRE=1,);
#

DEPLUN=CREA_CHAMP(TYPE_CHAM='NOEU_DEPL_R',
                  OPERATION='EXTR',
                  RESULTAT=RESUUN,
                  NOM_CHAM='DEPL',
                  NUME_ORDRE=1,);
#

MACR_ADAP_MAIL(LANGUE='ANGLAIS',
               MAILLAGE_N=MUN,
               MAILLAGE_NP1=CO('MDEUX'),
               ADAPTATION='RAFF_DERA',
               CHAM_GD=INDICUN,
               NOM_CMP='ERREST',
               CRIT_RAFF_PE=0.20,
               CRIT_DERA_PE=0.25,
               NIVE_MAX=8,
               NIVE_MIN=0,
               MAJ_CHAM=_F(CHAM_MAJ=CO('DEPLDEUX'),
                           TYPE_CHAM='NOEU_DEPL_R',
                           CHAM_GD=DEPLUN,),
               NOMBRE='OUI',
               QUALITE='OUI',);
#
# 8. CALCUL SUR LE MAILLAGE DEUX
# 8.1. MODELE MECANIQUE

MODEDEUX=AFFE_MODELE(MAILLAGE=MDEUX,
                     AFFE=_F(TOUT='OUI',
                             PHENOMENE='MECANIQUE',
                             MODELISATION='3D',),);
#
# 8.2. MISE EN PLACE DES MATERIAUX

MATEDEUX=AFFE_MATERIAU(MAILLAGE=MDEUX,
                       AFFE=(_F(GROUP_MA='MOITIE1',
                                MATER=MATER1,),
                             _F(GROUP_MA='MOITIE2',
                                MATER=MATER2,),),);
#
# 8.3. CHARGEMENTS

CHARDEUX=AFFE_CHAR_MECA(MODELE=MODEDEUX,
                        PESANTEUR=_F(GRAVITE=9.81,
                                     DIRECTION=(0.,0.,-1.,),),
                        DDL_IMPO=(_F(GROUP_NO='J',
                                    DZ=0.,),
                                  _F(GROUP_MA='O_I',
                                     DX=0.,
                                     DY=0.,
                                     DZ=0.,),),
                        FORCE_FACE=_F(GROUP_MA='Z_1',
                                      FZ=FORCE_Z,),
                        PRES_REP=(_F(GROUP_MA='Y_0',
                                     PRES=PRES_0,),
                                  _F(GROUP_MA='BORD_EXT',
                                     PRES=PRES_0,),),);
#
# 8.4. RESOLUTION

RESUDEUX=MECA_STATIQUE(MODELE=MODEDEUX,
                       CHAM_MATER=MATEDEUX,
                       EXCIT=_F(CHARGE=CHARDEUX,),);
#
# 9. TEST DE NON REGRESSION

TEST_RESU(CHAM_NO=_F(CHAM_GD=DEPLDEUX,
                     GROUP_NO='OPPOSE',
                     NOM_CMP='DY',
                     VALE=0.0616572976,
                     CRITERE='RELATIF',
                     PRECISION=1E-06,
                     REFERENCE='NON_REGRESSION',
                     VERSION='8.02.05',),
          RESU=(_F(RESULTAT=RESUDEUX,
                   NUME_ORDRE=1,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DX',
                   GROUP_NO='OPPOSE',
                   VALE=7.16394889E-3,
                   CRITERE='RELATIF',
                   PRECISION=1E-06,
                   REFERENCE='NON_REGRESSION',
                   VERSION='9.05.04',),
                _F(RESULTAT=RESUDEUX,
                   NUME_ORDRE=1,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DY',
                   GROUP_NO='OPPOSE',
                   VALE=6.32300372E-2,
                   CRITERE='RELATIF',
                   PRECISION=1E-06,
                   REFERENCE='NON_REGRESSION',
                   VERSION='9.05.04',),
                _F(RESULTAT=RESUDEUX,
                   NUME_ORDRE=1,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DZ',
                   GROUP_NO='OPPOSE',
                   VALE=3.32149366E-2,
                   CRITERE='RELATIF',
                   PRECISION=1E-06,
                   REFERENCE='NON_REGRESSION',
                   VERSION='9.05.04',),),);
#
# 10. ADAPTATION DU MAILLAGE DE DEUX VERS TROIS
#     . NI RAFFINEMENT, NI DERAFFINEMENT
#     . MISE A JOUR DE CHAMP

MACR_ADAP_MAIL(MAILLAGE_N=MDEUX,
               MAILLAGE_NP1=CO('MTROI'),
               ADAPTATION='RIEN',
               MAJ_CHAM=_F(CHAM_MAJ=CO('DEPLTROI'),
                           TYPE_CHAM='NOEU_DEPL_R',
                           RESULTAT=RESUDEUX,
                           NOM_CHAM='DEPL',
                           NUME_ORDRE=1,),
               NOMBRE='OUI',
               QUALITE='OUI',);
#
# 11. CALCUL SUR LE MAILLAGE TROIS
# 11.1. MODELE MECANIQUE

MODETROI=AFFE_MODELE(MAILLAGE=MTROI,
                     AFFE=_F(TOUT='OUI',
                             PHENOMENE='MECANIQUE',
                             MODELISATION='3D',),);
#
# 11.2. MISE EN PLACE DES MATERIAUX

MATETROI=AFFE_MATERIAU(MAILLAGE=MTROI,
                       AFFE=(_F(GROUP_MA='MOITIE1',
                                MATER=MATER1,),
                             _F(GROUP_MA='MOITIE2',
                                MATER=MATER2,),),);
#
# 11.4. CHARGEMENTS

CHA_TROI=AFFE_CHAR_MECA(MODELE=MODETROI,
                        PESANTEUR=_F(GRAVITE=9.81,
                                     DIRECTION=(0.,0.,-1.,),),
                        DDL_IMPO=(_F(GROUP_NO='J',
                                    DZ=0.,),
                                  _F(GROUP_MA='O_I',
                                     DX=0.,
                                     DY=0.,
                                     DZ=0.,),),
                        PRES_REP=(_F(GROUP_MA='Y_0',
                                     PRES=PRES_0,),
                                  _F(GROUP_MA='BORD_EXT',
                                     PRES=PRES_0,),),);

FZ=DEFI_PARA_SENSI(VALE=FORCE_Z,);

CHAFTROI=AFFE_CHAR_MECA_F(MODELE=MODETROI,
                          FORCE_FACE=_F(GROUP_MA='Z_1',
                                        FZ=FZ,),);
#
# 11.5. RESOLUTION

RESUTROI=MECA_STATIQUE(MODELE=MODETROI,
                       CHAM_MATER=MATETROI,
                       EXCIT=(_F(CHARGE=CHA_TROI,),
                              _F(CHARGE=CHAFTROI,),),
                       SENSIBILITE=FZ,);
#
# 12. TEST DE NON REGRESSION

TEST_RESU(CHAM_NO=_F(CHAM_GD=DEPLTROI,
                     GROUP_NO='OPPOSE',
                     NOM_CMP='DZ',
                     VALE=3.32149366E-2,
                     CRITERE='RELATIF',
                     PRECISION=1E-06,
                     REFERENCE='NON_REGRESSION',
                     VERSION='9.05.04',),
          RESU=(_F(RESULTAT=RESUTROI,
                   NUME_ORDRE=1,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DX',
                   GROUP_NO='OPPOSE',
                   VALE=7.16394889E-3,
                   CRITERE='RELATIF',
                   PRECISION=1E-06,
                   REFERENCE='NON_REGRESSION',
                   VERSION='9.05.04',),
                _F(RESULTAT=RESUTROI,
                   NUME_ORDRE=1,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DY',
                   GROUP_NO='OPPOSE',
                   VALE=6.32300372E-2,
                   CRITERE='RELATIF',
                   PRECISION=1E-06,
                   REFERENCE='NON_REGRESSION',
                   VERSION='9.05.04',),
                _F(RESULTAT=RESUTROI,
                   NUME_ORDRE=1,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DZ',
                   GROUP_NO='OPPOSE',
                   VALE=3.32149366E-2,
                   CRITERE='RELATIF',
                   PRECISION=1E-06,
                   REFERENCE='NON_REGRESSION',
                   VERSION='9.05.04',),),);
#
# 13. ADAPTATION DU MAILLAGE DE TROIS VERS QUATRE
#     . RAFFINEMENT SELON LA VALEUR RELATIVE DE l'INDICATEUR
#     . SELECTION DE L'INDICATEUR PAR LA DERIVEE D'UN CHAMP DE GRANDEUR
#     . MISE A JOUR DE LA DERIVEE D'UN CHAMP DE GRANDEUR
#     . MISE A JOUR EN AUTO ET EN ISO-P2

MACR_ADAP_MAIL(MAILLAGE_N=MTROI,
               MAILLAGE_NP1=CO('MQUAT'),
               ADAPTATION='RAFF_DERA',
               RESULTAT_N=RESUTROI,
               NOM_CHAM='DEPL',
               SENSIBILITE=FZ,
               NOM_CMP='DX',
               USAGE_CMP='ABSOLU',
               CRIT_RAFF_PE=0.20,
               CRIT_DERA_PE=0.25,
               MAJ_CHAM=(_F(CHAM_MAJ=CO('DUDFQUAT'),
                            TYPE_CHAM='NOEU_DEPL_R',
                            RESULTAT=RESUTROI,
                            NOM_CHAM='DEPL',
                            SENSIBILITE=FZ,
                            NUME_ORDRE=1,),
                         _F(CHAM_MAJ=CO('U_4_AUTO'),
                            TYPE_CHAM='NOEU_DEPL_R',
                            RESULTAT=RESUTROI,
                            NOM_CHAM='DEPL',
                            NUME_ORDRE=1,
                            TYPE_MAJ='AUTO',),
                         _F(CHAM_MAJ=CO('U_4_ISP2'),
                            TYPE_CHAM='NOEU_DEPL_R',
                            RESULTAT=RESUTROI,
                            NOM_CHAM='DEPL',
                            NUME_ORDRE=1,
                            TYPE_MAJ='ISOP2',),),
               NOMBRE='OUI',
               PROP_CALCUL='OUI',);
#
#    TEST DE NON REGRESSION SUR L'INTERPOLATION P2 ou ISO-P2
#    ON CREE UN GROUPE DE NOEUD CONTENANT UN NOEUD CREE AU MILIEU D'UNE ARETE.
#    CETTE POSITION PERMET DE COMPARER LES 2 TYPES D'INTERPOLATION : AUTOMATIQUE, DONC P2, ET ISO-P2
#    CELA PERMET DE S'AFFRANCHIR D'EVENTUELS CHANGEMENTS DE
#    NUMEROTATION DES NOEUDS DANS HOMARD ET DE PERENISER LES TESTS
#    REMARQUE : LE NOM EST CELUI DU NOEUD POUR LA VERSION 10.03.04
#
MQUAT=DEFI_GROUP( reuse =MQUAT,
                  MAILLAGE=MQUAT,
                  CREA_GROUP_NO=_F(NOM='N120',
                                   OPTION='ENV_SPHERE',
                                   POINT=(0.625,0.125,1.),
                                   PRECISION=1/200.,
                                   RAYON=1/200.),);

TEST_RESU(CHAM_NO=(_F(CHAM_GD=U_4_AUTO,
                     GROUP_NO='N120',
                     NOM_CMP='DZ',
                     VALE=0.189165296,
                     CRITERE='RELATIF',
                     PRECISION=1E-06,
                     REFERENCE='NON_REGRESSION',
                     VERSION='10.03.04',),
                   _F(CHAM_GD=U_4_ISP2,
                     GROUP_NO='N120',
                     NOM_CMP='DZ',
                     VALE=0.194256871,
                     CRITERE='RELATIF',
                     PRECISION=1E-06,
                     REFERENCE='NON_REGRESSION',
                     VERSION='10.03.04',),),),
#
# 14. CALCUL SUR LE MAILLAGE QUAT
# 14.1. MODELE MECANIQUE

MODEQUAT=AFFE_MODELE(MAILLAGE=MQUAT,
                     AFFE=_F(TOUT='OUI',
                             PHENOMENE='MECANIQUE',
                             MODELISATION='3D',),);
#
# 14.2. MISE EN PLACE DES MATERIAUX

MATEQUAT=AFFE_MATERIAU(MAILLAGE=MQUAT,
                       AFFE=(_F(GROUP_MA='MOITIE1',
                                MATER=MATER1,),
                             _F(GROUP_MA='MOITIE2',
                                MATER=MATER2,),),);
#
# 14.3. CHARGEMENTS

CHARQUAT=AFFE_CHAR_MECA(MODELE=MODEQUAT,
                        PESANTEUR=_F(GRAVITE=9.81,
                                     DIRECTION=(0.,0.,-1.,),),
                        DDL_IMPO=(_F(GROUP_NO='J',
                                    DZ=0.,),
                                  _F(GROUP_MA='O_I',
                                     DX=0.,
                                     DY=0.,
                                     DZ=0.,),),
                        FORCE_FACE=_F(GROUP_MA='Z_1',
                                      FZ=FORCE_Z,),
                        PRES_REP=(_F(GROUP_MA='Y_0',
                                     PRES=PRES_0,),
                                  _F(GROUP_MA='BORD_EXT',
                                     PRES=PRES_0,),),);
#
# 14.4. RESOLUTION

RESUQUAT=MECA_STATIQUE(MODELE=MODEQUAT,
                       CHAM_MATER=MATEQUAT,
                       EXCIT=_F(CHARGE=CHARQUAT,),);
#
# 14.5. CALCUL DE L'INDICATEUR D'ERREUR

RESUQUAT=CALC_ELEM(reuse =RESUQUAT,
                   RESULTAT=RESUQUAT,
                   OPTION=('SIGM_ELNO',),);

RESUQUAT=CALC_ERREUR(reuse =RESUQUAT,
                     RESULTAT=RESUQUAT,
                     OPTION=('ERME_ELEM',),);
#
# 15. TEST DE NON REGRESSION

TEST_RESU(CHAM_NO=_F(CHAM_GD=DUDFQUAT,
                     GROUP_NO='OPPOSE',
                     NOM_CMP='DX',
                     VALE=-1.94138756E-05,
                     CRITERE='RELATIF',
                     PRECISION=1E-06,
                     REFERENCE='NON_REGRESSION',
                     VERSION='9.05.04',),
          RESU=_F(RESULTAT=RESUQUAT,
                  NUME_ORDRE=1,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DZ',
                  GROUP_NO='OPPOSE',
                  VALE=1.24340262E-03,
                  CRITERE='RELATIF',
                  PRECISION=1E-06,
                  REFERENCE='NON_REGRESSION',
                  VERSION='9.05.04',),);
#
# 16. ADAPTATION DU MAILLAGE DE QUATRE VERS CINQ
#     . RAFFINEMENT SELON L'INDICATEUR D'ERREUR
#     . FILTRAGE SUR LES MAILLES DU GROUPE 'MOITIE2'

MACR_ADAP_MAIL(MAILLAGE_N=MQUAT,
               MAILLAGE_NP1=CO('MCINQ'),
               ADAPTATION='RAFFINEMENT',
               RESULTAT_N=RESUQUAT,
               NOM_CHAM='ERME_ELEM',
               NOM_CMP='ERREST',
               GROUP_MA='MOITIE2',
               CRIT_RAFF_PE=0.20,
               NOMBRE='OUI',
               PROP_CALCUL='OUI',);
#
# 17. CALCUL SUR LE MAILLAGE CINQ
# 17.1. MODELE MECANIQUE

MODECINQ=AFFE_MODELE(MAILLAGE=MCINQ,
                     AFFE=_F(TOUT='OUI',
                             PHENOMENE='MECANIQUE',
                             MODELISATION='3D',),);
#
# 17.2. MISE EN PLACE DES MATERIAUX

MATECINQ=AFFE_MATERIAU(MAILLAGE=MCINQ,
                       AFFE=(_F(GROUP_MA='MOITIE1',
                                MATER=MATER1,),
                             _F(GROUP_MA='MOITIE2',
                                MATER=MATER2,),),);
#
# 17.3. CHARGEMENTS

CHARCINQ=AFFE_CHAR_MECA(MODELE=MODECINQ,
                        PESANTEUR=_F(GRAVITE=9.81,
                                     DIRECTION=(0.,0.,-1.,),),
                        DDL_IMPO=(_F(GROUP_NO='J',
                                    DZ=0.,),
                                  _F(GROUP_MA='O_I',
                                     DX=0.,
                                     DY=0.,
                                     DZ=0.,),),
                        FORCE_FACE=_F(GROUP_MA='Z_1',
                                      FZ=FORCE_Z,),
                        PRES_REP=(_F(GROUP_MA='Y_0',
                                     PRES=PRES_0,),
                                  _F(GROUP_MA='BORD_EXT',
                                     PRES=PRES_0,),),);
#
# 17.4. RESOLUTION

RESUCINQ=MECA_STATIQUE(MODELE=MODECINQ,
                       CHAM_MATER=MATECINQ,
                       EXCIT=_F(CHARGE=CHARCINQ,),);
#
# 18. TEST DE NON REGRESSION

TEST_RESU(RESU=_F(RESULTAT=RESUCINQ,
                  NUME_ORDRE=1,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DZ',
                  GROUP_NO='OPPOSE',
                  VALE=-5.46210778E-02,
                  CRITERE='RELATIF',
                  PRECISION=1E-06,
                  REFERENCE='NON_REGRESSION',
                  VERSION='9.05.04',),);
#
# 19. LES GRANDEURS GLOBALES
# 19.1. MAILLAGE INITIAL

MCGZERO=POST_ELEM(MASS_INER=(_F(TOUT='OUI',),
                             _F(  GROUP_MA=('MOITIE1','MOITIE2',),),),
                  MODELE=MODEZERO,
                  CHAM_MATER=MATEZERO,
                  TITRE='POUR LE MAILLAGE INITIAL',);
#
# 19.2. APRES LA PREMIERE ADAPTATION

MCGUN=POST_ELEM(MASS_INER=(_F(TOUT='OUI',),
                           _F(  GROUP_MA=('MOITIE1','MOITIE2',),),),
                MODELE=MODEUN,
                CHAM_MATER=MATEUN,
                TITRE='APRES LA PREMIERE ADAPTATION',);
#
#
# 19.3. A LA FIN DES ADAPTATIONS

MCGCINQ=POST_ELEM(MASS_INER=(_F(TOUT='OUI',),
                             _F(  GROUP_MA=('MOITIE1','MOITIE2',),),),
                  MODELE=MODECINQ,
                  CHAM_MATER=MATECINQ,
                  TITRE='A LA FIN DES ADAPTATIONS',);
#
# 19.4. Impressions comparatives

IMPR_TABLE(TABLE=MCGZERO,
           NOM_PARA=('LIEU','ENTITE','MASSE','CDG_X','CDG_Y','CDG_Z',),);

IMPR_TABLE(TABLE=MCGUN,
           NOM_PARA=('LIEU','ENTITE','MASSE','CDG_X','CDG_Y','CDG_Z',),);

IMPR_TABLE(TABLE=MCGCINQ,
           NOM_PARA=('LIEU','ENTITE','MASSE','CDG_X','CDG_Y','CDG_Z',),);

IMPR_TABLE(TABLE=MCGZERO,
           NOM_PARA=('LIEU','IX_G','IY_G','IZ_G','IXY_G','IXZ_G','IYZ_G',),);

IMPR_TABLE(TABLE=MCGUN,
           NOM_PARA=('LIEU','IX_G','IY_G','IZ_G','IXY_G','IXZ_G','IYZ_G',),);

IMPR_TABLE(TABLE=MCGCINQ,
           NOM_PARA=('LIEU','IX_G','IY_G','IZ_G','IXY_G','IXZ_G','IYZ_G',),);

IMPR_TABLE(TABLE=MCGZERO,
           NOM_PARA=('LIEU','IX_PRIN_G','IY_PRIN_G','IZ_PRIN_G','ALPHA','BETA','GAMMA',),);

IMPR_TABLE(TABLE=MCGUN,
           NOM_PARA=('LIEU','IX_PRIN_G','IY_PRIN_G','IZ_PRIN_G','ALPHA','BETA','GAMMA',),);

IMPR_TABLE(TABLE=MCGCINQ,
           NOM_PARA=('LIEU','IX_PRIN_G','IY_PRIN_G','IZ_PRIN_G','ALPHA','BETA','GAMMA',),);
#
# 19.5. Test de non regression

TEST_TABLE(TABLE=MCGCINQ,
           FILTRE=_F(NOM_PARA='LIEU',
                     VALE_K='MOITIE2',),
           NOM_PARA='IZ_PRIN_G',
           VALE=691.666667,
           CRITERE='RELATIF',
           PRECISION=1E-06,
           REFERENCE='NON_REGRESSION',
           VERSION='9.01.17',);
#
# 20. IMPRESSIONS POUR CREER LA BASE DU CAS-TEST HOMARD tet_cube_d2_fil
#IMPR_RESU(FORMAT='MED',
         #RESU=_F(MAILLAGE=MZERO,),);
#IMPR_RESU(FORMAT='MED',
         #RESU=_F(MAILLAGE=MUN,),);
#IMPR_RESU(FORMAT='MED',
         #RESU=_F(CHAM_GD=INDICUN,),);
#IMPR_RESU(FORMAT='MED',
         #RESU=_F(CHAM_GD=DEPLUN,),);
#IMPR_RESU(FORMAT='MED',
         #RESU=_F(RESULTAT=RESUDEUX,),);
#IMPR_RESU(FORMAT='MED',
         #RESU=_F(RESULTAT=RESUTROI,),);
#IMPR_RESU(FORMAT='MED',
         #RESU=_F(RESULTAT=RESUTROI,
                 #SENSIBILITE=FZ,),);
#IMPR_RESU(FORMAT='MED',
         #RESU=_F(RESULTAT=RESUQUAT,),);
##IMPR_RESU(FORMAT='MED',
         ##RESU=_F(RESULTAT=RESUCINQ,),);

FIN(FORMAT_HDF='OUI',);
