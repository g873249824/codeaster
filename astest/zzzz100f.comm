# TITRE FONCTIONS, NAPPES, VALIDATION DE CALC_FONCTION / FRACTILE
# ======================================================================
# COPYRIGHT (C) 1991 - 2015  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET',),DEBUG=_F(SDVERI='OUI',),
      IGNORE_ALARM='UTILITAI3_37')

#========================================================================
#     DEFINITION DES NAPPES ET DES FONCTIONS
#========================================================================

# inversé pour tester le classement des paramètres => alarme UTILITAI3_37
N1=DEFI_NAPPE(NOM_PARA='INST',
              PARA=(222., 111.),
              NOM_PARA_FONC='X',
              DEFI_FONCTION=(_F(VALE=(1.0,3.0,2.0,4.0,),),
                             _F(VALE=(1.0,3.0,2.0,4.0,),),),)

N2=DEFI_NAPPE(NOM_PARA='INST',
              PARA=(111.,222.),
              NOM_PARA_FONC='X',
              DEFI_FONCTION=(_F(VALE=(1.0,4.0,2.0,9.0,),),
                             _F(VALE=(1.0,4.0,2.0,9.0,),),),)

N3=DEFI_NAPPE(NOM_PARA='INST',
              PARA=(111.,222.),
              NOM_PARA_FONC='X',
              DEFI_FONCTION=(_F(VALE=(1.0,8.0,2.0,7.0,),),
                             _F(VALE=(1.0,8.0,2.0,7.0,),),),)

F0=DEFI_FONCTION(  NOM_PARA='INST',
                   VALE=( 1., 1.,
                          3., 2.,
                          5., 2.,     )  )


F1=DEFI_FONCTION(  NOM_PARA='INST',
                   VALE=( 1., 1.,
                          3., 3.,
                          5., 2.,     )  )

F2=DEFI_FONCTION(  NOM_PARA='INST',
                   VALE=( 1., 3.,
                          3., 1.,
                          5., 3.,     )  )

F3=DEFI_FONCTION(  NOM_PARA='INST',
                   VALE=( 1., 7.,
                          3., 4.,
                          5.,-3.,    )  )

#========================================================================
#     CAS NAPPE. FRACTILE = 1 : CORRESPOND A L ENVELOPPE SUP DE LA NAPPE
#========================================================================
N4=CALC_FONCTION(FRACTILE=_F(FONCTION=(N1,N2,N3),
                             FRACT=1.) )

TEST_FONCTION(VALEUR=_F(VALE_CALC=8.0,
                        VALE_REFE=8.0,
                        VALE_PARA=(222.0, 1.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=N4,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=9.0,
                        VALE_REFE=9.0,
                        VALE_PARA=(111.0, 2.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=N4,),
              )

#========================================================================
#     CAS NAPPE. FRACTILE = 0 : CORRESPOND A L ENVELOPPE INF DE LA NAPPE
#========================================================================
N5=CALC_FONCTION(FRACTILE=_F(FONCTION=(N1,N2,N3),
                             FRACT=0.) )

TEST_FONCTION(VALEUR=_F(VALE_CALC=3.0,
                        VALE_REFE=3.0,
                        VALE_PARA=(222.0, 1.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=N5,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=4.0,
                        VALE_REFE=4.0,
                        VALE_PARA=(111.0, 2.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=N5,),
              )

#========================================================================
#     CAS NAPPE. FRACTILE = 0.7
#========================================================================
N6=CALC_FONCTION(FRACTILE=_F(FONCTION=(N1,N2,N3),
                             FRACT=0.7) )

TEST_FONCTION(VALEUR=_F(VALE_CALC=5.6,
                        VALE_REFE=5.5999999999999996,
                        VALE_PARA=(222.0, 1.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=N6,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=7.8,
                        VALE_REFE=7.7999999999999998,
                        VALE_PARA=(111.0, 2.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=N6,),
              )

#========================================================================
#     CAS FONCTION. FRACTILE = 0 : CORRESPOND A L ENVELOPPE INF DE LA FONCTION
#========================================================================
F4=CALC_FONCTION(FRACTILE=_F(FONCTION=(F1,F2,F3),
                             FRACT=0.) )

TEST_FONCTION(VALEUR=_F(VALE_CALC=1.0,
                        VALE_REFE=1.0,
                        VALE_PARA=1.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=F4,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=1.0,
                        VALE_REFE=1.0,
                        VALE_PARA=3.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=F4,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=-3.0,
                        VALE_REFE=-3.0,
                        VALE_PARA=5.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=F4,),
              )

#========================================================================
#     CAS FONCTION. FRACTILE = 1 : CORRESPOND A L ENVELOPPE SUP DE LA FONCTION
#========================================================================
F5=CALC_FONCTION(FRACTILE=_F(FONCTION=(F1,F2,F3),
                             FRACT=1.) )

TEST_FONCTION(VALEUR=_F(VALE_CALC=7.0,
                        VALE_REFE=7.0,
                        VALE_PARA=1.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=F5,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=4.0,
                        VALE_REFE=4.0,
                        VALE_PARA=3.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=F5,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=3.0,
                        VALE_REFE=3.0,
                        VALE_PARA=5.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=F5,),
              )

#========================================================================
#     CAS FONCTION. FRACTILE = 0.9
#========================================================================
F6=CALC_FONCTION(FRACTILE=_F(FONCTION=(F1,F2,F3),
                             FRACT=0.9) )

TEST_FONCTION(VALEUR=_F(VALE_CALC=6.2,
                        VALE_REFE=6.2000000000000002,
                        VALE_PARA=1.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=F6,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=3.8,
                        VALE_REFE=3.7999999999999998,
                        VALE_PARA=3.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=F6,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=2.8,
                        VALE_REFE=2.7999999999999998,
                        VALE_PARA=5.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=F6,),
              )

#========================================================================
#     VALIDATION DE L ENVELOPPE DE NAPPES A SUPPORTS DISJOINTS
#========================================================================

#========================================================================
#     DEFINITION DES NAPPES ET DES FONCTIONS
#========================================================================

E1=DEFI_NAPPE(NOM_PARA='INST',
              PARA=(111.,333.),
              NOM_PARA_FONC='X',
              DEFI_FONCTION=(_F(VALE=(1.0,13.0,2.0,4.0,),),
                             _F(VALE=(1.0,3.0,2.0,4.0,),),),)

E2=DEFI_NAPPE(NOM_PARA='INST',
              PARA=(111.,222.),
              NOM_PARA_FONC='X',
              PROL_DROITE='LINEAIRE',
              DEFI_FONCTION=(_F(VALE=(1.0,4.0,2.0,9.0,),),
                             _F(VALE=(1.0,4.0,2.0,6.0,),),),)

E3=DEFI_NAPPE(NOM_PARA='INST',
              PARA=(111.,222.),
              PROL_DROITE='LINEAIRE',
              NOM_PARA_FONC='X',
              DEFI_FONCTION=(_F(VALE=(1.0,8.0,2.0,7.0,),),
                             _F(VALE=(1.0,7.0,2.0,10.0,),),),)

E4=CALC_FONCTION(ENVELOPPE=_F(FONCTION=(E1,E2,E3),) )

TEST_FONCTION(VALEUR=_F(VALE_CALC=13.0,
                        VALE_REFE=13.0,
                        VALE_PARA=(111.0, 1.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=E4,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=9.0,
                        VALE_REFE=9.0,
                        VALE_PARA=(111.0, 2.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=E4,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=8.0,
                        VALE_REFE=8.0,
                        VALE_PARA=(222.0, 1.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=E4,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=10.0,
                        VALE_REFE=10.0,
                        VALE_PARA=(222.0, 2.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=E4,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=6.0,
                        VALE_REFE=6.0,
                        VALE_PARA=(333.0, 1.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=E4,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=13.0,
                        VALE_REFE=13.0,
                        VALE_PARA=(333.0, 2.0),
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA=('INST', 'X'),
                        FONCTION=E4,),
              )
#========================================================================
#     CAS NAPPE. MOYENNE
# ========================================================================
FM=CALC_FONCTION(MOYENNE=_F(FONCTION=(F0,F1,F2,F3), ) )

TEST_FONCTION(VALEUR=_F(VALE_CALC=3.0,
                        VALE_REFE=3.0,
                        VALE_PARA=1.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=FM,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=2.5,
                        VALE_REFE=2.5,
                        VALE_PARA=3.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=FM,),
              )

TEST_FONCTION(VALEUR=_F(VALE_CALC=1.0,
                        VALE_REFE=1.0,
                        VALE_PARA=5.0,
                        REFERENCE='ANALYTIQUE',
                        NOM_PARA='INST',
                        FONCTION=FM,),
              )


FIN();
