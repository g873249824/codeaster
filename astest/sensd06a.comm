# MODIF  DATE 20/10/2011   AUTEUR SELLENET N.SELLENET 
# RESPONSABLE H.ANDRIAMBOLOLONA
# TITRE SENSIBILITE AUX MATERIAUX EN DYNAMIQUE LINEAIRE TRANSITOIRE ISOTROPE 2D
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

DEBUT( CODE=_F(  NOM = 'SENSD06A',NIV_PUB_WEB='INTERNET',VISU_EFICAS='NON'),)
# ----------------------------------------------------------------------
#          J                               OPPOSE
#           *-------------------------------*
#           !               !               !
#           !               !               !
#           !               !               !
#           !               * CENTRE        !
#           !               !               !
#           !               !               !
#           !               !               !
#           *-------------------------------*
#       ORIGINE                              I
#
#              1   < X < 11
#             -1.5 < Y <  1.5
#
# Chargement par une force nodale au noeud OPPOSE sous forme non
# assemblee.
# Sensibilite simultanee materiaux et chargement
# La solution de reference de sensibilite parvient
# d'un calcul par differences finies.
# ----------------------------------------------------------------------
# Initialisations

I_DEBUT = 0.
I_FIN = 1.E-4

#
# 2. Definition des parametres sensibles
#
mot_cle =[    "E", "NU", "FX", "FY" ]
sensible=[ 3.6E10,  0.2,  10.,   3. ]
n=len(sensible)
PS=[None]*n

for i in range(n):
  PS[i]=DEFI_PARA_SENSI(VALE=sensible[i])

#
# 3. Prealable
#
MAILLAGE=LIRE_MAILLAGE(FORMAT='MED',);
MAILLAGE=DEFI_GROUP(reuse=MAILLAGE,
                    MAILLAGE=MAILLAGE,
                    CREA_GROUP_NO=_F(TOUT_GROUP_MA='OUI'));

#
# 3.1. Modele
#
MO=AFFE_MODELE(MAILLAGE=MAILLAGE,
                     AFFE=_F(TOUT='OUI',
                             PHENOMENE='MECANIQUE',
                             MODELISATION='C_PLAN',),);

#
# 3.2. Mise en place des materiaux
#
MAT=DEFI_MATERIAU(ELAS_FO=_F(E=PS[0],
                             RHO=2400.,
                             NU=PS[1],
                             ));
#
# 3.3. Affectation des materiaux
#
CHMAT=AFFE_MATERIAU(MAILLAGE=MAILLAGE,
                    AFFE=_F(TOUT='OUI',MATER=MAT,),);

#
# 3.4. Chargements
#
CLIM=AFFE_CHAR_MECA(MODELE=MO,
                    DDL_IMPO=(_F(GROUP_NO='ORIGINE',DX=0.0,DY=0.0),
                              _F(GROUP_MA='BORD_GAU',DX=0.0)),);
#
CH=AFFE_CHAR_MECA_F(MODELE=MO,
                    FORCE_NODALE=(_F(GROUP_NO='OPPOSE',
                                     FX=PS[2],
                                     FY=PS[3]))
                                     );
#
# 3.5 Premier membre
#

MATELER=CALC_MATR_ELEM(MODELE=MO,OPTION='RIGI_MECA',
                       CHAM_MATER=CHMAT,
                       CHARGE=CLIM)

MATELEM=CALC_MATR_ELEM(MODELE=MO,
                       OPTION='MASS_MECA',
                       CHAM_MATER=CHMAT,
                       CHARGE=CLIM)

NUM=NUME_DDL(MATR_RIGI=MATELER)

MATASSR=ASSE_MATRICE(MATR_ELEM=MATELER,NUME_DDL=NUM)

MATASSM=ASSE_MATRICE(MATR_ELEM=MATELEM,NUME_DDL=NUM)

FC=DEFI_FONCTION(NOM_PARA='INST',
                 PROL_DROITE='CONSTANT',
                 PROL_GAUCHE='CONSTANT',
                 VALE=(I_DEBUT,0.,I_FIN,1.,))

L_INST=DEFI_LIST_REEL(DEBUT=I_DEBUT,INTERVALLE=_F(JUSQU_A=I_FIN,NOMBRE=10))

#
# 4. Calcul
#

DYT=DYNA_VIBRA(TYPE_CALCUL='TRAN',BASE_CALCUL='PHYS',
                   MODELE=MO,CHAM_MATER=CHMAT,
                   MATR_MASS=MATASSM,MATR_RIGI=MATASSR,
                   SENSIBILITE=tuple(PS),
                   EXCIT=(_F(FONC_MULT=FC,CHARGE=CH),),
                   INCREMENT=_F(LIST_INST=L_INST,),
                   SCHEMA_TEMPS=_F(SCHEMA='NEWMARK',),)
#                   WILSON=_F(),)


DYT = CALC_ELEM( reuse = DYT, RESULTAT = DYT, OPTION = 'SIGM_ELNO', );

CALC_SENSI( reuse = DYT, RESULTAT = DYT, SENSIBILITE=tuple(PS),
                 OPTION = 'SIGM_ELNO',
                 );

T_REF_R=POST_RELEVE_T(ACTION=_F(INTITULE='SENSIBILITE',
                              GROUP_NO=('OPPOSE'),
                              RESULTAT=DYT,
                              NOM_CHAM='DEPL',
                              NUME_ORDRE=10,
                              NOM_CMP='DY',
                              OPERATION='EXTRACTION',
                              FORMAT_C='REEL',
                              ),);
TSREF_R=POST_RELEVE_T(ACTION=_F(INTITULE='SENSIBILITE',
                              GROUP_NO=('OPPOSE'),
                              RESULTAT=DYT,
                              NOM_CHAM='DEPL',
                              NUME_ORDRE=10,
                              NOM_CMP='DY',
                              OPERATION='EXTRACTION',
                              FORMAT_C='REEL',
                              SENSIBILITE=(PS_0,PS_1,PS_2,PS_3),
                              ),);

T_REF_C=POST_RELEVE_T(ACTION=_F(INTITULE='SENSIBILITE',
                                GROUP_NO=('OPPOSE'),
                                NOM_CHAM='SIGM_ELNO',
                                RESULTAT=DYT,
                                MAILLE ='M14',
                                NOM_CMP = 'SIXX',
                                OPERATION='EXTRACTION',
                                FORMAT_C='REEL',
                                NUME_ORDRE=10,
                                ),);

TSREF_C=POST_RELEVE_T(ACTION=_F(INTITULE='SENSIBILITE',
                                GROUP_NO=('OPPOSE'),
                                NOM_CHAM='SIGM_ELNO',
                                RESULTAT=DYT,
                                MAILLE ='M14',
                                NOM_CMP = 'SIXX',
                                OPERATION='EXTRACTION',
                                FORMAT_C='REEL',
                                NUME_ORDRE=10,
                                SENSIBILITE=(PS_0,PS_1,PS_2,PS_3),
                                ),);

IMPR_TABLE(TABLE=T_REF_R)
FIN()

