# MODIF  DATE 17/04/2012   AUTEUR DELMAS J.DELMAS 
#
# TITRE FATIGUE, AMPLITUDE VARIABLE, TEST DES GRANDEURS EN DEFORMATIONS
# sslv135q.para = tps_job 600 mem_job 600Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
#----------------------------------------------------------------------
#    Cas test sslv135q : cube 3D
#                        Essai de chargement cyclique bi-axial
#                        critere en formule
#----------------------------------------------------------------------
#        Unites : Newton , Millimetre , Seconde (N,MM,S,->Mpa)
#----------------------------------------------------------------------
#
#               y       a
#               I<------------->                     a = 10 mm
#                     Face1                                    2
#                   (dessus)                         S = 100 mm
#               P1              P2
#               o--------------o
#              /I             /I
#        P5   / I        P6  / I
#            o--+-----------o  I
#            I  I   Face5   I  I  Face4
#  Face3     I  I (derri.)  I  I (cote d.)
# (cote g.)  I  I           I  I
#            I  I  P3       I  I P4
#            I  o-----------I--o      - x
#            I /            I /
#         P7 I/          P8 I/
#            o--------------o
#
#          /       Face2
#         z      (dessous)
#
#----------------------------------------------------------------------
#
# DANS CE CAS TEST NOUS TESTONS LE CRITERE EN FORMULE AUX POINTS DE GAUSS
# ET AUX NOEUDS
#----------------------------------------------------------------------

DEBUT(CODE=_F(NOM='sslv135q',NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'),
               IGNORE_ALARM=('PREPOST4_27'))
               
CUBE = LIRE_MAILLAGE(FORMAT='MED', )

CUBE=DEFI_GROUP(reuse = CUBE,
                ALARME='OUI',
                CREA_GROUP_NO=(_F(GROUP_MA='FACE1',
                                  CRIT_NOEUD='TOUS'),
                               _F(GROUP_MA='FACE2',
                                  CRIT_NOEUD='TOUS'),
                               _F(GROUP_MA='FACE3',
                                  CRIT_NOEUD='TOUS'),
                               _F(GROUP_MA='FACE4',
                                CRIT_NOEUD='TOUS'),
                               _F(GROUP_MA='FACE5',
                                  CRIT_NOEUD='TOUS'),
                               _F(GROUP_MA='FACE6',
                                  CRIT_NOEUD='TOUS')),
                MAILLAGE=CUBE,);

CUBE=DEFI_GROUP(reuse = CUBE,
                ALARME='OUI',
                CREA_GROUP_MA=(_F(OPTION='APPUI',
                                  TYPE_APPUI='AU_MOINS_UN',
                                  GROUP_NO='FACE1',
                                  NOM='FACE1_3D'),
                               _F(OPTION='APPUI',
                                  TYPE_APPUI='AU_MOINS_UN',
                                  GROUP_NO='FACE2',
                                  NOM='FACE2_3D'),
                               _F(OPTION='APPUI',
                                  TYPE_APPUI='AU_MOINS_UN',
                                  GROUP_NO='FACE3',
                                  NOM='FACE3_3D'),
                               _F(OPTION='APPUI',
                                  TYPE_APPUI='AU_MOINS_UN',
                                  GROUP_NO='FACE4',
                                  NOM='FACE4_3D'),
                               _F(OPTION='APPUI',
                                  TYPE_APPUI='AU_MOINS_UN',
                                  GROUP_NO='FACE5',
                                  NOM='FACE5_3D'),
                               _F(OPTION='APPUI',
                                  TYPE_APPUI='AU_MOINS_UN',
                                  GROUP_NO='FACE6',
                                  NOM='FACE6_3D')),
                MAILLAGE=CUBE,);

MANCOF=DEFI_FONCTION( NOM_PARA='EPSI',
                      INTERPOL='LOG',
                      PROL_DROITE='LINEAIRE',
                      PROL_GAUCHE='LINEAIRE', 
                      VALE=(  0.00226,    5800000.,
                              0.00230,    4600000.,
                              0.00250,     239284.,
                              0.00270,     149535.,
                              0.00300,      73544.,
                              0.00350,      33821.,
                              0.00600,       2850.,
                              0.00850,       1068.,
                              0.01000,        562.,
                              1.00000,          1.,  ))

COEF   = DEFI_FONCTION ( NOM_PARA    ='INST',
                          PROL_DROITE  ='LINEAIRE',
                          PROL_GAUCHE ='LINEAIRE',
                          VALE        =( 0.,    0.,
                                         1.,  100.,
                                         2.,    0.,
                                         2.75, 75.,
                                         3.5,   0.,
                                        ))

COEF2  = DEFI_FONCTION ( NOM_PARA    ='INST',
                          PROL_DROITE  ='LINEAIRE',
                          PROL_GAUCHE ='LINEAIRE',
                          VALE        =( 0.,    0.,
                                         1.,  100.,
                                         2.5625, -56.25,
                                         3.5625, 75.,
                                         4.5625, -56.25,
                                         )
                                         )

COEF3   = DEFI_FONCTION ( NOM_PARA    ='INST',
                          PROL_DROITE  ='LINEAIRE',
                          PROL_GAUCHE ='LINEAIRE',
                          VALE        =( 0.,    0.,
                                         1.,  150.,
                                         2.,  -50.,
                                         3.,  200.,
                                         4., -100.,
                                         )
                                         )

ACIER   = DEFI_MATERIAU   ( ELAS           =_F( E         = 200000.,
                                                NU        = .3,
                                                ALPHA     = 0. ),
                            FATIGUE        =_F( MANSON_COFFIN = MANCOF, ),)

ACIER2  = DEFI_MATERIAU   ( ELAS           =_F( E         = 200000.,
                                                NU        = .3,
                                                ALPHA     = 0. ),
                            ECRO_LINE=_F( SY=  900, D_SIGM_EPSI = 50000),
                            FATIGUE        =_F( MANSON_COFFIN = MANCOF, ),)

LINST = DEFI_LIST_REEL   ( DEBUT      =  0.,
                           INTERVALLE =_F (JUSQU_A= 3.5, NOMBRE = 14  ));

LINST2 = DEFI_LIST_REEL   ( DEBUT      =  0.,
                           INTERVALLE =(_F (JUSQU_A= 2.5, NOMBRE = 25 ),
                                        _F (JUSQU_A= 2.5625, NOMBRE = 5 ),
                                        _F (JUSQU_A= 4.5625, NOMBRE = 20 ),
                                        ) );

LINST3 = DEFI_LIST_REEL   ( DEBUT      =  0.,
                           INTERVALLE =(_F (JUSQU_A= 3.9, NOMBRE = 39 ),
                                        _F (JUSQU_A= 3.916666668 , NOMBRE = 2 ),
                                        ));

TROISD   = AFFE_MODELE    ( MAILLAGE   =    CUBE,
                            AFFE       =_F ( PHENOMENE    = 'MECANIQUE',
                                             MODELISATION = '3D',
                                             TOUT         = 'OUI'    ))

MAT_ELAS   = AFFE_MATERIAU    ( MAILLAGE    =   CUBE,
                           AFFE        =_F ( TOUT       = 'OUI',
                                             MATER      = ACIER,
                                             ))

MAT_EPLA   = AFFE_MATERIAU    ( MAILLAGE    =   CUBE,
                           AFFE        =_F ( TOUT       = 'OUI',
                                             MATER      = ACIER2,
                                             ))
CRIT1 =   FORMULE(
           NOM_PARA=('EPSN1_1', 'EPSN1_2'),
           VALE= '''abs((EPSN1_1-EPSN1_2)/2)'''
           )

CRIT2 =   FORMULE(
           NOM_PARA=('ETPR1_1', 'ETPR1_2'),
           VALE= '''abs((ETPR1_1-ETPR1_2)/2)'''
           )

CRIT3 =   FORMULE(
           NOM_PARA=('ETEQ_1', 'ETEQ_2'),
           VALE= '''abs((ETEQ_1-ETEQ_2)/2)'''
           )

CRIT4 =   FORMULE(
           NOM_PARA=('EPPR1_1','EPPR1_2'),
           VALE= '''abs((EPPR1_2-EPPR1_1)/2)'''
           )

MANCO1=   FORMULE(
           NOM_PARA=('NBRUP'),
           VALE=''' 0.022524751*(NBRUP**(-0.1619)) '''
           )

# CHARGEMENT SELON LES 2 AXES X ET Y
# ----------------------------------

TR_CS  = AFFE_CHAR_MECA (
           MODELE       =  TROISD,
           FACE_IMPO    =(_F( GROUP_MA= 'FACE3' ,DX=0.),
                          _F( GROUP_MA= 'FACE2' ,DY=0.) ),
           DDL_IMPO     =(_F( GROUP_NO= 'P3' , DZ=0.) ),
           FORCE_FACE   =(_F( GROUP_MA= 'FACE4', FX=12.),
                          _F( GROUP_MA= 'FACE1', FY=-6.)
                          ));

# CHARGEMENT SELON L'AXE X
# ----------------------------------

TR_CS2  = AFFE_CHAR_MECA (
           MODELE       =  TROISD,
           FACE_IMPO    =(_F( GROUP_MA= 'FACE3' ,DX=0.),
                          _F( GROUP_MA= 'FACE2' ,DY=0.) ),
           DDL_IMPO     =(_F( GROUP_NO= 'P3' , DZ=0.) ),
           FORCE_FACE   =(_F( GROUP_MA= 'FACE4', FX=12.),
                          ));

# 1er CALCUL AVEC STAT_NON_LINE
# -------------------------

SOL_NL = STAT_NON_LINE ( TITRE      =
                'TEST TRACTION-COMPRESSION ALTERNEE - PLAN CRITIQUE',
                        MODELE     =   TROISD,
                        CHAM_MATER =   MAT_ELAS,
                        EXCIT      =_F ( CHARGE       = TR_CS,
                                         FONC_MULT    = COEF,
                                         TYPE_CHARGE  = 'FIXE_CSTE'),
                        COMP_ELAS  =_F ( RELATION     = 'ELAS',
                                         DEFORMATION  = 'PETIT',
                                         TOUT         = 'OUI'    ),
                        INCREMENT  =_F ( LIST_INST    = LINST, ),
                        NEWTON     =_F ( MATRICE      = 'ELASTIQUE',
                                         REAC_INCR    = 0 ))

SOL_NL = CALC_ELEM( reuse    = SOL_NL,
                    RESULTAT = SOL_NL,
                    OPTION   = ('EPSI_ELGA',
                                'SIGM_ELNO',
                                'EPSI_ELNO',
                                'EPSP_ELGA',
                                'EPSP_ELNO'))

SOL_NL = CALC_CHAMP( reuse    = SOL_NL,
                     RESULTAT = SOL_NL,
                     GROUP_MA = ('FACE1_3D', 'FACE2_3D', 'FACE3_3D', 'CUBE'),
                     CONTRAINTE='SIGM_NOEU',DEFORMATION='EPSI_NOEU'
                   )

# 2eme CALCUL AVEC STAT_NON_LINE
# -------------------------

SOL_NL2 = STAT_NON_LINE ( TITRE      =
                'TEST TRACTION-COMPRESSION ALTERNEE - PLAN CRITIQUE',
                        MODELE     =   TROISD,
                        CHAM_MATER =   MAT_EPLA,
                        EXCIT      =_F ( CHARGE       = TR_CS2,
                                         FONC_MULT    = COEF2,
                                         TYPE_CHARGE  = 'FIXE_CSTE'),
                        COMP_INCR  =_F ( RELATION     = 'VMIS_CINE_LINE',
                                        DEFORMATION  = 'PETIT',
                                        TOUT         = 'OUI'    ),
                       INCREMENT  =_F ( LIST_INST    = LINST2, ),
                       NEWTON     =_F(  MATRICE = 'TANGENTE',
                                        REAC_ITER = 1),
                       CONVERGENCE=_F(  RESI_REFE_RELA=1.,
                                        SIGM_REFE     =4.8E-3,
                                        ITER_GLOB_MAXI = 50),
                       SOLVEUR=_F(METHODE = 'MULT_FRONT'),)

SOL_NL2 = CALC_ELEM( reuse    = SOL_NL2,
                    RESULTAT = SOL_NL2,
                    OPTION   = ('EPSI_ELGA',
                                'SIGM_ELNO',
                                'EPSI_ELNO',
                                'EPSP_ELGA',
                                'EPSP_ELNO'))

SOL_NL2 = CALC_CHAMP( reuse    = SOL_NL2,
                      RESULTAT = SOL_NL2,
                      GROUP_MA = ('FACE1_3D', 'FACE2_3D', 'FACE3_3D', 'CUBE'),
                      CONTRAINTE='SIGM_NOEU',DEFORMATION=('EPSI_NOEU','EPSP_NOEU',),
                    )

# 3eme CALCUL AVEC STAT_NON_LINE
# -------------------------

SOL_NL3 = STAT_NON_LINE ( TITRE      =
                'TEST TRACTION-COMPRESSION ALTERNEE - PLAN CRITIQUE',
                        MODELE     =   TROISD,
                        CHAM_MATER =   MAT_EPLA,
                        EXCIT      =_F ( CHARGE       = TR_CS2,
                                         FONC_MULT    = COEF3,
                                         TYPE_CHARGE  = 'FIXE_CSTE'),
                        COMP_INCR  =_F ( RELATION     = 'VMIS_CINE_LINE',
                                        DEFORMATION  = 'PETIT',
                                        TOUT         = 'OUI'    ),
                       INCREMENT  =_F ( LIST_INST    = LINST3, ),
                       NEWTON     =_F(  MATRICE = 'TANGENTE',
                                        REAC_ITER = 1),
                       CONVERGENCE=_F(  RESI_REFE_RELA=1.,
                                        SIGM_REFE     =4.8E-3,
                                        ITER_GLOB_MAXI = 50),
                       SOLVEUR=_F(METHODE = 'MULT_FRONT'),)

SOL_NL3 = CALC_ELEM( reuse    = SOL_NL3,
                    RESULTAT = SOL_NL3,
                    OPTION   = ('EPSI_ELGA',
                                'SIGM_ELNO',
                                'EPSI_ELNO',
                                'EPSP_ELGA',
                                'EPSP_ELNO'))

SOL_NL3 = CALC_CHAMP( reuse    = SOL_NL3,
                      RESULTAT = SOL_NL3,
                      GROUP_MA = ('FACE1_3D', 'FACE2_3D', 'FACE3_3D', 'CUBE'),
                      CONTRAINTE='SIGM_NOEU',DEFORMATION=('EPSI_NOEU','EPSP_NOEU',),
                    )


##################################################################
#                                                                #
#                     Test avec SOL_NL                           #
#                                                                #
##################################################################


# TEST DU CRITERE 1 AVEC 'DOMA_NOEUD' et avec SOL_NL
#          avec la FORMULE DE MANSON
##################################################################
FATN_WF1=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL,
                           CHAM_MATER    = MAT_ELAS,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT1,
                           COURBE_GRD_VIE  = 'FORM_VIE',
                           FORMULE_VIE = MANCO1,
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_WF1,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 5.0E-5,
                            VALE = 1.08363973045249E-5 ),
                       )
              )

# TEST DU CRITERE 1 AVEC 'DOMA_ELGA' et avec SOL_NL
#          avec la FORMULE DE MANSON
##################################################################
FATM_WF1=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL,
                         CHAM_MATER    = MAT_ELAS,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT1,
                         COURBE_GRD_VIE  = 'FORM_VIE',
                         FORMULE_VIE = MANCO1,
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_WF1,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 5.0E-5,
                             VALE = 1.08363973045249E-5 ),
                          )
              )

# TEST DU CRITERE 1 AVEC 'DOMA_NOEUD' et avec SOL_NL
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATN_W1=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL,
                           CHAM_MATER    = MAT_ELAS,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT1,
                           COURBE_GRD_VIE  = 'MANSON_C',
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_W1,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 2.0E-5,
                            VALE = 3.26558685783619E-5 ),
                       )
              )

# TEST DU CRITERE 1 AVEC 'DOMA_ELGA' et avec SOL_NL
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATM_W1=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL,
                         CHAM_MATER    = MAT_ELAS,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT1,
                         COURBE_GRD_VIE  = 'MANSON_C',
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_W1,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 1.0E-5,
                             VALE = 3.26558685783619E-5 ),
                          )
              )

# TEST DU CRITERE 2 AVEC 'DOMA_NOEUD' et avec SOL_NL
#          avec la FORMULE DE MANSON
##################################################################
FATN_WF2=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL,
                           CHAM_MATER    = MAT_ELAS,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT2,
                           COURBE_GRD_VIE  = 'FORM_VIE',
                           FORMULE_VIE = MANCO1,
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_WF2,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 5.0E-5,
                            VALE = 1.08363973045249E-5 ),
                       )
              )

# TEST DU CRITERE 2 AVEC 'DOMA_ELGA' et avec SOL_NL
#          avec la FORMULE DE MANSON
##################################################################
FATM_WF2=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL,
                         CHAM_MATER    = MAT_ELAS,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT2,
                         COURBE_GRD_VIE  = 'FORM_VIE',
                         FORMULE_VIE = MANCO1,
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_WF2,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 5.0E-5,
                             VALE = 1.08363973045249E-5 ),
                          )
              )

# TEST DU CRITERE 2 AVEC 'DOMA_NOEUD' et avec SOL_NL
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATN_W2=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL,
                           CHAM_MATER    = MAT_ELAS,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT2,
                           COURBE_GRD_VIE  = 'MANSON_C',
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_W2,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 2.0E-5,
                            VALE = 3.26558685783619E-5 ),
                       )
              )

# TEST DU CRITERE 2 AVEC 'DOMA_ELGA' et avec SOL_NL
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATM_W2=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL,
                         CHAM_MATER    = MAT_ELAS,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT2,
                         COURBE_GRD_VIE  = 'MANSON_C',
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_W2,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 1.0E-5,
                             VALE = 3.26558685783619E-5 ),
                          )
              )

# TEST DU CRITERE 3 AVEC 'DOMA_NOEUD' et avec SOL_NL
#          avec la FORMULE DE MANSON
##################################################################
FATN_WF3=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL,
                           CHAM_MATER    = MAT_ELAS,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT3,
                           COURBE_GRD_VIE  = 'FORM_VIE',
                           FORMULE_VIE = MANCO1,
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_WF3,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 1.0E-5,
                            VALE = 1.0633842276096E-5 ),
                       )
              )

# TEST DU CRITERE 3 AVEC 'DOMA_ELGA' et avec SOL_NL
#          avec la FORMULE DE MANSON
##################################################################
FATM_WF3=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL,
                         CHAM_MATER    = MAT_ELAS,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT3,
                         COURBE_GRD_VIE  = 'FORM_VIE',
                         FORMULE_VIE = MANCO1,
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_WF3,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 1.0E-5,
                             VALE = 1.0633842276096E-5 ),
                          )
              )

# TEST DU CRITERE 3 AVEC 'DOMA_NOEUD' et avec SOL_NL
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATN_W3=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL,
                           CHAM_MATER    = MAT_ELAS,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT3,
                           COURBE_GRD_VIE  = 'MANSON_C',
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_W3,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 2.0E-4,
                            VALE = 3.21404432462201E-5 ),
                       )
              )

# TEST DU CRITERE 3 AVEC 'DOMA_ELGA' et avec SOL_NL
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATM_W3=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL,
                         CHAM_MATER    = MAT_ELAS,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT3,
                         COURBE_GRD_VIE  = 'MANSON_C',
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_W3,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 2.0E-4,
                             VALE = 3.21404432462201E-5 ),
                          )
              )


##################################################################
#                                                                #
#                     Test avec SOL_NL2                          #
#                                                                #
##################################################################


# TEST DU CRITERE 1 AVEC 'DOMA_NOEUD' et avec SOL_NL2
#          avec la FORMULE DE MANSON
##################################################################
FATN_WF4=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL2,
                           CHAM_MATER    = MAT_EPLA,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT1,
                           COURBE_GRD_VIE  = 'FORM_VIE',
                           FORMULE_VIE = MANCO1,
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_WF4,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 5.0E-5,
                            VALE = 1.449229E-4 ),
                       )
              )

# TEST DU CRITERE 1 AVEC 'DOMA_ELGA'  et avec SOL_NL2
#          avec la FORMULE DE MANSON
##################################################################
FATM_WF4=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL2,
                         CHAM_MATER    = MAT_EPLA,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT1,
                         COURBE_GRD_VIE  = 'FORM_VIE',
                         FORMULE_VIE = MANCO1,
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_WF4,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 5.0E-5,
                             VALE = 1.449229E-4 ),
                          )
              )

# TEST DU CRITERE 1 AVEC 'DOMA_NOEUD'  et avec SOL_NL2
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATN_W4=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL2,
                           CHAM_MATER    = MAT_EPLA,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT1,
                           COURBE_GRD_VIE  = 'MANSON_C',
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_W4,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 2.0E-5,
                            VALE = 2.408735E-4 ),
                       )
              )

# TEST DU CRITERE 1 AVEC 'DOMA_ELGA'  et avec SOL_NL2  
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATM_W4=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL2,
                         CHAM_MATER    = MAT_EPLA,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT1,
                         COURBE_GRD_VIE  = 'MANSON_C',
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_W4,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 1.0E-5,
                             VALE = 2.408735E-4 ),
                          )
              )

# TEST DU CRITERE 2 AVEC 'DOMA_NOEUD'  et avec SOL_NL2
#          avec la FORMULE DE MANSON
##################################################################
FATN_WF5=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL2,
                           CHAM_MATER    = MAT_EPLA,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT2,
                           COURBE_GRD_VIE  = 'FORM_VIE',
                           FORMULE_VIE = MANCO1,
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_WF5,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 5.0E-5,
                            VALE = 1.449229E-4 ),
                       )
              )

# TEST DU CRITERE 2 AVEC 'DOMA_ELGA'  et avec SOL_NL2 
#          avec la FORMULE DE MANSON
##################################################################
FATM_WF5=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL2,
                         CHAM_MATER    = MAT_EPLA,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT2,
                         COURBE_GRD_VIE  = 'FORM_VIE',
                         FORMULE_VIE = MANCO1,
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_WF5,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 5.0E-5,
                             VALE = 1.449229E-4 ),
                          )
              )

# TEST DU CRITERE 2 AVEC 'DOMA_NOEUD'  et avec SOL_NL2 
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATN_W5=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL2,
                           CHAM_MATER    = MAT_EPLA,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT2,
                           COURBE_GRD_VIE  = 'MANSON_C',
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_W5,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 2.0E-5,
                            VALE = 2.408735E-4 ),
                       )
              )

# TEST DU CRITERE 2 AVEC 'DOMA_ELGA'  et avec SOL_NL2  
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATM_W5=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL2,
                         CHAM_MATER    = MAT_EPLA,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT2,
                         COURBE_GRD_VIE  = 'MANSON_C',
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_W5,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 1.0E-5,
                             VALE = 2.408735E-4 ),
                          )
              )

# TEST DU CRITERE 3 AVEC 'DOMA_NOEUD'  et avec SOL_NL2 
#          avec la FORMULE DE MANSON
##################################################################
FATN_WF6=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL2,
                           CHAM_MATER    = MAT_EPLA,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT3,
                           COURBE_GRD_VIE  = 'FORM_VIE',
                           FORMULE_VIE = MANCO1,
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_WF6,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 1.0E-5,
                            VALE = 6.53204991059937E-5 ),
                       )
              )

# TEST DU CRITERE 3 AVEC 'DOMA_ELGA'  et avec SOL_NL2 
#          avec la FORMULE DE MANSON
##################################################################
FATM_WF6=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL2,
                         CHAM_MATER    = MAT_EPLA,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT3,
                         COURBE_GRD_VIE  = 'FORM_VIE',
                         FORMULE_VIE = MANCO1,
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_WF6,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 1.0E-5,
                             VALE = 6.53204991059937E-5 ),
                          )
              )

# TEST DU CRITERE 3 AVEC 'DOMA_NOEUD'  et avec SOL_NL2 
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATN_W6=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL2,
                           CHAM_MATER    = MAT_EPLA,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT3,
                           COURBE_GRD_VIE  = 'MANSON_C',
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_W6,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 2.0E-4,
                            VALE = 1.322816E-4 ),
                       )
              )

# TEST DU CRITERE 3 AVEC 'DOMA_ELGA'  et avec SOL_NL2  
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATM_W6=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                         OPTION        = 'DOMA_ELGA',
                         TYPE_CHARGE   = 'NON_PERIODIQUE',
                         MAILLAGE      = CUBE,
                         GROUP_MA      = ('CUBE'),
                         RESULTAT      = SOL_NL2,
                         CHAM_MATER    = MAT_EPLA,
                         CRITERE       = 'FORMULE_CRITERE',
                         FORMULE_GRDEQ   = CRIT3,
                         COURBE_GRD_VIE  = 'MANSON_C',
                         PROJECTION    = 'UN_AXE'
                       )
TEST_RESU(CHAM_ELEM=( _F(CHAM_GD = FATM_W6,
                             NOM_CMP = 'ENDO1',
                             MAILLE = 'M60',
                             POINT = 3,
                             REFERENCE = 'ANALYTIQUE',
                             PRECISION = 2.0E-4,
                             VALE = 1.322816E-4 ),
                          )
              )


##################################################################
#                                                                #
#                     Test avec SOL_NL3                          #
#                                                                #
##################################################################


# TEST DU CRITERE 4 AVEC 'DOMA_NOEUD'  et avec SOL_NL3
#          avec la FORMULE DE MANSON
##################################################################
FATN_WF7=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL3,
                           CHAM_MATER    = MAT_EPLA,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT4,
                           COURBE_GRD_VIE  = 'FORM_VIE',
                           FORMULE_VIE = MANCO1,
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_WF7,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 5.0E-5,
                            VALE = 1.37785513E-2 ),
                       )
              )

# TEST DU CRITERE 4 AVEC 'DOMA_NOEUD'  et avec SOL_NL3
#      par INTERPOLATION de la COURBE DE MANSON
##################################################################
FATN_W7=CALC_FATIGUE( TYPE_CALCUL   = 'FATIGUE_MULTI',
                           OPTION        = 'DOMA_NOEUD',
                           TYPE_CHARGE   = 'NON_PERIODIQUE',
                           RESULTAT      = SOL_NL3,
                           CHAM_MATER    = MAT_EPLA,
                           GROUP_MA      = ('FACE1', 'FACE2', 'FACE3'),
                           MAILLAGE      = CUBE,
                           CRITERE       = 'FORMULE_CRITERE',
                           FORMULE_GRDEQ   = CRIT4,
                           COURBE_GRD_VIE  = 'MANSON_C',
                           PROJECTION    = 'UN_AXE'
                         )
TEST_RESU(CHAM_NO=(  _F( CHAM_GD = FATN_W7,
                            NOM_CMP = 'ENDO1',
                            NOEUD = 'N1',
                            REFERENCE = 'ANALYTIQUE',
                            PRECISION = 2.0E-5,
                            VALE = 2.1858445E-3 ),
                       )
              )
FIN( )
