# ======================================================================
# COPYRIGHT (C) 1991 - 2016  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

DEBUT(CODE=_F(
              NIV_PUB_WEB='INTERNET',),
      DEBUG=_F(SDVERI='OUI',),);

PRE_IDEAS();

T20=DEFI_FONCTION(NOM_PARA='INST',NOM_RESU='TEMP',VALE=(0.0,20.0,
                        1200.0,20.0,
                        ),);

HE=DEFI_FONCTION(NOM_PARA='INST',NOM_RESU='H',VALE=(0.0,71.0,
                       1200.0,71.0,
                       ),);

CONDUC=DEFI_FONCTION(NOM_PARA='TEMP',NOM_RESU='LAMBDA',VALE=(0.0,40.0,
                           1200.0,40.0,
                           ),PROL_DROITE='LINEAIRE',PROL_GAUCHE='LINEAIRE',);

ENTHAL=DEFI_FONCTION(NOM_PARA='TEMP',NOM_RESU='CP',VALE=(0.0,0.0,
                           1200.0,1200.0,
                           ),PROL_DROITE='LINEAIRE',PROL_GAUCHE='LINEAIRE',);

RAYO=DEFI_FONCTION(NOM_PARA='TEMP',VALE=(0.0,12093.210046,
                         5.0,12078.807291,
                         10.0,12063.606525,
                         15.0,12047.578803,
                         20.0,12030.694661,
                         25.0,12012.924123,
                         30.0,11994.236696,
                         35.0,11974.601370,
                         40.0,11953.986620,
                         45.0,11932.360406,
                         50.0,11909.690172,
                         55.0,11885.942847,
                         60.0,11861.084841,
                         65.0,11835.082053,
                         70.0,11807.899864,
                         75.0,11779.503138,
                         80.0,11749.856225,
                         85.0,11718.922960,
                         90.0,11686.666660,
                         95.0,11653.050129,
                         100.0,11618.035652,
                         105.0,11581.585002,
                         110.0,11543.659433,
                         115.0,11504.219685,
                         120.0,11463.225983,
                         125.0,11420.638035,
                         130.0,11376.415033,
                         135.0,11330.515655,
                         140.0,11282.898061,
                         145.0,11233.519898,
                         150.0,11182.338294,
                         155.0,11129.309865,
                         160.0,11074.390708,
                         165.0,11017.536407,
                         170.0,10958.702029,
                         175.0,10897.842124,
                         180.0,10834.910729,
                         185.0,10769.861364,
                         190.0,10702.647032,
                         195.0,10633.220222,
                         200.0,10561.532908,
                         205.0,10487.536546,
                         210.0,10411.182078,
                         215.0,10332.419929,
                         220.0,10251.200010,
                         225.0,10167.471715,
                         230.0,10081.183922,
                         235.0,9992.284995,
                         240.0,9900.722781,
                         245.0,9806.444611,
                         250.0,9709.397302,
                         255.0,9609.527153,
                         260.0,9506.779949,
                         265.0,9401.100959,
                         270.0,9292.434935,
                         275.0,9180.726115,
                         280.0,9065.918221,
                         285.0,8947.954459,
                         290.0,8826.777518,
                         295.0,8702.329574,
                         300.0,8574.552286,
                         305.0,8443.386796,
                         310.0,8308.773732,
                         315.0,8170.653205,
                         320.0,8028.964813,
                         325.0,7883.647634,
                         330.0,7734.640235,
                         335.0,7581.880663,
                         340.0,7425.306452,
                         345.0,7264.854620,
                         350.0,7100.461668,
                         355.0,6932.063583,
                         360.0,6759.595835,
                         365.0,6582.993379,
                         370.0,6402.190653,
                         375.0,6217.121582,
                         380.0,6027.719573,
                         385.0,5833.917517,
                         390.0,5635.647792,
                         395.0,5432.842257,
                         400.0,5225.432258,
                         405.0,5013.348624,
                         410.0,4796.521667,
                         415.0,4574.881187,
                         420.0,4348.356464,
                         425.0,4116.876266,
                         430.0,3880.368843,
                         435.0,3638.761930,
                         440.0,3391.982746,
                         445.0,3139.957995,
                         450.0,2882.613864,
                         455.0,2619.876027,
                         460.0,2351.669638,
                         465.0,2077.919339,
                         470.0,1798.549256,
                         475.0,1513.482997,
                         480.0,1222.643656,
                         485.0,925.953811,
                         490.0,623.335524,
                         495.0,314.710342,
                         500.0,0.0,
                         ),PROL_DROITE='LINEAIRE',PROL_GAUCHE='LINEAIRE',);

MATER=DEFI_MATERIAU(THER_NL=_F(LAMBDA=CONDUC,
                               BETA=ENTHAL,),);

MAIL=LIRE_MAILLAGE();

CHMAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                    AFFE=_F(TOUT='OUI',
                            MATER=MATER,),);

MOTH=AFFE_MODELE(MAILLAGE=MAIL,
                 AFFE=_F(TOUT='OUI',
                         PHENOMENE='THERMIQUE',
                         MODELISATION='3D',),);

CHAVI=CREA_CHAMP(TYPE_CHAM='NOEU_DEPL_R',
                 OPERATION='AFFE',
                 MAILLAGE=MAIL,
                 AFFE=_F(TOUT='OUI',
                         NOM_CMP=('DX','DY','DZ',),
                         VALE=(0.,0.,0.,),),);

CHTH=AFFE_CHAR_THER_F(MODELE=MOTH,
                      FLUX_NL=_F(GROUP_MA='FACE_INT',
                                 FLUN=RAYO,),
                      ECHANGE=_F(GROUP_MA='FACE_EXT',
                                 COEF_H=HE,
                                 TEMP_EXT=T20,),
                      CONVECTION=_F(VITESSE=CHAVI,),);

CHTH2=AFFE_CHAR_THER(MODELE=MOTH,
                     ECHANGE=_F(GROUP_MA='FACE_EXT',
                                COEF_H=71.,
                                TEMP_EXT=20.,),);

TEMPE=THER_NON_LINE_MO(MODELE=MOTH,
                       CHAM_MATER=CHMAT,
                       EXCIT=(_F(CHARGE=CHTH,),
                              _F(CHARGE=CHTH2,),),
                       CONVERGENCE=_F(CRIT_TEMP_RELA=1.E-3,
                                      CRIT_ENTH_RELA=1.E-2,
                                      ITER_GLOB_MAXI=10,),
                       SOLVEUR=_F(METHODE='MULT_FRONT',),);

TEMPE=CALC_CHAMP(reuse =TEMPE,
                RESULTAT=TEMPE,
                NUME_ORDRE=0,
                 THERMIQUE=('FLUX_ELNO'),);

# VALEURS DE REFERENCE: VERSION  3.06.09 DU CODE_ASTER

TEST_RESU(RESU=(_F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='TEMP',
                   NOEUD='N106',
                   NOM_CMP='TEMP',
                   VALE_CALC=105.556049703,
                   VALE_REFE=105.55,
                   REFERENCE='NON_DEFINI',
                   PRECISION=1.E-2,),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='TEMP',
                   NOEUD='N105',
                   NOM_CMP='TEMP',
                   VALE_CALC=99.209587248,
                   VALE_REFE=99.209999999999994,
                   REFERENCE='NON_DEFINI',
                   PRECISION=1.E-2,),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='TEMP',
                   NOEUD='N115',
                   NOM_CMP='TEMP',
                   VALE_CALC=93.295250739,
                   VALE_REFE=93.299999999999997,
                   REFERENCE='NON_DEFINI',
                   PRECISION=1.E-2,),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='TEMP',
                   NOEUD='N125',
                   NOM_CMP='TEMP',
                   VALE_CALC=87.758536184,
                   VALE_REFE=87.760000000000005,
                   REFERENCE='NON_DEFINI',
                   PRECISION=1.E-2,),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='TEMP',
                   NOEUD='N123',
                   NOM_CMP='TEMP',
                   VALE_CALC=82.553631491,
                   VALE_REFE=82.560000000000002,
                   REFERENCE='NON_DEFINI',
                   PRECISION=1.E-2,),
                ),
          )

#

TEST_RESU(RESU=(_F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N123',
                   NOM_CMP='FLUX',
                   VALE_CALC= 8.96066859E+03,
                   VALE_REFE=8822.9799999999996,
                   REFERENCE='NON_DEFINI',
                   PRECISION=0.02,
                   MAILLE='M16',),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N123',
                   NOM_CMP='FLUY',
                   VALE_CALC=-5.92067357E-11,
                   VALE_REFE=0.0,
                   REFERENCE='NON_DEFINI',
                   CRITERE='ABSOLU',
                   PRECISION=1.0,
                   MAILLE='M16',),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N123',
                   NOM_CMP='FLUZ',
                   VALE_CALC=-20.343720667,
                   VALE_REFE=0.0,
                   REFERENCE='NON_DEFINI',
                   CRITERE='ABSOLU',
                   PRECISION=21.0,
                   MAILLE='M16',),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N119',
                   NOM_CMP='FLUX',
                   VALE_CALC= 8.96066859E+03,
                   VALE_REFE=8822.9799999999996,
                   REFERENCE='NON_DEFINI',
                   PRECISION=0.02,
                   MAILLE='M16',),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N119',
                   NOM_CMP='FLUY',
                   VALE_CALC=-1.24821946E-10,
                   VALE_REFE=0.0,
                   REFERENCE='NON_DEFINI',
                   CRITERE='ABSOLU',
                   PRECISION=1.0,
                   MAILLE='M16',),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N119',
                   NOM_CMP='FLUZ',
                   VALE_CALC=-20.343720667,
                   VALE_REFE=0.0,
                   REFERENCE='NON_DEFINI',
                   CRITERE='ABSOLU',
                   PRECISION=21.0,
                   MAILLE='M16',),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N106',
                   NOM_CMP='FLUX',
                   VALE_CALC= 1.16698458E+04,
                   VALE_REFE=1.157749E4,
                   REFERENCE='NON_DEFINI',
                   PRECISION=0.02,
                   MAILLE='M17',),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N106',
                   NOM_CMP='FLUY',
                   VALE_CALC=-2.53326525E-10,
                   VALE_REFE=0.0,
                   REFERENCE='NON_DEFINI',
                   CRITERE='ABSOLU',
                   PRECISION=1.0,
                   MAILLE='M17',),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N106',
                   NOM_CMP='FLUZ',
                   VALE_CALC=-25.583811624,
                   VALE_REFE=0.0,
                   REFERENCE='NON_DEFINI',
                   CRITERE='ABSOLU',
                   PRECISION=26.0,
                   MAILLE='M17',),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N103',
                   NOM_CMP='FLUX',
                   VALE_CALC= 1.16698458E+04,
                   VALE_REFE=1.157749E4,
                   REFERENCE='NON_DEFINI',
                   PRECISION=0.02,
                   MAILLE='M17',),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N103',
                   NOM_CMP='FLUY',
                   VALE_CALC= 3.16318285E-10,
                   VALE_REFE=0.0,
                   REFERENCE='NON_DEFINI',
                   CRITERE='ABSOLU',
                   PRECISION=1.0,
                   MAILLE='M17',),
                _F(NUME_ORDRE=0,
                   RESULTAT=TEMPE,
                   NOM_CHAM='FLUX_ELNO',
                   NOEUD='N103',
                   NOM_CMP='FLUZ',
                   VALE_CALC=-25.583811624,
                   VALE_REFE=0.0,
                   REFERENCE='NON_DEFINI',
                   CRITERE='ABSOLU',
                   PRECISION=26.0,
                   MAILLE='M17',),
                ),
          )

FIN();

#
