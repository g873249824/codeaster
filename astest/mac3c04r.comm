# ======================================================================
# COPYRIGHT (C) 1991 - 2017  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================

# UTILISATION : COMPARAISON DE LA SIMULATION NUMERIQUE D'UN ASSEMBLAGE
#               COMBUSTIBLE EN FLEXION AVEC LES RESULTATS EXPERIMENTAUX

DEBUT(CODE=_F(NIV_PUB_WEB='INTRANET'),IMPR_MACRO='NON',PAR_LOT='NON')

tabn = LIRE_TABLE(UNITE      = 38,
                  FORMAT     = 'LIBRE',
                  SEPARATEUR = '\t')

MA1=LIRE_MAILLAGE(FORMAT='MED',UNITE=20);

FLEX = CALC_MAC3COEUR(TYPE_COEUR  = 'MONO_FROID',
                      TABLE_N     =  tabn,
                      MAILLAGE_N  =  MA1,
                      DEFORMATION = _F(UNITE_THYC   = 32,
                                       NIVE_FLUENCE = 0.,
                                       TYPE_MAINTIEN = 'FORCE',
                                       FORCE_MAINTIEN =5610.,
                                       ARCHIMEDE      = 'NON',
                                       ),)

#----------------------------------------------------------------------
# TRACER LA COURBE FORCE-DEPLACEMENT
#----------------------------------------------------------------------

# courbe de charge de l'essai de flexion

FLEX_CH = LIRE_FONCTION(UNITE=21,
                    NOM_PARA='DX',
                    PROL_DROITE='CONSTANT',
                    PROL_GAUCHE = 'CONSTANT',);
FLEX_DCH = LIRE_FONCTION(UNITE=22,
                    NOM_PARA='DX',
                    PROL_DROITE='CONSTANT',
                    PROL_GAUCHE = 'CONSTANT',);
# 
# 
FLEX=CALC_CHAMP(reuse =FLEX,
             RESULTAT=FLEX,
             FORCE=('FORC_NODA',),)

POST1=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                        INTITULE='DY',
                        RESULTAT =FLEX,
                        NOM_CHAM ='DEPL',
                        NOM_CMP = 'DY',
                        GROUP_NO='P_A_A_5',),)
                        
                        


DEPLF=RECU_FONCTION(TABLE=POST1,PARA_X='INST',PARA_Y='DY',)

POST2=POST_RELEVE_T(
   ACTION=_F(INTITULE='FORCE',
             GROUP_NO=('GRIL_5'),
             RESULTAT=FLEX,
             NOM_CHAM='FORC_NODA',
             RESULTANTE=('DX','DY','DZ'),
             REPERE='GLOBAL',
             OPERATION='EXTRACTION',),)
             
             
FORCF=RECU_FONCTION(TABLE=POST2,PARA_X='INST',PARA_Y='DY',)
# 
# l'activation des commandes suivantes permet
# de tracer la courbe force-deplacement
IMPR_FONCTION(FORMAT='XMGRACE',UNITE=29,
              COURBE=(_F(FONCTION=FLEX_CH ,LEGENDE='essai de flexion - charge'  ,MARQUEUR =   0,COULEUR =    2,STYLE = 1,),
                      _F(FONCTION=FLEX_DCH,LEGENDE='essai de flexion - decharge',MARQUEUR =   0,COULEUR =    2,STYLE = 1,),
                      _F(FONC_X=DEPLF,FONC_Y=FORCF,LEGENDE='calcul',MARQUEUR =   0,COULEUR =    4,STYLE = 1,),
                      ),
              BORNE_X=(0.,0.026),BORNE_Y=(0.,1700.),ECHELLE_X='LIN',ECHELLE_Y='LIN',GRILLE_X=0.002,GRILLE_Y=200.,LEGENDE_X='DY(m)',LEGENDE_Y='effort (N)',
              TITRE='Recalage essai de flexion RFA900Zirlo',)
# 

TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.175,VALE_CALC=0.00383394517409,  VALE_REFE=0.0037883962264 ,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.0026,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.175,VALE_CALC=0.005640653966,  VALE_REFE=0.00543961904768,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.0028,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.175,VALE_CALC=0.00693651313922,  VALE_REFE=0.0064546309524 ,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.0029,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.175,VALE_CALC=0.0128530014111,  VALE_REFE=0.0126069642857 ,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.0033,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.175,VALE_CALC=0.0218749859193,  VALE_REFE=0.0216179878048 ,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.0038,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.175,VALE_CALC=0.0262839964897,  VALE_REFE=0.0251          ,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.004 ,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.175,VALE_CALC=0.0250010038665,  VALE_REFE=0.0240041002571 ,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.0052,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.175,VALE_CALC=0.0224350181053,  VALE_REFE=0.0216017384106 ,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.0056,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.175,VALE_CALC=0.0192275359037,  VALE_REFE=0.0172695121951 ,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.0061,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.175,VALE_CALC=0.0185860394634,  VALE_REFE=0.0160365853658 ,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.0062,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.25,VALE_CALC=0.0168077949612,  VALE_REFE=0.0139572967479 ,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.0064,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.25,VALE_CALC=0.0120805164928,  VALE_REFE=0.00992529891307,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.0068,),)
TEST_TABLE(CRITERE='RELATIF',REFERENCE='SOURCE_EXTERNE',PRECISION=0.25,VALE_CALC=0.00922257145857,  VALE_REFE=0.00770000000002,NOM_PARA='DY',TABLE=POST1,FILTRE=_F(NOM_PARA='INST',VALE=0.007 ,),)

TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=505.4999999730, VALE_REFE=5.05500E+02,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.0026,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=673.9999999996, VALE_REFE=6.74000E+02,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.0028,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=758.2499999675, VALE_REFE=7.58250E+02,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.0029,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=1095.250000000, VALE_REFE=1.09525E+03,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.0033,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=1516.499999934, VALE_REFE=1.51650E+03,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.0038,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=1684.999999905, VALE_REFE=1.68500E+03,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.004 ,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=1516.500000003  ,VALE_REFE=1.51650E+03  ,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.0052,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=1179.499999998  ,VALE_REFE=1.17950E+03  ,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.0056,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=758.2500000018  ,VALE_REFE=7.58250E+02  ,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.0061,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=674.0000000003  ,VALE_REFE=6.74000E+02  ,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.0062,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=505.5000000139  ,VALE_REFE=5.05500E+02  ,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.0064,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=168.5000000422  ,VALE_REFE=1.68500E+02  ,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.0068,),)
TEST_FONCTION(VALEUR=_F(CRITERE='ABSOLU',REFERENCE='SOURCE_EXTERNE',PRECISION=0.5,VALE_CALC=-8.063125398706E-09  ,VALE_REFE=1.82263E-09  ,NOM_PARA='DY',FONCTION=FORCF,VALE_PARA=0.007 ,),)



FIN()
