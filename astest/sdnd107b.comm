#
# TITRE EXCITATION SISMIQUE D’UN SYSTÈME AVEC AMORTISSEUR VISQUEUX NON LINÉAIRE DE TYPE "ZENER"
#
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#
# --------------------------------------------------------------------------------------------------
#
#                   DISCRET COMPORTEMENT ZENER GENERALISE
#
#   Validation du comportement avec DYNA_NON_LINE
#
#
# --------------------------------------------------------------------------------------------------

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET',VISU_EFICAS='NON',),)

MAIL=LIRE_MAILLAGE()
#
# Définition du matériau
Zener = DEFI_MATERIAU(
    ELAS=_F(E=1.0, NU=0.1),
    DIS_VISC=_F(K1=120.0, K2=10.0, K3=60.0, C=1.7, PUIS_ALPHA=0.5),
)
#
Chmater=AFFE_MATERIAU(
    MAILLAGE=MAIL,
    AFFE= _F(TOUT='OUI',  MATER=Zener,),
)
# Modèle
Modele=AFFE_MODELE(
    MAILLAGE=MAIL,
    AFFE=_F( GROUP_MA=('GM0102','MASSE','GM0203'), PHENOMENE='MECANIQUE', MODELISATION='DIS_T',),
)
# Caractéristiques Ressorts / Masse
kbid = 1.0
CaraElem=AFFE_CARA_ELEM(
    MODELE=Modele,
    DISCRET=(
        _F( REPERE='LOCAL',CARA='K_T_D_L', GROUP_MA='GM0102',  VALE=(kbid,kbid,kbid), ),
        _F( REPERE='LOCAL',CARA='A_T_D_L', GROUP_MA='GM0102',  VALE=( 0.0,0.0,0.0,), ),
        _F( REPERE='LOCAL',CARA='M_T_D_L', GROUP_MA='GM0102',  VALE=( 0.0), ),

        _F( REPERE='LOCAL',CARA='M_T_D_N', GROUP_MA='MASSE', VALE=( 1.0), ),
        _F( REPERE='LOCAL',CARA='K_T_D_N', GROUP_MA='MASSE', VALE=( 0.0,0.0,0.0,), ),
        _F( REPERE='LOCAL',CARA='A_T_D_N', GROUP_MA='MASSE', VALE=( 0.0,0.0,0.0,), ),

        _F( REPERE='LOCAL',CARA='K_T_D_L', GROUP_MA='GM0203',  VALE=( 1.0, 1.0, 1.0), ),
        _F( REPERE='LOCAL',CARA='A_T_D_L', GROUP_MA='GM0203',  VALE=( 0.0, 0.0, 0.0,), ),
        _F( REPERE='LOCAL',CARA='M_T_D_L', GROUP_MA='GM0203',  VALE=( 0.0), ),
    ),
)
#
# condition aux limites en déplacement
Blocage=AFFE_CHAR_MECA(
   MODELE=Modele,
   DDL_IMPO= (
        _F(NOEUD='N01', DX=0.0, DY=0.0, DZ=0.0,),
        _F(NOEUD='N02',         DY=0.0, DZ=0.0,),
        _F(NOEUD='N03', DX=0.0, DY=0.0, DZ=0.0,),
    ),
)
#
Frequence = 5.0
Pulsation = 2.0*pi*Frequence
Amplitude =-1.0*(Pulsation**2)
#
Tsignal = 4.0/Frequence
LinstF = DEFI_LIST_REEL(
    DEBUT=0.,
    INTERVALLE=_F(JUSQU_A = Tsignal, PAS = 0.5/Frequence/40.0),
)
Linst  = DEFI_LIST_REEL(
    DEBUT=0.,
    INTERVALLE=(
        _F(JUSQU_A = Tsignal, PAS = 0.5/Frequence/40.0),
        _F(JUSQU_A = 4.0*Tsignal, PAS = 0.5/Frequence/20.0),
    )
)
#
Deplace  = FORMULE(NOM_PARA='INST',VALE='-Amplitude*sin(Pulsation*INST)/(Pulsation**2)')
#
DeplaceI = CALC_FONC_INTERP(NOM_RESU='Deplace',
    FONCTION=Deplace, LIST_PARA=LinstF, NOM_PARA='INST',
    PROL_DROITE='CONSTANT', PROL_GAUCHE='CONSTANT',
)
#
#
ASSEMBLAGE(
    MODELE=Modele, CARA_ELEM=CaraElem, CHARGE=Blocage,
    NUME_DDL=CO('NumeDDL'),
    MATR_ASSE=(
        _F(MATRICE=CO('Masse'),    OPTION='MASS_MECA',),
        _F(MATRICE=CO('Rigidite'), OPTION='RIGI_MECA',),
    ),
)
#
DeplSism=CALC_CHAR_SEISME(
    MATR_MASS=Masse,
    MONO_APPUI='OUI',
    DIRECTION=(1.0, 0.0, 0.0),
)
#
# On transforme le CHAM_NO_DEPL_R et CHAR_MECA
ChaSism=AFFE_CHAR_MECA(MODELE=Modele, VECT_ASSE=DeplSism,)
#
# Calcul dynamique non-linéaire
Resultat=DYNA_NON_LINE(
    MODELE=Modele,
    CHAM_MATER=Chmater,
    CARA_ELEM=CaraElem,
    EXCIT=(
        _F(CHARGE=Blocage,),
        _F(CHARGE=ChaSism,FONC_MULT=DeplaceI),
    ),
    COMPORTEMENT=(
        _F(RELATION='ELAS',     TOUT='OUI'),
        _F(RELATION='DIS_VISC', GROUP_MA='GM0102'),
    ),
    INCREMENT=_F(LIST_INST=Linst,),
    CONVERGENCE=_F(RESI_GLOB_RELA=1.0E-6,ITER_GLOB_MAXI=50, ARRET='OUI',),
    SCHEMA_TEMPS=_F(SCHEMA='NEWMARK', FORMULATION='DEPLACEMENT',),
    NEWTON=_F(MATRICE='TANGENTE',REAC_INCR=1,REAC_ITER=1,),
    SOLVEUR=_F(METHODE='LDLT', ),
)
#
Resultat=CALC_CHAMP(reuse=Resultat,
    RESULTAT=Resultat,
    FORCE='FORC_NODA', TOUT_ORDRE='OUI', TOUT='OUI',
)
#IMPR_RESU(FORMAT='RESULTAT',RESU=_F(RESULTAT=Resultat,),)
#
Depl=RECU_FONCTION(NOM_RESU='Depl',
    RESULTAT=Resultat, LIST_INST=Linst,
    NOM_CHAM='DEPL', NOM_CMP='DX',
    NOEUD='N02',
    PROL_DROITE='LINEAIRE',
    PROL_GAUCHE='LINEAIRE',
)
# On récupère -Force, on est sur N01
Force=RECU_FONCTION(NOM_RESU='Force',
    RESULTAT=Resultat, LIST_INST=Linst,
    NOM_CHAM='FORC_NODA', NOM_CMP='DX',
    NOEUD='N01',
    PROL_DROITE='LINEAIRE',
    PROL_GAUCHE='LINEAIRE',
)
#
#
# Solution obtenue par intégartion RK
DeplRK=DEFI_FONCTION(NOM_RESU='Depl',
    NOM_PARA='INST', PROL_GAUCHE='EXCLU',  PROL_DROITE='EXCLU',
    VALE=(
 0.00000000e+00,  0.00000000e+00,   1.00000000e-02, -5.20902913e-06,   2.00000000e-02, -4.10312928e-05,   3.00000000e-02, -1.34942750e-04,
 4.00000000e-02, -3.08452682e-04,   5.00000000e-02, -5.74860186e-04,   6.00000000e-02, -9.37817655e-04,   7.00000000e-02, -1.39084367e-03,
 8.00000000e-02, -1.91783475e-03,   9.00000000e-02, -2.49452733e-03,   1.00000000e-01, -3.09076712e-03,   1.10000000e-01, -3.67336356e-03,
 1.20000000e-01, -4.20924847e-03,   1.30000000e-01, -4.66862844e-03,   1.40000000e-01, -5.02782129e-03,   1.50000000e-01, -5.27149874e-03,
 1.60000000e-01, -5.39411658e-03,   1.70000000e-01, -5.40039369e-03,   1.80000000e-01, -5.30479486e-03,   1.90000000e-01, -5.13006935e-03,
 2.00000000e-01, -4.90498885e-03,   2.10000000e-01, -4.66150632e-03,   2.20000000e-01, -4.43161276e-03,   2.30000000e-01, -4.24419860e-03,
 2.40000000e-01, -4.12222556e-03,   2.50000000e-01, -4.08048526e-03,   2.60000000e-01, -4.12416348e-03,   2.70000000e-01, -4.24835104e-03,
 2.80000000e-01, -4.43854964e-03,   2.90000000e-01, -4.67212358e-03,   3.00000000e-01, -4.92055524e-03,   3.10000000e-01, -5.15228315e-03,
 3.20000000e-01, -5.33584393e-03,   3.30000000e-01, -5.44300939e-03,   3.40000000e-01, -5.45161104e-03,   3.50000000e-01, -5.34777539e-03,
 3.60000000e-01, -5.12735130e-03,   3.70000000e-01, -4.79639085e-03,   3.80000000e-01, -4.37063714e-03,   3.90000000e-01, -3.87406993e-03,
 4.00000000e-01, -3.33665136e-03,   4.10000000e-01, -2.79149146e-03,   4.20000000e-01, -2.27170960e-03,   4.30000000e-01, -1.80729738e-03,
 4.40000000e-01, -1.42228672e-03,   4.50000000e-01, -1.13249459e-03,   4.60000000e-01, -9.44069871e-04,   4.70000000e-01, -8.52990456e-04,
 4.80000000e-01, -8.45559022e-04,   4.90000000e-01, -8.99847032e-04,   5.00000000e-01, -9.87944117e-04,   5.10000000e-01, -1.07879159e-03,
 5.20000000e-01, -1.14132220e-03,   5.30000000e-01, -1.14759868e-03,   5.40000000e-01, -1.07564369e-03,   5.50000000e-01, -9.11683770e-04,
 5.60000000e-01, -6.51586764e-04,   5.70000000e-01, -3.01350711e-04,   5.80000000e-01,  1.23404940e-04,   5.90000000e-01,  5.98897072e-04,
 6.00000000e-01,  1.09544323e-03,   6.10000000e-01,  1.58031043e-03,   6.20000000e-01,  2.02086846e-03,   6.30000000e-01,  2.38773762e-03,
 6.40000000e-01,  2.65762185e-03,   6.50000000e-01,  2.81554955e-03,   6.60000000e-01,  2.85630336e-03,   6.70000000e-01,  2.78490010e-03,
 6.80000000e-01,  2.61607536e-03,   6.90000000e-01,  2.37282411e-03,   7.00000000e-01,  2.08414094e-03,   7.10000000e-01,  1.78218052e-03,
 7.20000000e-01,  1.49911551e-03,   7.30000000e-01,  1.26399820e-03,   7.40000000e-01,  1.09993175e-03,   7.50000000e-01,  1.02182732e-03,
 7.60000000e-01,  1.03496639e-03,   7.70000000e-01,  1.13450922e-03,   7.80000000e-01,  1.30599848e-03,   7.90000000e-01,  1.52680915e-03,
 8.00000000e-01,  1.76840310e-03,   8.20000000e-01,  2.22858865e-03,   8.40000000e-01,  2.63837316e-03,   8.60000000e-01,  2.99181561e-03,
 8.80000000e-01,  3.28425200e-03,   9.00000000e-01,  3.51231990e-03,   9.20000000e-01,  3.67394726e-03,   9.40000000e-01,  3.76831297e-03,
 9.60000000e-01,  3.79578625e-03,   9.80000000e-01,  3.75785124e-03,   1.00000000e+00,  3.65702195e-03,   1.02000000e+00,  3.49675148e-03,
 1.04000000e+00,  3.28133854e-03,   1.06000000e+00,  3.01583320e-03,   1.08000000e+00,  2.70594319e-03,   1.10000000e+00,  2.35794141e-03,
 1.12000000e+00,  1.97857506e-03,   1.14000000e+00,  1.57497631e-03,   1.16000000e+00,  1.15457462e-03,   1.18000000e+00,  7.25010116e-04,
 1.20000000e+00,  2.94045009e-04,   1.22000000e+00, -1.30561541e-04,   1.24000000e+00, -5.41233758e-04,   1.26000000e+00, -9.30763697e-04,
 1.28000000e+00, -1.29247832e-03,   1.30000000e+00, -1.62038253e-03,   1.32000000e+00, -1.90927395e-03,   1.34000000e+00, -2.15482762e-03,
 1.36000000e+00, -2.35365099e-03,   1.38000000e+00, -2.50331115e-03,   1.40000000e+00, -2.60233756e-03,   1.42000000e+00, -2.65020398e-03,
 1.44000000e+00, -2.64729361e-03,   1.46000000e+00, -2.59485101e-03,   1.48000000e+00, -2.49492422e-03,   1.50000000e+00, -2.35029981e-03,
 1.52000000e+00, -2.16443301e-03,   1.54000000e+00, -1.94137474e-03,   1.56000000e+00, -1.68569668e-03,   1.58000000e+00, -1.40241536e-03,
 1.60000000e+00, -1.09691577e-03,   1.62000000e+00, -7.74874895e-04,   1.64000000e+00, -4.42185336e-04,   1.66000000e+00, -1.04879031e-04,
 1.68000000e+00,  2.30951954e-04,   1.70000000e+00,  5.59261559e-04,   1.72000000e+00,  8.74185718e-04,   1.74000000e+00,  1.17017639e-03,
 1.76000000e+00,  1.44212300e-03,   1.78000000e+00,  1.68545715e-03,   1.80000000e+00,  1.89623803e-03,   1.82000000e+00,  2.07121696e-03,
 1.84000000e+00,  2.20788124e-03,   1.86000000e+00,  2.30447805e-03,   1.88000000e+00,  2.36002031e-03,   1.90000000e+00,  2.37427657e-03,
 1.92000000e+00,  2.34774736e-03,   1.94000000e+00,  2.28163044e-03,   1.96000000e+00,  2.17777713e-03,   1.98000000e+00,  2.03864166e-03,
 2.00000000e+00,  1.86722533e-03,   2.02000000e+00,  1.66701670e-03,   2.04000000e+00,  1.44192901e-03,   2.06000000e+00,  1.19623569e-03,
 2.08000000e+00,  9.34504403e-04,   2.10000000e+00,  6.61530297e-04,   2.12000000e+00,  3.82268619e-04,   2.14000000e+00,  1.01766384e-04,
 2.16000000e+00, -1.74918075e-04,   2.18000000e+00, -4.42820678e-04,   2.20000000e+00, -6.97182087e-04,   2.22000000e+00, -9.33550821e-04,
 2.24000000e+00, -1.14787535e-03,   2.26000000e+00, -1.33658260e-03,   2.28000000e+00, -1.49664121e-03,   2.30000000e+00, -1.62560870e-03,
 2.32000000e+00, -1.72166275e-03,   2.34000000e+00, -1.78361718e-03,   2.36000000e+00, -1.81092398e-03,   2.38000000e+00, -1.80366284e-03,
 2.40000000e+00, -1.76252002e-03,   2.42000000e+00, -1.68875801e-03,   2.44000000e+00, -1.58417789e-03,   2.46000000e+00, -1.45107559e-03,
 2.48000000e+00, -1.29219350e-03,   2.50000000e+00, -1.11066834e-03,   2.52000000e+00, -9.09976389e-04,   2.54000000e+00, -6.93876532e-04,
 2.56000000e+00, -4.66351889e-04,   2.58000000e+00, -2.31550376e-04,   2.60000000e+00,  6.27543761e-06,   2.62000000e+00,  2.42830265e-04,
 2.64000000e+00,  4.73851163e-04,   2.66000000e+00,  6.95197633e-04,   2.68000000e+00,  9.02940580e-04,   2.70000000e+00,  1.09344425e-03,
 2.72000000e+00,  1.26343871e-03,   2.74000000e+00,  1.41008113e-03,   2.76000000e+00,  1.53100466e-03,   2.78000000e+00,  1.62435446e-03,
 2.80000000e+00,  1.68881096e-03,   2.82000000e+00,  1.72360086e-03,   2.84000000e+00,  1.72849687e-03,   2.86000000e+00,  1.70380720e-03,
 2.88000000e+00,  1.65035615e-03,   2.90000000e+00,  1.56945706e-03,   2.92000000e+00,  1.46287879e-03,   2.94000000e+00,  1.33280695e-03,
 2.96000000e+00,  1.18180077e-03,   2.98000000e+00,  1.01274663e-03,   3.00000000e+00,  8.28808888e-04,   3.02000000e+00,  6.33378647e-04,
 3.04000000e+00,  4.30021063e-04,   3.06000000e+00,  2.22421511e-04,   3.08000000e+00,  1.43306271e-05,   3.10000000e+00, -1.90498313e-04,
 3.12000000e+00, -3.88385612e-04,   3.14000000e+00, -5.75803090e-04,   3.16000000e+00, -7.49447262e-04,   3.18000000e+00, -9.06305530e-04,
 3.20000000e+00, -1.04371370e-03,
    ),
)
ForceRK=DEFI_FONCTION(NOM_RESU='Force',
    NOM_PARA='INST', PROL_GAUCHE='EXCLU',  PROL_DROITE='EXCLU',
    VALE=(
 0.00000000e+00,  0.00000000e+00,   1.00000000e-02, -2.30293188e-04,   2.00000000e-02, -1.81392365e-03,   3.00000000e-02, -5.96439017e-03,
 4.00000000e-02, -1.36262419e-02,   5.00000000e-02, -2.53678658e-02,   6.00000000e-02, -4.13076424e-02,   7.00000000e-02, -6.10840939e-02,
 8.00000000e-02, -8.38776170e-02,   9.00000000e-02, -1.08485675e-01,   1.00000000e-01, -1.33445445e-01,   1.10000000e-01, -1.57189602e-01,
 1.20000000e-01, -1.78214641e-01,   1.30000000e-01, -1.95238932e-01,   1.40000000e-01, -2.07330340e-01,   1.50000000e-01, -2.13989746e-01,
 1.60000000e-01, -2.15184845e-01,   1.70000000e-01, -2.11335988e-01,   1.80000000e-01, -2.03260935e-01,   1.90000000e-01, -1.92087878e-01,
 2.00000000e-01, -1.79146576e-01,   2.10000000e-01, -1.65846847e-01,   2.20000000e-01, -1.53552959e-01,   2.30000000e-01, -1.43462079e-01,
 2.40000000e-01, -1.36495226e-01,   2.50000000e-01, -1.33209581e-01,   2.60000000e-01, -1.33741203e-01,   2.70000000e-01, -1.37786237e-01,
 2.80000000e-01, -1.44626029e-01,   2.90000000e-01, -1.53196886e-01,   3.00000000e-01, -1.62199075e-01,   3.10000000e-01, -1.70233362e-01,
 3.20000000e-01, -1.75948536e-01,   3.30000000e-01, -1.78181588e-01,   3.40000000e-01, -1.76073871e-01,   3.50000000e-01, -1.69151213e-01,
 3.60000000e-01, -1.57362046e-01,   3.70000000e-01, -1.41073476e-01,   3.80000000e-01, -1.21029744e-01,   3.90000000e-01, -9.82801285e-02,
 4.00000000e-01, -7.40844004e-02,   4.10000000e-01, -4.98039220e-02,   4.20000000e-01, -2.67861230e-02,   4.30000000e-01, -6.25739979e-03,
 4.40000000e-01,  1.07152180e-02,   4.50000000e-01,  2.33950683e-02,   4.60000000e-01,  3.15103614e-02,   4.70000000e-01,  3.52660536e-02,
 4.80000000e-01,  3.53055303e-02,   4.90000000e-01,  3.26317873e-02,   5.00000000e-01,  2.84987967e-02,   5.10000000e-01,  2.42840238e-02,
 5.20000000e-01,  2.13524931e-02,   5.30000000e-01,  2.09222939e-02,   5.40000000e-01,  2.39414251e-02,   5.50000000e-01,  3.09863178e-02,
 5.60000000e-01,  4.21926478e-02,   5.70000000e-01,  5.72282290e-02,   5.80000000e-01,  7.53149412e-02,   5.90000000e-01,  9.53013445e-02,
 6.00000000e-01,  1.15780365e-01,   6.10000000e-01,  1.35238754e-01,   6.20000000e-01,  1.52219135e-01,   6.30000000e-01,  1.65473209e-01,
 6.40000000e-01,  1.74086932e-01,   6.50000000e-01,  1.77564226e-01,   6.60000000e-01,  1.75863261e-01,   6.70000000e-01,  1.69386247e-01,
 6.80000000e-01,  1.58928736e-01,   6.90000000e-01,  1.45597024e-01,   7.00000000e-01,  1.30702983e-01,   7.10000000e-01,  1.15645301e-01,
 7.20000000e-01,  1.01785501e-01,   7.30000000e-01,  9.03268798e-02,   7.40000000e-01,  8.22047162e-02,   7.50000000e-01,  7.79966490e-02,
 7.60000000e-01,  7.78623505e-02,   7.70000000e-01,  8.15208883e-02,   7.80000000e-01,  8.82716997e-02,   7.90000000e-01,  9.70606355e-02,
 8.00000000e-01,  1.06586430e-01,   8.20000000e-01,  1.24027433e-01,   8.40000000e-01,  1.38484020e-01,   8.60000000e-01,  1.49795485e-01,
 8.80000000e-01,  1.57906587e-01,   9.00000000e-01,  1.62850211e-01,   9.20000000e-01,  1.64728581e-01,   9.40000000e-01,  1.63695303e-01,
 9.60000000e-01,  1.59939624e-01,   9.80000000e-01,  1.53673583e-01,   1.00000000e+00,  1.45122125e-01,   1.02000000e+00,  1.34515945e-01,
 1.04000000e+00,  1.22086618e-01,   1.06000000e+00,  1.08063538e-01,   1.08000000e+00,  9.26722388e-02,   1.10000000e+00,  7.61336879e-02,
 1.12000000e+00,  5.86642760e-02,   1.14000000e+00,  4.04762597e-02,   1.16000000e+00,  2.17785029e-02,   1.18000000e+00,  2.77822183e-03,
 1.20000000e+00, -1.62288608e-02,   1.22000000e+00, -3.47824002e-02,   1.24000000e+00, -5.24265795e-02,   1.26000000e+00, -6.87495536e-02,
 1.28000000e+00, -8.33995487e-02,   1.30000000e+00, -9.60952343e-02,   1.32000000e+00, -1.06630117e-01,   1.34000000e+00, -1.14871541e-01,
 1.36000000e+00, -1.20755442e-01,   1.38000000e+00, -1.24278269e-01,   1.40000000e+00, -1.25487441e-01,   1.42000000e+00, -1.24471509e-01,
 1.44000000e+00, -1.21350877e-01,   1.46000000e+00, -1.16269600e-01,   1.48000000e+00, -1.09388526e-01,   1.50000000e+00, -1.00879816e-01,
 1.52000000e+00, -9.09227726e-02,   1.54000000e+00, -7.97007843e-02,   1.56000000e+00, -6.73992236e-02,   1.58000000e+00, -5.42040850e-02,
 1.60000000e+00, -4.03011996e-02,   1.62000000e+00, -2.58758741e-02,   1.64000000e+00, -1.11128347e-02,   1.66000000e+00,  3.80173598e-03,
 1.68000000e+00,  1.86106127e-02,   1.70000000e+00,  3.29705523e-02,   1.72000000e+00,  4.65511342e-02,   1.74000000e+00,  5.90534962e-02,
 1.76000000e+00,  7.02203204e-02,   1.78000000e+00,  7.98425231e-02,   1.80000000e+00,  8.77625066e-02,   1.82000000e+00,  9.38742424e-02,
 1.84000000e+00,  9.81207496e-02,   1.86000000e+00,  1.00489687e-01,   1.88000000e+00,  1.01007803e-01,   1.90000000e+00,  9.97348998e-02,
 1.92000000e+00,  9.67578640e-02,   1.94000000e+00,  9.21851089e-02,   1.96000000e+00,  8.61416804e-02,   1.98000000e+00,  7.87651154e-02,
 2.00000000e+00,  7.02020710e-02,   2.02000000e+00,  6.06056718e-02,   2.04000000e+00,  5.01334936e-02,   2.06000000e+00,  3.89460825e-02,
 2.08000000e+00,  2.72059072e-02,   2.10000000e+00,  1.50766487e-02,   2.12000000e+00,  2.72275048e-03,   2.14000000e+00, -9.66589345e-03,
 2.16000000e+00, -2.18225898e-02,   2.18000000e+00, -3.34746078e-02,   2.20000000e+00, -4.43682151e-02,   2.22000000e+00, -5.42770715e-02,
 2.24000000e+00, -6.30086148e-02,   2.26000000e+00, -7.04081683e-02,   2.28000000e+00, -7.63607657e-02,   2.30000000e+00, -8.07909150e-02,
 2.32000000e+00, -8.36606816e-02,   2.34000000e+00, -8.49665466e-02,   2.36000000e+00, -8.47355065e-02,   2.38000000e+00, -8.30208297e-02,
 2.40000000e+00, -7.98978085e-02,   2.42000000e+00, -7.54597515e-02,   2.44000000e+00, -6.98143727e-02,   2.46000000e+00, -6.30806600e-02,
 2.48000000e+00, -5.53862425e-02,   2.50000000e+00, -4.68652381e-02,   2.52000000e+00, -3.76565341e-02,   2.54000000e+00, -2.79024389e-02,
 2.56000000e+00, -1.77476385e-02,   2.58000000e+00, -7.33838803e-03,   2.60000000e+00,  3.17737840e-03,   2.62000000e+00,  1.36176162e-02,
 2.64000000e+00,  2.37564596e-02,   2.66000000e+00,  3.33749845e-02,   2.68000000e+00,  4.22717862e-02,   2.70000000e+00,  5.02688944e-02,
 2.72000000e+00,  5.72161882e-02,   2.74000000e+00,  6.29941766e-02,   2.76000000e+00,  6.75151721e-02,   2.78000000e+00,  7.07230283e-02,
 2.80000000e+00,  7.25917016e-02,   2.82000000e+00,  7.31229454e-02,   2.84000000e+00,  7.23434480e-02,   2.86000000e+00,  7.03016959e-02,
 2.88000000e+00,  6.70647932e-02,   2.90000000e+00,  6.27154134e-02,   2.92000000e+00,  5.73489970e-02,   2.94000000e+00,  5.10712643e-02,
 2.96000000e+00,  4.39960649e-02,   2.98000000e+00,  3.62435605e-02,   3.00000000e+00,  2.79387140e-02,   3.02000000e+00,  1.92100435e-02,
 3.04000000e+00,  1.01885959e-02,   3.06000000e+00,  1.00712045e-03,   3.08000000e+00, -8.18456827e-03,   3.10000000e+00, -1.71953064e-02,
 3.12000000e+00, -2.58331725e-02,   3.14000000e+00, -3.39183094e-02,   3.16000000e+00, -4.12881743e-02,   3.18000000e+00, -4.78017386e-02,
 3.20000000e+00, -5.33424722e-02,
    ),
)
#
LAbscD = DEFI_LIST_REEL(VALE=DeplRK.Absc())
DDepl0 = CALC_FONCTION(
    COMB=(
        _F(FONCTION=DeplRK,COEF = 1.0),
        _F(FONCTION=Depl,  COEF =-1.0),
    ),
    LIST_PARA=LAbscD,
)
DDepl1 = CALC_FONCTION(ABS=_F(FONCTION=DDepl0),)
MaxDeplRK=max(DeplRK.Ordo())
DDepl2 = CALC_FONCTION(
    COMB=_F(FONCTION=DDepl1,COEF = 1.0/MaxDeplRK),
)
#
LAbscF = DEFI_LIST_REEL(VALE= ForceRK.Absc())
DForce0 = CALC_FONCTION(
    COMB=(
        _F(FONCTION=ForceRK,COEF = 1.0),
        _F(FONCTION=Force,  COEF = 1.0),
    ),
    LIST_PARA=LAbscF,
)
DForce1 = CALC_FONCTION(ABS=_F(FONCTION=DForce0),)
MaxForceRK=max(ForceRK.Ordo())
DForce2 = CALC_FONCTION(
    COMB=_F(FONCTION=DForce1,COEF = 1.0/MaxForceRK),
)
#
TDDepl =CREA_TABLE(FONCTION=_F(FONCTION=DDepl2,),)
TDForce=CREA_TABLE(FONCTION=_F(FONCTION=DForce2,),)
#
TEST_TABLE(TABLE=TDDepl,
    FILTRE=_F(NOM_PARA='Depl',CRIT_COMP ='MAXI_ABS',),
    NOM_PARA='Depl',
    REFERENCE='SOURCE_EXTERNE',
    VALE_REFE= 9.7E-04, VALE_CALC=9.70022E-04,
)
TEST_TABLE(TABLE=TDForce,
    FILTRE=_F(NOM_PARA='Force',CRIT_COMP ='MAXI_ABS',),
    NOM_PARA='Force',
    REFERENCE='SOURCE_EXTERNE',
    VALE_REFE= 7.3019E-04, VALE_CALC=7.301891E-04,
)
#
IMPR_FONCTION(UNITE=29,
    FORMAT='TABLEAU',
    COURBE=(
        _F(FONCTION=Force),
        _F(FONCTION=Depl),
    ),
)
FIN()
