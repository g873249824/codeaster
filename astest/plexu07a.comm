# person_in_charge: sebastien.fayolle at edf.fr
# ======================================================================
# COPYRIGHT (C) 1991 - 2016  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#           REPONSE TRANSITOIRE D UNE DALLE EN BETON ARME
#
#  DETAILS : MODELISATION DKTG
#            Mailles TRIA3
#            Comportement GLRC_DAMAGE
#            Dynamique explicite
#            grands deplacements

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET',),DEBUG=_F(SDVERI='NON'))
# SDVERI='NON' car la verification est trop couteuse en CPU

EP=0.1
t1=1.0E-4
tmax=1.0E-3
dt=2.0E-6
pres=20.E7

MAIL=LIRE_MAILLAGE(FORMAT='MED',);

MAIL=DEFI_GROUP(reuse=MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=(_F(GROUP_MA='A1A2',),
                               _F(GROUP_MA='A4A3',),
                               _F(GROUP_MA='A2A4',),
                               _F(GROUP_MA='A3A1',),
                               _F(GROUP_MA='DALLE',),
                               _F(NOM='P04',
                                  OPTION='ENV_SPHERE',
                                  POINT=(0.4,0.2,),
                                  RAYON=0.001,
                                  PRECISION=0.0011,),),);

MAIL=MODI_MAILLAGE(reuse=MAIL,
                   MAILLAGE=MAIL,
                   ORIE_NORM_COQUE=_F(GROUP_MA='DALLE',
                                      VECT_NORM=(0.,0.,1.),
                                      GROUP_NO='A1',),);

MOD=AFFE_MODELE(MAILLAGE=MAIL,
                AFFE=_F(GROUP_MA='DALLE',
                        PHENOMENE='MECANIQUE',
                        MODELISATION='Q4GG',),);

#IMPR_RESU(MODELE=MOD,
          #RESU=_F(MAILLAGE=MAIL),);

MAT_B=DEFI_MATERIAU(ELAS=_F(E=30000.E6,
                            NU=0.2,
                            RHO=2500.0,),
                    BETON_ECRO_LINE=_F(D_SIGM_EPSI=0.0,
                                       SYT=5.E6,
                                       SYC=-35.E6,),);

MAT_A1=DEFI_MATERIAU(ELAS=_F(E=2.E11,
                             NU=0.0,),
                     ECRO_LINE=_F(D_SIGM_EPSI=0.0,
                                  SY=3.E9,),);

MAT_A2=DEFI_MATERIAU(ELAS=_F(E=2.E11,
                             NU=0.3,),
                     ECRO_LINE=_F(D_SIGM_EPSI=0.0,
                                  SY=5.E8,),);

MP1X=DEFI_FONCTION(NOM_PARA='X',
                   VALE=(-9170000.00000000,150000.000000000,
                         -5692500.00000000,315290.625000000,
                         -5616931.81818182,318798.534349174,
                         -5541363.63636364,322143.285123967,
                         -5465795.45454545,325324.877324380,
                         -5390227.27272727,328343.310950413,
                         -5314659.09090909,331198.586002066,
                         -5239090.90909091,333890.702479339,
                         -5163522.72727273,336419.660382231,
                         -5087954.54545454,338785.459710744,
                         -5012386.36363636,340988.100464876,
                         -4936818.18181818,343027.582644628,
                         -4861250.00000000,344903.906250000,
                         -4785681.81818182,346617.071280992,
                         -4710113.63636364,348167.077737603,
                         -4634545.45454546,349553.925619835,
                         -4558977.27272727,350777.614927686,
                         -4483409.09090909,351838.145661157,
                         -4407840.90909091,352735.517820248,
                         -4332272.72727273,353469.731404959,
                         -4256704.54545454,354040.786415289,
                         -4181136.36363636,354448.682851240,
                         -4105568.18181818,354693.420712810,
                         -4030000.00000000,354775.000000000,
                          530000.000000000,354775.000000000,
                          605568.181818182,354693.420712810,
                          681136.363636364,354448.682851240,
                          756704.545454545,354040.786415289,
                          832272.727272727,353469.731404959,
                          907840.909090909,352735.517820248,
                          983409.090909091,351838.145661157,
                          1058977.27272727,350777.614927686,
                          1134545.45454545,349553.925619835,
                          1210113.63636364,348167.077737603,
                          1285681.81818182,346617.071280992,
                          1361250.00000000,344903.906250000,
                          1436818.18181818,343027.582644628,
                          1512386.36363636,340988.100464876,
                          1587954.54545455,338785.459710744,
                          1663522.72727273,336419.660382231,
                          1739090.90909091,333890.702479339,
                          1814659.09090909,331198.586002066,
                          1890227.27272727,328343.310950413,
                          1965795.45454545,325324.877324380,
                          2041363.63636364,322143.285123967,
                          2116931.81818182,318798.534349174,
                          2192500.00000000,315290.625000000,
                          5582500.00000000,154265.625000000,
                          11670000.0000000,-150000.000000000,),
                   PROL_DROITE='LINEAIRE',
                   PROL_GAUCHE='LINEAIRE',);

MP2X=DEFI_FONCTION(NOM_PARA='X',
                   VALE=(-9170000.00000000,150000.000000000,
                         -3170000.00000000,-150000.000000000,
                          307500.000000000,-315290.625000000,
                          383068.181818182,-318798.534349174,
                          458636.363636364,-322143.285123967,
                          534204.545454546,-325324.877324380,
                          609772.727272727,-328343.310950413,
                          685340.909090910,-331198.586002066,
                          760909.090909091,-333890.702479339,
                          836477.272727273,-336419.660382231,
                          912045.454545455,-338785.459710744,
                          987613.636363637,-340988.100464876,
                          1063181.81818182,-343027.582644628,
                          1138750.00000000,-344903.906250000,
                          1214318.18181818,-346617.071280992,
                          1289886.36363636,-348167.077737603,
                          1365454.54545455,-349553.925619835,
                          1441022.72727273,-350777.614927686,
                          1516590.90909091,-351838.145661157,
                          1592159.09090909,-352735.517820248,
                          1667727.27272727,-353469.731404959,
                          1743295.45454545,-354040.786415289,
                          1818863.63636364,-354448.682851240,
                          1894431.81818182,-354693.420712810,
                          1970000.00000000,-354775.000000000,
                          6530000.00000000,-354775.000000000,
                          6605568.18181818,-354693.420712810,
                          6681136.36363636,-354448.682851240,
                          6756704.54545454,-354040.786415289,
                          6832272.72727273,-353469.731404959,
                          6907840.90909091,-352735.517820248,
                          6983409.09090909,-351838.145661157,
                          7058977.27272727,-350777.614927686,
                          7134545.45454546,-349553.925619835,
                          7210113.63636364,-348167.077737603,
                          7285681.81818182,-346617.071280992,
                          7361250.00000000,-344903.906250000,
                          7436818.18181818,-343027.582644628,
                          7512386.36363636,-340988.100464876,
                          7587954.54545454,-338785.459710744,
                          7663522.72727273,-336419.660382231,
                          7739090.90909091,-333890.702479339,
                          7814659.09090909,-331198.586002066,
                          7890227.27272727,-328343.310950413,
                          7965795.45454545,-325324.877324380,
                          8041363.63636364,-322143.285123967,
                          8116931.81818182,-318798.534349174,
                          8192500.00000000,-315290.625000000,
                          11582500.0000000,-154265.625000000,),
                   PROL_DROITE='LINEAIRE',
                   PROL_GAUCHE='LINEAIRE',);

MP1Y=DEFI_FONCTION(NOM_PARA='X',
                   VALE=(-13640000.0000000,150000.000000000,
                         -10162500.0000000,315290.625000000,
                         -10086931.8181818,318798.534349174,
                         -10011363.6363636,322143.285123967,
                         -9935795.45454545,325324.877324380,
                         -9860227.27272727,328343.310950413,
                         -9784659.09090909,331198.586002066,
                         -9709090.90909091,333890.702479339,
                         -9633522.72727273,336419.660382231,
                         -9557954.54545454,338785.459710744,
                         -9482386.36363636,340988.100464876,
                         -9406818.18181818,343027.582644628,
                         -9331250.00000000,344903.906250000,
                         -9255681.81818182,346617.071280992,
                         -9180113.63636364,348167.077737603,
                         -9104545.45454546,349553.925619835,
                         -9028977.27272727,350777.614927686,
                         -8953409.09090909,351838.145661157,
                         -8877840.90909091,352735.517820248,
                         -8802272.72727273,353469.731404959,
                         -8726704.54545454,354040.786415289,
                         -8651136.36363636,354448.682851240,
                         -8575568.18181818,354693.420712810,
                         -8500000.00000000,354775.000000000,
                          5000000.00000000,354775.000000000,
                          5075568.18181818,354693.420712810,
                          5151136.36363636,354448.682851240,
                          5226704.54545454,354040.786415289,
                          5302272.72727273,353469.731404959,
                          5377840.90909091,352735.517820248,
                          5453409.09090909,351838.145661157,
                          5528977.27272727,350777.614927686,
                          5604545.45454546,349553.925619835,
                          5680113.63636364,348167.077737603,
                          5755681.81818182,346617.071280992,
                          5831250.00000000,344903.906250000,
                          5906818.18181818,343027.582644628,
                          5982386.36363636,340988.100464876,
                          6057954.54545454,338785.459710744,
                          6133522.72727273,336419.660382231,
                          6209090.90909091,333890.702479339,
                          6284659.09090909,331198.586002066,
                          6360227.27272727,328343.310950413,
                          6435795.45454545,325324.877324380,
                          6511363.63636364,322143.285123967,
                          6586931.81818182,318798.534349174,
                          6662500.00000000,315290.625000000,
                          10052500.0000000,154265.625000000,
                          16140000.0000000,-150000.000000000,),
                   PROL_DROITE='LINEAIRE',
                   PROL_GAUCHE='LINEAIRE',);

MP2Y=DEFI_FONCTION(NOM_PARA='X',
                   VALE=(-13640000.0000000,150000.000000000,
                         -7640000.00000000,-150000.000000000,
                         -4162500.00000000,-315290.625000000,
                         -4086931.81818182,-318798.534349174,
                         -4011363.63636364,-322143.285123967,
                         -3935795.45454545,-325324.877324380,
                         -3860227.27272727,-328343.310950413,
                         -3784659.09090909,-331198.586002066,
                         -3709090.90909091,-333890.702479339,
                         -3633522.72727273,-336419.660382231,
                         -3557954.54545455,-338785.459710744,
                         -3482386.36363636,-340988.100464876,
                         -3406818.18181818,-343027.582644628,
                         -3331250.00000000,-344903.906250000,
                         -3255681.81818182,-346617.071280992,
                         -3180113.63636364,-348167.077737603,
                         -3104545.45454545,-349553.925619835,
                         -3028977.27272727,-350777.614927686,
                         -2953409.09090909,-351838.145661157,
                         -2877840.90909091,-352735.517820248,
                         -2802272.72727273,-353469.731404959,
                         -2726704.54545454,-354040.786415289,
                         -2651136.36363636,-354448.682851240,
                         -2575568.18181818,-354693.420712810,
                         -2500000.00000000,-354775.000000000,
                          11000000.0000000,-354775.000000000,
                          11075568.1818182,-354693.420712810,
                          11151136.3636364,-354448.682851240,
                          11226704.5454545,-354040.786415289,
                          11302272.7272727,-353469.731404959,
                          11377840.9090909,-352735.517820248,
                          11453409.0909091,-351838.145661157,
                          11528977.2727273,-350777.614927686,
                          11604545.4545455,-349553.925619835,
                          11680113.6363636,-348167.077737603,
                          11755681.8181818,-346617.071280992,
                          11831250.0000000,-344903.906250000,
                          11906818.1818182,-343027.582644628,
                          11982386.3636364,-340988.100464876,
                          12057954.5454545,-338785.459710744,
                          12133522.7272727,-336419.660382231,
                          12209090.9090909,-333890.702479339,
                          12284659.0909091,-331198.586002066,
                          12360227.2727273,-328343.310950413,
                          12435795.4545455,-325324.877324380,
                          12511363.6363636,-322143.285123967,
                          12586931.8181818,-318798.534349174,
                          12662500.0000000,-315290.625000000,
                          16052500.0000000,-154265.625000000,),
                   PROL_DROITE='LINEAIRE',
                   PROL_GAUCHE='LINEAIRE',);

MAT=DEFI_GLRC(RELATION='GLRC_DAMAGE',
              BETON=_F(MATER=MAT_B,
                       EPAIS=EP,
                       GAMMA=0.0,
                       QP1=0.15,
                       QP2=0.15,

                       C1N1=87.3E6,C1N2=87.3E6,C1N3=87.3E6,
                       C2N1=87.3E6,C2N2=87.3E6,C2N3=87.3E6,
                       C1M1=14.8E6,C1M2=14.8E6,C1M3=14.8E6,
                       C2M1=14.8E6,C2M2=14.8E6,C2M3=14.8E6,),
              NAPPE=(_F(MATER=MAT_A1,
                        OMX=5.65E-4,
                        OMY=5.65E-4,
                        RX=0.95,
                        RY=0.95,),
                     _F(MATER=MAT_A1,
                        OMX=5.65E-4,
                        OMY=5.65E-4,
                        RX=-0.95,
                        RY=-0.95,),),
              LINER=_F(MATER=MAT_A2,
                       OML=6.E-3,
                       RLR=-1.,),
              CABLE_PREC=_F(MATER=MAT_A2,
                            OMX=4.56E-3,
                            OMY=1.35E-2,
                            RX=0.0,
                            RY=0.0,
                            PREX=-3.0E6,
                            PREY=-3.0E6,),
              INFO=2,);

CHMAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                    AFFE=(_F(GROUP_MA='DALLE',MATER=MAT,),),);

CARA_ELE=AFFE_CARA_ELEM(MODELE=MOD,
                        COQUE=_F(GROUP_MA='DALLE',
                                 EPAIS=EP,
                                 ANGL_REP=(0.0,0.0),
                                 COQUE_NCOU = 1,
                                 MODI_METRIQUE = 'NON',
                                 ),);

IMPR_CO(CONCEPT=_F(NOM=MAT),);

COND_L=AFFE_CHAR_MECA(MODELE=MOD,
                      DDL_IMPO=(_F(GROUP_NO='A1',
                                   DX=0.0,
                                   DY=0.0,
                                   DZ=0.0,
                                   DRX=0.0,
                                   DRY=0.0,
                                   DRZ=0.0,),
                                _F(GROUP_NO='A3A1',
                                   DZ=0.0,
                                   DX=0.0,),
                                _F(GROUP_NO='A2A4',
                                   DZ=0.0,
                                   DX=0.0,),),);

chf0=DEFI_FONCTION(NOM_PARA='INST',
                   VALE=(0.0,1.0,
                         0.1 ,1.0,),
                   PROL_DROITE='CONSTANT',
                   PROL_GAUCHE='CONSTANT',);

COND_P=AFFE_CHAR_MECA(MODELE=MOD,
                      FORCE_COQUE=_F(GROUP_MA='DALLE',
                                     PRES=pres,),);

inst1=DEFI_LIST_REEL(DEBUT=0.0,
                     INTERVALLE=_F(JUSQU_A=tmax,
                                   PAS=dt),);

DEFLIST=DEFI_LIST_INST(DEFI_LIST=_F(LIST_INST=inst1,),
                       ECHEC=_F(SUBD_PAS=2,
                                SUBD_NIVEAU=20,),);


RESU1 = CALC_EUROPLEXUS(
   MODELE=MOD,
   LANCEMENT = 'OUI',
   CHAM_MATER=CHMAT,
   COMPORTEMENT =(_F(
                  RELATION='GLRC_DAMAGE',
                  GROUP_MA = 'DALLE',
                 ),
              ),
   CARA_ELEM=CARA_ELE,
   EXCIT=(_F(CHARGE=COND_L,),
                           _F(CHARGE=COND_P,
                              FONC_MULT=chf0,),),
   CALCUL = _F(TYPE_DISCRETISATION  ='UTIL',
               INST_INIT = 0,
               INST_FIN  = tmax,
               NMAX      = 1000,
               PASFIX    = dt,
               ),
   ARCHIVAGE   = _F(PAS_INST=1.90E-05,),
   );


#IMPR_RESU(RESU=_F(RESULTAT=RESU1,GROUP_NO='P04',NOM_CHAM='DEPL'))


TEST_RESU(RESU=(_F(GROUP_NO='P04',
                   INST=2.0E-05,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESU1,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DZ',
                   VALE_CALC=-1.6000001256644E-04,
                   VALE_REFE=-1.74913E-4,
                   PRECISION=0.15, ),
                _F(GROUP_NO='P04',
                   INST=2.0E-05,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESU1,
                   NOM_CHAM='ACCE',
                   NOM_CMP='DZ',
                   VALE_CALC=-8.0000207143139E+05,
                   VALE_REFE=-7.99968E5,
                   PRECISION=1.E-4, ),
                _F(GROUP_NO='P04',
                   INST=1.E-3,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESU1,
                   NOM_CHAM='DEPL',
                   NOM_CMP='DZ',
                   VALE_CALC=-0.449384151174,
                   VALE_REFE=-0.44933,
                   PRECISION=0.03, ),
                _F(GROUP_NO='P04',
                   INST=1.E-3,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESU1,
                   NOM_CHAM='VITE',
                   NOM_CMP='DZ',
                   VALE_CALC=-821.78513042,
                   VALE_REFE=-824.761,
                   PRECISION=0.1, ),
                ),
          )


FIN();
