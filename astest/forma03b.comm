# MODIF  DATE 28/05/2004   AUTEUR LEBOUVIE F.LEBOUVIER 
# RESPONSABLE JMBHH01 J.M.PROIX
# TITRE CORRIGE TP2 FORMATION THERMOPLASTICITE PLAQUE TROUEE EN TRACTIO
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2002  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
#            CONFIGURATION MANAGEMENT OF EDF VERSION

DEBUT(CODE=_F(NOM='FORMA03B',
              NIV_PUB_WEB='INTERNET',VISU_EFICAS='NON',),);
#===========================================

PRE_GIBI();

M=LIRE_MAILLAGE();
# PLAQUE TROUEE : CONTRAINTES PLANES

MO=AFFE_MODELE(MAILLAGE=M,
               VERIF='MAILLE',
               AFFE=_F(TOUT='OUI',
                       PHENOMENE='MECANIQUE',
                       MODELISATION='C_PLAN',),);
# COURBE DE TRACTION

CTRAC=DEFI_FONCTION(NOM_PARA='EPSI',
                    VALE=(0.004,4.0,0.006,5.0,0.009,5.5,0.02,6.0,),
                    PROL_DROITE='CONSTANT',);

MA=DEFI_MATERIAU(ELAS=_F(E=1000.0,
                         NU=0.3,),
                 TRACTION=_F(SIGM=CTRAC,),);

CM=AFFE_MATERIAU(MAILLAGE=M,
                 AFFE=_F(TOUT='OUI',
                         MATER=MA,),);
# CONDITIONS DE SYMETRIE (QUART DE PLAQUE)

CH1=AFFE_CHAR_MECA(MODELE=MO,
                   FACE_IMPO=(_F(GROUP_MA=('LBC','LCD',),
                                 DY=0.0,),
                              _F(GROUP_MA=('LGH','LHI','LIA',),
                                 DX=0.0,),),);
# TRACTION REPARTIE SUR LE HAUT

CH2=AFFE_CHAR_MECA(MODELE=MO,
                   FORCE_CONTOUR=_F(GROUP_MA='LFG',
                                    FY=1.0,),);
#PILOTAGE                            
INSTFIN2 = 4.0;


L_INST2=DEFI_LIST_REEL(DEBUT=0.0,
                       INTERVALLE=(_F(JUSQU_A=INSTFIN2,
                                      NOMBRE=40,),),);

RESUPILO=STAT_NON_LINE(MODELE=MO,
                       CHAM_MATER=CM,
                       EXCIT=(_F(CHARGE=CH1,),
                              _F(CHARGE=CH2,
                                 TYPE_CHARGE='FIXE_PILO',),),
                       COMP_INCR=_F(RELATION='VMIS_ISOT_TRAC',),
                       INCREMENT=_F(LIST_INST=L_INST2,
                                    INST_FIN=INSTFIN2,),
                       NEWTON=_F(REAC_ITER=1,),
                       PILOTAGE=_F(TYPE='DDL_IMPO',
                                   COEF_MULT=1.0,
                                   GROUP_NO='A',
                                   NOM_CMP='DY',),
                       ARCHIVAGE=_F(LIST_INST=L_INST2,),);

RESUPILO=CALC_ELEM(reuse =RESUPILO,
                   RESULTAT=RESUPILO,
                   OPTION='SIEF_ELNO_ELGA',);

RESUPILO=CALC_NO(reuse =RESUPILO,
                 RESULTAT=RESUPILO,
                 OPTION='SIEF_NOEU_ELGA',);

# POUR VISUALISER LE ETA_PILOTAGE = F(INST)

ETA_PILO=RECU_FONCTION(RESULTAT=RESUPILO,
                       NOM_PARA_RESU='ETA_PILOTAGE',
                       TOUT_ORDRE='OUI',);

IMPR_COURBE(FICHIER='RESULTAT',
            FORMAT='EXCEL',
            COURBE=_F(FONCTION=ETA_PILO,),);

TEST_FONCTION(VALEUR=(_F(FONCTION=ETA_PILO,
                         NOM_PARA='INST',
                         VALE_PARA=0.1,
                         VALE_REFE=3.11129783419,
                         REFERENCE='NON_REGRESSION',),
                      _F(FONCTION=ETA_PILO,
                         NOM_PARA='INST',
                         VALE_PARA=0.4,
                         VALE_REFE=5.05005332837,
                         REFERENCE='NON_REGRESSION',),
                      _F(FONCTION=ETA_PILO,
                         NOM_PARA='INST',
                         VALE_PARA=1.0,
                         VALE_REFE=5.38960514393,
                         REFERENCE='NON_REGRESSION',),
                      _F(FONCTION=ETA_PILO,
                         NOM_PARA='INST',
                         VALE_PARA=1.5,
                         VALE_REFE=5.40087494544,
                         REFERENCE='NON_REGRESSION',),
                      _F(FONCTION=ETA_PILO,
                         NOM_PARA='INST',
                         VALE_PARA=2.0,
                         VALE_REFE=5.40469494399,
                         REFERENCE='NON_REGRESSION',),),);
#=======================================================================        
# CHARGE-DECHARGE
INSTFIN1 = 5.4;

INSTFIN3 = 6.0;


F_DEPL=DEFI_FONCTION(NOM_PARA='INST',
                     VALE=(0.0,0.0,INSTFIN1,INSTFIN1,INSTFIN3,0.0,),);
# DISCRETISATION EN TEMPS

L_INST=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=(_F(JUSQU_A=1.0,
                                     NOMBRE=1,),
                                  _F(JUSQU_A=INSTFIN1,
                                     NOMBRE=22,),
                                  _F(JUSQU_A=INSTFIN3,
                                     NOMBRE=6,),),);
#  CALCUL JUSQU'A 5.4 MPA PUIS DECHARGE

RESUNL=STAT_NON_LINE(MODELE=MO,
                     CHAM_MATER=CM,
                     EXCIT=(_F(CHARGE=CH1,),
                            _F(CHARGE=CH2,
                               FONC_MULT=F_DEPL,),),
                     COMP_INCR=_F(RELATION='VMIS_ISOT_TRAC',),
                     INCREMENT=_F(LIST_INST=L_INST,
                                  INST_FIN=INSTFIN1,
                                  SUBD_PAS=4,
                                  SUBD_PAS_MINI=0.0001,),
                     NEWTON=_F(REAC_ITER=1,),
                     ARCHIVAGE=_F(LIST_INST=L_INST,),);

RESUNL=STAT_NON_LINE(reuse =RESUNL,
                     MODELE=MO,
                     CHAM_MATER=CM,
                     EXCIT=(_F(CHARGE=CH1,),
                            _F(CHARGE=CH2,
                               FONC_MULT=F_DEPL,),),
                     COMP_INCR=_F(RELATION='VMIS_ISOT_TRAC',),
                     ETAT_INIT=_F(EVOL_NOLI=RESUNL,),
                     INCREMENT=_F(LIST_INST=L_INST,
                                  INST_FIN=INSTFIN3,),
                     NEWTON=_F(PREDICTION='ELASTIQUE',
                               REAC_ITER=1,),);
# CALCUL DES CHAMPS AUX NOEUDS PAR ELEMENT

RESUNL=CALC_ELEM(reuse =RESUNL,
                 RESULTAT=RESUNL,
                 OPTION='SIEF_ELNO_ELGA',);
# CALCUL DES CHAMPS MOYENNES AUX NOEUDS POUR TEST_RESU

RESUNL=CALC_NO(reuse =RESUNL,
               RESULTAT=RESUNL,
               OPTION='SIEF_NOEU_ELGA',);

TEST_RESU(RESU=_F(RESULTAT=RESUNL,
                  INST=INSTFIN1,
                  NOM_CHAM='SIEF_NOEU_ELGA',
                  NOM_CMP='SIYY',
                  GROUP_NO='G',
                  VALE=5.40262,
                  REFERENCE='NON_REGRESSION',),);

TEST_RESU(RESU=_F(RESULTAT=RESUNL,
                  INST=INSTFIN3,
                  NOM_CHAM='SIEF_NOEU_ELGA',
                  NOM_CMP='SIYY',
                  GROUP_NO='A',
                  VALE=0.0871535,
                  REFERENCE='NON_REGRESSION',),);
#  CALCUL JUSQU'A 5.4 MPA PUIS DECHARGE
# RECHERCHE LINEAIRE ET SUBDIVISION DU PAS DE TEMPS

RESURL=STAT_NON_LINE(MODELE=MO,
                     CHAM_MATER=CM,
                     EXCIT=(_F(CHARGE=CH1,),
                            _F(CHARGE=CH2,
                               FONC_MULT=F_DEPL,),),
                     COMP_INCR=_F(RELATION='VMIS_ISOT_TRAC',),
                     INCREMENT=_F(LIST_INST=L_INST,
                                  INST_FIN=INSTFIN3,
                                  SUBD_PAS=4,
                                  SUBD_PAS_MINI=0.0001,),
                     NEWTON=_F(PREDICTION='ELASTIQUE',
                               REAC_ITER=1,),
                     RECH_LINEAIRE=_F(ITER_LINE_MAXI=3,),
                     ARCHIVAGE=_F(LIST_INST=L_INST,),);
# CALCUL DES CHAMPS AUX NOEUDS PAR ELEMENT

RESURL=CALC_ELEM(reuse =RESURL,
                 RESULTAT=RESURL,
                 OPTION=('SIEF_ELNO_ELGA','VARI_ELNO_ELGA',),);
# CALCUL DES CHAMPS MOYENNES AUX NOEUDS POUR TEST_RESU

RESURL=CALC_NO(reuse =RESURL,
               RESULTAT=RESURL,
               OPTION='SIEF_NOEU_ELGA',);

TEST_RESU(RESU=_F(RESULTAT=RESURL,
                  INST=5.4,
                  NOM_CHAM='SIEF_NOEU_ELGA',
                  NOM_CMP='SIYY',
                  GROUP_NO='G',
                  VALE=5.40262,
                  REFERENCE='NON_REGRESSION',),);

TEST_RESU(RESU=_F(RESULTAT=RESURL,
                  INST=INSTFIN3,
                  NOM_CHAM='SIEF_NOEU_ELGA',
                  NOM_CMP='SIYY',
                  GROUP_NO='A',
                  VALE=0.0871535,
                  REFERENCE='NON_REGRESSION',),);

IMPR_RESU(MODELE=MO,
          RESU=_F(FORMAT='MED',
                  RESULTAT=RESURL,
                  NOM_CHAM=('DEPL','SIEF_ELNO_ELGA','VARI_ELNO_ELGA',),
                  FICHIER='MED',),);

FIN();
