# MODIF  DATE 29/09/2003   AUTEUR CIBHHPD D.NUNEZ 
# TITRE CALCUL DE G POUR UN PB ELASTOPLASTIQUE
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
# (AT YOUR OPTION) ANY LATER VERSION.                                 
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
# ======================================================================
#
# ********************************************************************
# ********************************************************************
#
# SOLUTION DE REFERENCE ISSUE DE WATANABE
#
# PLAQUE ENTAILLEE SOUMISE A DES CHARGES ET DECHARGES
# EN PLASTICITE
#
# ********************************************************************
# ********************************************************************

DEBUT(CODE=_F( NOM = 'SSNP102A',NIV_PUB_WEB='INTERNET'))

PRE_GIBI()

M=LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='OUI'),   )

M=DEFI_GROUP(     reuse=M,        MAILLAGE=M,CREA_GROUP_NO=(
                          _F( 
                                          GROUP_MA = 'AB'),
                          _F( 
                                          GROUP_MA = 'DE')) )

MO=AFFE_MODELE(            MAILLAGE=M,
                                 AFFE=_F(  TOUT = 'OUI',
                                        PHENOMENE = 'MECANIQUE',
                                        MODELISATION = 'D_PLAN') )

SIGMF=DEFI_FONCTION(    NOM_PARA='EPSI',
                              VALE=(0.0023333,  480.2,
                                    0.01,       480.35778, ),
                           PROL_DROITE='LINEAIRE',
                          PROL_GAUCHE='LINEAIRE')

MA=DEFI_MATERIAU(            ELAS=_F(  E = 205800.,
                                        NU = 0.3,
                                        ALPHA = 0.0),
                             TRACTION=_F(  SIGM = SIGMF), 
                              PRAGER=_F(C=0.))

CM=AFFE_MATERIAU(        MAILLAGE=M,
                                 AFFE=_F(  TOUT = 'OUI',
                                        MATER = MA,
                                        TEMP_REF = 0.) )

#
# ****************************************************************
#            CONDITIONS AUX LIMITES EN DEPLACEMENTS :
#          CONTINUITE ET SYMETRIE SUR L'INTERFACE DE : U2=0
#                                                 AB : U1=0
# ****************************************************************
#


CH=AFFE_CHAR_MECA(      MODELE=MO,DDL_IMPO=(
                          _F(  GROUP_NO = 'AB',  DX = 0.),
                          _F(  GROUP_NO = 'DE',        DY = 0.)),
                          PRES_REP=_F(  GROUP_MA = 'FA',  PRES = -196.)
                      )

#
# ****************************************************************
#             DEFINITION DES INSTANTS DE CALCUL
# ****************************************************************
#


L_INST=DEFI_LIST_REEL(          DEBUT=0.0,
                              INTERVALLE=_F(  JUSQU_A = 3.0,
                                            NOMBRE = 30)
#                                            NOMBRE = 60)
                           )

#
# ****************************************************************
#     RESOLUTION DU PROBLEME
# ****************************************************************
#


F=DEFI_FONCTION(      NOM_PARA='INST',
                        PROL_DROITE='LINEAIRE',
                       PROL_GAUCHE='LINEAIRE',
                               VALE=( 0.0,  0.0, 
                                      0.5,  1.0, 
                                      1.0,  0.0, 
                                      1.5,  1.0, 
                                      2.0,  0.0, 
                                      2.5,  1.0, 
                                      3.0,  0.0, )
                     )

UP=STAT_NON_LINE( 
                            MODELE=MO,
                        CHAM_MATER=CM,
                             EXCIT=_F( 
                CHARGE = CH,
                FONC_MULT = F),
                         COMP_INCR=_F( 
                RELATION = 'VMIS_ISOT_TRAC',
                DEFORMATION = 'PETIT'),
                         INCREMENT=_F( 
                LIST_INST = L_INST,
                SUBD_PAS = 2,
                SUBD_PAS_MINI = 0.001,
                COEF_SUBD_PAS_1 = 0.001),
                         ARCHIVAGE=_F( 
                LIST_INST = L_INST),
                            NEWTON=_F( 
                MATRICE = 'TANGENTE',
                REAC_ITER = 1),
                       CONVERGENCE=_F( 
                RESI_REFE_RELA=1.,
                SIGM_REFE     =4.8E-3,
             #   RESI_GLOB_RELA = 1.E-8,
                ITER_GLOB_MAXI = 8)
              )

UP=CALC_ELEM( reuse=UP,
                            OPTION=(
                  'SIEF_ELNO_ELGA',  'VARI_ELNO_ELGA',),
                          RESULTAT=UP,
                            MODELE=MO,
                        CHAM_MATER=CM
              )

UP=CALC_ELEM( reuse=UP,       MODELE=MO,
                      RESULTAT=UP,
                    CHAM_MATER=CM,
                       OPTION=('EPSP_ELNO','EPSI_ELGA_DEPL')
                  )

UP2=STAT_NON_LINE( 
                            MODELE=MO,
                        CHAM_MATER=CM,
                             EXCIT=_F( 
                CHARGE = CH,
                FONC_MULT = F),
                         COMP_INCR=_F( 
                RELATION = 'VMIS_ECMI_TRAC',
                DEFORMATION = 'PETIT'),
                         INCREMENT=_F( 
                LIST_INST = L_INST,
                SUBD_PAS = 2,
                SUBD_PAS_MINI = 0.001,
                COEF_SUBD_PAS_1 = 0.001),
                         ARCHIVAGE=_F( 
                LIST_INST = L_INST),
                            NEWTON=_F( 
                MATRICE = 'TANGENTE',
                REAC_ITER = 1),
                       CONVERGENCE=_F(
                RESI_REFE_RELA=1.,
                SIGM_REFE     =4.8E-3,                        
         #       RESI_GLOB_RELA = 1.E-8,
                ITER_GLOB_MAXI = 8)
              )

UP2=CALC_ELEM( reuse=UP2,
                            OPTION=(
                  'SIEF_ELNO_ELGA',  'VARI_ELNO_ELGA',),
                          RESULTAT=UP2,
                            MODELE=MO,
                        CHAM_MATER=CM
              )

UP2=CALC_ELEM( reuse=UP2,       MODELE=MO,
                      RESULTAT=UP2,
                    CHAM_MATER=CM,
                       OPTION=('EPSP_ELNO','EPSI_ELGA_DEPL')
                  )
#############################################################
# CALCUL DE L ENERGIE TOTALE
#############################################################
ENER_TOT=POST_ELEM(     RESULTAT=UP,
                             MODELE=MO,
                         CHAM_MATER=CM,
                         TOUT_ORDRE='OUI',
                        ENER_TOTALE=_F(  TOUT = 'OUI')
                      )


ENER_TO2=POST_ELEM(     RESULTAT=UP2,
                             MODELE=MO,
                         CHAM_MATER=CM,
                         TOUT_ORDRE='OUI',
                        ENER_TOTALE=_F(  TOUT = 'OUI')
                      )

TEST_TABLE(TABLE=ENER_TO2,
          FILTRE=(
                 _F(  NOM_PARA = 'INST',
                          VALE = 0.1),),
          NOM_PARA='TOTALE',
          CRITERE='RELATIF',
          VALE= 1.11966  )


TEST_TABLE(TABLE=ENER_TO2,
          FILTRE=(
                 _F(  NOM_PARA = 'INST',
                          VALE = 0.9),),
          NOM_PARA='TOTALE',
          CRITERE='RELATIF',
         PRECISION=5.E-03,
          VALE= 1.36048  )


TEST_TABLE(TABLE=ENER_TO2,
          FILTRE=(
                 _F(  NOM_PARA = 'INST',
                          VALE = 2.0),),
          NOM_PARA='TOTALE',
          CRITERE='RELATIF',
         PRECISION=2.5E-2,
          VALE= 2.69534E-01  )

TEST_TABLE(TABLE=ENER_TO2,
          FILTRE=(
                 _F(  NOM_PARA = 'INST',
                          VALE =3.0 ),),
          NOM_PARA='TOTALE',
          CRITERE='RELATIF',
         PRECISION=2.5E-02,
          VALE= 2.99841E-01 )



# ****************************************************************
#     CALCUL DU TAUX DE RESTITUTION D'ENERGIE G SUR 4 COURONNES
# ****************************************************************
#

THET1=CALC_THETA(       MODELE=MO,
                        THETA_2D=_F(  GROUP_NO = 'D',
                                   MODULE = 1.0,
                                   R_INF = 0.55,
                                   R_SUP = 1.0),
                       DIRECTION=(1.,0.,0.,)
                   )

THET2=CALC_THETA(       MODELE=MO,
                        THETA_2D=_F(  GROUP_NO = 'D',
                                   MODULE = 1.0,
                                   R_INF = 1.0,
                                   R_SUP = 1.5),
                       DIRECTION=(1.,0.,0.,)
                   )

THET3=CALC_THETA(       MODELE=MO,
                        THETA_2D=_F(  GROUP_NO = 'D',
                                   MODULE = 1.0,
                                   R_INF = 1.5,
                                   R_SUP = 2.0),
                       DIRECTION=(1.,0.,0.,)
                    )

THET4=CALC_THETA(       MODELE=MO,
                        THETA_2D=_F(  GROUP_NO = 'D',
                                   MODULE = 1.0,
                                   R_INF = 2.0,
                                   R_SUP = 3.0),
                       DIRECTION=(1.,0.,0.,)
                   )

G1=CALC_G_THETA_T(         MODELE=MO,
                           RESULTAT=UP,
                         CHAM_MATER=CM,
                              THETA=THET1,
                             CHARGE=CH,
                          SYME_CHAR='SYME',
                          COMP_INCR=_F(  RELATION = 'VMIS_ISOT_TRAC',
                                      DEFORMATION = 'PETIT'),
                             OPTION='CALC_G'
                     )

G2=CALC_G_THETA_T(         MODELE=MO,
                           RESULTAT=UP,
                         CHAM_MATER=CM,
                              THETA=THET2,
                             CHARGE=CH,
                          SYME_CHAR='SYME',
                          COMP_INCR=_F(  RELATION = 'VMIS_ISOT_TRAC',
                                      DEFORMATION = 'PETIT'),
                             OPTION='CALC_G'
                     )

G3=CALC_G_THETA_T(         MODELE=MO,
                           RESULTAT=UP,
                         CHAM_MATER=CM,
                              THETA=THET3,
                             CHARGE=CH,
                          SYME_CHAR='SYME',
                          COMP_INCR=_F(  RELATION = 'VMIS_ISOT_TRAC',
                                      DEFORMATION = 'PETIT'),
                             OPTION='CALC_G'
                     )

G4=CALC_G_THETA_T(         MODELE=MO,
                           RESULTAT=UP,
                         CHAM_MATER=CM,
                              THETA=THET4,
                             CHARGE=CH,
                          SYME_CHAR='SYME',
                          COMP_INCR=_F(  RELATION = 'VMIS_ISOT_TRAC',
                                      DEFORMATION = 'PETIT'),
                             OPTION='CALC_G'
                     )

#
# ****************************************************************
#     TESTS DE G  POUR LES NUMEROS D'ORDRE 5,10,15,20,25 ET 30
# ****************************************************************
#



TEST_TABLE(       TABLE=G1,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 5),
                       NOM_PARA='G',
                           VALE=2.769,
                      PRECISION=3.5E-2   )

TEST_TABLE(       TABLE=G2,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 5),
                       NOM_PARA='G',
                           VALE=2.769,
                      PRECISION=3.5E-2   )

TEST_TABLE(       TABLE=G3,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 5),
                       NOM_PARA='G',
                           VALE=2.769,
                      PRECISION=3.5E-2   )

TEST_TABLE(       TABLE=G4,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 5),
                       NOM_PARA='G',
                           VALE=2.769,
                      PRECISION=3.5E-2   )

TEST_TABLE(       TABLE=G1,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 10),
                       NOM_PARA='G',
                           VALE=3.183,
                      PRECISION=5.E-2   )

TEST_TABLE(       TABLE=G2,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 10),
                       NOM_PARA='G',
                           VALE=3.183,
                      PRECISION=5.E-2   )

TEST_TABLE(       TABLE=G3,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 10),
                       NOM_PARA='G',
                           VALE=3.183,
                      PRECISION=5.E-2   )

TEST_TABLE(       TABLE=G4,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 10),
                       NOM_PARA='G',
                           VALE=3.183,
                      PRECISION=5.E-2   )

TEST_TABLE(       TABLE=G1,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 15),
                       NOM_PARA='G',
                           VALE=4.276,
                      PRECISION=2.E-2   )

TEST_TABLE(       TABLE=G2,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 15),
                       NOM_PARA='G',
                           VALE=4.276,
                      PRECISION=2.E-2   )

TEST_TABLE(       TABLE=G3,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 15),
                       NOM_PARA='G',
                           VALE=4.276,
                      PRECISION=2.E-2   )

TEST_TABLE(       TABLE=G4,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 15),
                       NOM_PARA='G',
                           VALE=4.276,
                      PRECISION=2.E-2   )

TEST_TABLE(       TABLE=G1,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 20),
                       NOM_PARA='G',
                           VALE=4.651,
                      PRECISION=5.E-2   )

TEST_TABLE(       TABLE=G2,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 20),
                       NOM_PARA='G',
                           VALE=4.651,
                      PRECISION=5.E-2   )

TEST_TABLE(       TABLE=G3,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 20),
                       NOM_PARA='G',
                           VALE=4.651,
                      PRECISION=5.E-2   )

TEST_TABLE(       TABLE=G4,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 20),
                       NOM_PARA='G',
                           VALE=4.651,
                      PRECISION=5.E-2   )

TEST_TABLE(       TABLE=G1,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 25),
                       NOM_PARA='G',
                           VALE=5.691,
                      PRECISION=3.E-2   )

TEST_TABLE(       TABLE=G2,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 25),
                       NOM_PARA='G',
                           VALE=5.691,
                      PRECISION=3.E-2   )

TEST_TABLE(       TABLE=G3,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 25),
                       NOM_PARA='G',
                           VALE=5.691,
                      PRECISION=3.E-2   )

TEST_TABLE(       TABLE=G4,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 25),
                       NOM_PARA='G',
                           VALE=5.691,
                      PRECISION=3.E-2   )

TEST_TABLE(       TABLE=G1,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 30),
                       NOM_PARA='G',
                           VALE=6.052,
                      PRECISION=5.E-2   )

TEST_TABLE(       TABLE=G2,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 30),
                       NOM_PARA='G',
                           VALE=6.052,
                      PRECISION=5.E-2   )

TEST_TABLE(       TABLE=G3,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 30),
                       NOM_PARA='G',
                           VALE=6.052,
                      PRECISION=5.E-2   )

TEST_TABLE(       TABLE=G4,
                         FILTRE=_F(  NOM_PARA = 'NUME_ORDRE',
                                  VALE_I = 30),
                       NOM_PARA='G',
                           VALE=6.052,
                      PRECISION=5.E-2   )

FIN()
#
