# TITRE  MURAKAMI 11.39 FISSURE CIRCULAIRE AU CENTRE D'UNE SPHERE
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#        SOUMISE A UNE TEMPERATURE UNIFORME SUR LES LEVRES
#        A/B = 0.4
#

DEBUT( CODE=_F(NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

MA=LIRE_MAILLAGE(FORMAT='MED', )

MA=DEFI_GROUP( reuse=MA,   MAILLAGE=MA,
                           CREA_GROUP_NO=_F(
                         GROUP_MA = ( 'LPOP11',  'LP11PC1',  'C1',
                                      'LP8P9',   'LP9PC2',   'LPOP8',
                                         ))
                       )

#
# -------------------------------------------------------------------
#                    DEBUT DU THERMIQUE
# -------------------------------------------------------------------
MOTH=AFFE_MODELE(        MAILLAGE=MA,
                                    AFFE=_F( TOUT = 'OUI',
                          PHENOMENE = 'THERMIQUE',
                          MODELISATION = 'AXIS')
                        )

#
MATH=DEFI_MATERIAU(    THER=_F( RHO_CP = 0.,
                                    LAMBDA = 1.)
                          )

#
CMTH=AFFE_MATERIAU(        MAILLAGE=MA,
                                      AFFE=_F(  TOUT = 'OUI',
                                             MATER = MATH)
                          )

#
CHTH=AFFE_CHAR_THER(      MODELE=MOTH,TEMP_IMPO=(
                              _F( GROUP_NO = 'C1',    TEMP = 0.),
                              _F( GROUP_NO = 'LPOP8', TEMP = -100.))
                           )

#
METH=CALC_MATR_ELEM(        MODELE=MOTH,
                                   CHARGE=CHTH,
                               CHAM_MATER=CMTH,
                                   OPTION='RIGI_THER'
                           )

#
VETH=CALC_VECT_ELEM(        CHARGE=CHTH,
                                   OPTION='CHAR_THER'
                           )

#
NUTH=NUME_DDL(          MATR_RIGI=METH )

#
KTH=ASSE_MATRICE(      MATR_ELEM=METH,
                                NUME_DDL=NUTH
                           )

#
FTH=ASSE_VECTEUR(      VECT_ELEM=VETH,
                                NUME_DDL=NUTH
                           )

#
KTH=FACTORISER(      reuse=KTH,   MATR_ASSE=KTH )

#
TEMP=RESOUDRE(         MATR=KTH,
                                 CHAM_NO=FTH
                           )

#
# -------------------------------------------------------------------
#                    FIN DU THERMIQUE
# -------------------------------------------------------------------
#
#
MO=AFFE_MODELE( MAILLAGE=MA,
                             AFFE=_F( TOUT = 'OUI',
                                   PHENOMENE = 'MECANIQUE',
                                   MODELISATION = 'AXIS')
                       )

#
E_T=DEFI_CONSTANTE(VALE=2.E11,);
NU_T=DEFI_CONSTANTE(VALE=0.3,);
ALPHA_T=DEFI_CONSTANTE(VALE=1.2E-5,);

MAT=DEFI_MATERIAU(  ELAS_FO=_F(  E = E_T,
                                 NU = NU_T,
                                 TEMP_DEF_ALPHA=20,
                                 ALPHA = ALPHA_T)
                         )

#
CHMAT=AFFE_MATERIAU(  MAILLAGE=MA,
                                AFFE=_F( TOUT = 'OUI',
                                      MATER = MAT),
                                AFFE_VARC=_F( TOUT='OUI',CHAM_GD=TEMP,VALE_REF=0.,
                                      NOM_VARC='TEMP',),)

#
CH=AFFE_CHAR_MECA(           MODELE=MO,
                              DDL_IMPO=(
                                   _F(  GROUP_NO = 'LP8P9',
                                              DX = 0.),
                                            _F(  GROUP_NO = 'LP9PC2',
                                              DX = 0.),
                                            _F(  GROUP_NO = 'LPOP11',
                                              DY = 0.),
                                            _F(  GROUP_NO = 'LP11PC1',
                                              DY = 0.))
                           )

#
RIGI_ELE=CALC_MATR_ELEM(        MODELE=MO,
                               CHAM_MATER=CHMAT,
                                   CHARGE=CH,
                                   OPTION='RIGI_MECA'
                           )

#
VECT_ELE=CALC_VECT_ELEM(        CHARGE=CH,
                               CHAM_MATER=CHMAT,
                                   OPTION='CHAR_MECA'
                           )

#
NUMEDDL=NUME_DDL(  MATR_RIGI=RIGI_ELE)

#
RIGIDITE=ASSE_MATRICE(  MATR_ELEM=RIGI_ELE,
                            NUME_DDL=NUMEDDL
                        )

#
FORCE=ASSE_VECTEUR(    VECT_ELEM=VECT_ELE,
                              NUME_DDL=NUMEDDL
                         )

#
RIGIDITE=FACTORISER(    reuse=RIGIDITE,  MATR_ASSE=RIGIDITE)

#
DEP=RESOUDRE(   MATR=RIGIDITE,
                            CHAM_NO=FORCE
                       )

RESU=CREA_RESU(  OPERATION='AFFE', TYPE_RESU='EVOL_ELAS',    NOM_CHAM='DEPL',
                      AFFE=_F(  CHAM_GD = DEP,
                                INST=0.,
                                MODELE=MO,
                                CHAM_MATER = CHMAT)     )
FOND=DEFI_FOND_FISS(    MAILLAGE=MA,
                        FOND_FISS=_F( GROUP_NO = ('P0',)),
                        SYME='OUI',
                        LEVRE_SUP=_F(MAILLE=('M570')),
                      )

# CALCUL DE G AVEC CALC_G / OPTION CALC_G
THETA0=CALC_THETA(    MODELE=MO,
                        THETA_2D=_F(  GROUP_NO = ('P0',),
                                   MODULE = 1.,
                                   R_INF = 1.E-6,
                                   R_SUP = 2.5E-5),
                       DIRECTION=(1., 0., 0.,)
                     )

#
G00=CALC_G(
                      RESULTAT=RESU,
                      THETA=_F(THETA=THETA0,SYME='OUI'),
                      EXCIT=_F(CHARGE=CH,),
             )

#
G01=CALC_G(
                 RESULTAT=RESU,
                 THETA=_F(FOND_FISS=FOND,
                          R_INF = 2.5E-5, R_SUP = 5.E-5,
                          DIRECTION=(1., 0., 0.,),),
                 EXCIT=_F(CHARGE=CH,),
             )

#
G02=CALC_G(
                RESULTAT=RESU,
                THETA=_F(FOND_FISS=FOND,
                          R_INF = 5.E-5, R_SUP = 7.5E-5,
                          DIRECTION=(1., 0., 0.,),),
                EXCIT=_F(CHARGE=CH,),
            )

#
G03=CALC_G(
                 RESULTAT=RESU,
                 THETA=_F(FOND_FISS=FOND,
                          R_INF = 7.5E-5, R_SUP = 1.E-4,
                          DIRECTION=(1., 0., 0.,),),
                 EXCIT=_F(CHARGE=CH,),
            )

#
G04=CALC_G(
                 RESULTAT=RESU,
                 THETA=_F(FOND_FISS=FOND,
                          DIRECTION=(1., 0., 0.,),),
                 EXCIT=_F(CHARGE=CH,),
            )

#
# LA VALEUR DE REFERENCE VAUT 102.31 ,LE RAYON LA FISSURE VAUT 1.E-3 :
# LA VALEUR A TESTER POUR L OPTION CALC_G VAUT 102.31*1.E-3=1.0231E-1
#
TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.059999999999999998,
           VALE_CALC=0.097013001472581,
           VALE_REFE=0.10231,
           NOM_PARA='G',
           TABLE=G00,)

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.02,
           VALE_CALC=0.10052099606345,
           VALE_REFE=0.10231,
           NOM_PARA='G',
           TABLE=G01,)

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.02,
           VALE_CALC=0.10055470895996,
           VALE_REFE=0.10231,
           NOM_PARA='G',
           TABLE=G02,)

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.02,
           VALE_CALC=0.10055919556373,
           VALE_REFE=0.10231,
           NOM_PARA='G',
           TABLE=G03,)

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.02,
           VALE_CALC=0.10055700749487,
           VALE_REFE=0.10231,
           NOM_PARA='G',
           TABLE=G04,)

# CALCUL DE K ET G AVEC CALC_G / OPTION CALC_K_G
KG00=CALC_G(
                 RESULTAT=RESU,
                 OPTION='CALC_K_G',
                 THETA=_F(FOND_FISS=FOND,
                          R_INF = 1.E-6, R_SUP = 2.5E-5,
                          DIRECTION=(1., 0., 0.,),),
                 EXCIT=_F(CHARGE=CH,),
             )
KG01=CALC_G(
                 RESULTAT=RESU,
                 OPTION='CALC_K_G',
                 THETA=_F(FOND_FISS=FOND,
                          R_INF = 2.5E-5, R_SUP = 5.E-5,
                          DIRECTION=(1., 0., 0.,),),
                 EXCIT=_F(CHARGE=CH,),
             )
KG02=CALC_G(
                RESULTAT=RESU,
                 OPTION='CALC_K_G',
                THETA=_F(FOND_FISS=FOND,
                          R_INF = 5.E-5, R_SUP = 7.5E-5,
                          DIRECTION=(1., 0., 0.,),),
                EXCIT=_F(CHARGE=CH,),
            )

KG03=CALC_G(
                 RESULTAT=RESU,
                 OPTION='CALC_K_G',
                 THETA=_F(FOND_FISS=FOND,
                          R_INF = 7.5E-5,R_SUP = 1.E-4,
                          DIRECTION=(1., 0., 0.,),),
                 EXCIT=_F(CHARGE=CH,),
                 INFO=2,
            )
IMPR_TABLE(       TABLE=KG03,)

KG04=CALC_G(
                 RESULTAT=RESU,
                 OPTION='CALC_K_G',
                 THETA=_F(FOND_FISS=FOND,
                          DIRECTION=(1., 0., 0.,),),
                 EXCIT=_F(CHARGE=CH,),
                 INFO=2,
            )
IMPR_TABLE(       TABLE=KG04,)

#
# LA VALEUR A TESTER POUR L OPTION CALC_K_G EST DIRECTEMENT LA VALEUR DE REFERENCE
#
TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.02,
           VALE_CALC=100.51802664692,
           VALE_REFE=102.31,
           NOM_PARA='G',
           TABLE=KG01,)

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.080000000000000002,
           VALE_CALC=4.4147384405608E+06,
           VALE_REFE=4.741900E6,
           NOM_PARA='K1',
           TABLE=KG00,)

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.02,
           VALE_CALC=4.7571436279942E+06,
           VALE_REFE=4.741900E6,
           NOM_PARA='K1',
           TABLE=KG01,)

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.02,
           VALE_CALC=4.7913745145458E+06,
           VALE_REFE=4.741900E6,
           NOM_PARA='K1',
           TABLE=KG02,)

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.02,
           VALE_CALC=4.8244445202679E+06,
           VALE_REFE=4.741900E6,
           NOM_PARA='K1',
           TABLE=KG03,)

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=0.02,
           VALE_CALC=4.8082231915442E+06,
           VALE_REFE=4.741900E6,
           NOM_PARA='K1',
           TABLE=KG04,)

FIN()
#
