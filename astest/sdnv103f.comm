# MODIF  DATE 23/04/2012   AUTEUR ABBAS M.ABBAS 
# TITRE IMPACT D UNE BARRE DE TAYLOR ELASTOPLASTIQUE
# sdnv103f.para = tps_job 360 mem_job 500Mo ncpus 1 liste_test R
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#       CAS-TEST SDNV103D (3D), METHODE CONTINUE

DEBUT(CODE=_F(NOM='SDNV103F',NIV_PUB_WEB='INTERNET'),
           IGNORE_ALARM=('CONTACT2_14'), 
           DEBUG=_F(SDVERI='OUI'))

# IGNORE ALARM: CONTACT2_14: MODELE AXI EN METHODE CONTINUE

MA=LIRE_MAILLAGE(FORMAT='MED', )

MA=DEFI_GROUP(reuse=MA,MAILLAGE=MA,
              CREA_GROUP_NO=_F( TOUT_GROUP_MA = 'OUI'),
              )

MODE=AFFE_MODELE(
            MAILLAGE=MA,
            VERIF='MAILLE',
            AFFE=(
           _F( TOUT='OUI',
               PHENOMENE = 'MECANIQUE',
               MODELISATION = ('AXIS','AXIS_SI')),),);

MA=MODI_MAILLAGE( reuse=MA,
             MAILLAGE=MA,
             ORIE_PEAU_2D=_F(  GROUP_MA = ('SZZ', 'RIGID')),
             INFO=2);

ACIER=DEFI_MATERIAU(
                ELAS=_F( E = 117.E3, NU = 0.35,  RHO = 8.930E-9),
                ECRO_LINE=_F(D_SIGM_EPSI = 100., SY = 400.));

CHMAT = AFFE_MATERIAU(
            MAILLAGE=MA,
            AFFE=(
              _F( GROUP_MA = ('VOL','VOL_RIG'), MATER = ACIER),),
                        );

CH=AFFE_CHAR_MECA(
            MODELE=MODE,
            DDL_IMPO=(
             _F( GROUP_MA = 'RIGID',      DX = 0., DY = 0.,),
             _F( GROUP_MA = 'VOL_RIG',    DX = 0., DY = 0.),
             _F( GROUP_MA = 'AXE',        DX = 0.),
             ),
               );

CH2 = DEFI_CONTACT(MODELE         = MODE,
                   FORMULATION    = 'CONTINUE',
                   FROTTEMENT     = 'COULOMB',
                   REAC_GEOM      = 'CONTROLE',
                   NB_ITER_GEOM   = 2,

                   ZONE        =_F(
                              GROUP_MA_MAIT='RIGID',
                              GROUP_MA_ESCL='SZZ',
                              COULOMB = 0.25,
                                 ),
                   )

VIT_0=CREA_CHAMP( OPERATION='AFFE',
                  TYPE_CHAM='NOEU_DEPL_R',
                  PROL_ZERO='NON',
                  MODELE=MODE,
                  AFFE=(
                     _F(TOUT='OUI',
                        NOM_CMP = ('DX', 'DY'),
                        VALE = (  0.0,  -227000.,)),
                     _F(GROUP_NO = 'VOL_RIG',
                        NOM_CMP = ('DX', 'DY'),
                        VALE = (  0.0,  0.0,   )),
                     _F(GROUP_NO = 'RIGID',
                        NOM_CMP = ('DX', 'DY'),
                        VALE = (  0.0,  0.0, )),
                    ));


# SANS DETECTION DE COLLISION

NPAS_IMPA   = 51
IFIN        = +2.0E-5


temps1=DEFI_LIST_REEL(DEBUT=-1.E-5,
                      INTERVALLE=(_F(JUSQU_A=IFIN,
                                     NOMBRE=NPAS_IMPA,),   
                                   ),);



liste1=DEFI_LIST_INST(  DEFI_LIST=_F(LIST_INST = temps1,),
                          ECHEC    =(
                            _F(
                               EVENEMENT        = 'ERREUR',
                               ACTION           = 'DECOUPE',
                               SUBD_METHODE     = 'MANUEL',
                               SUBD_PAS         = 3,
                              ),
                          ),
                        )

RESU1=DYNA_NON_LINE(MODELE=MODE,
                   CHAM_MATER=CHMAT,
                   EXCIT=_F(CHARGE=CH,
                            ),
                   CONTACT = CH2,
                   ETAT_INIT=_F(VITE = VIT_0,
                                ),
                   COMP_INCR=_F(RELATION='VMIS_ISOT_LINE',
                                DEFORMATION='SIMO_MIEHE',
                                TOUT='OUI',),
                   INCREMENT=_F(LIST_INST=liste1,
                                ),
                  SCHEMA_TEMPS=_F(SCHEMA='HHT',
                                     FORMULATION='DEPLACEMENT',
                                     ALPHA = -0.6,
                                ), 
                  NEWTON=_F(   REAC_INCR=1,
                                MATRICE='TANGENTE',
                                REAC_ITER=1,),
                   CONVERGENCE=_F(RESI_GLOB_MAXI=1.E-6,
                                  ITER_GLOB_MAXI=30,
                                  ARRET='OUI',),
                   );

#
### POST-TRAITEMENTS
#

CONTB1_1=POST_RELEVE_T(ACTION = _F(GROUP_NO='B1',
                                 INTITULE = 'MESSAGE',
                                 RESULTAT = RESU1,
                                 TOUT_CMP='OUI',
                                 NOM_CHAM   = 'VALE_CONT',
                                 OPERATION = 'EXTRACTION'))

VITEA2_1=POST_RELEVE_T(ACTION=_F(INTITULE='VITE EN A2',
                                GROUP_NO= 'A2',
                                RESULTAT=RESU1,
                                NOM_CHAM='VITE',
                                NOM_CMP='DY',
                                OPERATION='EXTRACTION',),);

DEPLA1_1=POST_RELEVE_T(ACTION=_F(INTITULE='DEPL EN A1',
                                GROUP_NO= 'A1',
                                RESULTAT=RESU1,
                                NOM_CHAM='DEPL',
                                NOM_CMP='DY',
                                OPERATION='EXTRACTION',),);

DEPLB1_1=POST_RELEVE_T(ACTION=_F(INTITULE='DEPL EN B1',
                                GROUP_NO= 'B1',
                                RESULTAT=RESU1,
                                NOM_CHAM='DEPL',
                                NOM_CMP='DY',
                                OPERATION='EXTRACTION',),);


#####################################################
# TESTS DE DEPLACEMENTS, VITESSES ET ACCELERATIONS
#####################################################

TEST_RESU(RESU=(
     _F(  RESULTAT = RESU1,   INST = IFIN,
          NOM_CHAM = 'DEPL',   GROUP_NO = 'B1',
          CRITERE = 'RELATIF', PRECISION = (3.E-2, 1.E-10),
          NOM_CMP = 'DX',    VALE =1.5825574088439, REFERENCE = 'NON_REGRESSION',
          VERSION='11.0.28' ),
     _F(  RESULTAT = RESU1,   INST = IFIN,
          NOM_CHAM = 'DEPL',   GROUP_NO = 'A2',
          CRITERE = 'RELATIF', PRECISION = (7.E-3, 1.E-10),
          NOM_CMP = 'DY',    VALE = -6.708400431849, REFERENCE = 'NON_REGRESSION',
          VERSION='11.0.22' ),
     _F(  RESULTAT = RESU1,   INST = IFIN,
          NOM_CHAM = 'VITE',   GROUP_NO = 'B1',
          CRITERE = 'RELATIF', PRECISION = (3.E-2, 1.E-10),
          NOM_CMP = 'DX',    VALE = 74025.543471751, REFERENCE = 'NON_REGRESSION',
          VERSION='11.0.22' ),
     _F(  RESULTAT = RESU1,   INST = IFIN,
          NOM_CHAM = 'VITE',   GROUP_NO = 'A2',
          CRITERE = 'RELATIF', PRECISION = (4.E-2, 1.E-10),
          NOM_CMP = 'DY',    VALE = -2.0385434072951E+05, REFERENCE = 'NON_REGRESSION',
          VERSION='11.0.22' ),
        ),);

#####################################################
# TESTS SUR LA VALEUR DU JEU ET DU FROTTEMENT
#####################################################



TEST_TABLE(TABLE     = CONTB1_1,
           FILTRE    =_F(NOM_PARA = 'INST',
                         PRECISION=1.E-10,
                         VALE = IFIN,),
           NOM_PARA  = 'JEU',
           CRITERE   = 'RELATIF',
           PRECISION = 1.E-10,
           VALE      = 0.060970760152392,
           REFERENCE = 'NON_REGRESSION',
           VERSION   = '11.0.21' )

TEST_TABLE(TABLE     = CONTB1_1,
           FILTRE    =_F(NOM_PARA = 'INST',
                         PRECISION=1.E-10,
                         VALE = IFIN,),
           NOM_PARA  = 'R',
           CRITERE   = 'ABSOLU',
           PRECISION = 1.E-15,
           VALE      = 0.0,
           REFERENCE = 'NON_REGRESSION',
           VERSION   = '11.0.21' )

#
### COURBES
#

F_DY_1=RECU_FONCTION( RESULTAT=RESU1,
                      NOM_CHAM='DEPL',
                      GROUP_NO='A1',
                      NOM_CMP='DY',);
IMPR_FONCTION(FORMAT='XMGRACE',
          UNITE=39,
          COURBE=(
       _F(FONCTION=F_DY_1),),);



F_VY_1=RECU_FONCTION( RESULTAT=RESU1,
                      NOM_CHAM='VITE',
                      GROUP_NO='A1',
                      NOM_CMP='DY',);
IMPR_FONCTION(FORMAT='XMGRACE',
          UNITE=40,
          COURBE=(
       _F(FONCTION=F_VY_1),),);


# AVEC DETECTION DE COLLISION

NPAS_IMPA   = 31
IFIN        = +2.0E-5


temps2=DEFI_LIST_REEL(DEBUT=-1.E-5,
                      INTERVALLE=(_F(JUSQU_A=IFIN,
                                     NOMBRE=NPAS_IMPA,),   
                                   ),);



liste2=DEFI_LIST_INST(  DEFI_LIST=_F(LIST_INST = temps2,),
                          ECHEC    =(
                            _F(
                               EVENEMENT        = 'ERREUR',
                               ACTION           = 'DECOUPE',
                               SUBD_METHODE     = 'MANUEL',
                               SUBD_PAS         = 3,
                              ),
                             _F(
                               EVENEMENT        = 'COLLISION',
                               ACTION           = 'DECOUPE',
                               SUBD_METHODE     = 'AUTO',
                               SUBD_INST = 1.7E-8,
                               SUBD_DUREE    = 1.5E-6,
                              ),   
                          ),
                        )

RESU2=DYNA_NON_LINE(MODELE=MODE,
                   CHAM_MATER=CHMAT,
                   EXCIT=_F(CHARGE=CH,
                            ),
                   CONTACT = CH2,
                   ETAT_INIT=_F(VITE = VIT_0,
                                ),
                   COMP_INCR=_F(RELATION='VMIS_ISOT_LINE',
                                DEFORMATION='SIMO_MIEHE',
                                TOUT='OUI',),
                   INCREMENT=_F(LIST_INST=liste2,
                                ),
                  SCHEMA_TEMPS=_F(SCHEMA='HHT',
                                     FORMULATION='DEPLACEMENT',
                                     ALPHA = -0.6,
                                ), 
                  NEWTON=_F(   REAC_INCR=1,
                                MATRICE='TANGENTE',
                                REAC_ITER=1,),
                   CONVERGENCE=_F(RESI_GLOB_MAXI=1.E-6,
                                  ITER_GLOB_MAXI=30,
                                  ARRET='OUI',),
                   );

#
### POST-TRAITEMENTS
#

CONTB1_2=POST_RELEVE_T(ACTION = _F(GROUP_NO='B1',
                                 INTITULE = 'MESSAGE',
                                 RESULTAT = RESU2,
                                 TOUT_CMP='OUI',
                                 NOM_CHAM   = 'VALE_CONT',
                                 OPERATION = 'EXTRACTION'))

VITEA2_2=POST_RELEVE_T(ACTION=_F(INTITULE='VITE EN A2',
                                GROUP_NO= 'A2',
                                RESULTAT=RESU2,
                                NOM_CHAM='VITE',
                                NOM_CMP='DY',
                                OPERATION='EXTRACTION',),);

DEPLA1_2=POST_RELEVE_T(ACTION=_F(INTITULE='DEPL EN A1',
                                GROUP_NO= 'A1',
                                RESULTAT=RESU2,
                                NOM_CHAM='DEPL',
                                NOM_CMP='DY',
                                OPERATION='EXTRACTION',),);

DEPLB1_2=POST_RELEVE_T(ACTION=_F(INTITULE='DEPL EN B1',
                                GROUP_NO= 'B1',
                                RESULTAT=RESU2,
                                NOM_CHAM='DEPL',
                                NOM_CMP='DY',
                                OPERATION='EXTRACTION',),);


#####################################################
# TESTS DE DEPLACEMENTS, VITESSES ET ACCELERATIONS
#####################################################

TEST_RESU(RESU=(
     _F(  RESULTAT = RESU2,   INST = IFIN,
          NOM_CHAM = 'DEPL',   GROUP_NO = 'B1',
          CRITERE = 'RELATIF', PRECISION = (3.E-2, 1.E-10),
          NOM_CMP = 'DX',    VALE =1.767749149604, REFERENCE = 'NON_REGRESSION',
          VERSION='11.0.28' ),
     _F(  RESULTAT = RESU2,   INST = IFIN,
          NOM_CHAM = 'DEPL',   GROUP_NO = 'A2',
          CRITERE = 'RELATIF', PRECISION = (7.E-3, 1.E-10),
          NOM_CMP = 'DY',    VALE = -6.708400431849, REFERENCE = 'NON_REGRESSION',
          VERSION='11.0.22' ),
     _F(  RESULTAT = RESU2,   INST = IFIN,
          NOM_CHAM = 'VITE',   GROUP_NO = 'B1',
          CRITERE = 'RELATIF', PRECISION = (3.E-2, 1.E-10),
          NOM_CMP = 'DX',    VALE = 79430.997053331, REFERENCE = 'NON_REGRESSION',
          VERSION='11.0.22' ),
     _F(  RESULTAT = RESU2,   INST = IFIN,
          NOM_CHAM = 'VITE',   GROUP_NO = 'A2',
          CRITERE = 'RELATIF', PRECISION = (4.E-2, 1.E-10),
          NOM_CMP = 'DY',    VALE = -2.0385434072951E+05, REFERENCE = 'NON_REGRESSION',
          VERSION='11.0.22' ),
        ),);

#####################################################
# TESTS SUR LA VALEUR DU JEU ET DU FROTTEMENT
#####################################################



TEST_TABLE(TABLE     = CONTB1_2,
           FILTRE    =_F(NOM_PARA = 'INST',
                         PRECISION=1.E-10,
                         VALE = IFIN,),
           NOM_PARA  = 'JEU',
           CRITERE   = 'RELATIF',
           PRECISION = 5.E-10,
           VALE      = 0.084079704132284 ,
           REFERENCE = 'NON_REGRESSION',
           VERSION   = '11.0.21' )

TEST_TABLE(TABLE     = CONTB1_2,
           FILTRE    =_F(NOM_PARA = 'INST',
                         PRECISION=1.E-10,
                         VALE = IFIN,),
           NOM_PARA  = 'R',
           CRITERE   = 'ABSOLU',
           PRECISION = 1.E-15,
           VALE      = 0.,
           REFERENCE = 'NON_REGRESSION',
           VERSION   = '11.0.21' )


#
### COURBES
#

F_DY_2=RECU_FONCTION( RESULTAT=RESU2,
                      NOM_CHAM='DEPL',
                      GROUP_NO='A1',
                      NOM_CMP='DY',);
IMPR_FONCTION(FORMAT='XMGRACE',
          UNITE=41,
          COURBE=(
       _F(FONCTION=F_DY_2),),);



F_VY_2=RECU_FONCTION( RESULTAT=RESU2,
                      NOM_CHAM='VITE',
                      GROUP_NO='A1',
                      NOM_CMP='DY',);
IMPR_FONCTION(FORMAT='XMGRACE',
          UNITE=42,
          COURBE=(
       _F(FONCTION=F_VY_2),),);


FIN()

