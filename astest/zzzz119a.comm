# MODIF  DATE 11/09/2002   AUTEUR VABHHTS J.PELLET 
# TITRE TEST DE VALIDATION D'ASTER :
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#      PROJ_CHAMP METHODE:'ELEM' POUR DES SURFACES EN 3D
#      PROJ_CHAMP METHODE:'ELEM' AVEC MOT-CLE VIS_A_VIS
DEBUT(CODE=_F( NOM = 'ZZZZ119A',NIV_PUB_WEB='INTERNET'))

# ======================================================
#
#  TEST ZZZZ119A
#
#  PROJ_CHAMP METHODE:'ELEM' POUR DES SURFACES EN 3D
#
#
#  ON FAIT UN CALCUL (DE COQUES DKQ) SUR UN QUART DE CYLINDRE
#  ON PROJETTE LE CHAMP DE DEPLACEMENT OBTENU (CH1) SUR UN AUTRE
#  MAILLAGE DU MEME QUART DE CYLINDRE (TRIA6)
#    CH1 -> CH2
#  PUIS ON RE-PROJETTE SUR LE 1ER MAILLAGE
#    CH2 -> CH1BIS
#  ON COMPARE ALORS LES CHAMPS CH1 ET CH1BIS SUR 3 NOEUDS
#
#
# ======================================================


PRE_GIBI()

MA=LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='NON'),   )

MA=DEFI_GROUP( reuse=MA,   MAILLAGE=MA,
  CREA_GROUP_MA=_F(  NOM = 'TOUTB', TOUT = 'OUI'))

MA=DEFI_GROUP(reuse=MA, MAILLAGE=MA,
                     CREA_GROUP_NO=_F(  GROUP_MA = 'AB1') )

MO1=AFFE_MODELE(     MAILLAGE=MA,
       AFFE=_F(  GROUP_MA = ('MA1','MB1',),
       MODELISATION = 'DKT', PHENOMENE = 'MECANIQUE'))

MO2=AFFE_MODELE(     MAILLAGE=MA,
       AFFE=_F(  GROUP_MA = ('MA2','MB2',),
       MODELISATION = '3D', PHENOMENE = 'MECANIQUE'))

MATER=DEFI_MATERIAU(  ELAS=_F(  E = 1.E6,      NU = 0.3) )

CHMAT=AFFE_MATERIAU(   MAILLAGE=MA,
                           AFFE=_F(  TOUT = 'OUI',   MATER = MATER) )

CHARGE=AFFE_CHAR_MECA(  MODELE=MO1,DDL_IMPO=(
              _F( GROUP_NO = 'AB1',  DX = 0.,  DY = 0.,  DZ = 0.),
              _F( GROUP_NO = 'AB1',  DRX = 0.,  DRY = 0.,  DRZ = 0.)),FORCE_COQUE=(
               _F( GROUP_MA = 'MA1',      PRES = 2.),
               _F( GROUP_MA = 'MB1',      PRES = -2.))
              )

CARELEM=AFFE_CARA_ELEM(   MODELE=MO1,
              COQUE=_F(  GROUP_MA = 'TOUTB', EPAIS = 0.2,  ANGL_REP = (0., 0.,)))


# remarque : on fait un faux transitoire (2 instants identiques) pour pouvoir tester
#            les mots cle NUME_ODRE et INST de PROJ_CHAMP
LINST=DEFI_LIST_REEL(VALE=(1.,3.),)
CH1=MECA_STATIQUE(MODELE=MO1, CHAM_MATER=CHMAT,  CARA_ELEM=CARELEM, LIST_INST=LINST,
                               EXCIT=_F(  CHARGE = CHARGE)
                            )

# VALIDATION DE PROJ_CHAMP/METHODE:'ELEM' EN 2.5D :
# -------------------------------------------------

CH2=PROJ_CHAMP(RESULTAT=CH1,     METHODE='ELEM', INST=3.,
                MODELE_1=MO1,    MODELE_2=MO2 )

# VALIDATION DE PROJ_CHAMP/'ELEM'/VIS_A_VIS
# -------------------------------------------------

CH1BIS=PROJ_CHAMP(RESULTAT=CH2,     METHODE='ELEM',
                MODELE_1=MO2,    MODELE_2=MO1,VIS_A_VIS=(
  _F(   GROUP_MA_1 = ('MB2',), GROUP_MA_2 = ('MB1',)),
  _F(   GROUP_MA_1 = ('MA2',), GROUP_MA_2 = ('MA1',)))
                )

TEST_RESU(RESU=(

# TEST_RESU/NON_REGRESSION:
#---------------------------
_F(  RESULTAT = CH1,  NUME_ORDRE = 1,   NOM_CHAM = 'DEPL', REFERENCE='NON_REGRESSION',
       NOEUD = 'N48', NOM_CMP = 'DX',  VALE = -9.3536431744501E-02),
_F(  RESULTAT = CH1,  NUME_ORDRE = 1,   NOM_CHAM = 'DEPL', REFERENCE='NON_REGRESSION',
       NOEUD = 'N48', NOM_CMP = 'DY',  VALE = -1.9074193320187E-01),
_F(  RESULTAT = CH1,  NUME_ORDRE = 1,   NOM_CHAM = 'DEPL', REFERENCE='NON_REGRESSION',
       NOEUD = 'N48', NOM_CMP = 'DRZ', VALE = 6.2594161971486E-02),
_F(  RESULTAT = CH1,  NUME_ORDRE = 1,   NOM_CHAM = 'DEPL', REFERENCE='NON_REGRESSION',
       NOEUD = 'N66', NOM_CMP = 'DX',  VALE = -2.1755549801733E-01),
_F(  RESULTAT = CH1,  NUME_ORDRE = 1,   NOM_CHAM = 'DEPL', REFERENCE='NON_REGRESSION',
       NOEUD = 'N123', NOM_CMP = 'DX', VALE = -2.1755549801735E-01),
_F(  RESULTAT = CH1,  NUME_ORDRE = 1,   NOM_CHAM = 'DEPL', REFERENCE='NON_REGRESSION',
       NOEUD = 'N123', NOM_CMP = 'DY', VALE = -3.9614357787072E-01),


# TEST_RESU/VALIDATION:
#---------------------------
_F(  RESULTAT = CH1BIS,  NUME_ORDRE = 2,   NOM_CHAM = 'DEPL', PRECISION = .02,REFERENCE='AUTRE_ASTER',
       NOEUD = 'N48', NOM_CMP = 'DX',  VALE = -9.3536431744501E-02),
_F(  RESULTAT = CH1BIS,  NUME_ORDRE = 2,   NOM_CHAM = 'DEPL', PRECISION = .02,REFERENCE='AUTRE_ASTER',
       NOEUD = 'N48', NOM_CMP = 'DY',  VALE = -1.9074193320187E-01),
_F(  RESULTAT = CH1BIS,  NUME_ORDRE = 2,   NOM_CHAM = 'DEPL', PRECISION = .02,REFERENCE='AUTRE_ASTER',
       NOEUD = 'N48', NOM_CMP = 'DRZ', VALE = 6.2594161971486E-02),
_F(  RESULTAT = CH1BIS,  NUME_ORDRE = 2,   NOM_CHAM = 'DEPL', PRECISION = .02,REFERENCE='AUTRE_ASTER',
       NOEUD = 'N66', NOM_CMP = 'DX',  VALE = -2.1755549801733E-01),
_F(  RESULTAT = CH1BIS,  NUME_ORDRE = 2,   NOM_CHAM = 'DEPL', PRECISION = .02,REFERENCE='AUTRE_ASTER',
       NOEUD = 'N123', NOM_CMP = 'DX', VALE = -2.1755549801735E-01),
_F(  RESULTAT = CH1BIS,  NUME_ORDRE = 2,   NOM_CHAM = 'DEPL', PRECISION = .02,REFERENCE='AUTRE_ASTER',
       NOEUD = 'N123', NOM_CMP = 'DY', VALE = -3.9614357787072E-01),

# TEST_RESU/"GLOBAUX"
#---------------------------
_F(  RESULTAT = CH1,  NUME_ORDRE = 1,   NOM_CHAM = 'DEPL', REFERENCE='NON_REGRESSION',
       TYPE_TEST = 'SOMM_ABS',NOM_CMP=('DX','DY','DZ','DRX','DRY','DRZ',),  VALE = 4.6064076156729E+01),

_F(  RESULTAT = CH2,  NUME_ORDRE = 2,   NOM_CHAM = 'DEPL', REFERENCE='NON_REGRESSION',
       TYPE_TEST = 'SOMM_ABS',NOM_CMP=('DX','DY','DZ','DRX','DRY','DRZ',),  VALE = 1.9542025417155E+02),

# REMARQUE : CH1 ET CH1BIS SONT COMPARABLES GLOBALEMENT CAR ON EXCLUE LES LAGRANGES  (MOT CLE NOM_CMP)
_F(  RESULTAT = CH1BIS,  NUME_ORDRE = 2,   NOM_CHAM = 'DEPL',REFERENCE='AUTRE_ASTER', PRECISION = .008,
       TYPE_TEST = 'SOMM_ABS',NOM_CMP=('DX','DY','DZ','DRX','DRY','DRZ',),  VALE = 4.6064076156729E+01 ))


   )



# pour valider la possibilite de projeter sur un modele filaire :
#------------------------------------------------------------------

MO3=AFFE_MODELE(MAILLAGE=MA,
AFFE= _F( MAILLE = ('M360','M361',), PHENOMENE = 'MECANIQUE', MODELISATION = 'BARRE'),)

CH3=PROJ_CHAMP(RESULTAT=CH1,     METHODE='ELEM',
                 MODELE_1=MO1,   MODELE_2=MO3 ,NUME_ORDRE=2, )

TEST_RESU(RESU=  _F( RESULTAT = CH1, NOM_CHAM = 'DEPL', REFERENCE='NON_REGRESSION',
         NOEUD = 'N69', NUME_ORDRE=2,  NOM_CMP = 'DX', VALE = -4.53120E-1),)

TEST_RESU(RESU=  _F( RESULTAT = CH3, NOM_CHAM = 'DEPL',REFERENCE='AUTRE_ASTER',
         NOEUD = 'N69', NUME_ORDRE=2,  NOM_CMP = 'DX', VALE = -4.53120E-1),)


FIN()



