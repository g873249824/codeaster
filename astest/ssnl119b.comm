# MODIF  DATE 02/04/2013   AUTEUR PROIX J-M.PROIX 
# TITRE POUTRE EULER_BERNOULLI MULTIFIBRES (STATIQUE NON-LINEAIRE)
# ssnl119b.para = tps_job 60 mem_job 256Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# tps_job 480 mem_job 32Mo ncpus 1 liste_test S

DEBUT(CODE=_F( NOM = 'SSNL119B',NIV_PUB_WEB='INTERNET'))

# lecture maillage lineique
MAPOU=LIRE_MAILLAGE(UNITE=17,FORMAT='MED',);
# lecture maillage section1
MASEC=LIRE_MAILLAGE(UNITE=18,FORMAT='MED',);

GF=DEFI_GEOM_FIBRE(
   INFO=2,
   FIBRE = (
      _F(GROUP_FIBRE='SACI', CARA = 'DIAMETRE', COOR_AXE_POUTRE = (0.,0.,),
         VALE =(   0.066, -0.218, 32.0E-03,
                  -0.066, -0.218, 32.0E-03,
                   0.066,  0.218,  8.0E-03,
                  -0.066,  0.218,  8.0E-03,), ),
   ),
   SECTION=_F(GROUP_FIBRE='SBET', COOR_AXE_POUTRE = (0., 0.,),
              MAILLAGE_SECT = MASEC, TOUT_SECT = 'OUI', ),
)


MOPOU=AFFE_MODELE(
   MAILLAGE=MAPOU,
   AFFE=_F(TOUT='OUI', PHENOMENE='MECANIQUE', MODELISATION='POU_D_EM',), )

# Beton
EB = 37272.0E+06
BETON = DEFI_MATER_GC(
   MAZARS=_F(
      UNITE_LONGUEUR = 'M',
      FCJ=40.963E+06, EIJ=EB,
      EPSI_C=1.75754E-03, AT=1.0,NU=0.2,
   ),
   RHO=2400.0, INFO=2,
)

ACIER=DEFI_MATER_GC(
   ACIER=_F(
      E = 2.0E+11,
      D_SIGM_EPSI=3.28E+9, SY=4.E+8,
   ),
   RHO=7800.,
)


MATOR=DEFI_MATERIAU(ELAS=_F(E=2.E11,  NU=0.0, RHO=7800.0,), )

PMFMAZAR=DEFI_COMPOR(
   GEOM_FIBRE=GF,
   MATER_SECT=MATOR,
   MULTIFIBRE=(
      _F(GROUP_FIBRE='SACI', MATER=ACIER, RELATION='VMIS_CINE_GC'),
      _F(GROUP_FIBRE='SBET', MATER=BETON, RELATION='MAZARS_GC'),),
)

MATMAZAR=AFFE_MATERIAU(
   MAILLAGE=MAPOU,
   AFFE=_F(GROUP_MA='POUTRE', MATER=(ACIER,BETON,MATOR),),
   AFFE_COMPOR=_F(GROUP_MA='POUTRE',COMPOR=PMFMAZAR),
)

POUCA=AFFE_CARA_ELEM(
   MODELE=MOPOU, INFO=1,
   POUTRE=_F(GROUP_MA=('POUTRE'), SECTION='RECTANGLE',
             CARA=('HY','HZ'), VALE=(0.2,0.5), PREC_AIRE=5., PREC_INERTIE=10.,),
   ORIENTATION=_F(GROUP_MA=('POUTRE'), CARA='ANGL_VRIL', VALE=-90.0,),
   GEOM_FIBRE=GF,
   MULTIFIBRE=_F(GROUP_MA=('POUTRE'), GROUP_FIBRE=('SBET','SACI')),
)

BLOCAGE=AFFE_CHAR_MECA(
   MODELE=MOPOU,
   DDL_IMPO=(
      _F(GROUP_NO='A', DX=0.0, DY=0.0, DZ=0.0, DRX=0.0, DRY=0.0,),
      _F(GROUP_NO='B', DY=0.0,), ),
)

DEPIMP=AFFE_CHAR_MECA(
   MODELE=MOPOU,
   DDL_IMPO=_F(GROUP_NO='C', DY=-1.E-2,),
)


FOFO=DEFI_FONCTION(
   NOM_PARA='INST',
   VALE=(0.0,0.0,3.5,3.5),
   PROL_DROITE='EXCLU',
   PROL_GAUCHE='EXCLU',
)


LINSTD=DEFI_LIST_REEL(
   DEBUT=0.0,
   INTERVALLE=(
      _F( JUSQU_A= 0.10,  NOMBRE =  2 ),
      _F( JUSQU_A= 1.40,  NOMBRE = 10 ),
      _F( JUSQU_A= 3.00,  NOMBRE = 10 ), ),
)

LINST = DEFI_LIST_INST(
   DEFI_LIST=_F(
      METHODE   = 'MANUEL',
      LIST_INST =  LINSTD, ),
   ECHEC=_F(
      EVENEMENT       = 'ERREUR',
      ACTION          = 'DECOUPE',
      SUBD_METHODE    = 'MANUEL',
      SUBD_PAS        = 4,
      SUBD_PAS_MINI   = 1.0E-10,
      SUBD_NIVEAU     = 5,
   ),
)

U1MAZAR=STAT_NON_LINE(
   MODELE=MOPOU,
   CHAM_MATER=MATMAZAR,
   CARA_ELEM=POUCA,
   EXCIT=(
      _F(CHARGE=BLOCAGE,),
      _F(CHARGE=DEPIMP, FONC_MULT=FOFO,),
   ),
   COMP_INCR=_F(RELATION='MULTIFIBRE'),
   INCREMENT=_F(LIST_INST=LINST, ),
   NEWTON=_F(MATRICE='TANGENTE',REAC_ITER=1),
   CONVERGENCE=_F(RESI_GLOB_RELA=1.E-5, ITER_GLOB_MAXI=10,),
)

U1MAZAR=CALC_CHAMP(FORCE='REAC_NODA', reuse =U1MAZAR, RESULTAT=U1MAZAR, );

# Instants
instant=[  0.100       ,   1.400       ,   2.680       ]
# reactions
React = [  1.75623E+04 ,   1.10527E+05 ,   1.21222E+05 ]
# contraintes acier tendu
Aciet = [  1.99326E+07 ,   4.00499E+08 ,   4.35444E+08 ]
# contraintes acier comprime
Aciec = [ -2.21394E+07 ,  -1.77301E+08 ,  -4.01893E+08 ]
# Deformations acier tendu
Eacit = [  9.93916E-05 ,   2.09912E-03 ,   1.07467E-02 ]
# contraintes beton comprime
Betoc = [ -4.47657E+06 ,  -3.53105E+07 ,  -3.06413E+07 ]
# contraintes beton tendu
Betot = [  2.92412E+06 ,   8.52817E+02 ,   5.02952E+03 ]

U1MAZAR=CALC_CHAMP(reuse=U1MAZAR, RESULTAT=U1MAZAR, DEFORMATION=('EPSI_ELGA'), )

mclf = {}
mclf['RESU'] = []
for ii in range(len(instant)):
   mclf['RESU'].append( _F(INST=instant[ii], GROUP_NO='A',                        RESULTAT=U1MAZAR, NOM_CHAM='REAC_NODA',
                           NOM_CMP='DY',   VALE_CALC=React[ii], TOLE_MACHINE=3.0E-4, CRITERE=('RELATIF', 'ABSOLU'), ), )

   mclf['RESU'].append( _F(INST=instant[ii], MAILLE='M9', POINT=1, SOUS_POINT=41, RESULTAT=U1MAZAR, NOM_CHAM='SIEF_ELGA',
                           NOM_CMP='SIXX', VALE_CALC=Aciet[ii], TOLE_MACHINE=3.0E-4, CRITERE=('RELATIF', 'ABSOLU'), ), )

   mclf['RESU'].append( _F(INST=instant[ii], MAILLE='M9', POINT=1, SOUS_POINT=44, RESULTAT=U1MAZAR, NOM_CHAM='SIEF_ELGA',
                           NOM_CMP='SIXX', VALE_CALC=Aciec[ii], TOLE_MACHINE=3.0E-4, CRITERE=('RELATIF', 'ABSOLU'), ), )

   mclf['RESU'].append( _F(INST=instant[ii], MAILLE='M9', POINT=1, SOUS_POINT=41, RESULTAT=U1MAZAR, NOM_CHAM='EPSI_ELGA',
                           NOM_CMP='EPXX', VALE_CALC=Eacit[ii], TOLE_MACHINE=3.0E-4, CRITERE=('RELATIF', 'ABSOLU'), ), )

   mclf['RESU'].append( _F(INST=instant[ii], MAILLE='M9', POINT=1, SOUS_POINT=1,  RESULTAT=U1MAZAR, NOM_CHAM='SIEF_ELGA',
                           NOM_CMP='SIXX', VALE_CALC=Betoc[ii], TOLE_MACHINE=3.0E-4, CRITERE=('RELATIF', 'ABSOLU'), ), )

   mclf['RESU'].append( _F(INST=instant[ii], MAILLE='M9', POINT=1, SOUS_POINT=40, RESULTAT=U1MAZAR, NOM_CHAM='SIEF_ELGA',
                           NOM_CMP='SIXX', VALE_CALC=Betot[ii], TOLE_MACHINE=3.0E-4, CRITERE=('RELATIF', 'ABSOLU'), ), )

TEST_RESU(**mclf)

FIN()
