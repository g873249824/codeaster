# TITRE  VALIDATION DES LOIS DE SECHAGE SUR UNE EPROUVETTE CYLINDRIQUE EN BETON
# ======================================================================
# COPYRIGHT (C) 1991 - 2015  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# MODELISATION A  : LOI DE MENSI
DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

MAIL=LIRE_MAILLAGE(FORMAT='MED', )

#  DEFINTION DES PROPRIETES HYDRIQUES DU BETON

BETON=DEFI_MATERIAU( SECH_MENSI = _F( A        = 0.73E-13,
                                      B        = 0.05),)

CHMAT=AFFE_MATERIAU( MAILLAGE=MAIL,
                     AFFE=_F( GROUP_MA  ='SURF' ,
                              MATER = BETON, ),
                    ),

MOTH=AFFE_MODELE( MAILLAGE=MAIL,
                  AFFE=_F( GROUP_MA    = ('SURF','FE','FI','DSUP','DINF'),
                           MODELISATION ='AXIS',
                           PHENOMENE    ='THERMIQUE', )
                 ),

#  LA TEMPERATURE EST CONSTANTE ET EGALE A 20 DEG. PDT TT L'ESSAI

TEMP=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
                OPERATION='AFFE',
                MAILLAGE=MAIL,
                AFFE=_F(TOUT='OUI',
                        NOM_CMP='TEMP',
                        VALE=20.0,),);

RESUTHER=CREA_RESU(OPERATION='AFFE',
                   TYPE_RESU='EVOL_THER',
                   NOM_CHAM='TEMP',
                   AFFE=(_F(CHAM_GD=TEMP,
                            INST=0.0,),),);


CEQ = DEFI_CONSTANTE ( VALE = 58.8, )

CHARSE = AFFE_CHAR_THER_F( MODELE=MOTH,
                           TEMP_IMPO= _F( GROUP_MA = 'FE',
                                           TEMP   = CEQ, ),  )

#      LES INSTANTS DE CALCULS CORRESPONDENT AUX PROFILS DE TENEUR EN EAU
#      PROPOSES FIG. 15.1., P.199 DE [GRANGER, 1995]
#      1 HEURE  -->      3600s
#      3 JOURS   -->   259200s
#     28 JOURS  -->   2419200s
#      1 AN 1/4 -->  39420000s
#      3 ANS    -->  94608000s
#      5 ANS    --> 157680000s
LISTSECH = DEFI_LIST_REEL( DEBUT = 0.,
                           INTERVALLE = ( _F( JUSQU_A =      3600,       NOMBRE = 10,  ),
                                          _F( JUSQU_A =    259200,       NOMBRE = 10,  ),
                                          _F( JUSQU_A =   2419200,       NOMBRE = 10,  ),
                                          _F( JUSQU_A =  39420000,       NOMBRE = 10,  ),
                                          _F( JUSQU_A =  94608000,       NOMBRE = 10,  ),
                                          _F( JUSQU_A = 157680000,       NOMBRE = 10,  ),
                                         ),
                          ),
LISTDEP= DEFI_LIST_REEL(VALE=(3600, 259200,2419200,    39420000,  94608000,  157680000,   ), ),

RESUSECH = THER_NON_LINE( MODELE        = MOTH,
                          EXCIT          = _F( CHARGE = CHARSE, ),
                          CHAM_MATER     = CHMAT,
                          SOLVEUR        = _F( METHODE = 'MULT_FRONT',   ),
                          PARM_THETA     = 0.57,
                          ETAT_INIT      = _F( VALE = 128.8,   ),
                          INCREMENT      = _F( LIST_INST = LISTSECH, ),
                          COMPORTEMENT   = _F( RELATION = 'SECH_MENSI',
                                               TOUT     = 'OUI', ),
                          EVOL_THER_SECH = RESUTHER,
                          INFO           = 1,
                         ),

# DEFINITION DE LA SOLUTION DE REFERENCE SCILAB
#A T =1 H
REF1 = [128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,127.435,117.091,
58.800 ]
# A T= 3J
REF2 =[128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.799,
128.799,128.797,128.794,128.787,128.773,128.748,128.704,128.627,128.501,128.297,
127.983,127.509,126.812,125.808,124.377,122.342,119.418,115.085,108.214,95.492 ,
58.800 ]
# A T = 28J
REF3 = [128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,128.800,
128.800 ,128.800 ,128.800 ,128.800 ,128.800 ,128.799 ,128.799 ,128.799 ,128.799 ,128.799 ,
128.798 ,128.798 ,128.797 ,128.796 ,128.795 ,128.793 ,128.792 ,128.789 ,128.787 ,128.783 ,
128.779 ,128.774 ,128.768 ,128.760 ,128.751 ,128.740 ,128.727 ,128.711 ,128.692 ,128.669 ,
128.643 ,128.611 ,128.574 ,128.530 ,128.480 ,128.421 ,128.352 ,128.273 ,128.182 ,128.078 ,
127.959 ,127.822 ,127.667 ,127.491 ,127.291 ,127.066 ,126.812 ,126.525 ,126.203 ,125.842 ,
125.437 ,124.982 ,124.473 ,123.902 ,123.261 ,122.543 ,121.735 ,120.825 ,119.796 ,118.628 ,
117.297 ,115.769 ,114.000 ,111.929 ,109.468 ,106.486 ,102.771 ,97.945  ,91.246  ,80.737  ,
58.800  ]
# A T = 1.25 AN
REF4 =[117.499,117.493,117.483,117.468,117.446,117.419,117.387,117.348,117.303,117.252,
117.194 ,117.131 ,117.062 ,116.986 ,116.903 ,116.815 ,116.719 ,116.617 ,116.509 ,116.393 ,
116.271 ,116.141 ,116.004 ,115.859 ,115.708 ,115.548 ,115.380 ,115.205 ,115.020 ,114.828 ,
114.626 ,114.416 ,114.196 ,113.967 ,113.728 ,113.478 ,113.218 ,112.947 ,112.665 ,112.370 ,
112.064 ,111.744 ,111.412 ,111.065 ,110.704 ,110.327 ,109.934 ,109.525 ,109.098 ,108.652 ,
108.186 ,107.699 ,107.190 ,106.658 ,106.100 ,105.515 ,104.902 ,104.257 ,103.579 ,102.865 ,
102.112 ,101.316 ,100.473 ,99.579  ,98.629  ,97.615  ,96.532  ,95.369  ,94.117  ,92.763  ,
91.291  ,89.682  ,87.911  ,85.945  ,83.742  ,81.241  ,78.358  ,74.967  ,70.867  ,65.707  ,
58.800  ]
# A T = 3 ANS
REF5 =[105.067,105.061,105.052,105.036,105.015,104.988,104.956,104.917,104.873,104.822,
104.766,104.703,104.634,104.559,104.477,104.390,104.295,104.195,104.087,103.973,
103.852,103.724,103.589,103.447,103.297,103.140,102.975,102.802,102.622,102.433,
102.235,102.029,101.814,101.590,101.356,101.113,100.859,100.595,100.321,100.035,
99.738,99.428,99.107,98.772,98.423,98.061,97.684,97.291,96.882,96.457,
96.013,95.551,95.068,94.565,94.039,93.490,92.915,92.314,91.684,91.023,
90.328,89.599,88.830,88.020,87.163,86.257,85.295,84.273,83.182,82.017,
80.766,79.418,77.961,76.376,74.643,72.735,70.616,68.242,65.547,62.444,
58.800]
#A T = 5 ANS
REF6 =[96.772 ,96.766 ,96.757 ,96.742 ,96.722 ,96.696 ,96.665 ,96.628 ,96.585 ,96.536 ,
96.482 ,96.421 ,96.355 ,96.283 ,96.204 ,96.120 ,96.029 ,95.932 ,95.829 ,95.720 ,
95.604 ,95.481 ,95.351 ,95.215 ,95.071 ,94.921 ,94.763 ,94.598 ,94.425 ,94.244 ,
94.056 ,93.859 ,93.654 ,93.441 ,93.218 ,92.987 ,92.746 ,92.495 ,92.235 ,91.964 ,
91.683 ,91.391 ,91.087 ,90.771 ,90.444 ,90.103 ,89.749 ,89.382 ,89.000 ,88.603 ,
88.190 ,87.760 ,87.313 ,86.848 ,86.364 ,85.859 ,85.333 ,84.784 ,84.211 ,83.612 ,
82.986 ,82.331 ,81.645 ,80.925 ,80.169 ,79.375 ,78.538 ,77.655 ,76.722 ,75.735 ,
74.688 ,73.575 ,72.389 ,71.120 ,69.760 ,68.296 ,66.714 ,64.998 ,63.125 ,61.070 ,
58.800 ]

# TEST EN X=0.0
TEST_RESU(RESU=(_F(GROUP_NO='P0',
                   INST=3600,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=128.800000000,
                   VALE_REFE=128.80000000000001,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P0',
                   INST=259200,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=128.800000000,
                   VALE_REFE=128.80000000000001,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P0',
                   INST=2419200,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=128.799952682,
                   VALE_REFE=128.80000000000001,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P0',
                   INST=39420000,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=117.764934978,
                   VALE_REFE=117.49299999999999,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P0',
                   INST=94608000,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=105.383889066,
                   VALE_REFE=105.06100000000001,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P0',
                   INST=157680000,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=97.087355284,
                   VALE_REFE=96.766000000000005,
                   PRECISION=1.E-2,),
                ),
          )

# TEST EN X=0.04
TEST_RESU(RESU=(_F(GROUP_NO='P4',
                   INST=3600,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=128.800000000,
                   VALE_REFE=128.80000000000001,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P4',
                   INST=259200,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=128.800000000,
                   VALE_REFE=128.80000000000001,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P4',
                   INST=2419200,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=128.659714603,
                   VALE_REFE=128.61099999999999,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P4',
                   INST=39420000,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=112.351001936,
                   VALE_REFE=111.744,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P4',
                   INST=94608000,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=100.058134394,
                   VALE_REFE=99.427999999999997,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P4',
                   INST=157680000,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=91.994648630,
                   VALE_REFE=91.391000000000005,
                   PRECISION=1.E-2,),
                ),
          )

# TEST EN X=0.06
TEST_RESU(RESU=(_F(GROUP_NO='P6',
                   INST=3600,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=128.800000000,
                   VALE_REFE=128.80000000000001,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P6',
                   INST=259200,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=128.799594310,
                   VALE_REFE=128.797,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P6',
                   INST=2419200,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=125.671593193,
                   VALE_REFE=124.982,
                   PRECISION=1.E-2,),
                _F(GROUP_NO='P6',
                   INST=39420000,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=102.419515023,
                   VALE_REFE=101.316,
                   PRECISION=0.012,),
                _F(GROUP_NO='P6',
                   INST=94608000,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=90.636529559,
                   VALE_REFE=89.599000000000004,
                   PRECISION=0.012,),
                _F(GROUP_NO='P6',
                   INST=157680000,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESUSECH,
                   NOM_CHAM='TEMP',
                   NOM_CMP='TEMP',
                   VALE_CALC=83.269578563,
                   VALE_REFE=82.331000000000003,
                   PRECISION=0.012,),
                ),
          )

FIN () ;
