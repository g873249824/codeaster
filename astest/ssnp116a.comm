# TITRE COUPLAGE FLUAGE/BETON_DOUBLE_DP - TRACTION UNIAXIALE EN 3D
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#-----------------------------------------------------------------------
#   TEST DU MODELE DE COUPLAGE D'UNE LOI DE FLUAGE DE GRANGER
#   (GRANGER_FP) ET DES LOIS DE PLASTICITE/FISSURATION :
#   BETON_DOUBLE_DP (DOUBLE CRITERE DE DRUCKER PRAGER),
#   VMIS_ISOT_LINE
#   EN DEPLACEMENT IMPOSE, EN MODELISATION 3D, EN TRACTION UNIAXIALE (XX).
#
#   POUR SIMPLIFIER LA SOLUTION ANALYTIQUE DE REFERENCE :
#   - LES PARAMETRES DE LA LOI DE PLASTICITE/FISSURATION SONT CHOISIS
#   AFIN D'OBTENIR UN COMPORTMENT ELASTO PLASTIQUE QUASI PARFAIT
#   (ECROUISSAGE QUASI NUL) .
#   LES VARIATIONS DE TEMPERATURE ET DE SECHAGE ET LES COEFFICIENTS
#  DE RETRAIT DE DESSICCATION ET RETRAIT THERMIQUE SONT CHOISIS DE TELLE
#   SORTE QUE LES 2 EFFETS S'ANNULENT
#-----------------------------------------------------------------------
#   LE MAILLAGE COMPREND :
#                1 ELEMENT  3D CUBE    A 8 NOEUDS
#                2 ELEMENTS 3D PRISMES A 6 NOEUDS
#                1 ELEMENT  3D CUBE    A 20 NOEUDS
#                2 ELEMENTS 3D PRISMES A 15 NOEUDS
#   LES ELEMENTS LINEAIRES ET QUADRATIQUES SONT LIEES PAR DES RELATIONS
#   LINEAIRES.
#-----------------------------------------------------------------------

DEBUT(CODE=_F(NOM='SSNP116A',NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

MAIL=LIRE_MAILLAGE(FORMAT='MED', )

MAIL=DEFI_GROUP( reuse=MAIL,
                 MAILLAGE=MAIL,
                 CREA_GROUP_NO=(
                       _F( GROUP_MA = 'SA'),
                       _F( GROUP_MA = 'SF'),
                       _F( GROUP_MA = 'FAY'),
                       _F( GROUP_MA = 'FDY'),
                       _F( GROUP_MA = 'FAZ'),
                       _F( GROUP_MA = 'FDZ'))
                   )

MO=AFFE_MODELE(    MAILLAGE=MAIL,
                   AFFE=_F( TOUT = 'OUI',
                            PHENOMENE = 'MECANIQUE',
                            MODELISATION = '3D')
                    )
# POUR GRANGER ON SUPPOSE QUE H=1=CSTE

DESORP=DEFI_FONCTION( NOM_PARA='SECH',
                      VALE=(0.,  1.,  1.,  1.,)
                       )

E = DEFI_CONSTANTE(VALE = 31000)

NU = DEFI_CONSTANTE(VALE = 0.2)

ALPHA = DEFI_CONSTANTE(VALE = 1.E-5)

FC = DEFI_CONSTANTE(VALE = 40.)

FT = DEFI_CONSTANTE(VALE = 4.)

BETA = DEFI_CONSTANTE(VALE = 1.16)

GC = DEFI_CONSTANTE(VALE = 10.)

# VALEUR NON PHYSIQUE DE GT POUR MODELISER UN ECROUISSAGE QUASI NUL
# VALEUR USUELLE : GT = 0.1
GT = DEFI_CONSTANTE(VALE = 10000.)

ECRO = DEFI_CONSTANTE(VALE = 0.01)

BETON=DEFI_MATERIAU(            ELAS_FO=_F( E = E,
                                            NU = NU,
                                            K_DESSIC = 2.E-4,
                                            ALPHA = ALPHA,
                                            TEMP_DEF_ALPHA=0.0,
                                            FONC_DESORP = DESORP,),
                                GRANGER_FP=_F( J1 = 0.2,
                                            TAUX_1 = 4320000.,
                                            QSR_K = 0.0),
                           BETON_DOUBLE_DP=_F( F_C = FC,
                                            F_T = FT,
                                            COEF_BIAX = BETA,
                                            ENER_COMP_RUPT = GC,
                                            ENER_TRAC_RUPT = GT,
                                            COEF_ELAS_COMP = 33.3333333,
                                            ECRO_COMP_P_PIC = 'LINEAIRE',
                                            ECRO_TRAC_P_PIC = 'LINEAIRE'),
                              ECRO_LINE_FO=_F( D_SIGM_EPSI = ECRO,
                                            SY = FT,),
                                             )


SECH1=CREA_CHAMP(   OPERATION='AFFE',
                       TYPE_CHAM='NOEU_TEMP_R',
                        MAILLAGE=MAIL,
                            AFFE=_F(  TOUT = 'OUI',
                                   NOM_CMP = 'TEMP',
                                   VALE = 1.)     )

SECH2=CREA_CHAMP(   OPERATION='AFFE',
                       TYPE_CHAM='NOEU_TEMP_R',
                        MAILLAGE=MAIL,
                            AFFE=_F(  TOUT = 'OUI',
                                   NOM_CMP = 'TEMP',
                                   VALE = 0.)     )

TEMP1=CREA_CHAMP(   OPERATION='AFFE',
                       TYPE_CHAM='NOEU_TEMP_R',
                        MAILLAGE=MAIL,
                            AFFE=_F(  TOUT = 'OUI',
                                   NOM_CMP = 'TEMP',
                                   VALE = 0.)     )

TEMP2=CREA_CHAMP(   OPERATION='AFFE',
                       TYPE_CHAM='NOEU_TEMP_R',
                        MAILLAGE=MAIL,
                            AFFE=_F(  TOUT = 'OUI',
                                   NOM_CMP = 'TEMP',
                                   VALE = 20.)     )

TEMP=CREA_RESU(  OPERATION='AFFE',
                 TYPE_RESU='EVOL_THER',
                 NOM_CHAM='TEMP',
                 AFFE=( _F(  INST = 0.,         CHAM_GD = TEMP1),
                        _F(  INST = 100.,       CHAM_GD = TEMP1))
                    )

SECH=CREA_RESU(  OPERATION='AFFE',
                 TYPE_RESU='EVOL_THER',
                 NOM_CHAM='TEMP',
                 AFFE=(_F(  INST = 0.,         CHAM_GD = SECH1),
                       _F(  INST = 100.,       CHAM_GD = SECH1))
                    )

CM=AFFE_MATERIAU(    MAILLAGE=MAIL,
                            AFFE=_F( TOUT = 'OUI',
                                  MATER = BETON),
                            AFFE_VARC=(_F(TOUT='OUI',
                                         EVOL=SECH,
                                         NOM_VARC='SECH',
                                         NOM_CHAM='TEMP',
                                         VALE_REF=1),
                                      _F(TOUT='OUI',
                                         EVOL=TEMP,
                                         NOM_VARC='TEMP',
                                         NOM_CHAM='TEMP',
                                         VALE_REF=0),)
                    )

COND_LIM=AFFE_CHAR_MECA( MODELE=MO,
                         DDL_IMPO=(_F(  GROUP_NO = 'SA',   DX = 0.),
                                   _F(  GROUP_NO = ('A1', 'A4',),  DY = 0.),
                                   _F(  GROUP_NO = ('A1', 'A2',),  DZ = 0.),
                                   _F(  GROUP_NO = ('C1', 'C4',),  DY = 0.),
                                   _F(  GROUP_NO = ('C1', 'C2',),  DZ = 0.),
                                   _F(  GROUP_NO = ('F1', 'F4',),  DY = 0.),
                                   _F(  GROUP_NO = ('F1', 'F2',),  DZ = 0.)),
                         LIAISON_DDL=( _F(  GROUP_NO = ( 'C1',  'D1', ),
                                            DDL = ( 'DX', 'DX', ),
                                            COEF_MULT = (  1., -1., ),
                                            COEF_IMPO = 0.),
                                       _F(  GROUP_NO = ( 'C2',  'D2', ),
                                            DDL = ( 'DX', 'DX', ),
                                            COEF_MULT = (  1., -1., ),
                                            COEF_IMPO = 0.),
                                       _F(  GROUP_NO = ( 'C3',  'D3', ),
                                            DDL = ( 'DX', 'DX', ),
                                            COEF_MULT = (  1., -1., ),
                                            COEF_IMPO = 0.),
                                       _F(  GROUP_NO = ( 'C4',  'D4', ),
                                            DDL = ( 'DX', 'DX', ),
                                            COEF_MULT = (  1., -1., ),
                                            COEF_IMPO = 0.)),
                         LIAISON_UNIF=_F(  GROUP_MA = 'SD', DDL = 'DX')
                   )

TRAC=AFFE_CHAR_MECA( MODELE=MO,
                     DDL_IMPO=_F(  GROUP_NO = 'SF',  DX = 0.00765685425)
                            )

LINST=DEFI_LIST_REEL(  DEBUT=0.,
                       INTERVALLE=(
                           _F(  JUSQU_A = 10.,        NOMBRE = 4),
                           _F(  JUSQU_A = 13.0242,    NOMBRE = 3),
                           _F(  JUSQU_A = 100.,       NOMBRE = 1))
                         )

COEF_TR=DEFI_FONCTION( NOM_PARA='INST',
                       VALE=(        0.,     0.,
                                   100.,     1., )
                        )

#########################################################
###    COUPLAGE GRANGER_FP BETON_DOUBLE_DP            ###
#     THERMIQUE ET SECHAGE CST - SOLUTION ANALYTIQUE  ###
#########################################################

COUPLA=STAT_NON_LINE(
                  TITRE='COUPLAGE FLUAGE/FISSURATION',
                  MODELE=MO,
                  EXCIT=(
                                 _F(  CHARGE = COND_LIM),
                                 _F(  CHARGE = TRAC,
                                      FONC_MULT = COEF_TR)),
                  INCREMENT=_F(  LIST_INST = LINST),
                  CHAM_MATER=CM,
                  COMP_INCR=_F(  RELATION = 'KIT_DDI',
                                 RELATION_KIT = ('GRANGER_FP',
                                             'BETON_DOUBLE_DP',),
                                 ITER_INTE_MAXI = 20,
                                 ITER_INTE_PAS = 0,
                                 RESI_INTE_RELA = 1.E-6,
                                 DEFORMATION = 'PETIT',
                                 TOUT = 'OUI'),
                  NEWTON=_F(     MATRICE = 'TANGENTE',
                                 REAC_INCR = 1,
                                 REAC_ITER = 5),
                  SOLVEUR=_F(),
                  CONVERGENCE=_F(ITER_GLOB_MAXI = 30,
                                 RESI_GLOB_RELA = 1.E-6)
                            )

COUPLA=CALC_CHAMP(reuse=COUPLA,CONTRAINTE=('SIGM_ELNO'),DEFORMATION=('EPFP_ELNO','EPSP_ELNO'),RESULTAT=COUPLA)


RELEVE_1=POST_RELEVE_T(ACTION=(
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'SIEF',
                            NOM_CHAM = 'SIGM_ELNO',
                            NOM_CMP = 'SIXX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'C1',
                            OPERATION = 'EXTRACTION'),
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'EPSP',
                            NOM_CHAM = 'EPSP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'C1',
                            OPERATION = 'EXTRACTION'),
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'EPSF',
                            NOM_CHAM = 'EPFP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'C1',
                            OPERATION = 'EXTRACTION'),)
                            )


TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=1.E-4,
           VALE_CALC=3.077862258,
           VALE_REFE=3.0778599999999998,
           NOM_PARA='SIXX',
           TABLE=RELEVE_1,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='SIEF',),
                   _F(NOM_PARA='INST',
                      VALE=10.0,),
                   ),
           )

TEST_TABLE(REFERENCE='ANALYTIQUE',
           TOLE_MACHINE=1.E-4,
           PRECISION=3.E-4,
           VALE_CALC= 7.14120724E-07,
           VALE_REFE=7.1417100000000002E-07,
           NOM_PARA='EPXX',
           TABLE=RELEVE_1,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSF',),
                   _F(NOM_PARA='INST',
                      VALE=10.0,),
                   ),
           )

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=1.E-4,
           VALE_CALC=3.999999389,
           VALE_REFE=4.0,
           NOM_PARA='SIXX',
           TABLE=RELEVE_1,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='SIEF',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

TEST_TABLE(REFERENCE='ANALYTIQUE',
           TOLE_MACHINE=1.E-5,
           PRECISION=1.E-4,
           VALE_CALC= 1.73160842E-05,
           VALE_REFE=1.7316199999999999E-05,
           NOM_PARA='EPXX',
           TABLE=RELEVE_1,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSF',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=5.0000000000000001E-4,
           VALE_CALC= 8.53653773E-04,
           VALE_REFE=8.5365199999999999E-4,
           NOM_PARA='EPXX',
           TABLE=RELEVE_1,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSP',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

RELEVE_2=POST_RELEVE_T(ACTION=(
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'SIEF',
                            NOM_CHAM = 'SIGM_ELNO',
                            NOM_CMP = 'SIXX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'),
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'EPSP',
                            NOM_CHAM = 'EPSP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'),
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'EPSF',
                            NOM_CHAM = 'EPFP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'),)
                       )

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=1.E-4,
           VALE_CALC=3.077862258,
           VALE_REFE=3.0778599999999998,
           NOM_PARA='SIXX',
           TABLE=RELEVE_2,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='SIEF',),
                   _F(NOM_PARA='INST',
                      VALE=10.0,),
                   ),
           )

TEST_TABLE(REFERENCE='ANALYTIQUE',
           TOLE_MACHINE=1.E-4,
           PRECISION=3.E-4,
           VALE_CALC= 7.14120724E-07,
           VALE_REFE=7.1417100000000002E-07,
           NOM_PARA='EPXX',
           TABLE=RELEVE_2,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSF',),
                   _F(NOM_PARA='INST',
                      VALE=10.0,),
                   ),
           )

TEST_TABLE(REFERENCE='ANALYTIQUE',
           PRECISION=1.E-4,
           VALE_CALC=3.999997767,
           VALE_REFE=4.0,
           NOM_PARA='SIXX',
           TABLE=RELEVE_2,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='SIEF',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

TEST_TABLE(REFERENCE='ANALYTIQUE',
           TOLE_MACHINE=1.E-5,
           PRECISION=1.E-4,
           VALE_CALC= 1.73160783E-05,
           VALE_REFE=1.7316199999999999E-05,
           NOM_PARA='EPXX',
           TABLE=RELEVE_2,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSF',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

TEST_TABLE(REFERENCE='ANALYTIQUE',
           TOLE_MACHINE=1.E-5,
           PRECISION=5.0000000000000001E-4,
           VALE_CALC= 8.53606702E-04,
           VALE_REFE=8.5365199999999999E-4,
           NOM_PARA='EPXX',
           TABLE=RELEVE_2,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSP',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

#####################################################################
#   TEST DE TOUS LES COUPLAGES AVEC THERMIQUE ET SECHAGE VARIABLES
#####################################################################

TEMPV=CREA_RESU(  OPERATION='AFFE',
                 TYPE_RESU='EVOL_THER',
                 NOM_CHAM='TEMP',
                 AFFE=( _F(  INST = 0.,         CHAM_GD = TEMP1),
                        _F(  INST = 100.,       CHAM_GD = TEMP2))
                    )

SECHV=CREA_RESU(  OPERATION='AFFE',
                 TYPE_RESU='EVOL_THER',
                 NOM_CHAM='TEMP',
                 AFFE=(_F(  INST = 0.,         CHAM_GD = SECH1),
                       _F(  INST = 100.,       CHAM_GD = SECH2))
                    )
CMV=AFFE_MATERIAU(    MAILLAGE=MAIL,
                            AFFE=_F( TOUT = 'OUI',
                                  MATER = BETON),
                            AFFE_VARC=(_F(TOUT='OUI',
                                         EVOL=SECHV,
                                         NOM_VARC="SECH",
                                         NOM_CHAM='TEMP',
                                         VALE_REF=1),
                                      _F(TOUT='OUI',
                                         EVOL=TEMPV,
                                         NOM_VARC='TEMP',
                                         NOM_CHAM='TEMP',
                                         VALE_REF=0),)
                    );


COND_LI2=AFFE_CHAR_MECA( MODELE=MO,
                         DDL_IMPO=( _F(  GROUP_NO = 'SA',   DX = 0.),
                                    _F(  GROUP_NO = ('A1', 'A4',),  DY = 0.),
                                    _F(  GROUP_NO = ('A1', 'A2',),  DZ = 0.),
                                    _F(  GROUP_NO = ('C1', 'C4',),  DY = 0.),
                                    _F(  GROUP_NO = ('C1', 'C2',),  DZ = 0.),
                                    _F(  GROUP_NO = ('F1', 'F4',),  DY = 0.),
                                    _F(  GROUP_NO = ('F1', 'F2',),  DZ = 0.)),
                         LIAISON_DDL=( _F( GROUP_NO = ( 'C1',  'D1', ),
                                           DDL = ( 'DX', 'DX', ),
                                           COEF_MULT = (  1., -1., ),
                                           COEF_IMPO = 0.),
                                       _F( GROUP_NO = ( 'C2',  'D2', ),
                                           DDL = ( 'DX', 'DX', ),
                                           COEF_MULT = (  1., -1., ),
                                           COEF_IMPO = 0.),
                                       _F( GROUP_NO = ( 'C3',  'D3', ),
                                           DDL = ( 'DX', 'DX', ),
                                           COEF_MULT = (  1., -1., ),
                                           COEF_IMPO = 0.),
                                       _F( GROUP_NO = ( 'C4',  'D4', ),
                                          DDL = ( 'DX', 'DX', ),
                                          COEF_MULT = (  1., -1., ),
                                          COEF_IMPO = 0.)),
                         LIAISON_UNIF=_F(  GROUP_MA = 'SD', DDL = 'DX')
                   )

#########################################################
###    COUPLAGE GRANGER_FP BETON_DOUBLE_DP            ###
#     THERMIQUE ET SECHAGE VARIABLE  ###
#########################################################

COUPLA2=STAT_NON_LINE(
                  TITRE='COUPLAGE FLUAGE/FISSURATION',
                  MODELE=MO,
                  EXCIT=(
                                 _F(  CHARGE = COND_LI2),
                                 _F(  CHARGE = TRAC,
                                      FONC_MULT = COEF_TR)),
                  INCREMENT=_F(  LIST_INST = LINST),
                  CHAM_MATER=CMV,
                  COMP_INCR=_F(  RELATION = 'KIT_DDI',
                                 RELATION_KIT = ('GRANGER_FP',
                                             'BETON_DOUBLE_DP',),
                                 DEFORMATION = 'PETIT',
                                 ITER_INTE_MAXI = 20,
                                 ITER_INTE_PAS = 0,
                                 RESI_INTE_RELA = 1.E-6,
                                 TOUT = 'OUI'),
                  NEWTON=_F(     MATRICE = 'TANGENTE',
                                 REAC_INCR = 1,
                                 REAC_ITER = 5),
                  SOLVEUR=_F(),
                  CONVERGENCE=_F(ITER_GLOB_MAXI = 30,
                                 RESI_GLOB_RELA = 1.E-6)
                            )

COUPLA2=CALC_CHAMP(reuse=COUPLA2,CONTRAINTE=('SIGM_ELNO'),DEFORMATION=('EPSI_ELNO','EPFP_ELNO','EPSP_ELNO'),RESULTAT=COUPLA2)


RELEVE_3=POST_RELEVE_T(ACTION=(
                   _F(  RESULTAT = COUPLA2,
                            INTITULE = 'SIEF',
                            NOM_CHAM = 'SIGM_ELNO',
                            NOM_CMP = 'SIXX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'),
                   _F(  RESULTAT = COUPLA2,
                            INTITULE = 'EPSP',
                            NOM_CHAM = 'EPSP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'),
                   _F(  RESULTAT = COUPLA2,
                            INTITULE = 'EPSF',
                            NOM_CHAM = 'EPFP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'),)
                       )

TEST_TABLE(
           VALE_CALC=3.0771929999999998,
           TOLE_MACHINE=1.E-4,
           NOM_PARA='SIXX',
           TABLE=RELEVE_3,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='SIEF',),
                   _F(NOM_PARA='INST',
                      VALE=10.0,),
                   ),
           )

TEST_TABLE(
           VALE_CALC=7.3571779999999999E-07,
           TOLE_MACHINE=2.0000000000000001E-4,
           NOM_PARA='EPXX',
           TABLE=RELEVE_3,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSF',),
                   _F(NOM_PARA='INST',
                      VALE=10.0,),
                   ),
           )

TEST_TABLE(
           VALE_CALC=3.9999980000000002,
           TOLE_MACHINE=1.E-4,
           NOM_PARA='SIXX',
           TABLE=RELEVE_3,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='SIEF',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

TEST_TABLE(
           VALE_CALC=2.1405339999999999E-05,
           TOLE_MACHINE=1.E-4,
           NOM_PARA='EPXX',
           TABLE=RELEVE_3,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSF',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

TEST_TABLE(
           VALE_CALC=8.4951320000000005E-4,
           TOLE_MACHINE=1.E-4,
           NOM_PARA='EPXX',
           TABLE=RELEVE_3,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSP',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

################################################
###    COUPLAGE GRANGER_FP  VMIS_ISOT_LINE   ###
################################################

COUPLA3=STAT_NON_LINE(
                 TITRE='COUPLAGE FLUAGE/FISSURATION',
                 MODELE=MO,
                 EXCIT=(_F(  CHARGE = COND_LI2),
                        _F(  CHARGE = TRAC,
                             FONC_MULT = COEF_TR)),
                INCREMENT=_F(  LIST_INST = LINST),
                CHAM_MATER=CMV,
                COMP_INCR=_F(  RELATION = 'KIT_DDI',
                               RELATION_KIT = ('GRANGER_FP',
                                               'VMIS_ISOT_LINE',),
                               DEFORMATION = 'PETIT',
                               ITER_INTE_MAXI = 20,
                               ITER_INTE_PAS = 0,
                               RESI_INTE_RELA = 1.E-6,
                               TOUT = 'OUI'),
                NEWTON=_F(     MATRICE = 'TANGENTE',
                               REAC_INCR = 1,
                               REAC_ITER = 5),
                CONVERGENCE=_F(ITER_GLOB_MAXI = 30,
                               RESI_GLOB_RELA = 1.E-6),
              )

COUPLA3=CALC_CHAMP(reuse=COUPLA3,CONTRAINTE=('SIGM_ELNO'),DEFORMATION=('EPFP_ELNO','EPSP_ELNO'),RESULTAT=COUPLA3)


RELEVE_4=POST_RELEVE_T(ACTION=(
                   _F(  RESULTAT = COUPLA3,
                            INTITULE = 'SIEF',
                            NOM_CHAM = 'SIGM_ELNO',
                            NOM_CMP = 'SIXX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'),
                   _F(  RESULTAT = COUPLA3,
                            INTITULE = 'EPSP',
                            NOM_CHAM = 'EPSP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'),
                   _F(  RESULTAT = COUPLA3,
                            INTITULE = 'EPSF',
                            NOM_CHAM = 'EPFP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'),)
                       )

TEST_TABLE(
           VALE_CALC=3.0771929999999998,
           TOLE_MACHINE=1.E-4,
           NOM_PARA='SIXX',
           TABLE=RELEVE_4,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='SIEF',),
                   _F(NOM_PARA='INST',
                      VALE=10.0,),
                   ),
           )

TEST_TABLE(
           VALE_CALC=7.3571779999999999E-07,
           TOLE_MACHINE=2.0000000000000001E-4,
           NOM_PARA='EPXX',
           TABLE=RELEVE_4,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSF',),
                   _F(NOM_PARA='INST',
                      VALE=10.0,),
                   ),
           )

TEST_TABLE(
           VALE_CALC=4.0000090000000004,
           TOLE_MACHINE=1.E-4,
           NOM_PARA='SIXX',
           TABLE=RELEVE_4,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='SIEF',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

TEST_TABLE(
           VALE_CALC=2.1405370000000001E-05,
           TOLE_MACHINE=1.E-4,
           NOM_PARA='EPXX',
           TABLE=RELEVE_4,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSF',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

TEST_TABLE(
           VALE_CALC=8.4956210000000003E-4,
           TOLE_MACHINE=1.E-4,
           NOM_PARA='EPXX',
           TABLE=RELEVE_4,
           FILTRE=(_F(NOM_PARA='INTITULE',
                      VALE_K='EPSP',),
                   _F(NOM_PARA='INST',
                      VALE=100.0,),
                   ),
           )

FIN()
#
