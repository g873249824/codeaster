# TITRE IMPACT DE DEUX POUTRES ELASTIQUES
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# CAS_TEST__: SDNL111A

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

#

POUTRE=LIRE_MAILLAGE(FORMAT='MED', )

POUTRE=DEFI_GROUP( reuse=POUTRE,   MAILLAGE=POUTRE,
  CREA_GROUP_MA=_F(  NOM = 'TOUT', TOUT = 'OUI'))

#

MODELE=AFFE_MODELE(   MAILLAGE=POUTRE,
                         AFFE=_F( TOUT = 'OUI', PHENOMENE = 'MECANIQUE',
                        MODELISATION = 'POU_D_T'))

#
MATER1=DEFI_MATERIAU(  ELAS=_F( E = 2.E11,  NU = 0.,  RHO = 7800.0))

#
CHAMPMAT=AFFE_MATERIAU(  MAILLAGE=POUTRE,
                      AFFE=_F( TOUT = 'OUI',MATER = MATER1))

#
CHAMPCAR=AFFE_CARA_ELEM(  MODELE=MODELE,  POUTRE=_F(
       GROUP_MA = 'TOUT',

                        SECTION = 'RECTANGLE', CARA = ('H',),
                        VALE = (0.02, )))

#
CHARGE=AFFE_CHAR_MECA(  MODELE=MODELE,DDL_IMPO=(
                     _F( TOUT = 'OUI', DY = 0., DZ = 0.,
                                          DRX = 0., DRY = 0., DRZ = 0.),
                     _F( NOEUD = 'NO4', DX = 0.))
                       )

#
RIGIELEM=CALC_MATR_ELEM(  MODELE=MODELE,CHARGE=CHARGE,
                         CHAM_MATER=CHAMPMAT,
                         CARA_ELEM=CHAMPCAR,
                         OPTION='RIGI_MECA')

#
MASSELEM=CALC_MATR_ELEM(  MODELE=MODELE,CHARGE=CHARGE,
                         CHAM_MATER=CHAMPMAT,
                         CARA_ELEM=CHAMPCAR,
                         OPTION='MASS_MECA')

#
NUMEROTA=NUME_DDL(   MATR_RIGI=RIGIELEM )

#
MATRRIGI=ASSE_MATRICE(   MATR_ELEM=RIGIELEM,  NUME_DDL=NUMEROTA )

#
MATRMASS=ASSE_MATRICE(   MATR_ELEM=MASSELEM,  NUME_DDL=NUMEROTA )

#
MODES=MODE_ITER_SIMULT(   MATR_RIGI=MATRRIGI,  MATR_MASS=MATRMASS,

                         CALC_FREQ=_F( OPTION = 'CENTRE',
                        NMAX_FREQ = 40,
                        FREQ = 20000.),
                         VERI_MODE=_F(  STOP_ERREUR = 'OUI')
                         )


#
VITIPHYS=CREA_CHAMP( OPERATION='AFFE', PROL_ZERO='OUI', TYPE_CHAM='NOEU_DEPL_R',
                            MAILLAGE=POUTRE,AFFE=(
                            _F( GROUP_NO = 'POUTRE1',
                                  NOM_CMP = 'DX', VALE = -1.0),
                            _F( GROUP_NO = 'POUTRE2',
                                  NOM_CMP = 'DX', VALE = 0.0)),
                            NUME_DDL=NUMEROTA
                        )

#
##
PROJ_BASE(  BASE=MODES,
            STOCKAGE='DIAG',
            MATR_ASSE_GENE=(
             _F(
                             MATRICE = CO("MASSEPRO"),
                             MATR_ASSE = MATRMASS),
             _F(
                             MATRICE = CO("RIGIPROJ"),
                             MATR_ASSE = MATRRIGI)),
             VECT_ASSE_GENE=_F(
                             VECTEUR = CO("VITINI"),
                             VECT_ASSE = VITIPHYS,
                             TYPE_VECT = 'VITE')
)

#
PLANZ=DEFI_OBSTACLE(  TYPE='BI_PLAN_Z' )

PLANY=DEFI_OBSTACLE(  TYPE='BI_PLAN_Y' )

CERCLE=DEFI_OBSTACLE(  TYPE='BI_CERCLE' )

#
DYNAMODA=DYNA_VIBRA(TYPE_CALCUL='TRAN',BASE_CALCUL='GENE',
                       SCHEMA_TEMPS=_F(SCHEMA='EULER',),
                       MATR_MASS=MASSEPRO,
                       MATR_RIGI=RIGIPROJ,
                       AMOR_MODAL=_F(AMOR_REDUIT=(0.001,  ),),
                       ETAT_INIT=_F( VITE = VITINI),
                       INCREMENT=_F(  INST_INIT = 0.,
                                   INST_FIN = 0.00102,
                                   PAS = 1.E-6,
                                   VERI_PAS = 'NON'),
                      CHOC=_F(
                               NOEUD_1 = 'NO1',
                               NOEUD_2 = 'NO3',
                               INTITULE = 'LIAISON',
                               OBSTACLE = PLANZ,
                               NORM_OBST = (0., 0., 1., ),
                               DIST_1 = 5.E-6,
                               DIST_2 = 5.E-6,
                               RIGI_NOR = 5.E9,
                               AMOR_NOR = 2.E4,
                               RIGI_TAN = 0.,
                               AMOR_TAN = 0.,
                               FROTTEMENT='COULOMB',
                               COULOMB = 0.)
                       )

#
DYNAMOD2=DYNA_VIBRA(TYPE_CALCUL='TRAN',BASE_CALCUL='GENE',
                       SCHEMA_TEMPS=_F(SCHEMA='EULER',),
                       MATR_MASS=MASSEPRO,
                       MATR_RIGI=RIGIPROJ,
                       AMOR_MODAL=_F(AMOR_REDUIT=(0.001,  ),),
                       ETAT_INIT=_F( VITE = VITINI),
                       INCREMENT=_F(  INST_INIT = 0.,
                                   INST_FIN = 0.00102,
                                   PAS = 1.E-6,
                                   VERI_PAS = 'NON'),
                      CHOC=_F(
                               NOEUD_1 = 'NO1',
                               NOEUD_2 = 'NO3',
                               INTITULE = 'LIAISON',
                               OBSTACLE = PLANY,
                               NORM_OBST = (0., 1., 0., ),
                               DIST_1 = 5.E-6,
                               DIST_2 = 5.E-6,
                               RIGI_NOR = 5.E9,
                               AMOR_NOR = 2.E4,
                               RIGI_TAN = 0.,
                               AMOR_TAN = 0.,
                               FROTTEMENT='COULOMB',
                               COULOMB = 0.)
                       )

#
DYNAMOD3=DYNA_VIBRA(TYPE_CALCUL='TRAN',BASE_CALCUL='GENE',
                       SCHEMA_TEMPS=_F(SCHEMA='EULER',),
                       MATR_MASS=MASSEPRO,
                       MATR_RIGI=RIGIPROJ,
                       AMOR_MODAL=_F(AMOR_REDUIT=(0.001,  ),),
                       ETAT_INIT=_F( VITE = VITINI),
                       INCREMENT=_F(  INST_INIT = 0.,
                                   INST_FIN = 0.00102,
                                   PAS = 1.E-6,
                                   VERI_PAS = 'NON'),
                      CHOC=_F(
                               NOEUD_1 = 'NO1',
                               NOEUD_2 = 'NO3',
                               INTITULE = 'LIAISON',
                               OBSTACLE = CERCLE,
                               NORM_OBST = (0., 1., 0., ),
                               DIST_1 = 5.E-6,
                               DIST_2 = 5.E-6,
                               RIGI_NOR = 5.E9,
                               AMOR_NOR = 2.E4,
                               RIGI_TAN = 0.,
                               AMOR_TAN = 0.,
                               FROTTEMENT='COULOMB',
                               COULOMB = 0.)
                       )

DEPLX=RECU_FONCTION(   NOEUD='NO1', NOM_CMP='DX',
                    INTERPOL='LIN',
                    RESU_GENE=DYNAMODA,
                     NOM_CHAM='DEPL' )

DEPLX2=RECU_FONCTION(   NOEUD='NO1', NOM_CMP='DX',
                    INTERPOL='LIN',
                    RESU_GENE=DYNAMOD2,
                     NOM_CHAM='DEPL' )

DEPLX3=RECU_FONCTION(   NOEUD='NO1', NOM_CMP='DX',
                    INTERPOL='LIN',
                    RESU_GENE=DYNAMOD3,
                     NOM_CHAM='DEPL' )

TEST_FONCTION(VALEUR=(_F(VALE_CALC=-1.0077968682e-04,
                         VALE_REFE=-1.E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=2.0E-4,
                         PRECISION=1.E-2,
                         FONCTION=DEPLX,),
                      _F(VALE_CALC=-1.9373483811e-04,
                         VALE_REFE=-2.0E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=4.0E-4,
                         PRECISION=0.035,
                         FONCTION=DEPLX,),
                      _F(VALE_CALC=-9.5579435564e-05,
                         VALE_REFE=-1.E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=6.E-4,
                         PRECISION=0.05,
                         FONCTION=DEPLX,),
                      _F(VALE_CALC=7.9679302672e-06,
                         VALE_REFE=-1.0E-09,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=1.0E-05,
                         CRITERE='ABSOLU',
                         VALE_PARA=8.0E-4,
                         FONCTION=DEPLX,),
                      _F(VALE_CALC=2.0615655185e-04,
                         VALE_REFE=2.0E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=1.E-3,
                         PRECISION=0.035,
                         FONCTION=DEPLX,),
                      _F(VALE_CALC=-1.0077968682e-04,
                         VALE_REFE=-1.E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=2.0E-4,
                         PRECISION=1.E-2,
                         FONCTION=DEPLX2,),
                      _F(VALE_CALC=-1.9373483811e-04,
                         VALE_REFE=-2.0E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=4.0E-4,
                         PRECISION=0.035,
                         FONCTION=DEPLX2,),
                      _F(VALE_CALC=-9.5579435564e-05,
                         VALE_REFE=-1.E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=6.E-4,
                         PRECISION=0.05,
                         FONCTION=DEPLX2,),
                      _F(VALE_CALC=7.9679302672e-06,
                         VALE_REFE=-1.0E-09,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=1.0E-05,
                         CRITERE='ABSOLU',
                         VALE_PARA=8.0E-4,
                         FONCTION=DEPLX2,),
                      _F(VALE_CALC=2.0615655185e-04,
                         VALE_REFE=2.0E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=1.E-3,
                         PRECISION=0.035,
                         FONCTION=DEPLX2,),
                      _F(VALE_CALC=-1.0077968682e-04,
                         VALE_REFE=-1.E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=2.0E-4,
                         PRECISION=1.E-2,
                         FONCTION=DEPLX3,),
                      _F(VALE_CALC=-1.9373483811e-04,
                         VALE_REFE=-2.0E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=4.0E-4,
                         PRECISION=0.035,
                         FONCTION=DEPLX3,),
                      _F(VALE_CALC=-9.5579435564e-05,
                         VALE_REFE=-1.E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=6.E-4,
                         PRECISION=0.05,
                         FONCTION=DEPLX3,),
                      _F(VALE_CALC=7.9679302672e-06,
                         VALE_REFE=-1.0E-09,
                         REFERENCE='ANALYTIQUE',
                         PRECISION=1.0E-05,
                         CRITERE='ABSOLU',
                         VALE_PARA=8.0E-4,
                         FONCTION=DEPLX3,),
                      _F(VALE_CALC=2.0615655185e-04,
                         VALE_REFE=2.0E-4,
                         REFERENCE='ANALYTIQUE',
                         VALE_PARA=1.E-3,
                         PRECISION=0.035,
                         FONCTION=DEPLX3,),
                      ),
              )

#
FIN()
#
