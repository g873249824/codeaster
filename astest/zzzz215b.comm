# TITRE CHAINAGE 3D CODE_SATURNE CODE_ASTER
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

DEBUT(CODE=_F(NOM='ZZZZ215B', NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'),
      IGNORE_ALARM=('CALCULEL2_63','CALCULEL2_64'))

# <CALCULEL2_63> : DANS UN MODELE, IL EXISTE DES ELEMENTS DE TYPE "BORD" QUI N'ONT PAS DE VOISIN AVEC RIGIDITE
# <CALCULEL2_64> : DANS UN MODELE, IL N'Y A AUCUN ELEMENT AVEC AVEC RIGIDITE
#  LE MODELE PROVOQUANT CES ALARMES EST UN MODELE FLUIDE

# ==============================================================
# CREATION D'UN CHAMP DE PRESSION SUR LA PEAU
# DU CUBE MAILLE FIN A L'AIDE D'UNE FONCTION
# DE L'ESPACE ET DU TEMPS
# ==============================================================

MAFLUIDE=LIRE_MAILLAGE(UNITE=22,
                       FORMAT='MED',);


MOFLUIDE=AFFE_MODELE(MAILLAGE=MAFLUIDE,
                  AFFE=_F(GROUP_MA=('Face1','Face2','Face3','Face4','Face5','Face6',),
                          PHENOMENE='MECANIQUE',
                          MODELISATION='3D',),);

FORM=FORMULE(NOM_PARA=('X','Y','Z','INST'),
                VALE='1.E-4*INST*(X+Y+Z)');

VALE=CREA_CHAMP(TYPE_CHAM='NOEU_PRES_F',
                OPERATION='AFFE',
                MODELE=MOFLUIDE,

                AFFE=_F(TOUT='OUI',
                        NOM_CMP='PRES',
                        VALE_F=FORM,),
                INFO=1,);

L_INST0=DEFI_LIST_REEL(DEBUT=0.0,
                       INTERVALLE=_F(JUSQU_A=1.0,
                                     NOMBRE=2,),);

RES_PRES=CREA_RESU(OPERATION='AFFE',
                   TYPE_RESU='EVOL_CHAR',
                   NOM_CHAM='PRES',
                   AFFE=_F(CHAM_GD=VALE,
                           MODELE=MOFLUIDE,
                           LIST_INST=L_INST0),
                        );

#IMPR_RESU(FORMAT='GMSH',
#          UNITE=97,
#          RESU=_F(RESULTAT=RES_PRES,
#                  ),);


# ==============================================================
# EXPLOITATION DE CET EVOL_CHAR DANS UN CALCUL MECANIQUE
#   - on projete la pression fluide sur le maillage mecanique
#   - on cree un evol_char utilise pour la resolution
# ==============================================================

MASOLIDE=LIRE_MAILLAGE(UNITE=23,
                       FORMAT='MED',);

MOSOLIDE=AFFE_MODELE(MAILLAGE=MASOLIDE,
                  AFFE=_F(TOUT='OUI',
                          PHENOMENE='MECANIQUE',
                          MODELISATION='3D',),);

ACIER=DEFI_MATERIAU(ELAS=_F(E=1.,
                            NU=0.3,),);

MATER=AFFE_MATERIAU(MAILLAGE=MASOLIDE,
                    AFFE=_F(TOUT='OUI',
                            MATER=ACIER,),);

RES_PROJ=PROJ_CHAMP(METHODE='COLLOCATION',
                    RESULTAT=RES_PRES,
                    MODELE_1=MOFLUIDE,
                    MODELE_2=MOSOLIDE,
                    VIS_A_VIS=_F(TOUT_1='OUI',
                                 GROUP_MA_2=('Face1','Face2','Face3','Face4','Face5','Face6',),),
                    );

#IMPR_RESU(FORMAT='GMSH',
#          UNITE=98,
#          RESU=_F(RESULTAT=RES_PROJ,),);

CHA_PROJ=AFFE_CHAR_MECA(MODELE=MOSOLIDE,
                        EVOL_CHAR=RES_PROJ,);

CHA_IMPO=AFFE_CHAR_MECA(MODELE=MOSOLIDE,
                      FACE_IMPO=_F(GROUP_MA='Face1',
                                   DX=0.0,
                                   DY=0.0,
                                   DZ=0.0,),);

L_INST=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=_F(JUSQU_A=1.0,
                                    NOMBRE=5,),);


RAMPE=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(0.0,0.0,1.0,1.0,),);


RESU=STAT_NON_LINE(MODELE=MOSOLIDE,
                   CHAM_MATER=MATER,
                   EXCIT=(_F(CHARGE=CHA_IMPO,),
                          _F(CHARGE=CHA_PROJ,),),
                   COMP_INCR=_F(RELATION='ELAS',),
                   INCREMENT=_F(LIST_INST=L_INST,),
                   );


TEST_RESU(RESU=(_F(INST=1.0,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N134',
                   NOM_CMP='DX',
                   VALE_CALC=-9.3603275999999997,

                   MAILLE='M81',
                   ),
                _F(INST=1.0,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N134',
                   NOM_CMP='DY',
                   VALE_CALC=-2.3152018999999999,

                   MAILLE='M81',
                   ),
                _F(INST=1.0,
                   RESULTAT=RESU,
                   NOM_CHAM='DEPL',
                   NOEUD='N134',
                   NOM_CMP='DZ',
                   VALE_CALC=-6.97205648,

                   MAILLE='M81',
                   ),
                ),
          )

#IMPR_RESU(FORMAT='GMSH',
#          UNITE=99,
#          RESU=_F(RESULTAT=RESU,
#                  NOM_CHAM='DEPL',),);

FIN();
