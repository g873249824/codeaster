# MODIF  DATE 16/11/2009   AUTEUR DURAND C.DURAND 
# TITRE TUBE SOUS PRESSION A TEMPERATURE CONSTANTE 
# hsnv134b.para = tps_job 900 mem_job 150Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2008  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
# AVEC LOI META_LEMA_ANI EN MODELISATION 3D
# TEST V7.22.134
# MAILLAGE : HEXA20
# FICHIER .33 ZMAT
# ***material
# *integration theta_method_a 1. 1.e-12 100
# ***behavior gen_evp
# **elasticity
# young 80000.
# poisson 0.35
# **potential gen_evp ev
# *flow norton
# K 253.5497
# n 4.39
# *criterion anisotropic orthotropic
# c11 0.294267      c22 0.6666667      c33 0.476
# c44 0.5            c55  0.5           c66 0.5
# c12 -0.242467      c23  -0.4242    c31 -0.0518
# *isotropic constant
# R0 0.
# ***return

DEBUT(CODE=_F(NOM='HSNV134B',NIV_PUB_WEB='INTERNET',),);

MAIL=LIRE_MAILLAGE(UNITE=20,
                   FORMAT='MED',);

MAIL=MODI_MAILLAGE(reuse =MAIL,
                   MAILLAGE=MAIL,
                   ORIE_PEAU_3D=_F(GROUP_MA=('FACE_INT','FACE_SUP',),),);

# PARTIES THERMIQUE ET METALLURGIQUE
# TEMPERATURE DE 700 DEGRES PARTOUT DANS LE TUBE 
# ET CONSTANTE AU COURS DU TEMPS 
# A CETTE TEMPERATURE PAS DE TRANSFORMATION

ZIRCALOY=DEFI_MATERIAU(THER=_F(RHO_CP = 2000000.0, LAMBDA = 9999.9),
                        META_ZIRC=_F(
                                  TDEQ = 809.,   K = 1.135E-2,   N = 2.187,
                                  T1C = 831. , T2C=0., 
                                  QSR_K = 14614.,AC = 1.58E-4,  M = 4.7,
                                  T1R=949.1, T2R=0.,AR = -5.725,  BR = 0.05))

CHMAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                    AFFE=_F(TOUT = 'OUI',MATER = ZIRCALOY))

MOTH=AFFE_MODELE(MAILLAGE=MAIL,
                 AFFE=_F(TOUT = 'OUI',
                         MODELISATION = '3D',
                         PHENOMENE = 'THERMIQUE'))

TFONC=DEFI_FONCTION(NOM_PARA='INST',
                    NOM_RESU='TEMP',
                    VALE=( 0. ,    700.0,
                           100.,   700.,),
                    PROL_GAUCHE='CONSTANT',
                    PROL_DROITE='CONSTANT',)

TIMPO=CREA_CHAMP(OPERATION='AFFE',
                 TYPE_CHAM='NOEU_TEMP_F',
                 MAILLAGE=MAIL,
                 AFFE=_F(TOUT = 'OUI',
                         NOM_CMP = 'TEMP',
                         VALE_F = TFONC))

L_INST=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=(
                      _F(JUSQU_A=1.1,NOMBRE = 10),
                      _F(JUSQU_A=100.,NOMBRE = 10),),)

PHASINIT=CREA_CHAMP(OPERATION='AFFE',
                    TYPE_CHAM='CART_VAR2_R',
                    MAILLAGE=MAIL,
                    AFFE=_F(TOUT = 'OUI',
                            NOM_CMP = ('V1', 'V2', 'V3','V4'),
                            VALE = ( 1.0, 0.0, 20.,0.)))

TEMPE=CREA_RESU(OPERATION='AFFE',
                TYPE_RESU='EVOL_THER',
                NOM_CHAM='TEMP',
                AFFE=_F(CHAM_GD = TIMPO,
                        LIST_INST = L_INST))

TEMPE=CALC_META(reuse=TEMPE,
                MODELE=MOTH,
                CHAM_MATER=CHMAT,
                RESULTAT=TEMPE,
                ETAT_INIT=_F( META_INIT_ELNO = PHASINIT),
                COMP_INCR=_F(RELATION = 'ZIRC',
                             TOUT = 'OUI'),
                OPTION='META_ELNO_TEMP',);

# PARTIE MECANIQUE
# ON DEGENERE LA LOI POUR AVOIR UNE LOI DE VISCOSITE
# DE TYPE NORTON D OU F1_M=0.D0                                 
# CETTE LOI ANISOTROPE AVEC UNE SEULE PHASE ET UNE LOI DE NORTON
# EST IDENTIQUE A UNE LOI CONTENUE DANS ZMAT
                             
ACIER=DEFI_MATERIAU(ELAS_META=_F(E = 80000.,
                               NU = 0.35,
                               F_ALPHA = 8.E-6,
                               C_ALPHA = 8.E-6,
                               PHASE_REFE = 'FROID',
                               EPSF_EPSC_TREF = 0.,),
                   META_LEMA_ANI=_F(
                            F1_A=2.39,    F2_A=0.22,     C_A=9.36,  
                            F1_M=0.0,    F2_M=0.77E-04, C_M=0.99E-04,  
                            F1_N=4.39,    F2_N=2.96,     C_N=6.11,  
                            F1_Q=19922.8, F2_Q=21023.7,  C_Q=6219., 
                            F_MRR_RR=0.4414,             C_MRR_RR=1.,
                            F_MTT_TT=0.714,              C_MTT_TT=1.,
                            F_MZZ_ZZ=1.,                 C_MZZ_ZZ=1.,
                            F_MRT_RT=0.75,               C_MRT_RT=0.75,
                            F_MRZ_RZ=0.75,               C_MRZ_RZ=0.75,
                            F_MTZ_TZ=0.75,               C_MTZ_TZ=0.75,),),

CM2=AFFE_MATERIAU(MAILLAGE=MAIL,
                  AFFE=_F( TOUT = 'OUI', MATER = ACIER ),
                  AFFE_VARC=(_F(TOUT='OUI',
                                EVOL=TEMPE,
                                NOM_VARC='M_ZIRC',
                                NOM_CHAM='META_ELNO_TEMP'),
                             _F(TOUT='OUI',
                                EVOL=TEMPE,
                                VALE_REF=700.,
                                NOM_VARC='TEMP',
                                NOM_CHAM='TEMP'),))

MO=AFFE_MODELE(MAILLAGE=MAIL,
               AFFE=_F(TOUT='OUI',
                       PHENOMENE ='MECANIQUE',
                       MODELISATION ='3D'))

CH_L=AFFE_CHAR_MECA(MODELE=MO,
                    FACE_IMPO=(_F(GROUP_MA='FACE_INF',DNOR=0.,),
                               _F(GROUP_MA='FACE_X0',DX=0.,),
                               _F(GROUP_MA='FACE_Y0',DY=0.,),),
                    LIAISON_UNIF=_F(GROUP_MA='FACE_SUP',DDL='DZ',),);

# ON MET UNE PRESSION INTERNE ET L EFFET DE FOND
RINT = 4.118;
REXT = 4.746;
COEF = ((RINT * RINT) / ((REXT * REXT) - (RINT * RINT)));

CHPC=AFFE_CHAR_MECA(MODELE=MO,
                    PRES_REP=(_F(GROUP_MA='FACE_INT',PRES=1.,),
                              _F(GROUP_MA='FACE_SUP',PRES=-COEF,),),);

FMULT=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(0.0,0.0,
                          1.1,7.5,
                          100.0,9.5,),
                    PROL_DROITE='CONSTANT',
                    PROL_GAUCHE='CONSTANT',);
                    
U=STAT_NON_LINE(MODELE=MO,
                CHAM_MATER=CM2,
                EXCIT=(_F(CHARGE = CHPC,FONC_MULT = FMULT),
                       _F(CHARGE = CH_L),),
                COMP_INCR=_F(RELATION = 'META_LEMA_ANI',
                             RELATION_KIT='ZIRC',
                             ITER_INTE_MAXI=10,
                             RESI_INTE_RELA=1.E-06),
               INCREMENT=_F(LIST_INST = L_INST,),
               NEWTON=_F(MATRICE = 'TANGENTE',
                         REAC_ITER = 1),
               CONVERGENCE=_F(RESI_GLOB_RELA = 1.E-6,
                              ITER_GLOB_MAXI = 30))

U=CALC_ELEM(reuse=U,
            RESULTAT=U,
            OPTION=('SIEF_ELNO_ELGA',
                    'EPSI_ELGA_DEPL',
                    'EPSI_ELNO_DEPL'),)

U=CALC_NO(reuse =U,
          RESULTAT=U,
          OPTION=('EPSI_NOEU_DEPL','SIEF_NOEU_ELGA',),);                    


U_C=MODI_REPERE(RESULTAT=U,
                INST=100.,
                MODI_CHAM=(_F(GROUP_NO=('NA','NB'),
                              TYPE_CHAM='TENS_3D',
                              NOM_CHAM='SIEF_NOEU_ELGA',
                              NOM_CMP=('SIXX','SIYY','SIZZ','SIXY','SIXZ','SIYZ',),),
                           _F(GROUP_NO=('NA','NB'),
                              TYPE_CHAM='TENS_3D',
                              NOM_CHAM='EPSI_NOEU_DEPL',
                              NOM_CMP=('EPXX','EPYY','EPZZ','EPXY','EPXZ','EPYZ',),),),
                   DEFI_REPERE=_F(REPERE='CYLINDRIQUE',
                                  ORIGINE=(0.0,0.0,0.0,),
                                  AXE_Z=(0.0,0.0,1.0,),),);

# NA (CE NOEUD SE SITUE A L INTERIEUR DU TUBE EN Y=0)
# TEST DES TROIS DEFORMATIONS ET DES TROIS CONTRAINTES
# COMPARAISON AVEC LA SOLUTION ZMAT

TEST_RESU(RESU=( 
            _F(RESULTAT = U_C,  NOM_CHAM = 'SIEF_NOEU_ELGA',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 0.5,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NA',  
               NOM_CMP = 'SIXX', VALE = -9.442),
            _F(RESULTAT = U_C,  NOM_CHAM = 'SIEF_NOEU_ELGA',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 0.5,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NA',  
               NOM_CMP = 'SIZZ', VALE = 60.226),
            _F(RESULTAT = U_C,  NOM_CHAM = 'SIEF_NOEU_ELGA',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 0.5,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NA',  
               NOM_CMP = 'SIYY', VALE = 26.795),
            _F(RESULTAT = U_C,  NOM_CHAM = 'EPSI_NOEU_DEPL',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 1.E-04,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NA',  
               NOM_CMP = 'EPXX', VALE = -9.49597E-03),
            _F(RESULTAT = U_C,  NOM_CHAM = 'EPSI_NOEU_DEPL',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 1.E-04,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NA',  
               NOM_CMP = 'EPZZ', VALE = 1.35633E-02),
            _F(RESULTAT = U_C,  NOM_CHAM = 'EPSI_NOEU_DEPL',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 1.E-04,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NA',  
               NOM_CMP = 'EPYY', VALE = -3.77690E-03),),);

# NB (CE NOEUD SE SITUE A L EXTERIEUR DU TUBE EN Y=0)
# TEST DES TROIS DEFORMATIONS ET DES TROIS CONTRAINTES
# COMPARAISON AVEC LA SOLUTION ZMAT

TEST_RESU(RESU=( 
            _F(RESULTAT = U_C,  NOM_CHAM = 'SIEF_NOEU_ELGA',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 0.5,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NB',  
               NOM_CMP = 'SIXX', VALE = 3.28215E-02 ),
            _F(RESULTAT = U_C,  NOM_CHAM = 'SIEF_NOEU_ELGA',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 0.5,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NB',  
               NOM_CMP = 'SIZZ', VALE = 64.199),
            _F(RESULTAT = U_C,  NOM_CHAM = 'SIEF_NOEU_ELGA',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 0.5,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NB',  
               NOM_CMP = 'SIYY', VALE = 30.771),
            _F(RESULTAT = U_C,  NOM_CHAM = 'EPSI_NOEU_DEPL',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 1.E-04,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NB',  
               NOM_CMP = 'EPXX', VALE = -6.58609E-03),
            _F(RESULTAT = U_C,  NOM_CHAM = 'EPSI_NOEU_DEPL',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 1.E-04,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NB',  
               NOM_CMP = 'EPZZ', VALE = 1.07189E-02),
            _F(RESULTAT = U_C,  NOM_CHAM = 'EPSI_NOEU_DEPL',
               NUME_ORDRE = 20,  CRITERE = 'ABSOLU', PRECISION = 1.E-04,
               REFERENCE = 'SOURCE_EXTERNE',
               GROUP_NO = 'NB',  
               NOM_CMP = 'EPYY', VALE = -3.77690E-03),),);                  
                 
FIN()
